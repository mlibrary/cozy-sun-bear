<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
=======
{"version":3,"file":"cozy-sun-bear.js","sources":["../node_modules/url-polyfill/url-polyfill.js","../node_modules/classlist-polyfill/src/index.js","../src/core/Util.js","../src/core/Class.js","../src/core/Events.js","../src/core/Browser.js","../src/geometry/Point.js","../src/dom/DomEvent.Pointer.js","../src/dom/DomEvent.DoubleTap.js","../src/dom/DomEvent.js","../src/dom/DomUtil.js","../node_modules/lodash/isObject.js","../node_modules/lodash/_freeGlobal.js","../node_modules/lodash/_root.js","../node_modules/lodash/_Symbol.js","../node_modules/lodash/_getRawTag.js","../node_modules/lodash/_objectToString.js","../node_modules/lodash/_baseGetTag.js","../node_modules/lodash/isObjectLike.js","../node_modules/lodash/isFunction.js","../node_modules/lodash/_coreJsData.js","../node_modules/lodash/_isMasked.js","../node_modules/lodash/_toSource.js","../node_modules/lodash/_baseIsNative.js","../node_modules/lodash/_getValue.js","../node_modules/lodash/_getNative.js","../node_modules/lodash/_defineProperty.js","../node_modules/lodash/_baseAssignValue.js","../node_modules/lodash/eq.js","../node_modules/lodash/_assignValue.js","../node_modules/lodash/_copyObject.js","../node_modules/lodash/identity.js","../node_modules/lodash/_apply.js","../node_modules/lodash/_overRest.js","../node_modules/lodash/constant.js","../node_modules/lodash/_baseSetToString.js","../node_modules/lodash/_shortOut.js","../node_modules/lodash/_setToString.js","../node_modules/lodash/_baseRest.js","../node_modules/lodash/isLength.js","../node_modules/lodash/isArrayLike.js","../node_modules/lodash/_isIndex.js","../node_modules/lodash/_isIterateeCall.js","../node_modules/lodash/_createAssigner.js","../node_modules/lodash/_isPrototype.js","../node_modules/lodash/_baseTimes.js","../node_modules/lodash/_baseIsArguments.js","../node_modules/lodash/isArguments.js","../node_modules/lodash/isArray.js","../node_modules/lodash/stubFalse.js","../node_modules/lodash/isBuffer.js","../node_modules/lodash/_baseIsTypedArray.js","../node_modules/lodash/_baseUnary.js","../node_modules/lodash/_nodeUtil.js","../node_modules/lodash/isTypedArray.js","../node_modules/lodash/_arrayLikeKeys.js","../node_modules/lodash/_overArg.js","../node_modules/lodash/_nativeKeys.js","../node_modules/lodash/_baseKeys.js","../node_modules/lodash/keys.js","../node_modules/lodash/assign.js","../src/screenfull.js","../src/reader/Reader.js","../src/control/Control.js","../src/control/Control.Paging.js","../src/control/Modal.js","../src/control/Control.Contents.js","../src/control/Control.Title.js","../src/control/Control.PublicationMetadata.js","../src/control/Control.Preferences.js","../src/control/Control.Widget.js","../src/control/Control.Citation.js","../src/control/Control.Search.js","../src/control/Control.BibliographicInformation.js","../src/control/Control.Download.js","../src/control/Control.Navigator.js","../src/control/index.js","../src/core/Bus.js","../src/core/index.js","../src/epubjs.js","../node_modules/path-webpack/path.js","../src/reader/Reader.EpubJS.js","../src/reader/Reader.Mock.js","../src/reader/index.js"],"sourcesContent":["(function(global) {\r\n  /**\r\n   * Polyfill URLSearchParams\r\n   *\r\n   * Inspired from : https://github.com/WebReflection/url-search-params/blob/master/src/url-search-params.js\r\n   */\r\n\r\n  var checkIfIteratorIsSupported = function() {\r\n    try {\r\n      return !!Symbol.iterator;\r\n    } catch(error) {\r\n      return false;\r\n    }\r\n  };\r\n\r\n\r\n  var iteratorSupported = checkIfIteratorIsSupported();\r\n\r\n  var createIterator = function(items) {\r\n    var iterator = {\r\n      next: function() {\r\n        var value = items.shift();\r\n        return { done: value === void 0, value: value };\r\n      }\r\n    };\r\n\r\n    if(iteratorSupported) {\r\n      iterator[Symbol.iterator] = function() {\r\n        return iterator;\r\n      };\r\n    }\r\n\r\n    return iterator;\r\n  };\r\n\r\n  /**\r\n   * Search param name and values should be encoded according to https://url.spec.whatwg.org/#urlencoded-serializing\r\n   * encodeURIComponent() produces the same result except encoding spaces as `%20` instead of `+`.\r\n   */\r\n  var serializeParam = function(value) {\r\n    return encodeURIComponent(value).replace(/%20/g, '+');\r\n  };\r\n\r\n  var deserializeParam = function(value) {\r\n    return decodeURIComponent(value).replace(/\\+/g, ' ');\r\n  };\r\n\r\n  var polyfillURLSearchParams= function() {\r\n\r\n    var URLSearchParams = function(searchString) {\r\n      Object.defineProperty(this, '_entries', { value: {} });\r\n\r\n      if(typeof searchString === 'string') {\r\n        if(searchString !== '') {\r\n          searchString = searchString.replace(/^\\?/, '');\r\n          var attributes = searchString.split('&');\r\n          var attribute;\r\n          for(var i = 0; i < attributes.length; i++) {\r\n            attribute = attributes[i].split('=');\r\n            this.append(\r\n              deserializeParam(attribute[0]),\r\n              (attribute.length > 1) ? deserializeParam(attribute[1]) : ''\r\n            );\r\n          }\r\n        }\r\n      } else if(searchString instanceof URLSearchParams) {\r\n        var _this = this;\r\n        searchString.forEach(function(value, name) {\r\n          _this.append(value, name);\r\n        });\r\n      }\r\n    };\r\n\r\n    var proto = URLSearchParams.prototype;\r\n\r\n    proto.append = function(name, value) {\r\n      if(name in this._entries) {\r\n        this._entries[name].push(value.toString());\r\n      } else {\r\n        this._entries[name] = [value.toString()];\r\n      }\r\n    };\r\n\r\n    proto.delete = function(name) {\r\n      delete this._entries[name];\r\n    };\r\n\r\n    proto.get = function(name) {\r\n      return (name in this._entries) ? this._entries[name][0] : null;\r\n    };\r\n\r\n    proto.getAll = function(name) {\r\n      return (name in this._entries) ? this._entries[name].slice(0) : [];\r\n    };\r\n\r\n    proto.has = function(name) {\r\n      return (name in this._entries);\r\n    };\r\n\r\n    proto.set = function(name, value) {\r\n      this._entries[name] = [value.toString()];\r\n    };\r\n\r\n    proto.forEach = function(callback, thisArg) {\r\n      var entries;\r\n      for(var name in this._entries) {\r\n        if(this._entries.hasOwnProperty(name)) {\r\n          entries = this._entries[name];\r\n          for(var i = 0; i < entries.length; i++) {\r\n            callback.call(thisArg, entries[i], name, this);\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    proto.keys = function() {\r\n      var items = [];\r\n      this.forEach(function(value, name) { items.push(name); });\r\n      return createIterator(items);\r\n    };\r\n\r\n    proto.values = function() {\r\n      var items = [];\r\n      this.forEach(function(value) { items.push(value); });\r\n      return createIterator(items);\r\n    };\r\n\r\n    proto.entries = function() {\r\n      var items = [];\r\n      this.forEach(function(value, name) { items.push([name, value]); });\r\n      return createIterator(items);\r\n    };\r\n\r\n    if(iteratorSupported) {\r\n      proto[Symbol.iterator] = proto.entries;\r\n    }\r\n\r\n    proto.toString = function() {\r\n      var searchString = '';\r\n      this.forEach(function(value, name) {\r\n        if(searchString.length > 0) searchString+= '&';\r\n        searchString += serializeParam(name) + '=' + serializeParam(value);\r\n      });\r\n      return searchString;\r\n    };\r\n\r\n    global.URLSearchParams = URLSearchParams;\r\n  };\r\n\r\n  if(!('URLSearchParams' in global) || (new URLSearchParams('?a=1').toString() !== 'a=1')) {\r\n    polyfillURLSearchParams();\r\n  }\r\n\r\n  // HTMLAnchorElement\r\n\r\n})(\r\n  (typeof global !== 'undefined') ? global\r\n    : ((typeof window !== 'undefined') ? window\r\n    : ((typeof self !== 'undefined') ? self : this))\r\n);\r\n\r\n(function(global) {\r\n  /**\r\n   * Polyfill URL\r\n   *\r\n   * Inspired from : https://github.com/arv/DOM-URL-Polyfill/blob/master/src/url.js\r\n   */\r\n\r\n  var checkIfURLIsSupported = function() {\r\n    try {\r\n      var u = new URL('b', 'http://a');\r\n      u.pathname = 'c%20d';\r\n      return (u.href === 'http://a/c%20d') && u.searchParams;\r\n    } catch(e) {\r\n      return false;\r\n    }\r\n  };\r\n\r\n\r\n  var polyfillURL = function() {\r\n    var _URL = global.URL;\r\n\r\n    var URL = function(url, base) {\r\n      if(typeof url !== 'string') url = String(url);\r\n\r\n      var doc = document.implementation.createHTMLDocument('');\r\n      window.doc = doc;\r\n      if(base) {\r\n        var baseElement = doc.createElement('base');\r\n        baseElement.href = base;\r\n        doc.head.appendChild(baseElement);\r\n      }\r\n\r\n      var anchorElement = doc.createElement('a');\r\n      anchorElement.href = url;\r\n      doc.body.appendChild(anchorElement);\r\n      anchorElement.href = anchorElement.href; // force href to refresh\r\n\r\n      if(anchorElement.protocol === ':' || !/:/.test(anchorElement.href)) {\r\n        throw new TypeError('Invalid URL');\r\n      }\r\n\r\n      Object.defineProperty(this, '_anchorElement', {\r\n        value: anchorElement\r\n      });\r\n    };\r\n\r\n    var proto = URL.prototype;\r\n\r\n    var linkURLWithAnchorAttribute = function(attributeName) {\r\n      Object.defineProperty(proto, attributeName, {\r\n        get: function() {\r\n          return this._anchorElement[attributeName];\r\n        },\r\n        set: function(value) {\r\n          this._anchorElement[attributeName] = value;\r\n        },\r\n        enumerable: true\r\n      });\r\n    };\r\n\r\n    ['hash', 'host', 'hostname', 'port', 'protocol', 'search']\r\n    .forEach(function(attributeName) {\r\n      linkURLWithAnchorAttribute(attributeName);\r\n    });\r\n\r\n    Object.defineProperties(proto, {\r\n\r\n      'toString': {\r\n        get: function() {\r\n          var _this = this;\r\n          return function() {\r\n            return _this.href;\r\n          };\r\n        }\r\n      },\r\n\r\n      'href' : {\r\n        get: function() {\r\n          return this._anchorElement.href.replace(/\\?$/,'');\r\n        },\r\n        set: function(value) {\r\n          this._anchorElement.href = value;\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'pathname' : {\r\n        get: function() {\r\n          return this._anchorElement.pathname.replace(/(^\\/?)/,'/');\r\n        },\r\n        set: function(value) {\r\n          this._anchorElement.pathname = value;\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'origin': {\r\n        get: function() {\r\n          // get expected port from protocol\r\n          var expectedPort = {'http:': 80, 'https:': 443, 'ftp:': 21}[this._anchorElement.protocol];\r\n          // add port to origin if, expected port is different than actual port\r\n          // and it is not empty f.e http://foo:8080\r\n          // 8080 != 80 && 8080 != ''\r\n          var addPortToOrigin = this._anchorElement.port != expectedPort &&\r\n            this._anchorElement.port !== ''\r\n\r\n          return this._anchorElement.protocol +\r\n            '//' +\r\n            this._anchorElement.hostname +\r\n            (addPortToOrigin ? (':' + this._anchorElement.port) : '');\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'password': { // TODO\r\n        get: function() {\r\n          return '';\r\n        },\r\n        set: function(value) {\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'username': { // TODO\r\n        get: function() {\r\n          return '';\r\n        },\r\n        set: function(value) {\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'searchParams': {\r\n        get: function() {\r\n          var searchParams = new URLSearchParams(this.search);\r\n          var _this = this;\r\n          ['append', 'delete', 'set'].forEach(function(methodName) {\r\n            var method = searchParams[methodName];\r\n            searchParams[methodName] = function() {\r\n              method.apply(searchParams, arguments);\r\n              _this.search = searchParams.toString();\r\n            };\r\n          });\r\n          return searchParams;\r\n        },\r\n        enumerable: true\r\n      }\r\n    });\r\n\r\n    URL.createObjectURL = function(blob) {\r\n      return _URL.createObjectURL.apply(_URL, arguments);\r\n    };\r\n\r\n    URL.revokeObjectURL = function(url) {\r\n      return _URL.revokeObjectURL.apply(_URL, arguments);\r\n    };\r\n\r\n    global.URL = URL;\r\n\r\n  };\r\n\r\n  if(!checkIfURLIsSupported()) {\r\n    polyfillURL();\r\n  }\r\n\r\n  if((global.location !== void 0) && !('origin' in global.location)) {\r\n    var getOrigin = function() {\r\n      return global.location.protocol + '//' + global.location.hostname + (global.location.port ? (':' + global.location.port) : '');\r\n    };\r\n\r\n    try {\r\n      Object.defineProperty(global.location, 'origin', {\r\n        get: getOrigin,\r\n        enumerable: true\r\n      });\r\n    } catch(e) {\r\n      setInterval(function() {\r\n        global.location.origin = getOrigin();\r\n      }, 100);\r\n    }\r\n  }\r\n\r\n})(\r\n  (typeof global !== 'undefined') ? global\r\n    : ((typeof window !== 'undefined') ? window\r\n    : ((typeof self !== 'undefined') ? self : this))\r\n);\r\n","/*\n * classList.js: Cross-browser full element.classList implementation.\n * 1.1.20170427\n *\n * By Eli Grey, http://eligrey.com\n * License: Dedicated to the public domain.\n *   See https://github.com/eligrey/classList.js/blob/master/LICENSE.md\n */\n\n/*global self, document, DOMException */\n\n/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js */\n\nif (\"document\" in window.self) {\n\n// Full polyfill for browsers with no classList support\n// Including IE < Edge missing SVGElement.classList\nif (!(\"classList\" in document.createElement(\"_\")) \n\t|| document.createElementNS && !(\"classList\" in document.createElementNS(\"http://www.w3.org/2000/svg\",\"g\"))) {\n\n(function (view) {\n\n\"use strict\";\n\nif (!('Element' in view)) return;\n\nvar\n\t  classListProp = \"classList\"\n\t, protoProp = \"prototype\"\n\t, elemCtrProto = view.Element[protoProp]\n\t, objCtr = Object\n\t, strTrim = String[protoProp].trim || function () {\n\t\treturn this.replace(/^\\s+|\\s+$/g, \"\");\n\t}\n\t, arrIndexOf = Array[protoProp].indexOf || function (item) {\n\t\tvar\n\t\t\t  i = 0\n\t\t\t, len = this.length\n\t\t;\n\t\tfor (; i < len; i++) {\n\t\t\tif (i in this && this[i] === item) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t}\n\t// Vendors: please allow content code to instantiate DOMExceptions\n\t, DOMEx = function (type, message) {\n\t\tthis.name = type;\n\t\tthis.code = DOMException[type];\n\t\tthis.message = message;\n\t}\n\t, checkTokenAndGetIndex = function (classList, token) {\n\t\tif (token === \"\") {\n\t\t\tthrow new DOMEx(\n\t\t\t\t  \"SYNTAX_ERR\"\n\t\t\t\t, \"An invalid or illegal string was specified\"\n\t\t\t);\n\t\t}\n\t\tif (/\\s/.test(token)) {\n\t\t\tthrow new DOMEx(\n\t\t\t\t  \"INVALID_CHARACTER_ERR\"\n\t\t\t\t, \"String contains an invalid character\"\n\t\t\t);\n\t\t}\n\t\treturn arrIndexOf.call(classList, token);\n\t}\n\t, ClassList = function (elem) {\n\t\tvar\n\t\t\t  trimmedClasses = strTrim.call(elem.getAttribute(\"class\") || \"\")\n\t\t\t, classes = trimmedClasses ? trimmedClasses.split(/\\s+/) : []\n\t\t\t, i = 0\n\t\t\t, len = classes.length\n\t\t;\n\t\tfor (; i < len; i++) {\n\t\t\tthis.push(classes[i]);\n\t\t}\n\t\tthis._updateClassName = function () {\n\t\t\telem.setAttribute(\"class\", this.toString());\n\t\t};\n\t}\n\t, classListProto = ClassList[protoProp] = []\n\t, classListGetter = function () {\n\t\treturn new ClassList(this);\n\t}\n;\n// Most DOMException implementations don't allow calling DOMException's toString()\n// on non-DOMExceptions. Error's toString() is sufficient here.\nDOMEx[protoProp] = Error[protoProp];\nclassListProto.item = function (i) {\n\treturn this[i] || null;\n};\nclassListProto.contains = function (token) {\n\ttoken += \"\";\n\treturn checkTokenAndGetIndex(this, token) !== -1;\n};\nclassListProto.add = function () {\n\tvar\n\t\t  tokens = arguments\n\t\t, i = 0\n\t\t, l = tokens.length\n\t\t, token\n\t\t, updated = false\n\t;\n\tdo {\n\t\ttoken = tokens[i] + \"\";\n\t\tif (checkTokenAndGetIndex(this, token) === -1) {\n\t\t\tthis.push(token);\n\t\t\tupdated = true;\n\t\t}\n\t}\n\twhile (++i < l);\n\n\tif (updated) {\n\t\tthis._updateClassName();\n\t}\n};\nclassListProto.remove = function () {\n\tvar\n\t\t  tokens = arguments\n\t\t, i = 0\n\t\t, l = tokens.length\n\t\t, token\n\t\t, updated = false\n\t\t, index\n\t;\n\tdo {\n\t\ttoken = tokens[i] + \"\";\n\t\tindex = checkTokenAndGetIndex(this, token);\n\t\twhile (index !== -1) {\n\t\t\tthis.splice(index, 1);\n\t\t\tupdated = true;\n\t\t\tindex = checkTokenAndGetIndex(this, token);\n\t\t}\n\t}\n\twhile (++i < l);\n\n\tif (updated) {\n\t\tthis._updateClassName();\n\t}\n};\nclassListProto.toggle = function (token, force) {\n\ttoken += \"\";\n\n\tvar\n\t\t  result = this.contains(token)\n\t\t, method = result ?\n\t\t\tforce !== true && \"remove\"\n\t\t:\n\t\t\tforce !== false && \"add\"\n\t;\n\n\tif (method) {\n\t\tthis[method](token);\n\t}\n\n\tif (force === true || force === false) {\n\t\treturn force;\n\t} else {\n\t\treturn !result;\n\t}\n};\nclassListProto.toString = function () {\n\treturn this.join(\" \");\n};\n\nif (objCtr.defineProperty) {\n\tvar classListPropDesc = {\n\t\t  get: classListGetter\n\t\t, enumerable: true\n\t\t, configurable: true\n\t};\n\ttry {\n\t\tobjCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\n\t} catch (ex) { // IE 8 doesn't support enumerable:true\n\t\t// adding undefined to fight this issue https://github.com/eligrey/classList.js/issues/36\n\t\t// modernie IE8-MSW7 machine has IE8 8.0.6001.18702 and is affected\n\t\tif (ex.number === undefined || ex.number === -0x7FF5EC54) {\n\t\t\tclassListPropDesc.enumerable = false;\n\t\t\tobjCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\n\t\t}\n\t}\n} else if (objCtr[protoProp].__defineGetter__) {\n\telemCtrProto.__defineGetter__(classListProp, classListGetter);\n}\n\n}(window.self));\n\n}\n\n// There is full or partial native classList support, so just check if we need\n// to normalize the add/remove and toggle APIs.\n\n(function () {\n\t\"use strict\";\n\n\tvar testElement = document.createElement(\"_\");\n\n\ttestElement.classList.add(\"c1\", \"c2\");\n\n\t// Polyfill for IE 10/11 and Firefox <26, where classList.add and\n\t// classList.remove exist but support only one argument at a time.\n\tif (!testElement.classList.contains(\"c2\")) {\n\t\tvar createMethod = function(method) {\n\t\t\tvar original = DOMTokenList.prototype[method];\n\n\t\t\tDOMTokenList.prototype[method] = function(token) {\n\t\t\t\tvar i, len = arguments.length;\n\n\t\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t\ttoken = arguments[i];\n\t\t\t\t\toriginal.call(this, token);\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t\tcreateMethod('add');\n\t\tcreateMethod('remove');\n\t}\n\n\ttestElement.classList.toggle(\"c3\", false);\n\n\t// Polyfill for IE 10 and Firefox <24, where classList.toggle does not\n\t// support the second argument.\n\tif (testElement.classList.contains(\"c3\")) {\n\t\tvar _toggle = DOMTokenList.prototype.toggle;\n\n\t\tDOMTokenList.prototype.toggle = function(token, force) {\n\t\t\tif (1 in arguments && !this.contains(token) === !force) {\n\t\t\t\treturn force;\n\t\t\t} else {\n\t\t\t\treturn _toggle.call(this, token);\n\t\t\t}\n\t\t};\n\n\t}\n\n\ttestElement = null;\n}());\n\n}\n","/*\n * @namespace Util\n *\n * Various utility functions, used by Leaflet internally.\n */\n\n// @function extend(dest: Object, src?: Object): Object\n// Merges the properties of the `src` object (or multiple objects) into `dest` object and returns the latter. Has an `L.extend` shortcut.\nexport function extend(dest) {\n    var i, j, len, src;\n\n    for (j = 1, len = arguments.length; j < len; j++) {\n        src = arguments[j];\n        for (i in src) {\n            dest[i] = src[i];\n        }\n    }\n    return dest;\n}\n\n// @function create(proto: Object, properties?: Object): Object\n// Compatibility polyfill for [Object.create](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/create)\nexport var create = Object.create || (function () {\n    function F() {}\n    return function (proto) {\n        F.prototype = proto;\n        return new F();\n    };\n})();\n\n// @function bind(fn: Function, …): Function\n// Returns a new function bound to the arguments passed, like [Function.prototype.bind](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Function/bind).\n// Has a `L.bind()` shortcut.\nexport function bind(fn, obj) {\n    var slice = Array.prototype.slice;\n\n    if (fn.bind) {\n        return fn.bind.apply(fn, slice.call(arguments, 1));\n    }\n\n    var args = slice.call(arguments, 2);\n\n    return function () {\n        return fn.apply(obj, args.length ? args.concat(slice.call(arguments)) : arguments);\n    };\n}\n\n// @property lastId: Number\n// Last unique ID used by [`stamp()`](#util-stamp)\nexport var lastId = 0;\n\n// @function stamp(obj: Object): Number\n// Returns the unique ID of an object, assiging it one if it doesn't have it.\nexport function stamp(obj) {\n    /*eslint-disable */\n    obj._cozy_id = obj._cozy_id || ++lastId;\n    return obj._cozy_id; /* not leaflet */\n    /*eslint-enable */\n}\n\n// @function throttle(fn: Function, time: Number, context: Object): Function\n// Returns a function which executes function `fn` with the given scope `context`\n// (so that the `this` keyword refers to `context` inside `fn`'s code). The function\n// `fn` will be called no more than one time per given amount of `time`. The arguments\n// received by the bound function will be any arguments passed when binding the\n// function, followed by any arguments passed when invoking the bound function.\n// Has an `L.throttle` shortcut.\nexport function throttle(fn, time, context) {\n    var lock, args, wrapperFn, later;\n\n    later = function () {\n        // reset lock and call if queued\n        lock = false;\n        if (args) {\n            wrapperFn.apply(context, args);\n            args = false;\n        }\n    };\n\n    wrapperFn = function () {\n        if (lock) {\n            // called too soon, queue to call later\n            args = arguments;\n\n        } else {\n            // call and lock until later\n            fn.apply(context, arguments);\n            setTimeout(later, time);\n            lock = true;\n        }\n    };\n\n    return wrapperFn;\n}\n\n// @function wrapNum(num: Number, range: Number[], includeMax?: Boolean): Number\n// Returns the number `num` modulo `range` in such a way so it lies within\n// `range[0]` and `range[1]`. The returned value will be always smaller than\n// `range[1]` unless `includeMax` is set to `true`.\nexport function wrapNum(x, range, includeMax) {\n    var max = range[1],\n        min = range[0],\n        d = max - min;\n    return x === max && includeMax ? x : ((x - min) % d + d) % d + min;\n}\n\n// @function falseFn(): Function\n// Returns a function which always returns `false`.\nexport function falseFn() { return false; }\n\n// @function formatNum(num: Number, digits?: Number): Number\n// Returns the number `num` rounded to `digits` decimals, or to 5 decimals by default.\nexport function formatNum(num, digits) {\n    var pow = Math.pow(10, digits || 5);\n    return Math.round(num * pow) / pow;\n}\n\n// @function isNumeric(num: Number): Boolean\n// Returns whether num is actually numeric\nexport function isNumeric(num) {\n  return !isNaN(parseFloat(num)) && isFinite(num);\n}\n\n// @function trim(str: String): String\n// Compatibility polyfill for [String.prototype.trim](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String/Trim)\nexport function trim(str) {\n    return str.trim ? str.trim() : str.replace(/^\\s+|\\s+$/g, '');\n}\n\n// @function splitWords(str: String): String[]\n// Trims and splits the string on whitespace and returns the array of parts.\nexport function splitWords(str) {\n    return trim(str).split(/\\s+/);\n}\n\n// @function setOptions(obj: Object, options: Object): Object\n// Merges the given properties to the `options` of the `obj` object, returning the resulting options. See `Class options`. Has an `L.setOptions` shortcut.\nexport function setOptions(obj, options) {\n    if (!obj.hasOwnProperty('options')) {\n        obj.options = obj.options ? create(obj.options) : {};\n    }\n    for (var i in options) {\n        obj.options[i] = options[i];\n    }\n    return obj.options;\n}\n\n// @function getParamString(obj: Object, existingUrl?: String, uppercase?: Boolean): String\n// Converts an object into a parameter URL string, e.g. `{a: \"foo\", b: \"bar\"}`\n// translates to `'?a=foo&b=bar'`. If `existingUrl` is set, the parameters will\n// be appended at the end. If `uppercase` is `true`, the parameter names will\n// be uppercased (e.g. `'?A=foo&B=bar'`)\nexport function getParamString(obj, existingUrl, uppercase) {\n    var params = [];\n    for (var i in obj) {\n        params.push(encodeURIComponent(uppercase ? i.toUpperCase() : i) + '=' + encodeURIComponent(obj[i]));\n    }\n    return ((!existingUrl || existingUrl.indexOf('?') === -1) ? '?' : '&') + params.join('&');\n}\n\nvar templateRe = /\\{ *([\\w_\\-]+) *\\}/g;\n\n// @function template(str: String, data: Object): String\n// Simple templating facility, accepts a template string of the form `'Hello {a}, {b}'`\n// and a data object like `{a: 'foo', b: 'bar'}`, returns evaluated string\n// `('Hello foo, bar')`. You can also specify functions instead of strings for\n// data values — they will be evaluated passing `data` as an argument.\nexport function template(str, data) {\n    return str.replace(templateRe, function (str, key) {\n        var value = data[key];\n\n        if (value === undefined) {\n            throw new Error('No value provided for variable ' + str);\n\n        } else if (typeof value === 'function') {\n            value = value(data);\n        }\n        return value;\n    });\n}\n\n// @function isArray(obj): Boolean\n// Compatibility polyfill for [Array.isArray](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array/isArray)\nexport var isArray = Array.isArray || function (obj) {\n    return (Object.prototype.toString.call(obj) === '[object Array]');\n};\n\n// @function indexOf(array: Array, el: Object): Number\n// Compatibility polyfill for [Array.prototype.indexOf](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf)\nexport function indexOf(array, el) {\n    for (var i = 0; i < array.length; i++) {\n        if (array[i] === el) { return i; }\n    }\n    return -1;\n}\n\n// @property emptyImageUrl: String\n// Data URI string containing a base64-encoded empty GIF image.\n// Used as a hack to free memory from unused images on WebKit-powered\n// mobile devices (by setting image `src` to this string).\nexport var emptyImageUrl = 'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=';\n\n// inspired by http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n\nfunction getPrefixed(name) {\n    return window['webkit' + name] || window['moz' + name] || window['ms' + name];\n}\n\nvar lastTime = 0;\n\n// fallback for IE 7-8\nfunction timeoutDefer(fn) {\n    var time = +new Date(),\n        timeToCall = Math.max(0, 16 - (time - lastTime));\n\n    lastTime = time + timeToCall;\n    return window.setTimeout(fn, timeToCall);\n}\n\nexport var requestFn = window.requestAnimationFrame || getPrefixed('RequestAnimationFrame') || timeoutDefer;\nexport var cancelFn = window.cancelAnimationFrame || getPrefixed('CancelAnimationFrame') ||\n        getPrefixed('CancelRequestAnimationFrame') || function (id) { window.clearTimeout(id); };\n\n// @function requestAnimFrame(fn: Function, context?: Object, immediate?: Boolean): Number\n// Schedules `fn` to be executed when the browser repaints. `fn` is bound to\n// `context` if given. When `immediate` is set, `fn` is called immediately if\n// the browser doesn't have native support for\n// [`window.requestAnimationFrame`](https://developer.mozilla.org/docs/Web/API/window/requestAnimationFrame),\n// otherwise it's delayed. Returns a request ID that can be used to cancel the request.\nexport function requestAnimFrame(fn, context, immediate) {\n    if (immediate && requestFn === timeoutDefer) {\n        fn.call(context);\n    } else {\n        return requestFn.call(window, bind(fn, context));\n    }\n}\n\n// @function cancelAnimFrame(id: Number): undefined\n// Cancels a previous `requestAnimFrame`. See also [window.cancelAnimationFrame](https://developer.mozilla.org/docs/Web/API/window/cancelAnimationFrame).\nexport function cancelAnimFrame(id) {\n    if (id) {\n        cancelFn.call(window, id);\n    }\n}\n\nexport var loader = {\n    js: function(url) {\n        var handler = { _resolved: false };\n        handler.callbacks = [];\n        handler.error = [];\n        handler.then = function(cb) {\n            handler.callbacks.push(cb);\n            if ( handler._resolved ) { return handler.resolve(); }\n            return handler;\n        }\n        handler.catch = function(cb) {\n            handler.error.push(cb);\n            if ( handler._resolved ) { return handler.reject(); }\n            return handler;\n        }\n        handler.resolve = function(_argv) {\n            // var _argv;\n            handler._resolved = true;\n            while ( handler.callbacks.length ) {\n                var cb = handler.callbacks.shift();\n                var retval;\n                try {\n                    _argv = cb(_argv);\n                } catch(e) {\n                    console.log(e);\n                    handler.reject(e);\n                    break;\n                }\n            }\n            return handler;\n        }\n\n        handler.reject = function(e) {\n            while ( handler.error.length ) {\n                var cb = handler.error.shift();\n                cb(e);\n            }\n            console.log(e);\n            console.trace();\n            return handler;\n        }\n\n        if ( url == undefined ) {\n            handler._resolved = true;\n            return handler;\n        }\n\n        var element = document.createElement('script');\n\n        element.onload = function() {\n          handler.resolve(url);\n        };\n        element.onerror = function() {\n          handler.catch.apply(arguments);\n        };\n\n        element.async = true;\n        var parent = 'body';\n        var attr = 'src';\n        element[attr] = url;\n        document[parent].appendChild(element);\n\n        console.log(\"AHOY APPENDED\", url);\n\n        return handler;\n    }\n}","import * as Util from './Util';\r\n\r\n// @class Class\r\n// @aka L.Class\r\n\r\n// @section\r\n// @uninheritable\r\n\r\n// Thanks to John Resig and Dean Edwards for inspiration!\r\n\r\nexport function Class() {}\r\n\r\nClass.extend = function (props) {\r\n\r\n\t// @function extend(props: Object): Function\r\n\t// [Extends the current class](#class-inheritance) given the properties to be included.\r\n\t// Returns a Javascript function that is a class constructor (to be called with `new`).\r\n\tvar NewClass = function () {\r\n\r\n\t\t// call the constructor\r\n\t\tif (this.initialize) {\r\n\t\t\tthis.initialize.apply(this, arguments);\r\n\t\t}\r\n\r\n\t\t// call all constructor hooks\r\n\t\tthis.callInitHooks();\r\n\t};\r\n\r\n\tvar parentProto = NewClass.__super__ = this.prototype;\r\n\r\n\tvar proto = Util.create(parentProto);\r\n\tproto.constructor = NewClass;\r\n\r\n\tNewClass.prototype = proto;\r\n\r\n\t// inherit parent's statics\r\n\tfor (var i in this) {\r\n\t\tif (this.hasOwnProperty(i) && i !== 'prototype') {\r\n\t\t\tNewClass[i] = this[i];\r\n\t\t}\r\n\t}\r\n\r\n\t// mix static properties into the class\r\n\tif (props.statics) {\r\n\t\tUtil.extend(NewClass, props.statics);\r\n\t\tdelete props.statics;\r\n\t}\r\n\r\n\t// mix includes into the prototype\r\n\tif (props.includes) {\r\n\t\tcheckDeprecatedMixinEvents(props.includes);\r\n\t\tUtil.extend.apply(null, [proto].concat(props.includes));\r\n\t\tdelete props.includes;\r\n\t}\r\n\r\n\t// merge options\r\n\tif (proto.options) {\r\n\t\tprops.options = Util.extend(Util.create(proto.options), props.options);\r\n\t}\r\n\r\n\t// mix given properties into the prototype\r\n\tUtil.extend(proto, props);\r\n\t\r\n\tproto._initHooks = [];\r\n\r\n\t// add method for calling all hooks\r\n\tproto.callInitHooks = function () {\r\n\r\n\t\tif (this._initHooksCalled) { return; }\r\n\r\n\t\tif (parentProto.callInitHooks) {\r\n\t\t\tparentProto.callInitHooks.call(this);\r\n\t\t}\r\n\r\n\t\tthis._initHooksCalled = true;\r\n\r\n\t\tfor (var i = 0, len = proto._initHooks.length; i < len; i++) {\r\n\t\t\tproto._initHooks[i].call(this);\r\n\t\t}\r\n\t};\r\n\r\n\treturn NewClass;\r\n};\r\n\r\n\r\n// @function include(properties: Object): this\r\n// [Includes a mixin](#class-includes) into the current class.\r\nClass.include = function (props) {\r\n\tUtil.extend(this.prototype, props);\r\n\treturn this;\r\n};\r\n\r\n// @function mergeOptions(options: Object): this\r\n// [Merges `options`](#class-options) into the defaults of the class.\r\nClass.mergeOptions = function (options) {\r\n\tUtil.extend(this.prototype.options, options);\r\n\treturn this;\r\n};\r\n\r\n// @function addInitHook(fn: Function): this\r\n// Adds a [constructor hook](#class-constructor-hooks) to the class.\r\nClass.addInitHook = function (fn) { // (Function) || (String, args...)\r\n\tvar args = Array.prototype.slice.call(arguments, 1);\r\n\r\n\tvar init = typeof fn === 'function' ? fn : function () {\r\n\t\tthis[fn].apply(this, args);\r\n\t};\r\n\r\n\tthis.prototype._initHooks = this.prototype._initHooks || [];\r\n\tthis.prototype._initHooks.push(init);\r\n\treturn this;\r\n};\r\n\r\nfunction checkDeprecatedMixinEvents(includes) {\r\n\tif (!cozy || !cozy.Mixin) { return; }\r\n\r\n\tincludes = cozy.Util.isArray(includes) ? includes : [includes];\r\n\r\n\t// for (var i = 0; i < includes.length; i++) {\r\n\t// \tif (includes[i] === cozy.Mixin.Events) {\r\n\t// \t\tconsole.warn('Deprecated include of cozy.Mixin.Events: ' +\r\n\t// \t\t\t'this property will be removed in future releases, ' +\r\n\t// \t\t\t'please inherit from cozy.Evented instead.', new Error().stack);\r\n\t// \t}\r\n\t// }\r\n}\r\n","import {Class} from './Class';\r\nimport * as Util from './Util';\r\n\r\n/*\r\n * @class Evented\r\n * @aka L.Evented\r\n * @inherits Class\r\n *\r\n * A set of methods shared between event-powered classes (like `Map` and `Marker`). Generally, events allow you to execute some function when something happens with an object (e.g. the user clicks on the map, causing the map to fire `'click'` event).\r\n *\r\n * @example\r\n *\r\n * ```js\r\n * map.on('click', function(e) {\r\n * \talert(e.latlng);\r\n * } );\r\n * ```\r\n *\r\n * Leaflet deals with event listeners by reference, so if you want to add a listener and then remove it, define it as a function:\r\n *\r\n * ```js\r\n * function onClick(e) { ... }\r\n *\r\n * map.on('click', onClick);\r\n * map.off('click', onClick);\r\n * ```\r\n */\r\n\r\nexport var Evented = Class.extend({\r\n\r\n\t/* @method on(type: String, fn: Function, context?: Object): this\r\n\t * Adds a listener function (`fn`) to a particular event type of the object. You can optionally specify the context of the listener (object the this keyword will point to). You can also pass several space-separated types (e.g. `'click dblclick'`).\r\n\t *\r\n\t * @alternative\r\n\t * @method on(eventMap: Object): this\r\n\t * Adds a set of type/listener pairs, e.g. `{click: onClick, mousemove: onMouseMove}`\r\n\t */\r\n\ton: function (types, fn, context) {\r\n\r\n\t\t// types can be a map of types/handlers\r\n\t\tif (typeof types === 'object') {\r\n\t\t\tfor (var type in types) {\r\n\t\t\t\t// we don't process space-separated events here for performance;\r\n\t\t\t\t// it's a hot path since Layer uses the on(obj) syntax\r\n\t\t\t\tthis._on(type, types[type], fn);\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\t// types can be a string of space-separated words\r\n\t\t\ttypes = Util.splitWords(types);\r\n\r\n\t\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\t\tthis._on(types[i], fn, context);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t/* @method off(type: String, fn?: Function, context?: Object): this\r\n\t * Removes a previously added listener function. If no function is specified, it will remove all the listeners of that particular event from the object. Note that if you passed a custom context to `on`, you must pass the same context to `off` in order to remove the listener.\r\n\t *\r\n\t * @alternative\r\n\t * @method off(eventMap: Object): this\r\n\t * Removes a set of type/listener pairs.\r\n\t *\r\n\t * @alternative\r\n\t * @method off: this\r\n\t * Removes all listeners to all events on the object.\r\n\t */\r\n\toff: function (types, fn, context) {\r\n\r\n\t\tif (!types) {\r\n\t\t\t// clear all listeners if called without arguments\r\n\t\t\tdelete this._events;\r\n\r\n\t\t} else if (typeof types === 'object') {\r\n\t\t\tfor (var type in types) {\r\n\t\t\t\tthis._off(type, types[type], fn);\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\ttypes = Util.splitWords(types);\r\n\r\n\t\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\t\tthis._off(types[i], fn, context);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// attach listener (without syntactic sugar now)\r\n\t_on: function (type, fn, context) {\r\n\t\tthis._events = this._events || {};\r\n\r\n\t\t/* get/init listeners for type */\r\n\t\tvar typeListeners = this._events[type];\r\n\t\tif (!typeListeners) {\r\n\t\t\ttypeListeners = [];\r\n\t\t\tthis._events[type] = typeListeners;\r\n\t\t}\r\n\r\n\t\tif (context === this) {\r\n\t\t\t// Less memory footprint.\r\n\t\t\tcontext = undefined;\r\n\t\t}\r\n\t\tvar newListener = {fn: fn, ctx: context},\r\n\t\t    listeners = typeListeners;\r\n\r\n\t\t// check if fn already there\r\n\t\tfor (var i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\tif (listeners[i].fn === fn && listeners[i].ctx === context) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlisteners.push(newListener);\r\n\t},\r\n\r\n\t_off: function (type, fn, context) {\r\n\t\tvar listeners,\r\n\t\t    i,\r\n\t\t    len;\r\n\r\n\t\tif (!this._events) { return; }\r\n\r\n\t\tlisteners = this._events[type];\r\n\r\n\t\tif (!listeners) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!fn) {\r\n\t\t\t// Set all removed listeners to noop so they are not called if remove happens in fire\r\n\t\t\tfor (i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\t\tlisteners[i].fn = Util.falseFn;\r\n\t\t\t}\r\n\t\t\t// clear all listeners for a type if function isn't specified\r\n\t\t\tdelete this._events[type];\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (context === this) {\r\n\t\t\tcontext = undefined;\r\n\t\t}\r\n\r\n\t\tif (listeners) {\r\n\r\n\t\t\t// find fn and remove it\r\n\t\t\tfor (i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\t\tvar l = listeners[i];\r\n\t\t\t\tif (l.ctx !== context) { continue; }\r\n\t\t\t\tif (l.fn === fn) {\r\n\r\n\t\t\t\t\t// set the removed listener to noop so that's not called if remove happens in fire\r\n\t\t\t\t\tl.fn = Util.falseFn;\r\n\r\n\t\t\t\t\tif (this._firingCount) {\r\n\t\t\t\t\t\t/* copy array in case events are being fired */\r\n\t\t\t\t\t\tthis._events[type] = listeners = listeners.slice();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlisteners.splice(i, 1);\r\n\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t// @method fire(type: String, data?: Object, propagate?: Boolean): this\r\n\t// Fires an event of the specified type. You can optionally provide an data\r\n\t// object — the first argument of the listener function will contain its\r\n\t// properties. The event can optionally be propagated to event parents.\r\n\tfire: function (type, data, propagate) {\r\n\t\tif (!this.listens(type, propagate)) { return this; }\r\n\r\n\t\tvar event = Util.extend({}, data, {type: type, target: this});\r\n\r\n\t\tif (this._events) {\r\n\t\t\tvar listeners = this._events[type];\r\n\r\n\t\t\tif (listeners) {\r\n\t\t\t\tthis._firingCount = (this._firingCount + 1) || 1;\r\n\t\t\t\tfor (var i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\t\t\tvar l = listeners[i];\r\n\t\t\t\t\tl.fn.call(l.ctx || this, event);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._firingCount--;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (propagate) {\r\n\t\t\t// propagate the event to parents (set with addEventParent)\r\n\t\t\tthis._propagateEvent(event);\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method listens(type: String): Boolean\r\n\t// Returns `true` if a particular event type has any listeners attached to it.\r\n\tlistens: function (type, propagate) {\r\n\t\tvar listeners = this._events && this._events[type];\r\n\t\tif (listeners && listeners.length) { return true; }\r\n\r\n\t\tif (propagate) {\r\n\t\t\t// also check parents for listeners if event propagates\r\n\t\t\tfor (var id in this._eventParents) {\r\n\t\t\t\tif (this._eventParents[id].listens(type, propagate)) { return true; }\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\r\n\t// @method once(…): this\r\n\t// Behaves as [`on(…)`](#evented-on), except the listener will only get fired once and then removed.\r\n\tonce: function (types, fn, context) {\r\n\r\n\t\tif (typeof types === 'object') {\r\n\t\t\tfor (var type in types) {\r\n\t\t\t\tthis.once(type, types[type], fn);\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tvar handler = Util.bind(function () {\r\n\t\t\tthis\r\n\t\t\t    .off(types, fn, context)\r\n\t\t\t    .off(types, handler, context);\r\n\t\t}, this);\r\n\r\n\t\t// add a listener that's executed once and removed after that\r\n\t\treturn this\r\n\t\t    .on(types, fn, context)\r\n\t\t    .on(types, handler, context);\r\n\t},\r\n\r\n\t// @method addEventParent(obj: Evented): this\r\n\t// Adds an event parent - an `Evented` that will receive propagated events\r\n\taddEventParent: function (obj) {\r\n\t\tthis._eventParents = this._eventParents || {};\r\n\t\tthis._eventParents[Util.stamp(obj)] = obj;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method removeEventParent(obj: Evented): this\r\n\t// Removes an event parent, so it will stop receiving propagated events\r\n\tremoveEventParent: function (obj) {\r\n\t\tif (this._eventParents) {\r\n\t\t\tdelete this._eventParents[Util.stamp(obj)];\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\t_propagateEvent: function (e) {\r\n\t\tfor (var id in this._eventParents) {\r\n\t\t\tthis._eventParents[id].fire(e.type, Util.extend({layer: e.target}, e), true);\r\n\t\t}\r\n\t}\r\n});\r\n\r\nvar proto = Evented.prototype;\r\n\r\n// aliases; we should ditch those eventually\r\n\r\n// @method addEventListener(…): this\r\n// Alias to [`on(…)`](#evented-on)\r\nproto.addEventListener = proto.on;\r\n\r\n// @method removeEventListener(…): this\r\n// Alias to [`off(…)`](#evented-off)\r\n\r\n// @method clearAllEventListeners(…): this\r\n// Alias to [`off()`](#evented-off)\r\nproto.removeEventListener = proto.clearAllEventListeners = proto.off;\r\n\r\n// @method addOneTimeEventListener(…): this\r\n// Alias to [`once(…)`](#evented-once)\r\nproto.addOneTimeEventListener = proto.once;\r\n\r\n// @method fireEvent(…): this\r\n// Alias to [`fire(…)`](#evented-fire)\r\nproto.fireEvent = proto.fire;\r\n\r\n// @method hasEventListeners(…): Boolean\r\n// Alias to [`listens(…)`](#evented-listens)\r\nproto.hasEventListeners = proto.listens;\r\n","\n/*\n * @namespace Browser\n * @aka L.Browser\n *\n * A namespace with static properties for browser/feature detection used by Leaflet internally.\n *\n * @example\n *\n * ```js\n * if (L.Browser.ielt9) {\n *   alert('Upgrade your browser, dude!');\n * }\n * ```\n */\n\nvar style = document.documentElement.style;\n\n// @property ie: Boolean; `true` for all Internet Explorer versions (not Edge).\nexport var ie = 'ActiveXObject' in window;\n\n// @property ielt9: Boolean; `true` for Internet Explorer versions less than 9.\nexport var ielt9 = ie && !document.addEventListener;\n\n// @property edge: Boolean; `true` for the Edge web browser.\nexport var edge = 'msLaunchUri' in navigator && !('documentMode' in document);\n\n// @property webkit: Boolean;\n// `true` for webkit-based browsers like Chrome and Safari (including mobile versions).\nexport var webkit = userAgentContains('webkit');\n\n// @property android: Boolean\n// `true` for any browser running on an Android platform.\nexport var android = userAgentContains('android');\n\n// @property android23: Boolean; `true` for browsers running on Android 2 or Android 3.\nexport var android23 = userAgentContains('android 2') || userAgentContains('android 3');\n\n// @property opera: Boolean; `true` for the Opera browser\nexport var opera = !!window.opera;\n\n// @property chrome: Boolean; `true` for the Chrome browser.\nexport var chrome = userAgentContains('chrome');\n\n// @property gecko: Boolean; `true` for gecko-based browsers like Firefox.\nexport var gecko = userAgentContains('gecko') && !webkit && !opera && !ie;\n\n// @property safari: Boolean; `true` for the Safari browser.\nexport var safari = !chrome && userAgentContains('safari');\n\nexport var phantom = userAgentContains('phantom');\n\n// @property opera12: Boolean\n// `true` for the Opera browser supporting CSS transforms (version 12 or later).\nexport var opera12 = 'OTransition' in style;\n\n// @property win: Boolean; `true` when the browser is running in a Windows platform\nexport var win = navigator.platform.indexOf('Win') === 0;\n\n// @property ie3d: Boolean; `true` for all Internet Explorer versions supporting CSS transforms.\nexport var ie3d = ie && ('transition' in style);\n\n// @property webkit3d: Boolean; `true` for webkit-based browsers supporting CSS transforms.\nexport var webkit3d = ('WebKitCSSMatrix' in window) && ('m11' in new window.WebKitCSSMatrix()) && !android23;\n\n// @property gecko3d: Boolean; `true` for gecko-based browsers supporting CSS transforms.\nexport var gecko3d = 'MozPerspective' in style;\n\n// @property any3d: Boolean\n// `true` for all browsers supporting CSS transforms.\nexport var any3d = !window.L_DISABLE_3D && (ie3d || webkit3d || gecko3d) && !opera12 && !phantom;\n\n// @property mobile: Boolean; `true` for all browsers running in a mobile device.\nexport var mobile = typeof orientation !== 'undefined' || userAgentContains('mobile');\n\n// @property mobileWebkit: Boolean; `true` for all webkit-based browsers in a mobile device.\nexport var mobileWebkit = mobile && webkit;\n\n// @property mobileWebkit3d: Boolean\n// `true` for all webkit-based browsers in a mobile device supporting CSS transforms.\nexport var mobileWebkit3d = mobile && webkit3d;\n\n// @property msPointer: Boolean\n// `true` for browsers implementing the Microsoft touch events model (notably IE10).\nexport var msPointer = !window.PointerEvent && window.MSPointerEvent;\n\n// @property pointer: Boolean\n// `true` for all browsers supporting [pointer events](https://msdn.microsoft.com/en-us/library/dn433244%28v=vs.85%29.aspx).\nexport var pointer = !!(window.PointerEvent || msPointer);\n\n// @property touch: Boolean\n// `true` for all browsers supporting [touch events](https://developer.mozilla.org/docs/Web/API/Touch_events).\n// This does not necessarily mean that the browser is running in a computer with\n// a touchscreen, it only means that the browser is capable of understanding\n// touch events.\nexport var touch = !window.L_NO_TOUCH && (pointer || 'ontouchstart' in window ||\n        (window.DocumentTouch && document instanceof window.DocumentTouch));\n\n// @property mobileOpera: Boolean; `true` for the Opera browser in a mobile device.\nexport var mobileOpera = mobile && opera;\n\n// @property mobileGecko: Boolean\n// `true` for gecko-based browsers running in a mobile device.\nexport var mobileGecko = mobile && gecko;\n\n// @property retina: Boolean\n// `true` for browsers on a high-resolution \"retina\" screen.\nexport var retina = (window.devicePixelRatio || (window.screen.deviceXDPI / window.screen.logicalXDPI)) > 1;\n\n\n// @property canvas: Boolean\n// `true` when the browser supports [`<canvas>`](https://developer.mozilla.org/docs/Web/API/Canvas_API).\nexport var canvas = (function () {\n    return !!document.createElement('canvas').getContext;\n}());\n\n// @property svg: Boolean\n// `true` when the browser supports [SVG](https://developer.mozilla.org/docs/Web/SVG).\n// export var svg = !!(document.createElementNS && svgCreate('svg').createSVGRect);\nexport var svg = true;\n\n// @property vml: Boolean\n// `true` if the browser supports [VML](https://en.wikipedia.org/wiki/Vector_Markup_Language).\nexport var vml = !svg && (function () {\n    try {\n        var div = document.createElement('div');\n        div.innerHTML = '<v:shape adj=\"1\"/>';\n\n        var shape = div.firstChild;\n        shape.style.behavior = 'url(#default#VML)';\n\n        return shape && (typeof shape.adj === 'object');\n\n    } catch (e) {\n        return false;\n    }\n}());\n\nexport var columnCount = ( 'columnCount' in style );\nexport var classList = ( document.documentElement.classList !== undefined );\n\nfunction userAgentContains(str) {\n    return navigator.userAgent.toLowerCase().indexOf(str) >= 0;\n}\n","import {isArray, formatNum} from '../core/Util';\r\n\r\n/*\r\n * @class Point\r\n * @aka L.Point\r\n *\r\n * Represents a point with `x` and `y` coordinates in pixels.\r\n *\r\n * @example\r\n *\r\n * ```js\r\n * var point = L.point(200, 300);\r\n * ```\r\n *\r\n * All Leaflet methods and options that accept `Point` objects also accept them in a simple Array form (unless noted otherwise), so these lines are equivalent:\r\n *\r\n * ```js\r\n * map.panBy([200, 300]);\r\n * map.panBy(L.point(200, 300));\r\n * ```\r\n */\r\n\r\nexport function Point(x, y, round) {\r\n\t// @property x: Number; The `x` coordinate of the point\r\n\tthis.x = (round ? Math.round(x) : x);\r\n\t// @property y: Number; The `y` coordinate of the point\r\n\tthis.y = (round ? Math.round(y) : y);\r\n}\r\n\r\nPoint.prototype = {\r\n\r\n\t// @method clone(): Point\r\n\t// Returns a copy of the current point.\r\n\tclone: function () {\r\n\t\treturn new Point(this.x, this.y);\r\n\t},\r\n\r\n\t// @method add(otherPoint: Point): Point\r\n\t// Returns the result of addition of the current and the given points.\r\n\tadd: function (point) {\r\n\t\t// non-destructive, returns a new point\r\n\t\treturn this.clone()._add(toPoint(point));\r\n\t},\r\n\r\n\t_add: function (point) {\r\n\t\t// destructive, used directly for performance in situations where it's safe to modify existing point\r\n\t\tthis.x += point.x;\r\n\t\tthis.y += point.y;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method subtract(otherPoint: Point): Point\r\n\t// Returns the result of subtraction of the given point from the current.\r\n\tsubtract: function (point) {\r\n\t\treturn this.clone()._subtract(toPoint(point));\r\n\t},\r\n\r\n\t_subtract: function (point) {\r\n\t\tthis.x -= point.x;\r\n\t\tthis.y -= point.y;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method divideBy(num: Number): Point\r\n\t// Returns the result of division of the current point by the given number.\r\n\tdivideBy: function (num) {\r\n\t\treturn this.clone()._divideBy(num);\r\n\t},\r\n\r\n\t_divideBy: function (num) {\r\n\t\tthis.x /= num;\r\n\t\tthis.y /= num;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method multiplyBy(num: Number): Point\r\n\t// Returns the result of multiplication of the current point by the given number.\r\n\tmultiplyBy: function (num) {\r\n\t\treturn this.clone()._multiplyBy(num);\r\n\t},\r\n\r\n\t_multiplyBy: function (num) {\r\n\t\tthis.x *= num;\r\n\t\tthis.y *= num;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method scaleBy(scale: Point): Point\r\n\t// Multiply each coordinate of the current point by each coordinate of\r\n\t// `scale`. In linear algebra terms, multiply the point by the\r\n\t// [scaling matrix](https://en.wikipedia.org/wiki/Scaling_%28geometry%29#Matrix_representation)\r\n\t// defined by `scale`.\r\n\tscaleBy: function (point) {\r\n\t\treturn new Point(this.x * point.x, this.y * point.y);\r\n\t},\r\n\r\n\t// @method unscaleBy(scale: Point): Point\r\n\t// Inverse of `scaleBy`. Divide each coordinate of the current point by\r\n\t// each coordinate of `scale`.\r\n\tunscaleBy: function (point) {\r\n\t\treturn new Point(this.x / point.x, this.y / point.y);\r\n\t},\r\n\r\n\t// @method round(): Point\r\n\t// Returns a copy of the current point with rounded coordinates.\r\n\tround: function () {\r\n\t\treturn this.clone()._round();\r\n\t},\r\n\r\n\t_round: function () {\r\n\t\tthis.x = Math.round(this.x);\r\n\t\tthis.y = Math.round(this.y);\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method floor(): Point\r\n\t// Returns a copy of the current point with floored coordinates (rounded down).\r\n\tfloor: function () {\r\n\t\treturn this.clone()._floor();\r\n\t},\r\n\r\n\t_floor: function () {\r\n\t\tthis.x = Math.floor(this.x);\r\n\t\tthis.y = Math.floor(this.y);\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method ceil(): Point\r\n\t// Returns a copy of the current point with ceiled coordinates (rounded up).\r\n\tceil: function () {\r\n\t\treturn this.clone()._ceil();\r\n\t},\r\n\r\n\t_ceil: function () {\r\n\t\tthis.x = Math.ceil(this.x);\r\n\t\tthis.y = Math.ceil(this.y);\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method distanceTo(otherPoint: Point): Number\r\n\t// Returns the cartesian distance between the current and the given points.\r\n\tdistanceTo: function (point) {\r\n\t\tpoint = toPoint(point);\r\n\r\n\t\tvar x = point.x - this.x,\r\n\t\t    y = point.y - this.y;\r\n\r\n\t\treturn Math.sqrt(x * x + y * y);\r\n\t},\r\n\r\n\t// @method equals(otherPoint: Point): Boolean\r\n\t// Returns `true` if the given point has the same coordinates.\r\n\tequals: function (point) {\r\n\t\tpoint = toPoint(point);\r\n\r\n\t\treturn point.x === this.x &&\r\n\t\t       point.y === this.y;\r\n\t},\r\n\r\n\t// @method contains(otherPoint: Point): Boolean\r\n\t// Returns `true` if both coordinates of the given point are less than the corresponding current point coordinates (in absolute values).\r\n\tcontains: function (point) {\r\n\t\tpoint = toPoint(point);\r\n\r\n\t\treturn Math.abs(point.x) <= Math.abs(this.x) &&\r\n\t\t       Math.abs(point.y) <= Math.abs(this.y);\r\n\t},\r\n\r\n\t// @method toString(): String\r\n\t// Returns a string representation of the point for debugging purposes.\r\n\ttoString: function () {\r\n\t\treturn 'Point(' +\r\n\t\t        formatNum(this.x) + ', ' +\r\n\t\t        formatNum(this.y) + ')';\r\n\t}\r\n};\r\n\r\n// @factory L.point(x: Number, y: Number, round?: Boolean)\r\n// Creates a Point object with the given `x` and `y` coordinates. If optional `round` is set to true, rounds the `x` and `y` values.\r\n\r\n// @alternative\r\n// @factory L.point(coords: Number[])\r\n// Expects an array of the form `[x, y]` instead.\r\n\r\n// @alternative\r\n// @factory L.point(coords: Object)\r\n// Expects a plain object of the form `{x: Number, y: Number}` instead.\r\nexport function toPoint(x, y, round) {\r\n\tif (x instanceof Point) {\r\n\t\treturn x;\r\n\t}\r\n\tif (isArray(x)) {\r\n\t\treturn new Point(x[0], x[1]);\r\n\t}\r\n\tif (x === undefined || x === null) {\r\n\t\treturn x;\r\n\t}\r\n\tif (typeof x === 'object' && 'x' in x && 'y' in x) {\r\n\t\treturn new Point(x.x, x.y);\r\n\t}\r\n\treturn new Point(x, y, round);\r\n}\r\n","import * as DomEvent from './DomEvent';\nimport * as Util from '../core/Util';\nimport * as Browser from '../core/Browser';\n\n/*\n * Extends L.DomEvent to provide touch support for Internet Explorer and Windows-based devices.\n */\n\n\nvar POINTER_DOWN =   Browser.msPointer ? 'MSPointerDown'   : 'pointerdown',\n    POINTER_MOVE =   Browser.msPointer ? 'MSPointerMove'   : 'pointermove',\n    POINTER_UP =     Browser.msPointer ? 'MSPointerUp'     : 'pointerup',\n    POINTER_CANCEL = Browser.msPointer ? 'MSPointerCancel' : 'pointercancel',\n    TAG_WHITE_LIST = ['INPUT', 'SELECT', 'OPTION'],\n\n    _pointers = {},\n    _pointerDocListener = false;\n\n// DomEvent.DoubleTap needs to know about this\nexport var _pointersCount = 0;\n\n// Provides a touch events wrapper for (ms)pointer events.\n// ref http://www.w3.org/TR/pointerevents/ https://www.w3.org/Bugs/Public/show_bug.cgi?id=22890\n\nexport function addPointerListener(obj, type, handler, id) {\n\tif (type === 'touchstart') {\n\t\t_addPointerStart(obj, handler, id);\n\n\t} else if (type === 'touchmove') {\n\t\t_addPointerMove(obj, handler, id);\n\n\t} else if (type === 'touchend') {\n\t\t_addPointerEnd(obj, handler, id);\n\t}\n\n\treturn this;\n}\n\nexport function removePointerListener(obj, type, id) {\n\tvar handler = obj['_leaflet_' + type + id];\n\n\tif (type === 'touchstart') {\n\t\tobj.removeEventListener(POINTER_DOWN, handler, false);\n\n\t} else if (type === 'touchmove') {\n\t\tobj.removeEventListener(POINTER_MOVE, handler, false);\n\n\t} else if (type === 'touchend') {\n\t\tobj.removeEventListener(POINTER_UP, handler, false);\n\t\tobj.removeEventListener(POINTER_CANCEL, handler, false);\n\t}\n\n\treturn this;\n}\n\nfunction _addPointerStart(obj, handler, id) {\n\tvar onDown = Util.bind(function (e) {\n\t\tif (e.pointerType !== 'mouse' && e.pointerType !== e.MSPOINTER_TYPE_MOUSE && e.pointerType !== e.MSPOINTER_TYPE_MOUSE) {\n\t\t\t// In IE11, some touch events needs to fire for form controls, or\n\t\t\t// the controls will stop working. We keep a whitelist of tag names that\n\t\t\t// need these events. For other target tags, we prevent default on the event.\n\t\t\tif (TAG_WHITE_LIST.indexOf(e.target.tagName) < 0) {\n\t\t\t\tDomEvent.preventDefault(e);\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t_handlePointer(e, handler);\n\t});\n\n\tobj['_leaflet_touchstart' + id] = onDown;\n\tobj.addEventListener(POINTER_DOWN, onDown, false);\n\n\t// need to keep track of what pointers and how many are active to provide e.touches emulation\n\tif (!_pointerDocListener) {\n\t\t// we listen documentElement as any drags that end by moving the touch off the screen get fired there\n\t\tdocument.documentElement.addEventListener(POINTER_DOWN, _globalPointerDown, true);\n\t\tdocument.documentElement.addEventListener(POINTER_MOVE, _globalPointerMove, true);\n\t\tdocument.documentElement.addEventListener(POINTER_UP, _globalPointerUp, true);\n\t\tdocument.documentElement.addEventListener(POINTER_CANCEL, _globalPointerUp, true);\n\n\t\t_pointerDocListener = true;\n\t}\n}\n\nfunction _globalPointerDown(e) {\n\t_pointers[e.pointerId] = e;\n\t_pointersCount++;\n}\n\nfunction _globalPointerMove(e) {\n\tif (_pointers[e.pointerId]) {\n\t\t_pointers[e.pointerId] = e;\n\t}\n}\n\nfunction _globalPointerUp(e) {\n\tdelete _pointers[e.pointerId];\n\t_pointersCount--;\n}\n\nfunction _handlePointer(e, handler) {\n\te.touches = [];\n\tfor (var i in _pointers) {\n\t\te.touches.push(_pointers[i]);\n\t}\n\te.changedTouches = [e];\n\n\thandler(e);\n}\n\nfunction _addPointerMove(obj, handler, id) {\n\tvar onMove = function (e) {\n\t\t// don't fire touch moves when mouse isn't down\n\t\tif ((e.pointerType === e.MSPOINTER_TYPE_MOUSE || e.pointerType === 'mouse') && e.buttons === 0) { return; }\n\n\t\t_handlePointer(e, handler);\n\t};\n\n\tobj['_leaflet_touchmove' + id] = onMove;\n\tobj.addEventListener(POINTER_MOVE, onMove, false);\n}\n\nfunction _addPointerEnd(obj, handler, id) {\n\tvar onUp = function (e) {\n\t\t_handlePointer(e, handler);\n\t};\n\n\tobj['_leaflet_touchend' + id] = onUp;\n\tobj.addEventListener(POINTER_UP, onUp, false);\n\tobj.addEventListener(POINTER_CANCEL, onUp, false);\n}\n\n","import * as Browser from '../core/Browser';\r\nimport {_pointersCount} from './DomEvent.Pointer';\r\n\r\n/*\r\n * Extends the event handling code with double tap support for mobile browsers.\r\n */\r\n\r\nvar _touchstart = Browser.msPointer ? 'MSPointerDown' : Browser.pointer ? 'pointerdown' : 'touchstart',\r\n    _touchend = Browser.msPointer ? 'MSPointerUp' : Browser.pointer ? 'pointerup' : 'touchend',\r\n    _pre = '_leaflet_';\r\n\r\n// inspired by Zepto touch code by Thomas Fuchs\r\nexport function addDoubleTapListener(obj, handler, id) {\r\n\tvar last, touch,\r\n\t    doubleTap = false,\r\n\t    delay = 250;\r\n\r\n\tfunction onTouchStart(e) {\r\n\t\tvar count;\r\n\r\n\t\tif (Browser.pointer) {\r\n\t\t\tif ((!Browser.edge) || e.pointerType === 'mouse') { return; }\r\n\t\t\tcount = _pointersCount;\r\n\t\t} else {\r\n\t\t\tcount = e.touches.length;\r\n\t\t}\r\n\r\n\t\tif (count > 1) { return; }\r\n\r\n\t\tvar now = Date.now(),\r\n\t\t    delta = now - (last || now);\r\n\r\n\t\ttouch = e.touches ? e.touches[0] : e;\r\n\t\tdoubleTap = (delta > 0 && delta <= delay);\r\n\t\tlast = now;\r\n\t}\r\n\r\n\tfunction onTouchEnd(e) {\r\n\t\tif (doubleTap && !touch.cancelBubble) {\r\n\t\t\tif (Browser.pointer) {\r\n\t\t\t\tif ((!Browser.edge) || e.pointerType === 'mouse') { return; }\r\n\t\t\t\t// work around .type being readonly with MSPointer* events\r\n\t\t\t\tvar newTouch = {},\r\n\t\t\t\t    prop, i;\r\n\r\n\t\t\t\tfor (i in touch) {\r\n\t\t\t\t\tprop = touch[i];\r\n\t\t\t\t\tnewTouch[i] = prop && prop.bind ? prop.bind(touch) : prop;\r\n\t\t\t\t}\r\n\t\t\t\ttouch = newTouch;\r\n\t\t\t}\r\n\t\t\ttouch.type = 'dblclick';\r\n\t\t\thandler(touch);\r\n\t\t\tlast = null;\r\n\t\t}\r\n\t}\r\n\r\n\tobj[_pre + _touchstart + id] = onTouchStart;\r\n\tobj[_pre + _touchend + id] = onTouchEnd;\r\n\tobj[_pre + 'dblclick' + id] = handler;\r\n\r\n\tobj.addEventListener(_touchstart, onTouchStart, false);\r\n\tobj.addEventListener(_touchend, onTouchEnd, false);\r\n\r\n\t// On some platforms (notably, chrome<55 on win10 + touchscreen + mouse),\r\n\t// the browser doesn't fire touchend/pointerup events but does fire\r\n\t// native dblclicks. See #4127.\r\n\t// Edge 14 also fires native dblclicks, but only for pointerType mouse, see #5180.\r\n\tobj.addEventListener('dblclick', handler, false);\r\n\r\n\treturn this;\r\n}\r\n\r\nexport function removeDoubleTapListener(obj, id) {\r\n\tvar touchstart = obj[_pre + _touchstart + id],\r\n\t    touchend = obj[_pre + _touchend + id],\r\n\t    dblclick = obj[_pre + 'dblclick' + id];\r\n\r\n\tobj.removeEventListener(_touchstart, touchstart, false);\r\n\tobj.removeEventListener(_touchend, touchend, false);\r\n\tif (!Browser.edge) {\r\n\t\tobj.removeEventListener('dblclick', dblclick, false);\r\n\t}\r\n\r\n\treturn this;\r\n}\r\n","import {Point} from '../geometry/Point';\r\nimport * as Util from '../core/Util';\r\nimport * as Browser from '../core/Browser';\r\nimport {addPointerListener, removePointerListener} from './DomEvent.Pointer';\r\nimport {addDoubleTapListener, removeDoubleTapListener} from './DomEvent.DoubleTap';\r\n\r\n/*\r\n * @namespace DomEvent\r\n * Utility functions to work with the [DOM events](https://developer.mozilla.org/docs/Web/API/Event), used by Leaflet internally.\r\n */\r\n\r\n// Inspired by John Resig, Dean Edwards and YUI addEvent implementations.\r\n\r\n// @function on(el: HTMLElement, types: String, fn: Function, context?: Object): this\r\n// Adds a listener function (`fn`) to a particular DOM event type of the\r\n// element `el`. You can optionally specify the context of the listener\r\n// (object the `this` keyword will point to). You can also pass several\r\n// space-separated types (e.g. `'click dblclick'`).\r\n\r\n// @alternative\r\n// @function on(el: HTMLElement, eventMap: Object, context?: Object): this\r\n// Adds a set of type/listener pairs, e.g. `{click: onClick, mousemove: onMouseMove}`\r\nexport function on(obj, types, fn, context) {\r\n\r\n\tif (typeof types === 'object') {\r\n\t\tfor (var type in types) {\r\n\t\t\taddOne(obj, type, types[type], fn);\r\n\t\t}\r\n\t} else {\r\n\t\ttypes = Util.splitWords(types);\r\n\r\n\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\taddOne(obj, types[i], fn, context);\r\n\t\t}\r\n\t}\r\n\r\n\treturn this;\r\n}\r\n\r\nvar eventsKey = '_leaflet_events';\r\n\r\n// @function off(el: HTMLElement, types: String, fn: Function, context?: Object): this\r\n// Removes a previously added listener function. If no function is specified,\r\n// it will remove all the listeners of that particular DOM event from the element.\r\n// Note that if you passed a custom context to on, you must pass the same\r\n// context to `off` in order to remove the listener.\r\n\r\n// @alternative\r\n// @function off(el: HTMLElement, eventMap: Object, context?: Object): this\r\n// Removes a set of type/listener pairs, e.g. `{click: onClick, mousemove: onMouseMove}`\r\n\r\n// @alternative\r\n// @function off(el: HTMLElement): this\r\n// Removes all known event listeners\r\nexport function off(obj, types, fn, context) {\r\n\r\n\tif (typeof types === 'object') {\r\n\t\tfor (var type in types) {\r\n\t\t\tremoveOne(obj, type, types[type], fn);\r\n\t\t}\r\n\t} else if (types) {\r\n\t\ttypes = Util.splitWords(types);\r\n\r\n\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\tremoveOne(obj, types[i], fn, context);\r\n\t\t}\r\n\t} else {\r\n\t\tfor (var j in obj[eventsKey]) {\r\n\t\t\tremoveOne(obj, j, obj[eventsKey][j]);\r\n\t\t}\r\n\t\tdelete obj[eventsKey];\r\n\t}\r\n}\r\n\r\nfunction addOne(obj, type, fn, context) {\r\n\tvar id = type + Util.stamp(fn) + (context ? '_' + Util.stamp(context) : '');\r\n\r\n\tif (obj[eventsKey] && obj[eventsKey][id]) { return this; }\r\n\r\n\tvar handler = function (e) {\r\n\t\treturn fn.call(context || obj, e || window.event);\r\n\t};\r\n\r\n\tvar originalHandler = handler;\r\n\r\n\tif (Browser.pointer && type.indexOf('touch') === 0) {\r\n\t\t// Needs DomEvent.Pointer.js\r\n\t\taddPointerListener(obj, type, handler, id);\r\n\r\n\t} else if (Browser.touch && (type === 'dblclick') && addDoubleTapListener &&\r\n\t           !(Browser.pointer && Browser.chrome)) {\r\n\t\t// Chrome >55 does not need the synthetic dblclicks from addDoubleTapListener\r\n\t\t// See #5180\r\n\t\taddDoubleTapListener(obj, handler, id);\r\n\r\n\t} else if ('addEventListener' in obj) {\r\n\r\n\t\tif (type === 'mousewheel') {\r\n\t\t\tobj.addEventListener('onwheel' in obj ? 'wheel' : 'mousewheel', handler, false);\r\n\r\n\t\t} else if ((type === 'mouseenter') || (type === 'mouseleave')) {\r\n\t\t\thandler = function (e) {\r\n\t\t\t\te = e || window.event;\r\n\t\t\t\tif (isExternalTarget(obj, e)) {\r\n\t\t\t\t\toriginalHandler(e);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tobj.addEventListener(type === 'mouseenter' ? 'mouseover' : 'mouseout', handler, false);\r\n\r\n\t\t} else {\r\n\t\t\tif (type === 'click' && Browser.android) {\r\n\t\t\t\thandler = function (e) {\r\n\t\t\t\t\tfilterClick(e, originalHandler);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tobj.addEventListener(type, handler, false);\r\n\t\t}\r\n\r\n\t} else if ('attachEvent' in obj) {\r\n\t\tobj.attachEvent('on' + type, handler);\r\n\t}\r\n\r\n\tobj[eventsKey] = obj[eventsKey] || {};\r\n\tobj[eventsKey][id] = handler;\r\n}\r\n\r\nfunction removeOne(obj, type, fn, context) {\r\n\r\n\tvar id = type + Util.stamp(fn) + (context ? '_' + Util.stamp(context) : ''),\r\n\t    handler = obj[eventsKey] && obj[eventsKey][id];\r\n\r\n\tif (!handler) { return this; }\r\n\r\n\tif (Browser.pointer && type.indexOf('touch') === 0) {\r\n\t\tremovePointerListener(obj, type, id);\r\n\r\n\t} else if (Browser.touch && (type === 'dblclick') && removeDoubleTapListener) {\r\n\t\tremoveDoubleTapListener(obj, id);\r\n\r\n\t} else if ('removeEventListener' in obj) {\r\n\r\n\t\tif (type === 'mousewheel') {\r\n\t\t\tobj.removeEventListener('onwheel' in obj ? 'wheel' : 'mousewheel', handler, false);\r\n\r\n\t\t} else {\r\n\t\t\tobj.removeEventListener(\r\n\t\t\t\ttype === 'mouseenter' ? 'mouseover' :\r\n\t\t\t\ttype === 'mouseleave' ? 'mouseout' : type, handler, false);\r\n\t\t}\r\n\r\n\t} else if ('detachEvent' in obj) {\r\n\t\tobj.detachEvent('on' + type, handler);\r\n\t}\r\n\r\n\tobj[eventsKey][id] = null;\r\n}\r\n\r\n// @function stopPropagation(ev: DOMEvent): this\r\n// Stop the given event from propagation to parent elements. Used inside the listener functions:\r\n// ```js\r\n// L.DomEvent.on(div, 'click', function (ev) {\r\n// \tL.DomEvent.stopPropagation(ev);\r\n// });\r\n// ```\r\nexport function stopPropagation(e) {\r\n\r\n\tif (e.stopPropagation) {\r\n\t\te.stopPropagation();\r\n\t} else if (e.originalEvent) {  // In case of Leaflet event.\r\n\t\te.originalEvent._stopped = true;\r\n\t} else {\r\n\t\te.cancelBubble = true;\r\n\t}\r\n\tskipped(e);\r\n\r\n\treturn this;\r\n}\r\n\r\n// @function disableScrollPropagation(el: HTMLElement): this\r\n// Adds `stopPropagation` to the element's `'mousewheel'` events (plus browser variants).\r\nexport function disableScrollPropagation(el) {\r\n\treturn addOne(el, 'mousewheel', stopPropagation);\r\n}\r\n\r\n// @function disableClickPropagation(el: HTMLElement): this\r\n// Adds `stopPropagation` to the element's `'click'`, `'doubleclick'`,\r\n// `'mousedown'` and `'touchstart'` events (plus browser variants).\r\nexport function disableClickPropagation(el) {\r\n\ton(el, 'mousedown touchstart dblclick', stopPropagation);\r\n\taddOne(el, 'click', fakeStop);\r\n\treturn this;\r\n}\r\n\r\n// @function preventDefault(ev: DOMEvent): this\r\n// Prevents the default action of the DOM Event `ev` from happening (such as\r\n// following a link in the href of the a element, or doing a POST request\r\n// with page reload when a `<form>` is submitted).\r\n// Use it inside listener functions.\r\nexport function preventDefault(e) {\r\n\tif (e.preventDefault) {\r\n\t\te.preventDefault();\r\n\t} else {\r\n\t\te.returnValue = false;\r\n\t}\r\n\treturn this;\r\n}\r\n\r\n// @function stop(ev): this\r\n// Does `stopPropagation` and `preventDefault` at the same time.\r\nexport function stop(e) {\r\n\tpreventDefault(e);\r\n\tstopPropagation(e);\r\n\treturn this;\r\n}\r\n\r\n// @function getMousePosition(ev: DOMEvent, container?: HTMLElement): Point\r\n// Gets normalized mouse position from a DOM event relative to the\r\n// `container` or to the whole page if not specified.\r\nexport function getMousePosition(e, container) {\r\n\tif (!container) {\r\n\t\treturn new Point(e.clientX, e.clientY);\r\n\t}\r\n\r\n\tvar rect = container.getBoundingClientRect();\r\n\r\n\treturn new Point(\r\n\t\te.clientX - rect.left - container.clientLeft,\r\n\t\te.clientY - rect.top - container.clientTop);\r\n}\r\n\r\n// Chrome on Win scrolls double the pixels as in other platforms (see #4538),\r\n// and Firefox scrolls device pixels, not CSS pixels\r\nvar wheelPxFactor =\r\n\t(Browser.win && Browser.chrome) ? 2 :\r\n\tBrowser.gecko ? window.devicePixelRatio : 1;\r\n\r\n// @function getWheelDelta(ev: DOMEvent): Number\r\n// Gets normalized wheel delta from a mousewheel DOM event, in vertical\r\n// pixels scrolled (negative if scrolling down).\r\n// Events from pointing devices without precise scrolling are mapped to\r\n// a best guess of 60 pixels.\r\nexport function getWheelDelta(e) {\r\n\treturn (Browser.edge) ? e.wheelDeltaY / 2 : // Don't trust window-geometry-based delta\r\n\t       (e.deltaY && e.deltaMode === 0) ? -e.deltaY / wheelPxFactor : // Pixels\r\n\t       (e.deltaY && e.deltaMode === 1) ? -e.deltaY * 20 : // Lines\r\n\t       (e.deltaY && e.deltaMode === 2) ? -e.deltaY * 60 : // Pages\r\n\t       (e.deltaX || e.deltaZ) ? 0 :\t// Skip horizontal/depth wheel events\r\n\t       e.wheelDelta ? (e.wheelDeltaY || e.wheelDelta) / 2 : // Legacy IE pixels\r\n\t       (e.detail && Math.abs(e.detail) < 32765) ? -e.detail * 20 : // Legacy Moz lines\r\n\t       e.detail ? e.detail / -32765 * 60 : // Legacy Moz pages\r\n\t       0;\r\n}\r\n\r\nvar skipEvents = {};\r\n\r\nexport function fakeStop(e) {\r\n\t// fakes stopPropagation by setting a special event flag, checked/reset with skipped(e)\r\n\tskipEvents[e.type] = true;\r\n}\r\n\r\nexport function skipped(e) {\r\n\tvar events = skipEvents[e.type];\r\n\t// reset when checking, as it's only used in map container and propagates outside of the map\r\n\tskipEvents[e.type] = false;\r\n\treturn events;\r\n}\r\n\r\n// check if element really left/entered the event target (for mouseenter/mouseleave)\r\nexport function isExternalTarget(el, e) {\r\n\r\n\tvar related = e.relatedTarget;\r\n\r\n\tif (!related) { return true; }\r\n\r\n\ttry {\r\n\t\twhile (related && (related !== el)) {\r\n\t\t\trelated = related.parentNode;\r\n\t\t}\r\n\t} catch (err) {\r\n\t\treturn false;\r\n\t}\r\n\treturn (related !== el);\r\n}\r\n\r\nvar lastClick;\r\n\r\n// this is a horrible workaround for a bug in Android where a single touch triggers two click events\r\nfunction filterClick(e, handler) {\r\n\tvar timeStamp = (e.timeStamp || (e.originalEvent && e.originalEvent.timeStamp)),\r\n\t    elapsed = lastClick && (timeStamp - lastClick);\r\n\r\n\t// are they closer together than 500ms yet more than 100ms?\r\n\t// Android typically triggers them ~300ms apart while multiple listeners\r\n\t// on the same event should be triggered far faster;\r\n\t// or check if click is simulated on the element, and if it is, reject any non-simulated events\r\n\r\n\tif ((elapsed && elapsed > 100 && elapsed < 500) || (e.target._simulatedClick && !e._simulated)) {\r\n\t\tstop(e);\r\n\t\treturn;\r\n\t}\r\n\tlastClick = timeStamp;\r\n\r\n\thandler(e);\r\n}\r\n\r\n// @function addListener(…): this\r\n// Alias to [`L.DomEvent.on`](#domevent-on)\r\nexport {on as addListener};\r\n\r\n// @function removeListener(…): this\r\n// Alias to [`L.DomEvent.off`](#domevent-off)\r\nexport {off as removeListener};\r\n","import * as DomEvent from './DomEvent';\nimport * as Util from '../core/Util';\nimport {Point} from '../geometry/Point';\nimport * as Browser from '../core/Browser';\n\n/*\n * @namespace DomUtil\n *\n * Utility functions to work with the [DOM](https://developer.mozilla.org/docs/Web/API/Document_Object_Model)\n * tree, used by Leaflet internally.\n *\n * Most functions expecting or returning a `HTMLElement` also work for\n * SVG elements. The only difference is that classes refer to CSS classes\n * in HTML and SVG classes in SVG.\n */\n\n if (!Element.prototype.matches) {\n    var ep = Element.prototype;\n \n    if (ep.webkitMatchesSelector) // Chrome <34, SF<7.1, iOS<8\n      ep.matches = ep.webkitMatchesSelector;\n \n    if (ep.msMatchesSelector) // IE9/10/11 & Edge\n      ep.matches = ep.msMatchesSelector;\n \n    if (ep.mozMatchesSelector) // FF<34\n      ep.matches = ep.mozMatchesSelector;\n }\n\n// @property TRANSFORM: String\n// Vendor-prefixed fransform style name (e.g. `'webkitTransform'` for WebKit).\nexport var TRANSFORM = testProp(\n    ['transform', 'WebkitTransform', 'OTransform', 'MozTransform', 'msTransform']);\n\n// webkitTransition comes first because some browser versions that drop vendor prefix don't do\n// the same for the transitionend event, in particular the Android 4.1 stock browser\n\n// @property TRANSITION: String\n// Vendor-prefixed transform style name.\nexport var TRANSITION = testProp(\n    ['webkitTransition', 'transition', 'OTransition', 'MozTransition', 'msTransition']);\n\nexport var TRANSITION_END =\n    TRANSITION === 'webkitTransition' || TRANSITION === 'OTransition' ? TRANSITION + 'End' : 'transitionend';\n\n\n// @function get(id: String|HTMLElement): HTMLElement\n// Returns an element given its DOM id, or returns the element itself\n// if it was passed directly.\nexport function get(id) {\n    return typeof id === 'string' ? document.getElementById(id) : id;\n}\n\n// @function getStyle(el: HTMLElement, styleAttrib: String): String\n// Returns the value for a certain style attribute on an element,\n// including computed values or values set through CSS.\nexport function getStyle(el, style) {\n    var value = el.style[style] || (el.currentStyle && el.currentStyle[style]);\n\n    if ((!value || value === 'auto') && document.defaultView) {\n        var css = document.defaultView.getComputedStyle(el, null);\n        value = css ? css[style] : null;\n    }\n    return value === 'auto' ? null : value;\n}\n\n// @function create(tagName: String, className?: String, container?: HTMLElement): HTMLElement\n// Creates an HTML element with `tagName`, sets its class to `className`, and optionally appends it to `container` element.\nexport function create(tagName, className, container) {\n    var el = document.createElement(tagName);\n    el.className = className || '';\n\n    if (container) {\n        container.appendChild(el);\n    }\n    return el;\n}\n\n// @function remove(el: HTMLElement)\n// Removes `el` from its parent element\nexport function remove(el) {\n    var parent = el.parentNode;\n    if (parent) {\n        parent.removeChild(el);\n    }\n}\n\n// @function empty(el: HTMLElement)\n// Removes all of `el`'s children elements from `el`\nexport function empty(el) {\n    while (el.firstChild) {\n        el.removeChild(el.firstChild);\n    }\n}\n\n// @function toFront(el: HTMLElement)\n// Makes `el` the last child of its parent, so it renders in front of the other children.\nexport function toFront(el) {\n    el.parentNode.appendChild(el);\n}\n\n// @function toBack(el: HTMLElement)\n// Makes `el` the first child of its parent, so it renders behind the other children.\nexport function toBack(el) {\n    var parent = el.parentNode;\n    parent.insertBefore(el, parent.firstChild);\n}\n\n// @function hasClass(el: HTMLElement, name: String): Boolean\n// Returns `true` if the element's class attribute contains `name`.\nexport function hasClass(el, name) {\n    if (el.classList !== undefined) {\n        return el.classList.contains(name);\n    }\n    var className = getClass(el);\n    return className.length > 0 && new RegExp('(^|\\\\s)' + name + '(\\\\s|$)').test(className);\n}\n\n// @function addClass(el: HTMLElement, name: String)\n// Adds `name` to the element's class attribute.\nexport function addClass(el, name) {\n    if (el.classList !== undefined) {\n        var classes = Util.splitWords(name);\n        for (var i = 0, len = classes.length; i < len; i++) {\n            el.classList.add(classes[i]);\n        }\n    } else if (!hasClass(el, name)) {\n        var className = getClass(el);\n        setClass(el, (className ? className + ' ' : '') + name);\n    }\n}\n\n// @function removeClass(el: HTMLElement, name: String)\n// Removes `name` from the element's class attribute.\nexport function removeClass(el, name) {\n    if (el.classList !== undefined) {\n        el.classList.remove(name);\n    } else {\n        setClass(el, Util.trim((' ' + getClass(el) + ' ').replace(' ' + name + ' ', ' ')));\n    }\n}\n\n// @function setClass(el: HTMLElement, name: String)\n// Sets the element's class.\nexport function setClass(el, name) {\n    if (el.className.baseVal === undefined) {\n        el.className = name;\n    } else {\n        // in case of SVG element\n        el.className.baseVal = name;\n    }\n}\n\n// @function getClass(el: HTMLElement): String\n// Returns the element's class.\nexport function getClass(el) {\n    return el.className.baseVal === undefined ? el.className : el.className.baseVal;\n}\n\n// @function setOpacity(el: HTMLElement, opacity: Number)\n// Set the opacity of an element (including old IE support).\n// `opacity` must be a number from `0` to `1`.\nexport function setOpacity(el, value) {\n    if ('opacity' in el.style) {\n        el.style.opacity = value;\n    } else if ('filter' in el.style) {\n        _setOpacityIE(el, value);\n    }\n}\n\nfunction _setOpacityIE(el, value) {\n    var filter = false,\n        filterName = 'DXImageTransform.Microsoft.Alpha';\n\n    // filters collection throws an error if we try to retrieve a filter that doesn't exist\n    try {\n        filter = el.filters.item(filterName);\n    } catch (e) {\n        // don't set opacity to 1 if we haven't already set an opacity,\n        // it isn't needed and breaks transparent pngs.\n        if (value === 1) { return; }\n    }\n\n    value = Math.round(value * 100);\n\n    if (filter) {\n        filter.Enabled = (value !== 100);\n        filter.Opacity = value;\n    } else {\n        el.style.filter += ' progid:' + filterName + '(opacity=' + value + ')';\n    }\n}\n\n// @function testProp(props: String[]): String|false\n// Goes through the array of style names and returns the first name\n// that is a valid style name for an element. If no such name is found,\n// it returns false. Useful for vendor-prefixed styles like `transform`.\nexport function testProp(props) {\n    var style = document.documentElement.style;\n\n    for (var i = 0; i < props.length; i++) {\n        if (props[i] in style) {\n            return props[i];\n        }\n    }\n    return false;\n}\n\nexport function isPropertySupported(prop) {\n    var style = document.documentElement.style;\n    return prop in style;\n}\n\n// @function setTransform(el: HTMLElement, offset: Point, scale?: Number)\n// Resets the 3D CSS transform of `el` so it is translated by `offset` pixels\n// and optionally scaled by `scale`. Does not have an effect if the\n// browser doesn't support 3D CSS transforms.\nexport function setTransform(el, offset, scale) {\n    var pos = offset || new Point(0, 0);\n\n    el.style[TRANSFORM] =\n        (Browser.ie3d ?\n            'translate(' + pos.x + 'px,' + pos.y + 'px)' :\n            'translate3d(' + pos.x + 'px,' + pos.y + 'px,0)') +\n        (scale ? ' scale(' + scale + ')' : '');\n}\n\n// @function setPosition(el: HTMLElement, position: Point)\n// Sets the position of `el` to coordinates specified by `position`,\n// using CSS translate or top/left positioning depending on the browser\n// (used by Leaflet internally to position its layers).\nexport function setPosition(el, point) {\n\n    /*eslint-disable */\n    el._leaflet_pos = point;\n    /*eslint-enable */\n\n    if (Browser.any3d) {\n        setTransform(el, point);\n    } else {\n        el.style.left = point.x + 'px';\n        el.style.top = point.y + 'px';\n    }\n}\n\n// @function getPosition(el: HTMLElement): Point\n// Returns the coordinates of an element previously positioned with setPosition.\nexport function getPosition(el) {\n    // this method is only used for elements previously positioned using setPosition,\n    // so it's safe to cache the position for performance\n\n    return el._leaflet_pos || new Point(0, 0);\n}\n\n// @function disableTextSelection()\n// Prevents the user from generating `selectstart` DOM events, usually generated\n// when the user drags the mouse through a page with text. Used internally\n// by Leaflet to override the behaviour of any click-and-drag interaction on\n// the map. Affects drag interactions on the whole document.\n\n// @function enableTextSelection()\n// Cancels the effects of a previous [`L.DomUtil.disableTextSelection`](#domutil-disabletextselection).\nexport var disableTextSelection;\nexport var enableTextSelection;\nvar _userSelect;\nif ('onselectstart' in document) {\n    disableTextSelection = function () {\n        DomEvent.on(window, 'selectstart', DomEvent.preventDefault);\n    };\n    enableTextSelection = function () {\n        DomEvent.off(window, 'selectstart', DomEvent.preventDefault);\n    };\n} else {\n    var userSelectProperty = testProp(\n        ['userSelect', 'WebkitUserSelect', 'OUserSelect', 'MozUserSelect', 'msUserSelect']);\n\n    disableTextSelection = function () {\n        if (userSelectProperty) {\n            var style = document.documentElement.style;\n            _userSelect = style[userSelectProperty];\n            style[userSelectProperty] = 'none';\n        }\n    };\n    enableTextSelection = function () {\n        if (userSelectProperty) {\n            document.documentElement.style[userSelectProperty] = _userSelect;\n            _userSelect = undefined;\n        }\n    };\n}\n\n// @function disableImageDrag()\n// As [`L.DomUtil.disableTextSelection`](#domutil-disabletextselection), but\n// for `dragstart` DOM events, usually generated when the user drags an image.\nexport function disableImageDrag() {\n    DomEvent.on(window, 'dragstart', DomEvent.preventDefault);\n}\n\n// @function enableImageDrag()\n// Cancels the effects of a previous [`L.DomUtil.disableImageDrag`](#domutil-disabletextselection).\nexport function enableImageDrag() {\n    DomEvent.off(window, 'dragstart', DomEvent.preventDefault);\n}\n\nvar _outlineElement, _outlineStyle;\n// @function preventOutline(el: HTMLElement)\n// Makes the [outline](https://developer.mozilla.org/docs/Web/CSS/outline)\n// of the element `el` invisible. Used internally by Leaflet to prevent\n// focusable elements from displaying an outline when the user performs a\n// drag interaction on them.\nexport function preventOutline(element) {\n    while (element.tabIndex === -1) {\n        element = element.parentNode;\n    }\n    if (!element || !element.style) { return; }\n    restoreOutline();\n    _outlineElement = element;\n    _outlineStyle = element.style.outline;\n    element.style.outline = 'none';\n    DomEvent.on(window, 'keydown', restoreOutline);\n}\n\n// @function restoreOutline()\n// Cancels the effects of a previous [`L.DomUtil.preventOutline`]().\nexport function restoreOutline() {\n    if (!_outlineElement) { return; }\n    _outlineElement.style.outline = _outlineStyle;\n    _outlineElement = undefined;\n    _outlineStyle = undefined;\n    DomEvent.off(window, 'keydown', restoreOutline);\n}\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var baseGetTag = require('./_baseGetTag'),\n    isObject = require('./isObject');\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nmodule.exports = isFunction;\n","var root = require('./_root');\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nmodule.exports = coreJsData;\n","var coreJsData = require('./_coreJsData');\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nmodule.exports = isMasked;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nmodule.exports = toSource;\n","var isFunction = require('./isFunction'),\n    isMasked = require('./_isMasked'),\n    isObject = require('./isObject'),\n    toSource = require('./_toSource');\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nmodule.exports = baseIsNative;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nmodule.exports = getValue;\n","var baseIsNative = require('./_baseIsNative'),\n    getValue = require('./_getValue');\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nmodule.exports = getNative;\n","var getNative = require('./_getNative');\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nmodule.exports = defineProperty;\n","var defineProperty = require('./_defineProperty');\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\nmodule.exports = baseAssignValue;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nmodule.exports = eq;\n","var baseAssignValue = require('./_baseAssignValue'),\n    eq = require('./eq');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nmodule.exports = assignValue;\n","var assignValue = require('./_assignValue'),\n    baseAssignValue = require('./_baseAssignValue');\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property identifiers to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @param {Function} [customizer] The function to customize copied values.\n * @returns {Object} Returns `object`.\n */\nfunction copyObject(source, props, object, customizer) {\n  var isNew = !object;\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n\n    var newValue = customizer\n      ? customizer(object[key], source[key], key, object, source)\n      : undefined;\n\n    if (newValue === undefined) {\n      newValue = source[key];\n    }\n    if (isNew) {\n      baseAssignValue(object, key, newValue);\n    } else {\n      assignValue(object, key, newValue);\n    }\n  }\n  return object;\n}\n\nmodule.exports = copyObject;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nmodule.exports = identity;\n","/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\nmodule.exports = apply;\n","var apply = require('./_apply');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * A specialized version of `baseRest` which transforms the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @param {Function} transform The rest array transform.\n * @returns {Function} Returns the new function.\n */\nfunction overRest(func, start, transform) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = transform(array);\n    return apply(func, this, otherArgs);\n  };\n}\n\nmodule.exports = overRest;\n","/**\n * Creates a function that returns `value`.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {*} value The value to return from the new function.\n * @returns {Function} Returns the new constant function.\n * @example\n *\n * var objects = _.times(2, _.constant({ 'a': 1 }));\n *\n * console.log(objects);\n * // => [{ 'a': 1 }, { 'a': 1 }]\n *\n * console.log(objects[0] === objects[1]);\n * // => true\n */\nfunction constant(value) {\n  return function() {\n    return value;\n  };\n}\n\nmodule.exports = constant;\n","var constant = require('./constant'),\n    defineProperty = require('./_defineProperty'),\n    identity = require('./identity');\n\n/**\n * The base implementation of `setToString` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar baseSetToString = !defineProperty ? identity : function(func, string) {\n  return defineProperty(func, 'toString', {\n    'configurable': true,\n    'enumerable': false,\n    'value': constant(string),\n    'writable': true\n  });\n};\n\nmodule.exports = baseSetToString;\n","/** Used to detect hot functions by number of calls within a span of milliseconds. */\nvar HOT_COUNT = 800,\n    HOT_SPAN = 16;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeNow = Date.now;\n\n/**\n * Creates a function that'll short out and invoke `identity` instead\n * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n * milliseconds.\n *\n * @private\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new shortable function.\n */\nfunction shortOut(func) {\n  var count = 0,\n      lastCalled = 0;\n\n  return function() {\n    var stamp = nativeNow(),\n        remaining = HOT_SPAN - (stamp - lastCalled);\n\n    lastCalled = stamp;\n    if (remaining > 0) {\n      if (++count >= HOT_COUNT) {\n        return arguments[0];\n      }\n    } else {\n      count = 0;\n    }\n    return func.apply(undefined, arguments);\n  };\n}\n\nmodule.exports = shortOut;\n","var baseSetToString = require('./_baseSetToString'),\n    shortOut = require('./_shortOut');\n\n/**\n * Sets the `toString` method of `func` to return `string`.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar setToString = shortOut(baseSetToString);\n\nmodule.exports = setToString;\n","var identity = require('./identity'),\n    overRest = require('./_overRest'),\n    setToString = require('./_setToString');\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  return setToString(overRest(func, start, identity), func + '');\n}\n\nmodule.exports = baseRest;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nmodule.exports = isLength;\n","var isFunction = require('./isFunction'),\n    isLength = require('./isLength');\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nmodule.exports = isArrayLike;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  length = length == null ? MAX_SAFE_INTEGER : length;\n  return !!length &&\n    (typeof value == 'number' || reIsUint.test(value)) &&\n    (value > -1 && value % 1 == 0 && value < length);\n}\n\nmodule.exports = isIndex;\n","var eq = require('./eq'),\n    isArrayLike = require('./isArrayLike'),\n    isIndex = require('./_isIndex'),\n    isObject = require('./isObject');\n\n/**\n * Checks if the given arguments are from an iteratee call.\n *\n * @private\n * @param {*} value The potential iteratee value argument.\n * @param {*} index The potential iteratee index or key argument.\n * @param {*} object The potential iteratee object argument.\n * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n *  else `false`.\n */\nfunction isIterateeCall(value, index, object) {\n  if (!isObject(object)) {\n    return false;\n  }\n  var type = typeof index;\n  if (type == 'number'\n        ? (isArrayLike(object) && isIndex(index, object.length))\n        : (type == 'string' && index in object)\n      ) {\n    return eq(object[index], value);\n  }\n  return false;\n}\n\nmodule.exports = isIterateeCall;\n","var baseRest = require('./_baseRest'),\n    isIterateeCall = require('./_isIterateeCall');\n\n/**\n * Creates a function like `_.assign`.\n *\n * @private\n * @param {Function} assigner The function to assign values.\n * @returns {Function} Returns the new assigner function.\n */\nfunction createAssigner(assigner) {\n  return baseRest(function(object, sources) {\n    var index = -1,\n        length = sources.length,\n        customizer = length > 1 ? sources[length - 1] : undefined,\n        guard = length > 2 ? sources[2] : undefined;\n\n    customizer = (assigner.length > 3 && typeof customizer == 'function')\n      ? (length--, customizer)\n      : undefined;\n\n    if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n      customizer = length < 3 ? undefined : customizer;\n      length = 1;\n    }\n    object = Object(object);\n    while (++index < length) {\n      var source = sources[index];\n      if (source) {\n        assigner(object, source, index, customizer);\n      }\n    }\n    return object;\n  });\n}\n\nmodule.exports = createAssigner;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nmodule.exports = isPrototype;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nmodule.exports = baseTimes;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nmodule.exports = baseIsArguments;\n","var baseIsArguments = require('./_baseIsArguments'),\n    isObjectLike = require('./isObjectLike');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nmodule.exports = isArguments;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nmodule.exports = isArray;\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = stubFalse;\n","var root = require('./_root'),\n    stubFalse = require('./stubFalse');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nmodule.exports = isBuffer;\n","var baseGetTag = require('./_baseGetTag'),\n    isLength = require('./isLength'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nmodule.exports = baseIsTypedArray;\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nmodule.exports = baseUnary;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nmodule.exports = nodeUtil;\n","var baseIsTypedArray = require('./_baseIsTypedArray'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nmodule.exports = isTypedArray;\n","var baseTimes = require('./_baseTimes'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isIndex = require('./_isIndex'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayLikeKeys;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nmodule.exports = overArg;\n","var overArg = require('./_overArg');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nmodule.exports = nativeKeys;\n","var isPrototype = require('./_isPrototype'),\n    nativeKeys = require('./_nativeKeys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseKeys;\n","var arrayLikeKeys = require('./_arrayLikeKeys'),\n    baseKeys = require('./_baseKeys'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nmodule.exports = keys;\n","var assignValue = require('./_assignValue'),\n    copyObject = require('./_copyObject'),\n    createAssigner = require('./_createAssigner'),\n    isArrayLike = require('./isArrayLike'),\n    isPrototype = require('./_isPrototype'),\n    keys = require('./keys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns own enumerable string keyed properties of source objects to the\n * destination object. Source objects are applied from left to right.\n * Subsequent sources overwrite property assignments of previous sources.\n *\n * **Note:** This method mutates `object` and is loosely based on\n * [`Object.assign`](https://mdn.io/Object/assign).\n *\n * @static\n * @memberOf _\n * @since 0.10.0\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} [sources] The source objects.\n * @returns {Object} Returns `object`.\n * @see _.assignIn\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * function Bar() {\n *   this.c = 3;\n * }\n *\n * Foo.prototype.b = 2;\n * Bar.prototype.d = 4;\n *\n * _.assign({ 'a': 0 }, new Foo, new Bar);\n * // => { 'a': 1, 'c': 3 }\n */\nvar assign = createAssigner(function(object, source) {\n  if (isPrototype(source) || isArrayLike(source)) {\n    copyObject(source, keys(source), object);\n    return;\n  }\n  for (var key in source) {\n    if (hasOwnProperty.call(source, key)) {\n      assignValue(object, key, source[key]);\n    }\n  }\n});\n\nmodule.exports = assign;\n","var document = typeof window !== 'undefined' && typeof window.document !== 'undefined' ? window.document : {};\nvar keyboardAllowed = typeof Element !== 'undefined' && 'ALLOW_KEYBOARD_INPUT' in Element;\n\nvar fn = (function () {\n  var val;\n\n  var fnMap = [\n    [\n      'requestFullscreen',\n      'exitFullscreen',\n      'fullscreenElement',\n      'fullscreenEnabled',\n      'fullscreenchange',\n      'fullscreenerror'\n    ],\n    // New WebKit\n    [\n      'webkitRequestFullscreen',\n      'webkitExitFullscreen',\n      'webkitFullscreenElement',\n      'webkitFullscreenEnabled',\n      'webkitfullscreenchange',\n      'webkitfullscreenerror'\n\n    ],\n    // Old WebKit (Safari 5.1)\n    [\n      'webkitRequestFullScreen',\n      'webkitCancelFullScreen',\n      'webkitCurrentFullScreenElement',\n      'webkitCancelFullScreen',\n      'webkitfullscreenchange',\n      'webkitfullscreenerror'\n\n    ],\n    [\n      'mozRequestFullScreen',\n      'mozCancelFullScreen',\n      'mozFullScreenElement',\n      'mozFullScreenEnabled',\n      'mozfullscreenchange',\n      'mozfullscreenerror'\n    ],\n    [\n      'msRequestFullscreen',\n      'msExitFullscreen',\n      'msFullscreenElement',\n      'msFullscreenEnabled',\n      'MSFullscreenChange',\n      'MSFullscreenError'\n    ]\n  ];\n\n  var i = 0;\n  var l = fnMap.length;\n  var ret = {};\n\n  for (; i < l; i++) {\n    val = fnMap[i];\n    if (val && val[1] in document) {\n      for (i = 0; i < val.length; i++) {\n        ret[fnMap[0][i]] = val[i];\n      }\n      return ret;\n    }\n  }\n\n  return false;\n})();\n\nvar eventNameMap = {\n  change: fn.fullscreenchange,\n  error: fn.fullscreenerror\n};\n\nvar screenfull = {\n  request: function (elem) {\n    var request = fn.requestFullscreen;\n\n    elem = elem || document.documentElement;\n\n    // Work around Safari 5.1 bug: reports support for\n    // keyboard in fullscreen even though it doesn't.\n    // Browser sniffing, since the alternative with\n    // setTimeout is even worse.\n    if (/5\\.1[.\\d]* Safari/.test(navigator.userAgent)) {\n      elem[request]();\n    } else {\n      elem[request](keyboardAllowed && Element.ALLOW_KEYBOARD_INPUT);\n    }\n  },\n  exit: function () {\n    document[fn.exitFullscreen]();\n  },\n  toggle: function (elem) {\n    if (this.isFullscreen) {\n      this.exit();\n    } else {\n      this.request(elem);\n    }\n  },\n  onchange: function (callback) {\n    this.on('change', callback);\n  },\n  onerror: function (callback) {\n    this.on('error', callback);\n  },\n  on: function (event, callback) {\n    var eventName = eventNameMap[event];\n    if (eventName) {\n      document.addEventListener(eventName, callback, false);\n    }\n  },\n  off: function (event, callback) {\n    var eventName = eventNameMap[event];\n    if (eventName) {\n      document.removeEventListener(eventName, callback, false);\n    }\n  },\n  raw: fn\n};\n\nObject.defineProperties(screenfull, {\n  isFullscreen: {\n    get: function () {\n      return Boolean(document[fn.fullscreenElement]);\n    }\n  },\n  element: {\n    enumerable: true,\n    get: function () {\n      return document[fn.fullscreenElement];\n    }\n  },\n  enabled: {\n    enumerable: true,\n    get: function () {\n      // Coerce to boolean in case of old WebKit\n      return Boolean(document[fn.fullscreenEnabled]);\n    }\n  }\n});\n\nexport {screenfull};","import * as Util from '../core/Util';\nimport {Evented} from '../core/Events';\n// import {Class} from '../core/Class';\nimport * as Browser from '../core/Browser';\nimport * as DomEvent from '../dom/DomEvent';\nimport * as DomUtil from '../dom/DomUtil';\n\nimport debounce from 'lodash/debounce';\nimport assign from 'lodash/assign';\n\nimport {screenfull} from '../screenfull';\n\n/*\n * @class Reader\n * @aka cozy.Map\n * @inherits Evented\n *\n * The central class of the API — it is used to create a book on a page and manipulate it.\n *\n * @example\n *\n * ```js\n * // initialize the map on the \"map\" div with a given center and zoom\n * var map = L.map('map', {\n *  center: [51.505, -0.09],\n *  zoom: 13\n * });\n * ```\n *\n */\n\nvar _padding = 1.0;\nexport var Reader = Evented.extend({\n  options: {\n    regions: [\n      'header',\n      'toolbar.top',\n      'toolbar.left',\n      'main',\n      'toolbar.right',\n      'toolbar.bottom',\n      'footer'\n    ],\n    metadata: {},\n    flow: 'auto',\n    engine: 'epubjs',\n    fontSizeLarge: '140%',\n    fontSizeSmall: '90%',\n    fontSizeDefault: '100%',\n    trackResize: true,\n    text_size: 100,\n    mobileMediaQuery: '(min-device-width : 300px) and (max-device-width : 600px)',\n    forceScrolledDocHeight: 1200,\n    theme: 'default',\n    rootfilePath: '',\n    themes: []\n  },\n\n  initialize: function(id, options) {\n    var self = this\n\n    self._original_document_title = document.title;\n\n    if ( localStorage.getItem('cozy.options') ) {\n      options = assign(options, JSON.parse(localStorage.getItem('cozy.options')));\n    }\n    options = Util.setOptions(this, options);\n\n    this._checkFeatureCompatibility();\n\n    this.metadata = this.options.metadata; // initial seed\n\n    this._initContainer(id);\n    this._initLayout();\n\n    if ( this.options.themes && this.options.themes.length > 0 ) {\n        this.options.themes.forEach(function(theme) {\n            if ( theme.href ) { return; }\n            var klass = theme.klass;\n            var rules = {};\n            for(var rule in theme.rules) {\n                var new_rule = '.' + klass;\n                if ( rule == 'body' ) { new_rule = 'body' + new_rule; }\n                else { new_rule += ' ' + rule ; }\n                rules[new_rule] = theme.rules[rule];\n            }\n            theme.rules = rules;\n        });\n    }\n\n    this._updateTheme();\n\n    // hack for https://github.com/Leaflet/Leaflet/issues/1980\n    // this._onResize = Util.bind(this._onResize, this);\n\n    this._initEvents();\n\n    this.callInitHooks();\n\n    this._mode = this.options.mode;\n  },\n\n  start: function(target, cb) {\n    var self = this;\n\n    if ( typeof(target) == 'function' && cb === undefined ) {\n      cb = target;\n      target = undefined;\n    }\n\n    Util.loader.js(this.options.engine_href).then(function() {\n      self._start(target, cb);\n      self._loaded = true;\n    })\n  },\n\n  _start: function(target, cb) {\n    var self = this;\n    target = target || 0;\n\n    // self.open(function() {\n    //   self.draw(target, cb);\n    // });\n\n    self.open(target, cb);\n  },\n\n  reopen: function(options, target) {\n    /* NOP */\n  },\n\n  saveOptions: function(options) {\n    var saved_options = {};\n    assign(saved_options, options);\n    if ( saved_options.flow == 'auto' ) {\n      // do not save\n      delete saved_options.flow;\n    }\n    localStorage.setItem('cozy.options', JSON.stringify(saved_options));\n  },\n\n  _updateTheme: function() {\n    DomUtil.removeClass(this._container, 'cozy-theme-' + ( this._container.dataset.theme || 'default' ));\n    DomUtil.addClass(this._container, 'cozy-theme-' + this.options.theme);\n    this._container.dataset.theme = this.options.theme;\n  },\n\n  draw: function(target) {\n    // NOOP\n  },\n\n  next: function() {\n    // NOOP\n  },\n\n  prev: function() {\n    // NOOP\n  },\n\n  display: function(index) {\n    // NOOP\n  },\n\n  gotoPage: function(target) {\n    // NOOP\n  },\n\n  goBack: function() {\n    history.back();\n  },\n\n  goForward: function() {\n    history.forward();\n  },\n\n  requestFullscreen: function() {\n    if ( screenfull.enabled ) {\n      // this._preResize();\n      screenfull.toggle(this._container);\n    }\n  },\n\n  _preResize: function() {\n\n  },\n\n  _initContainer: function (id) {\n    var container = this._container = DomUtil.get(id);\n\n    if (!container) {\n      throw new Error('Reader container not found.');\n    } else if (container._cozy_id) {\n      throw new Error('Reader container is already initialized.');\n    }\n\n    DomEvent.on(container, 'scroll', this._onScroll, this);\n    this._containerId = Util.stamp(container);\n  },\n\n  _initLayout: function () {\n    var container = this._container;\n\n    this._fadeAnimated = this.options.fadeAnimation && Browser.any3d;\n\n    DomUtil.addClass(container, 'cozy-container' +\n      (Browser.touch ? ' cozy-touch' : '') +\n      (Browser.retina ? ' cozy-retina' : '') +\n      (Browser.ielt9 ? ' cozy-oldie' : '') +\n      (Browser.safari ? ' cozy-safari' : '') +\n      (this._fadeAnimated ? ' cozy-fade-anim' : '') +\n      ' cozy-engine-' + this.options.engine +\n      ' cozy-theme-' + this.options.theme);\n\n    var position = DomUtil.getStyle(container, 'position');\n\n    this._initPanes();\n\n    if ( ! Browser.columnCount ) {\n      this.options.flow = 'scrolled-doc';\n    }\n  },\n\n  _initPanes: function () {\n    var self = this;\n\n    var panes = this._panes = {};\n\n    var l = 'cozy-';\n    var container = this._container;\n\n    var prefix = 'cozy-module-';\n\n    DomUtil.addClass(container, 'cozy-container');\n    panes['top'] = DomUtil.create('div', prefix + 'top', container);\n    panes['main'] = DomUtil.create('div', prefix + 'main', container);\n    panes['bottom'] = DomUtil.create('div', prefix + 'bottom', container);\n\n    panes['left'] = DomUtil.create('div', prefix + 'left', panes['main']);\n    panes['book-cover'] = DomUtil.create('div', prefix + 'book-cover', panes['main']);\n    panes['right'] = DomUtil.create('div', prefix + 'right', panes['main']);\n    panes['book'] = DomUtil.create('div', prefix + 'book', panes['book-cover']);\n    panes['loader'] = DomUtil.create('div', prefix + 'book-loading', panes['book']);\n    panes['epub'] = DomUtil.create('div', prefix + 'book-epub', panes['book']);\n    this._initBookLoader();\n  },\n\n  _checkIfLoaded: function () {\n    if (!this._loaded) {\n      throw new Error('Set map center and zoom first.');\n    }\n  },\n\n  // DOM event handling\n\n  // @section Interaction events\n  _initEvents: function (remove) {\n    this._targets = {};\n    this._targets[Util.stamp(this._container)] = this;\n\n    this.tracking = function(reader) {\n      var _action = [];\n      var _last_location_start;\n      var _reader = reader;\n      return {\n        action: function(v) {\n          if ( v ) {\n            _action = [v];\n            this.event(v);\n            // _reader.fire('trackAction', { action: v })\n          } else {\n            return _action.pop();\n          }\n        },\n\n        event: function(action, data) {\n          if ( data == null ) { data = {}; }\n          data.action = action;\n          _reader.fire(\"trackAction\", data);\n        },\n\n        pageview: function(location) {\n          if ( location.start != _last_location_start ) {\n            _last_location_start = location.start;\n            // console.log(\"AHOY RELOCATED\", location, location.start, location.href, location.location, this.action());\n            _reader.fire('trackPageview', { cfi: location.start, href: location.href, action: this.action()})\n            return true;\n          }\n          return false;\n        }\n      }\n    }(this);\n\n    var onOff = remove ? DomEvent.off : DomEvent.on;\n\n    // @event click: MouseEvent\n    // Fired when the user clicks (or taps) the map.\n    // @event dblclick: MouseEvent\n    // Fired when the user double-clicks (or double-taps) the map.\n    // @event mousedown: MouseEvent\n    // Fired when the user pushes the mouse button on the map.\n    // @event mouseup: MouseEvent\n    // Fired when the user releases the mouse button on the map.\n    // @event mouseover: MouseEvent\n    // Fired when the mouse enters the map.\n    // @event mouseout: MouseEvent\n    // Fired when the mouse leaves the map.\n    // @event mousemove: MouseEvent\n    // Fired while the mouse moves over the map.\n    // @event contextmenu: MouseEvent\n    // Fired when the user pushes the right mouse button on the map, prevents\n    // default browser context menu from showing if there are listeners on\n    // this event. Also fired on mobile when the user holds a single touch\n    // for a second (also called long press).\n    // @event keypress: KeyboardEvent\n    // Fired when the user presses a key from the keyboard while the map is focused.\n    // onOff(this._container, 'click dblclick mousedown mouseup ' +\n    //   'mouseover mouseout mousemove contextmenu keypress', this._handleDOMEvent, this);\n\n    // if (this.options.trackResize) {\n    //   var self = this;\n    //   var fn = debounce(function(){ self.invalidateSize({}); }, 150);\n    //   onOff(window, 'resize', fn, this);\n    // }\n\n    if (Browser.any3d && this.options.transform3DLimit) {\n      (remove ? this.off : this.on).call(this, 'moveend', this._onMoveEnd);\n    }\n\n    var self = this;\n    if (screenfull.enabled) {\n      screenfull.on('change', function() {\n        // setTimeout(function() {\n        //   self.invalidateSize({});\n        // }, 100);\n        console.log('AHOY: Am I fullscreen?', screenfull.isFullscreen ? 'YES' : 'NO');\n      });\n    }\n\n    self.on(\"updateLocation\", function(location) {\n      var location_href = location.start;\n\n      if ( self._ignoreHistory ) {\n        self._ignoreHistory = false;\n        return;\n      }\n\n      if ( self.tracking.pageview(location) ) {\n        var tmp_href = window.location.href.split(\"#\");\n        tmp_href[1] = location.start.substr(8, location.start.length - 8 - 1);\n        history.pushState({ cfi: location.start }, '', tmp_href.join('#'));\n\n        if ( location.percentage ) {\n          var p = Math.ceil(location.percentage * 100);\n          document.title = `${self._original_document_title} - ${p}%`;\n        }        \n      }\n    })\n\n    window.addEventListener('popstate', function(event) {\n      if ( event.isTrusted && event.state !== null ) {\n        self._ignoreHistory = true;\n        self.gotoPage(event.state.cfi);\n      }\n    })\n\n    document.addEventListener('keydown', function(event) {\n      var keyName = event.key;\n      var target = event.target;\n\n      // check if the activeElement is \".special-panel\"\n      var check = document.activeElement;\n      while ( check.localName != 'body' ) {\n        if ( check.classList.contains('special-panel') ) {\n          return;\n        }\n        check = check.parentElement;\n      }\n\n      var IGNORE_TARGETS = [ 'input', 'target' ];\n      if ( IGNORE_TARGETS.indexOf(target.localName) >= 0 ) {\n        return;\n      }\n\n      self.fire('keyDown', { keyName: keyName, shiftKey: event.shiftKey });\n    });\n\n    self.on('keyDown', function(data) {\n      switch(data.keyName) {\n        case 'ArrowRight':\n        case 'PageDown':\n          self.next();\n          break;\n        case 'ArrowLeft':\n        case 'PageUp':\n          self.prev();\n          break;\n        case 'Home':\n          self._scroll('HOME');\n          break;\n        case 'End':\n          self._scroll('END')\n          break;\n      }\n    });\n  },\n\n  // _onResize: function() {\n  //   if ( ! this._resizeRequest ) {\n  //     this._resizeRequest = Util.requestAnimFrame(function() {\n  //       this.invalidateSize({})\n  //     }, this);\n  //   }\n  // },\n\n  _onScroll: function () {\n    this._container.scrollTop  = 0;\n    this._container.scrollLeft = 0;\n  },\n\n  _handleDOMEvent: function (e) {\n    if (!this._loaded || DomEvent.skipped(e)) { return; }\n\n    var type = e.type === 'keypress' && e.keyCode === 13 ? 'click' : e.type;\n\n    if (type === 'mousedown') {\n      // prevents outline when clicking on keyboard-focusable element\n      DomUtil.preventOutline(e.target || e.srcElement);\n    }\n\n    this._fireDOMEvent(e, type);\n  },\n\n  _fireDOMEvent: function (e, type, targets) {\n\n    if (e.type === 'click') {\n      // Fire a synthetic 'preclick' event which propagates up (mainly for closing popups).\n      // @event preclick: MouseEvent\n      // Fired before mouse click on the map (sometimes useful when you\n      // want something to happen on click before any existing click\n      // handlers start running).\n      var synth = Util.extend({}, e);\n      synth.type = 'preclick';\n      this._fireDOMEvent(synth, synth.type, targets);\n    }\n\n    if (e._stopped) { return; }\n\n    // Find the layer the event is propagating from and its parents.\n    targets = (targets || []).concat(this._findEventTargets(e, type));\n\n    if (!targets.length) { return; }\n\n    var target = targets[0];\n    if (type === 'contextmenu' && target.listens(type, true)) {\n      DomEvent.preventDefault(e);\n    }\n\n    var data = {\n      originalEvent: e\n    };\n\n    if (e.type !== 'keypress') {\n      var isMarker = (target.options && 'icon' in target.options);\n      data.containerPoint = isMarker ?\n          this.latLngToContainerPoint(target.getLatLng()) : this.mouseEventToContainerPoint(e);\n      data.layerPoint = this.containerPointToLayerPoint(data.containerPoint);\n      data.latlng = isMarker ? target.getLatLng() : this.layerPointToLatLng(data.layerPoint);\n    }\n\n    for (var i = 0; i < targets.length; i++) {\n      targets[i].fire(type, data, true);\n      if (data.originalEvent._stopped ||\n        (targets[i].options.nonBubblingEvents && Util.indexOf(targets[i].options.nonBubblingEvents, type) !== -1)) { return; }\n    }\n  },\n\n  getFixedBookPanelSize: function() {\n    // have to make the book\n    var style = window.getComputedStyle(this._panes['book']);\n    var h = this._panes['book'].clientHeight - parseFloat(style.paddingTop) - parseFloat(style.paddingBottom);\n    var w = this._panes['book'].clientWidth - parseFloat(style.paddingRight) - parseFloat(style.paddingLeft);\n    return { height: Math.floor(h * 1.00), width: Math.floor(w * 1.00) };\n  },\n\n  invalidateSize: function(options) {\n    // TODO: IS THIS EVER USED?\n    var self = this;\n\n    if ( ! self._drawn ) { return; }\n\n    Util.cancelAnimFrame(this._resizeRequest);\n\n    if (! this._loaded) { return this; }\n\n    this.fire('resized');\n  },\n\n  _resizeBookPane: function() {\n\n  },\n\n  _setupHooks: function() {\n\n  },\n\n  _checkFeatureCompatibility: function() {\n    if ( ! DomUtil.isPropertySupported('columnCount') || this._checkMobileDevice() ) {\n      // force\n      this.options.flow = 'scrolled-doc';\n    }\n    if ( this._checkMobileDevice() ) {\n      // this.options.fontSizeLarge = '160%';\n      // this.options.fontSizeSmall ='100%';\n      // this.options.fontSizeDefault = '120%';\n      this.options.text_size = 120;\n    }\n  },\n\n  _checkMobileDevice: function() {\n    if ( this._isMobile === undefined ) {\n      this._isMobile = false;\n      if ( this.options.mobileMediaQuery ) {\n        this._isMobile = window.matchMedia(this.options.mobileMediaQuery).matches;\n      }\n    }\n    return this._isMobile;\n  },\n\n  _enableBookLoader: function(delay=0) {\n    var self = this;\n    self._clearBookLoaderTimeout();\n    if ( delay < 0 ) {\n      delay = 0;\n      self._force_progress = true;\n    }\n    self._loader_timeout = setTimeout(function() {\n      self._panes['loader'].style.display = 'block';\n    }, delay);\n  },\n\n  _disableBookLoader: function(force=false) {\n    var self = this;\n    self._clearBookLoaderTimeout();\n    if ( ! self._force_progress || force ) {\n      self._panes['loader'].style.display = 'none';\n      self._force_progress = false;\n      self._panes['loader-status'].innerHTML = '';\n    }\n  },\n\n  _clearBookLoaderTimeout: function() {\n    var self = this;\n    if ( self._loader_timeout ) {\n      clearTimeout(self._loader_timeout);\n      self._loader_timeout = null;\n    }\n  },\n\n  _initBookLoader: function() {\n    // is this not awesome?\n    var template = this.options.loader_template || this.loaderTemplate();\n\n    var body = new DOMParser().parseFromString(template, \"text/html\").body;\n    while ( body.children.length ) {\n      this._panes['loader'].appendChild(body.children[0]);\n    }\n    this._panes['loader-status'] = DomUtil.create('div', 'cozy-module-book-loading-status', this._panes['loader']);\n  },\n\n  loaderTemplate: function() {\n    return `<div class=\"cozy-loader-spinner\">\n    <div class=\"spinner-backdrop spinner-backdrop--1\"></div>\n    <div class=\"spinner-backdrop spinner-backdrop--2\"></div>\n    <div class=\"spinner-backdrop spinner-backdrop--3\"></div>\n    <div class=\"spinner-backdrop spinner-backdrop--4\"></div>\n    <div class=\"spinner-quarter spinner-quarter--1\"></div>\n    <div class=\"spinner-quarter spinner-quarter--2\"></div>\n    <div class=\"spinner-quarter spinner-quarter--3\"></div>\n    <div class=\"spinner-quarter spinner-quarter--4\"></div>\n  </div>`;\n  },\n\n  EOT: true\n});\n\nexport function createReader(id, options) {\n  return new Reader(id, options);\n}\n","import {Class} from '../core/Class';\nimport {Reader} from '../reader/Reader';\nimport * as Util from '../core/Util';\nimport * as DomUtil from '../dom/DomUtil';\n\n/*\n * @class Control\n * @aka L.Control\n * @inherits Class\n *\n * L.Control is a base class for implementing reader controls. Handles regioning.\n * All other controls extend from this class.\n */\n\nexport var Control = Class.extend({\n    // @section\n    // @aka Control options\n    options: {\n        // @option region: String = 'topright'\n        // The region of the control (one of the reader corners). Possible values are `'topleft'`,\n        // `'topright'`, `'bottomleft'` or `'bottomright'`\n    },\n\n    initialize: function (options) {\n        Util.setOptions(this, options);\n        if ( options.container ) {\n            this._container = options.container;\n            this._locked = true;\n        }\n        this._id = (new Date()).getTime() + '-' + parseInt(Math.random((new Date()).getTime()) * 1000, 10);\n    },\n\n    /* @section\n     * Classes extending L.Control will inherit the following methods:\n     *\n     * @method getRegion: string\n     * Returns the region of the control.\n     */\n    getRegion: function () {\n        return this.options.region;\n    },\n\n    // @method setRegion(region: string): this\n    // Sets the region of the control.\n    setRegion: function (region) {\n        var reader = this._reader;\n\n        if (reader) {\n            reader.removeControl(this);\n        }\n\n        this.options.region = region;\n\n        if (reader) {\n            reader.addControl(this);\n        }\n\n        return this;\n    },\n\n    // @method getContainer: HTMLElement\n    // Returns the HTMLElement that contains the control.\n    getContainer: function () {\n        return this._container;\n    },\n\n    // @method addTo(reader: Map): this\n    // Adds the control to the given reader.\n    addTo: function (reader) {\n        this.remove();\n        this._reader = reader;\n\n        var container = this._container = this.onAdd(reader);\n\n        DomUtil.addClass(container, 'cozy-control');\n\n        if ( ! this._locked ) {\n            var region = this.getRegion();\n            var area = reader.getControlRegion(region);\n            area.appendChild(container);\n        }\n\n        return this;\n    },\n\n    // @method remove: this\n    // Removes the control from the reader it is currently active on.\n    remove: function () {\n        if (!this._reader) {\n            return this;\n        }\n\n        if (! this._container) {\n            return this;\n        }\n\n        if ( ! this._locked ) {\n            DomUtil.remove(this._container);\n        }\n\n        if (this.onRemove) {\n            this.onRemove(this._reader);\n        }\n\n        this._reader = null;\n\n        return this;\n    },\n\n    _refocusOnMap: function (e) {\n        // if reader exists and event is not a keyboard event\n        if (this._reader && e && e.screenX > 0 && e.screenY > 0) {\n            this._reader.getContainer().focus();\n        }\n    },\n\n    _className: function(widget) {\n        var className = [ 'cozy-control' ];\n        if ( this.options.direction ) {\n            className.push('cozy-control-' + this.options.direction);\n        }\n        if ( widget ) {\n            className.push('cozy-control-' + widget);\n        }\n        return className.join(' ');\n    }\n});\n\nexport var control = function (options) {\n    return new Control(options);\n};\n\n/* @section Extension methods\n * @uninheritable\n *\n * Every control should extend from `L.Control` and (re-)implement the following methods.\n *\n * @method onAdd(reader: Map): HTMLElement\n * Should return the container DOM element for the control and add listeners on relevant reader events. Called on [`control.addTo(reader)`](#control-addTo).\n *\n * @method onRemove(reader: Map)\n * Optional method. Should contain all clean up code that removes the listeners previously added in [`onAdd`](#control-onadd). Called on [`control.remove()`](#control-remove).\n */\n\n/* @namespace Map\n * @section Methods for Layers and Controls\n */\nReader.include({\n    // @method addControl(control: Control): this\n    // Adds the given control to the reader\n    addControl: function (control) {\n        control.addTo(this);\n        return this;\n    },\n\n    // @method removeControl(control: Control): this\n    // Removes the given control from the reader\n    removeControl: function (control) {\n        control.remove();\n        return this;\n    },\n\n    getControlContainer: function() {\n        var l = 'cozy-';\n        if ( ! this._controlContainer ) {\n            this._controlContainer =\n                DomUtil.create('div', l + 'control-container', this._container);\n        }\n        return this._controlContainer;\n    },\n\n    getControlRegion: function (target) {\n\n        if ( ! this._panes[target] ) {\n            // target is dot-delimited string\n            // first dot is the panel\n            var parts = target.split('.');\n            var tmp = [];\n            var parent = this._container;\n            var x = 0;\n            while ( parts.length ) {\n                var slug = parts.shift();\n                tmp.push(slug);\n                var panel = tmp.join(\".\");\n                var className = 'cozy-panel-' + slug;\n                if ( ! this._panes[panel] ) {\n                    this._panes[panel] = DomUtil.create('div', className, parent);\n                }\n                parent = this._panes[panel];\n                x += 1;\n                if ( x > 100 ) { break; }\n            }\n        }\n        return this._panes[target];\n    },\n\n    getControlRegion_1: function (target) {\n\n        var tmp = target.split('.');\n        var region = tmp.shift();\n        var slot = tmp.pop() || '-slot';\n\n        var container = this._panes[region];\n        if ( ! this._panes[target] ) {\n            var className = 'cozy-' + region + '--item cozy-slot-' + slot\n            if ( ! this._panes[region + '.' + slot] ) {\n                var div = DomUtil.create('div', className);\n                if ( slot == 'left' || slot == 'bottom' ) {\n                    var childElement = this._panes[region].firstChild;\n                    this._panes[region].insertBefore(div, childElement);\n                } else {\n                    this._panes[region].appendChild(div);\n                }\n                this._panes[region + '.' + slot] = div;\n            }\n            className = this._classify(tmp);\n            this._panes[target] = DomUtil.create('div', className, this._panes[region + '.' + slot]);\n        }\n\n        return this._panes[target];\n    },\n\n    _classify: function(tmp) {\n        var l = 'cozy-';\n        var className = [];\n        for(var i in tmp) {\n            className.push(l + tmp[i]);\n        }\n        className = className.join(' ');\n        return className;\n    },\n\n    _clearControlRegion: function () {\n        for (var i in this._controlRegions) {\n            DomUtil.remove(this._controlRegions[i]);\n        }\n        DomUtil.remove(this._controlContainer);\n        delete this._controlRegions;\n        delete this._controlContainer;\n    }\n});\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nvar PageControl = Control.extend({\n  onAdd: function(reader) {\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n      container = DomUtil.create('div', className),\n\n      this._control  = this._createButton(this._fill(options.html || options.label), this._fill(options.label),\n              className, container);\n    }\n    this._bindEvents();\n\n    return container;\n  },\n\n  _createButton: function (html, title, className, container) {\n    var link = DomUtil.create('a', className, container);\n    link.innerHTML = html;\n    link.href = '#';\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    return link;\n  },\n\n  _bindEvents: function() {\n    var self = this;\n    DomEvent.disableClickPropagation(this._control);\n    DomEvent.on(this._control, 'click', DomEvent.stop);\n    DomEvent.on(this._control, 'click', this._action, this);\n\n    this._reader.on('reopen', function(data) {\n      // update the button text / titles\n      var html = self.options.html || self.options.label;\n      self._control.innerHTML = self._fill(html);\n      self._control.setAttribute('title', self._fill(self.options.label));\n      self._control.setAttribute('aria-label', self._fill(self.options.label));\n    });\n\n  },\n\n  _unit: function() {\n    return ( this._reader.options.flow == 'scrolled-doc' ) ? 'Section' : 'Page';\n  },\n\n  _fill: function(s) {\n    var unit = this._unit();\n    return s.replace(/\\$\\{unit\\}/g, unit);\n  },\n\n  _label: function() {\n    return this.options.label + \" \" + ( this._reader.options.flow == 'scrolled-doc' ) ? 'Section' : 'Page';\n  },\n\n  EOT: true\n});\n\nexport var PagePrevious = PageControl.extend({\n  options: {\n    region: 'edge.left',\n    direction: 'previous',\n    label: 'Previous ${unit}',\n    html: '<i class=\"icon-chevron-left oi\" data-glyph=\"chevron-left\" title=\"Previous ${unit}\" aria-hidden=\"true\"></i>'\n  },\n\n  _action: function(e) {\n    this._reader.prev();\n  }\n});\n\nexport var PageNext = PageControl.extend({\n  options: {\n    region: 'edge.right',\n    direction: 'next',\n    label: 'Next ${unit}',\n    html: '<i class=\"icon-chevron-right oi\" data-glyph=\"chevron-right\" title=\"Next ${unit}\" aria-hidden=\"true\"></i>'\n  },\n\n  _action: function(e) {\n    this._reader.next();\n  }\n});\n\nexport var PageFirst = PageControl.extend({\n  options: {\n    direction: 'first',\n    label: 'First ${unit}'\n  },\n  _action: function(e) {\n      this._reader.first();\n  }\n});\n\nexport var PageLast = PageControl.extend({\n  options: {\n    direction: 'last',\n    label: 'Last ${unit}'\n  },\n  _action: function(e) {\n      this._reader.last();\n  }\n});\n\nexport var pageNext = function(options) {\n  return new PageNext(options);\n}\n\nexport var pagePrevious = function(options) {\n  return new PagePrevious(options);\n}\n\nexport var pageFirst = function(options) {\n  return new PageFirst(options);\n}\n\nexport var pageLast = function(options) {\n  return new PageLast(options);\n}\n","import {Class} from '../core/Class';\nimport {Reader} from '../reader/Reader';\nimport * as Util from '../core/Util';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nimport assign from 'lodash/assign';\n\nvar activeModal;\nvar dismissModalListener = false;\n\n// from https://github.com/ghosh/micromodal/blob/master/src/index.js\nconst FOCUSABLE_ELEMENTS = [\n    'a[href]',\n    'area[href]',\n    'input:not([disabled]):not([type=\"hidden\"])',\n    'select:not([disabled])',\n    'textarea:not([disabled])',\n    'button:not([disabled])',\n    'iframe',\n    'object',\n    'embed',\n    '[contenteditable]',\n    '[tabindex]:not([tabindex^=\"-\"])'\n  ];\n\nconst ACTIONABLE_ELEMENTS = [\n    'a[href]',\n    'area[href]',\n    'input[type=\"submit\"]:not([disabled])',\n    'button:not([disabled])'\n  ];\n\nexport var Modal = Class.extend({\n  options: {\n    // @option region: String = 'topright'\n    // The region of the control (one of the reader edges). Possible values are `'left' ad 'right'`\n    region: 'left',\n    fraction: 0,\n    width: null,\n    className: {},\n    actions: null,\n    callbacks: { onShow: function() {}, onClose: function() {} },\n    handlers: {}\n  },\n\n  initialize: function (options) {\n    options = Util.setOptions(this, options);\n    this._id = (new Date()).getTime() + '-' + parseInt(Math.random((new Date()).getTime()) * 1000, 10);\n    this._initializedEvents = false;\n    this.callbacks = assign({}, this.options.callbacks);\n    this.actions = this.options.actions ? assign({}, this.options.actions) : null;\n    this.handlers = assign({}, this.options.handlers);\n    if ( typeof(this.options.className) == 'string' ) {\n      this.options.className = { container: this.options.className };\n    }\n  },\n\n  addTo: function(reader) {\n    var self = this;\n    this._reader = reader;\n    var template = this.options.template;\n\n    var panelHTML = `<div class=\"cozy-modal modal-slide ${this.options.region || 'left'}\" id=\"modal-${this._id}\" aria-labelledby=\"modal-${this._id}-title\" role=\"dialog\" aria-describedby=\"modal-${this._id}-content\" aria-hidden=\"true\">\n      <div class=\"modal__overlay\" tabindex=\"-1\" data-modal-close>\n        <div class=\"modal__container ${this.options.className.container ? this.options.className.container : ''}\" role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"modal-${this._id}-title\" aria-describedby=\"modal-${this._id}-content\" id=\"modal-${this._id}-container\">\n          <div role=\"document\">\n            <header class=\"modal__header\">\n              <h3 class=\"modal__title\" id=\"modal-${this._id}-title\">${this.options.title}</h3>\n              <button class=\"modal__close\" aria-label=\"Close modal\" aria-controls=\"modal-${this._id}-container\" data-modal-close></button>\n            </header>\n            <main class=\"modal__content ${this.options.className.main ? this.options.className.main : ''}\" id=\"modal-${this._id}-content\">\n              ${template}\n            </main>`;\n\n    if ( this.options.actions ) {\n      panelHTML += '<footer class=\"modal__footer\">'\n      for(var i in this.options.actions) {\n        var action = this.options.actions[i];\n        var button_cls = action.className || 'button--default';\n        panelHTML += `<button id=\"action-${this._id}-${i}\" class=\"button button--lg ${button_cls}\">${action.label}</button>`;\n      }\n      panelHTML += '</footer>';\n    }\n\n    panelHTML += '</div></div></div></div>';\n\n    var body = new DOMParser().parseFromString(panelHTML, \"text/html\").body;\n\n    this.modal = reader._container.appendChild(body.children[0]);\n    this._container = this.modal; // compatibility\n\n    this.container = this.modal.querySelector('.modal__container');\n    this._bindEvents();\n    return this;\n  },\n\n  _bindEvents: function() {\n    var self = this;\n    this.onClick = this.onClick.bind(this);\n    this.onKeydown = this.onKeydown.bind(this);\n    this.onModalTransition = this.onModalTransition.bind(this);\n\n    this.modal.addEventListener('transitionend', function() {\n    }.bind(this));\n\n    // bind any actions\n    if ( this.actions ) {\n      for(var i in this.actions) {\n        let action = this.actions[i];\n        let button_id = '#action-' + this._id + '-' + i;\n        let button = this.modal.querySelector(button_id);\n        if ( button ) {\n          DomEvent.on(button, 'click', function(event) {\n            event.preventDefault();\n            action.callback(event);\n            if ( action.close ) {\n              self.closeModal();\n            }\n          })\n        }\n      }\n    }\n  },\n\n  deactivate: function() {\n    this.closeModal();\n  },\n\n  closeModal: function() {\n    var self = this;\n    this.modal.setAttribute('aria-hidden', 'true');\n    this.removeEventListeners();\n    if ( this.activeElement ) {\n      this.activeElement.focus();\n    }\n    this.callbacks.onClose(this.modal);\n  },\n\n  showModal: function() {\n    this.activeElement = document.activeElement\n    this._resize();\n    this.modal.setAttribute('aria-hidden', 'false')\n    this.setFocusToFirstNode()\n    this.addEventListeners()\n    this.callbacks.onShow(this.modal)\n  },\n\n  activate: function() {\n    return this.showModal();\n    var self = this;\n    activeModal = this;\n    DomUtil.addClass(self._reader._container, 'st-modal-activating');\n    this._resize();\n    DomUtil.addClass(this._reader._container, 'st-modal-open');\n    setTimeout(function() {\n      DomUtil.addClass(self._container, 'active');\n      DomUtil.removeClass(self._reader._container, 'st-modal-activating');\n      self._container.setAttribute('aria-hidden', 'false');\n      self.setFocusToFirstNode();\n    }, 25);\n  },\n\n  addEventListeners: function () {\n    // --- do we need touch listeners?\n    // this.modal.addEventListener('touchstart', this.onClick)\n    // this.modal.addEventListener('touchend', this.onClick)\n    this.modal.addEventListener('click', this.onClick)\n    document.addEventListener('keydown', this.onKeydown)\n    'webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend'.split(' ').forEach(function(event) {\n      this.modal.addEventListener(event, this.onModalTransition);\n    }.bind(this))\n  },\n\n  removeEventListeners: function () {\n    this.modal.removeEventListener('touchstart', this.onClick)\n    this.modal.removeEventListener('click', this.onClick)\n    'webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend'.split(' ').forEach(function(event) {\n      this.modal.removeEventListener(event, this.onModalTransition);\n    }.bind(this))\n    document.removeEventListener('keydown', this.onKeydown)\n  },\n\n  _resize: function() {\n    var container = this._reader._container;\n    this.container.style.height = container.offsetHeight + 'px';\n    console.log(\"AHOY MODAL\", this.container.style.height);\n    if ( ! this.options.className.container  ) {\n      this.container.style.width = this.options.width || parseInt(container.offsetWidth * this.options.fraction) + 'px';\n    }\n\n    var header = this.container.querySelector('header');\n    var footer = this.container.querySelector('footer');\n    var main = this.container.querySelector('main');\n    var height = this.container.clientHeight - header.clientHeight;\n    if ( footer ) {\n      height -= footer.clientHeight;\n    }\n    main.style.height = height + 'px';\n  },\n\n  getFocusableNodes: function() {\n    const nodes = this.modal.querySelectorAll(FOCUSABLE_ELEMENTS);\n    return Object.keys(nodes).map((key) => nodes[key]);\n  },\n\n  setFocusToFirstNode: function() {\n    var focusableNodes = this.getFocusableNodes();\n    if ( focusableNodes.length ) {\n      focusableNodes[0].focus();\n    } else {\n      activeModal._container.focus();\n    }\n  },\n\n  getActionableNodes: function() {\n    const nodes = this.modal.querySelectorAll(ACTIONABLE_ELEMENTS);\n    return Object.keys(nodes).map((key) => nodes[key]);\n  },\n\n  onKeydown: function(event) {\n    if ( event.keyCode == 27 ) { this.closeModal(); }\n    if ( event.keyCode == 9 ) {\n      this.maintainFocus(event);\n    }\n  },\n\n  onClick: function(event) {\n\n    var closeAfterAction = false;\n    var target = event.target;\n\n    // As far as I can tell, the code below isn't catching direct clicks on\n    // items with class='data-modal-close' as they're not ACTIONABLE_ELEMENTS.\n    // Adding them to ACTIONABLE_ELEMENTS causes undesirable behavior where\n    // their child items also close the modal thanks to the loop below.\n    // Children of .modal__overlay include the modal header, border area and\n    // padding. We don't want clicks on these closing the modal.\n    // Just close the modal now for direct clicks on a '.data-modal-close'.\n    if (target.hasAttribute('data-modal-close')) {\n      this.fire('closed');\n      this.closeModal();\n      return;\n    }\n\n    // if the target isn't an actionable type, walk the DOM until\n    // one is found\n    var actionableNodes = this.getActionableNodes();\n    while ( actionableNodes.indexOf(target) < 0 && target != this.modal ) {\n      target = target.parentElement;\n    }\n\n    // no target found, punt\n    if ( actionableNodes.indexOf(target) < 0 ) {\n      return;\n    }\n\n    if (this.handlers.click) {\n      var did_match = false;\n      for(var selector in this.handlers.click) {\n        if ( target.matches(selector) ) {\n          closeAfterAction = this.handlers.click[selector](this, target);\n          break;\n        }\n      }\n    }\n\n    if (closeAfterAction || target.hasAttribute('data-modal-close')) this.closeModal();\n\n    event.preventDefault();\n  },\n\n  onModalTransition: function(event) {\n    if ( this.modal.getAttribute('aria-hidden') == 'true' ) {\n      this._reader.fire('modal-closed');\n    } else {\n      this._reader.fire('modal-opened');\n    }\n  },\n\n  on: function(event, selector, handler) {\n    if (! this.handlers[event] ) {\n      this.handlers[event] = {};\n    }\n    if (typeof(selector) == 'function') {\n      handler = selector;\n      selector = '*';\n    }\n    this.handlers[event][selector] = handler;\n  },\n\n  fire: function(event) {\n    if ( this.handlers[event] && this.handlers[event]['*'] ) {\n      this.handlers[event]['*'](this);\n    }\n  },\n\n  maintainFocus: function(event) {\n    var focusableNodes = this.getFocusableNodes();\n    var focusedItemIndex = focusableNodes.indexOf(document.activeElement);\n    if (event.shiftKey && focusedItemIndex === 0) {\n      focusableNodes[focusableNodes.length - 1].focus()\n      event.preventDefault()\n    }\n\n    if (!event.shiftKey && focusedItemIndex === focusableNodes.length - 1) {\n      focusableNodes[0].focus()\n      event.preventDefault()\n    }\n  },\n\n  EOT: true\n});\n\nReader.include({\n  modal: function (options) {\n    var modal = new Modal(options);\n    return modal.addTo(this);\n    // return this;\n  },\n\n  EOT: true\n});\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport {Modal} from './Modal';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Contents = Control.extend({\n\n  defaultTemplate: `<button class=\"button--sm\" data-toggle=\"open\" aria-label=\"Table of Contents\"><i class=\"icon-menu oi\" data-glyph=\"menu\" title=\"Table of Contents\" aria-hidden=\"true\"></i></button>`,\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    this._control.setAttribute('id', 'action-' + this._id);\n    container.style.position = 'relative';\n\n    this._reader.on('updateContents', function(data) {\n\n      DomEvent.on(this._control, 'click', function(event) {\n        event.preventDefault();\n        self._reader.tracking.action('contents/open');\n        self._modal.activate();\n      }, this)\n\n      this._modal = this._reader.modal({\n        template: '<ul></ul>',\n        title: 'Contents',\n        region: 'left',\n        className: 'cozy-modal-contents'\n      });\n\n      this._modal.on('click', 'a[href]', function(modal, target) {\n        target = target.getAttribute('data-href');\n        this._reader.tracking.action('contents/go');\n        this._reader.gotoPage(target);\n        return true;\n      }.bind(this))\n\n      this._modal.on('closed', function() {\n        self._reader.tracking.action('contents/close');\n      })\n\n      this._setupSkipLink();\n\n      var parent = self._modal._container.querySelector('ul');\n      // var s = data.toc.filter(function(value) { return value.parent == null }).map(function(value) { return [ value, 0, parent ] });\n      // while ( s.length ) {\n      //   var tuple = s.shift();\n      //   var chapter = tuple[0];\n      //   var tabindex = tuple[1];\n      //   var parent = tuple[2];\n\n      //   var option = self._createOption(chapter, tabindex, parent);\n      //   data.toc.filter(function(value) { return value.parent == chapter.id }).reverse().forEach(function(chapter_) {\n      //     s.unshift([chapter_, tabindex + 1, option]);\n      //   });\n      // }\n      var _process = function(items, tabindex, parent) {\n        items.forEach(function(item) {\n          var option = self._createOption(item, tabindex, parent);\n          if ( item.subitems.length ) {\n            _process(item.subitems, tabindex + 1, option);\n          }\n        })\n      }\n      _process(data.toc, 0, parent);\n    }.bind(this))\n\n    return container;\n  },\n\n  _createOption(chapter, tabindex, parent) {\n\n    function pad(value, length) {\n        return (value.toString().length < length) ? pad(\"-\"+value, length):value;\n    }\n    var option = DomUtil.create('li');\n    if ( chapter.href ) {\n      var anchor = DomUtil.create('a', null, option);\n      anchor.textContent = chapter.label;\n      // var tab = pad('', tabindex); tab = tab.length ? tab + ' ' : '';\n      // option.textContent = tab + chapter.label;\n      anchor.setAttribute('href', chapter.href);\n      anchor.setAttribute('data-href', chapter.href);\n    } else {\n      var span = DomUtil.create('span', null, option);\n      span.textContent = chapter.label;\n    }\n\n    if ( parent.tagName == 'LI' ) {\n      // need to nest\n      var tmp = parent.querySelector('ul');\n      if ( ! tmp ) {\n        tmp = DomUtil.create('ul', null, parent);\n      }\n      parent = tmp;\n    }\n\n    parent.appendChild(option);\n    return option;\n  },\n\n  _setupSkipLink: function() {\n    if ( ! this.options.skipLink ) { return; }\n      \n    var target = document.querySelector(this.options.skipLink);\n    if ( ! target ) { return; }\n\n    var link = document.createElement('a');\n    link.textContent = 'Skip to contents';\n    link.setAttribute('href', '#action-' + this._id);\n\n    var ul = target.querySelector('ul');\n    if ( ul ) {\n      // add to list\n      target = document.createElement('li');\n      ul.appendChild(target);\n    }\n    target.appendChild(link);\n    link.addEventListener('click', function(event) {\n      event.preventDefault();\n      event.stopPropagation();\n      this._control.click();\n    }.bind(this))\n\n  },\n\n  EOT: true\n});\n\nexport var contents = function(options) {\n  return new Contents(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\n// Title + Chapter\n\nexport var Title = Control.extend({\n  onAdd: function(reader) {\n    var self = this;\n    var className = this._className(),\n        container = DomUtil.create('div', className),\n        options = this.options;\n\n    // var template = '<h1><span class=\"cozy-title\">Contents: </span><select size=\"1\" name=\"contents\"></select></label>';\n    // var control = new DOMParser().parseFromString(template, \"text/html\").body.firstChild;\n\n    var h1 = DomUtil.create('h1', 'cozy-h1', container);\n    DomUtil.setOpacity(h1, 0);\n    this._title = DomUtil.create('span', 'cozy-title', h1);\n    this._divider = DomUtil.create('span', 'cozy-divider', h1);\n    this._divider.textContent = \" · \";\n    this._section = DomUtil.create('span', 'cozy-section', h1);\n\n    // --- TODO: disable until we can work out how to \n    // --- more reliably match the current section to the contents\n    // this._reader.on('updateSection', function(data) {\n    //   if ( data && data.label ) {\n    //     self._section.textContent = data.label;\n    //     DomUtil.setOpacity(self._section, 1.0);\n    //     DomUtil.setOpacity(self._divider, 1.0);\n    //   } else {\n    //     DomUtil.setOpacity(self._section, 0);\n    //     DomUtil.setOpacity(self._divider, 0);\n    //   }\n    // })\n\n    this._reader.on('updateTitle', function(data) {\n      if ( data ) {\n        self._title.textContent = data.title || data.bookTitle;\n        DomUtil.setOpacity(self._section, 0);\n        DomUtil.setOpacity(self._divider, 0);\n        DomUtil.setOpacity(h1, 1);\n      }\n    })\n\n    return container;\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('a', className, container);\n    link.innerHTML = html;\n    link.href = '#';\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n    // DomEvent.on(link, 'click', this._refocusOnMap, this);\n\n    return link;\n  },\n\n  EOT: true\n});\n\nexport var title = function(options) {\n  return new Title(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\n// Title + Chapter\n\nexport var PublicationMetadata = Control.extend({\n  onAdd: function(reader) {\n    var self = this;\n    var className = this._className(),\n        container = DomUtil.create('div', className),\n        options = this.options;\n\n    // var template = '<h1><span class=\"cozy-title\">Contents: </span><select size=\"1\" name=\"contents\"></select></label>';\n    // var control = new DOMParser().parseFromString(template, \"text/html\").body.firstChild;\n\n    this._publisher = DomUtil.create('div', 'cozy-publisher', container);\n    this._rights = DomUtil.create('div', 'cozy-rights', container);\n\n    this._reader.on('updateTitle', function(data) {\n      if ( data ) {\n        self._publisher.textContent = data.publisher;\n        self._rights.textContent = data.rights;\n      }\n    })\n\n    return container;\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('a', className, container);\n    link.innerHTML = html;\n    link.href = '#';\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n    // DomEvent.on(link, 'click', this._refocusOnMap, this);\n\n    return link;\n  },\n\n  EOT: true\n});\n\nexport var publicationMetadata = function(options) {\n  return new PublicationMetadata(options);\n}\n","import {Class} from '../core/Class';\nimport {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\nimport * as Util from '../core/Util';\n\nimport assign from 'lodash/assign';\nimport keys from 'lodash/keys';\n\nexport var Preferences = Control.extend({\n  options: {\n    label: 'Preferences',\n    hasThemes: false,\n    html: '<i class=\"icon-cog oi\" data-glyph=\"cog\" title=\"Preferences and Settings\" aria-hidden=\"true\"></i>'\n  },\n\n  onAdd: function(reader) {\n    var self = this;\n    var className = this._className('preferences'),\n        container = DomUtil.create('div', className),\n        options = this.options;\n\n    this._activated = false;\n    this._control = this._createButton(options.html || options.label, options.label,\n            className, container, this._action)\n\n    // self.initializeForm();\n    this._modal = this._reader.modal({\n      // template: '<form></form>',\n      title: 'Preferences',\n      className: 'cozy-modal-preferences',\n      actions: [\n        {\n          label: 'Save Changes',\n          callback: function(event) {\n            self.updatePreferences(event);\n          }\n        }\n      ],\n      region: 'right'\n    });\n\n\n    return container;\n  },\n\n  _action: function() {\n    var self = this;\n    self.initializeForm();\n    self._modal.activate();\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('button', className, container);\n    link.innerHTML = html;\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n\n    return link;\n  },\n\n  _createPanel: function() {\n    var self = this;\n    if ( this._modal._container.querySelector('form') ) { return; }\n\n    var template = '';\n\n    var possible_fieldsets = [];\n    if ( this._reader.metadata.layout == 'pre-paginated' ) {\n      // different panel\n      possible_fieldsets.push('Scale');\n    } else {\n      possible_fieldsets.push('TextSize');\n    }\n    possible_fieldsets.push('Display');\n\n    if ( this._reader.rootfiles && this._reader.rootfiles.length > 1 ) {\n      // this.options.hasPackagePaths = true;\n      possible_fieldsets.push('Rendition');\n    }\n\n    if ( this._reader.options.themes && this._reader.options.themes.length > 0 ) {\n      this.options.hasThemes = true;\n      possible_fieldsets.push('Theme');\n    }\n\n    this._fieldsets = [];\n    possible_fieldsets.forEach(function(cls) {\n      var fieldset = new Preferences.fieldset[cls](this);\n      template += fieldset.template();\n      this._fieldsets.push(fieldset);\n    }.bind(this))\n\n    if ( this.options.fields ) {\n      this.options.hasFields = true;\n      for(var i in this.options.fields) {\n        var field = this.options.fields[i];\n        var id = \"preferences-custom-\" + i;\n        template += `<fieldset class=\"custom-field\">\n          <legend>${field.label}</legend>\n        `;\n        for(var j in field.inputs) {\n          var input = field.inputs[j];\n          var checked = input.value == field.value ? ' checked=\"checked\"' : '';\n          template += `<label><input id=\"preferences-custom-${i}-${j}\" type=\"radio\" name=\"x${field.name}\" value=\"${input.value}\" ${checked}/>${input.label}</label>`;\n        }\n        if ( field.hint ) {\n          template += `<p class=\"hint\" style=\"font-size: 90%\">${field.hint}</p>`;\n        }\n      }\n    }\n\n    template = '<form>' + template + '</form>';\n\n    // this._modal = this._reader.modal({\n    //   template: template,\n    //   title: 'Preferences',\n    //   className: 'cozy-modal-preferences',\n    //   actions: [\n    //     {\n    //       label: 'Save Changes',\n    //       callback: function(event) {\n    //         self.updatePreferences(event);\n    //       }\n    //     }\n    //   ],\n    //   region: 'right'\n    // });\n\n    this._modal._container.querySelector('main').innerHTML = template;\n    this._form = this._modal._container.querySelector('form');\n  },\n\n  initializeForm: function() {\n    this._createPanel();\n    this._fieldsets.forEach(function(fieldset) {\n      fieldset.initializeForm(this._form);\n    }.bind(this));\n  },\n\n  updatePreferences: function(event) {\n    event.preventDefault();\n\n    var doUpdate = false;\n    var new_options = {};\n    var saveable_options = {};\n    this._fieldsets.forEach(function(fieldset) {\n      // doUpdate = doUpdate || fieldset.updateForm(this._form, new_options);\n      // assign(new_options, fieldset.updateForm(this._form));\n      fieldset.updateForm(this._form, new_options, saveable_options);\n    }.bind(this));\n\n    if ( this.options.hasFields ) {\n      for(var i in this.options.fields) {\n        var field = this.options.fields[i];\n        var id = \"preferences-custom-\" + i;\n        var input = this._form.querySelector(`input[name=\"x${field.name}\"]:checked`);\n        if ( input.value != field.value ) {\n          field.value = input.value;\n          field.callback(field.value);\n        }\n      }\n    }\n\n    this._modal.deactivate();\n\n    setTimeout(function() {\n      this._reader.saveOptions(saveable_options);\n      this._reader.reopen(new_options);\n    }.bind(this), 100);\n  },\n\n  EOT: true\n});\n\nPreferences.fieldset = {};\n\nvar Fieldset = Class.extend({\n\n  options: {},\n\n  initialize: function (control, options) {\n      Util.setOptions(this, options);\n      this._control = control;\n      this._current = {};\n      this._id = (new Date()).getTime() + '-' + parseInt(Math.random((new Date()).getTime()) * 1000, 10);\n  },\n\n  template: function() {\n\n  },\n\n  EOT: true\n\n\n});\n\nPreferences.fieldset.TextSize = Fieldset.extend({\n\n  initializeForm: function(form) {\n    if ( ! this._input ) {\n      this._input = form.querySelector(`#x${this._id}-input`);\n      this._output = form.querySelector(`#x${this._id}-output`);\n      this._preview = form.querySelector(`#x${this._id}-preview`);\n\n      this._input.addEventListener('input', this._updatePreview.bind(this));\n      this._input.addEventListener('change', this._updatePreview.bind(this));\n    }\n\n    var text_size = this._control._reader.options.text_size || 100;\n    if ( text_size == 'auto' ) { text_size = 100; }\n    this._current.text_size = text_size;\n    this._input.value = text_size;\n    this._updatePreview();\n  },\n\n  updateForm: function(form, options, saveable) {\n    // return { text_size: this._input.value };\n    options.text_size = saveable.text_size = this._input.value;\n    // options.text_size = this._input.value;\n    // return ( this._input.value != this._current.text_size );\n  },\n\n  template: function() {\n    return `<fieldset class=\"cozy-fieldset-text_size\">\n        <legend>Text Size</legend>\n        <div class=\"preview--text_size\" id=\"x${this._id}-preview\">\n          ‘Yes, that’s it,’ said the Hatter with a sigh: ‘it’s always tea-time, and we’ve no time to wash the things between whiles.’\n        </div>\n        <p style=\"white-space: no-wrap\">\n          <span>T-</span>\n          <input name=\"text_size\" type=\"range\" id=\"x${this._id}-input\" value=\"100\" min=\"50\" max=\"400\" step=\"10\" style=\"width: 75%; display: inline-block\" />\n          <span>T+</span>\n        </p>\n        <p>\n          <span>Text Size: </span>\n          <output for=\"preferences-input-text_size\" id=\"x${this._id}-output\">100</output>\n        </p>\n      </fieldset>`;\n  },\n\n  _updatePreview: function() {\n    this._preview.style.fontSize = `${( parseInt(this._input.value, 10) / 100 )}em`;\n    this._output.value = `${this._input.value}%`;\n  },\n\n  EOT: true\n\n});\n\nPreferences.fieldset.Display = Fieldset.extend({\n\n  initializeForm: function(form) {\n    var flow = this._control._reader.options.flow || this._control._reader.metadata.flow || 'auto';\n    // if ( flow == 'auto' ) { flow = 'paginated'; }\n\n    var input = form.querySelector(`#x${this._id}-input-${flow}`);\n    input.checked = true;\n    this._current.flow = flow;\n\n  },\n\n  updateForm: function(form, options, saveable) {\n    var input = form.querySelector(`input[name=\"x${this._id}-flow\"]:checked`);\n    options.flow = input.value;\n    if ( options.flow != 'auto' ) {\n      saveable.flow = options.flow;\n    }\n    // if ( input.value == 'auto' ) {\n    //   // we do NOT want to save flow as a preference\n    //   return {};\n    // }\n    // return { flow: input.value };\n  },\n\n  template: function() {\n    var scrolled_help = '';\n    if ( this._control._reader.metadata.layout != 'pre-paginated' ) {\n      scrolled_help = \"<br /><small>This is an experimental feature that may cause display and loading issues for the book when enabled.</small>\";\n    }\n    return `<fieldset>\n            <legend>Display</legend>\n            <label><input name=\"x${this._id}-flow\" type=\"radio\" id=\"x${this._id}-input-auto\" value=\"auto\" /> Auto<br /><small>Let the reader determine display mode based on your browser dimensions and the type of content you're reading</small></label>\n            <label><input name=\"x${this._id}-flow\" type=\"radio\" id=\"x${this._id}-input-paginated\" value=\"paginated\" /> Page-by-Page</label>\n            <label><input name=\"x${this._id}-flow\" type=\"radio\" id=\"x${this._id}-input-scrolled-doc\" value=\"scrolled-doc\" /> Scroll${scrolled_help}</label>\n          </fieldset>`;\n  },\n\n  EOT: true\n\n});\n\nPreferences.fieldset.Theme = Fieldset.extend({\n\n  initializeForm: function(form) {\n    var theme = this._control._reader.options.theme || 'default';\n\n    var input = form.querySelector(`#x${this._id}-input-theme-${theme}`);\n    input.checked = true;\n    this._current.theme = theme;\n  },\n\n  updateForm: function(form, options, saveable) {\n    var input = form.querySelector(`input[name=\"x${this._id}-theme\"]:checked`);\n    options.theme = saveable.theme = input.value;\n    // return { theme: input.value };\n  },\n\n  template: function() {\n    var template = `<fieldset>\n            <legend>Theme</legend>\n            <label><input name=\"x${this._id}-theme\" type=\"radio\" id=\"x${this._id}-input-theme-default\" value=\"default\" />Default</label>`;\n\n    this._control._reader.options.themes.forEach(function(theme) {\n      template += `<label><input name=\"x${this._id}-theme\" type=\"radio\" id=\"x${this._id}-input-theme-${theme.klass}\" value=\"${theme.klass}\" />${theme.name}</label>`\n    }.bind(this));\n\n    template += '</fieldset>';\n\n    return template;\n\n  },\n\n  EOT: true\n\n});\n\nPreferences.fieldset.Rendition = Fieldset.extend({\n\n  initializeForm: function(form) {\n    var rootfiles = this._control._reader.rootfiles;\n    var rootfilePath = this._control._reader.options.rootfilePath;\n    var expr = rootfilePath ? `[value=\"${rootfilePath}\"]` : \":first-child\";\n    var input = form.querySelector(`input[name=\"x${this._id}-rootfilePath\"]${expr}`);\n    input.checked = true;\n    this._current.rootfilePath = rootfilePath || rootfiles[0].rootfilePath;\n  },\n\n  updateForm: function(form, options, saveable) {\n    var input = form.querySelector(`input[name=\"x${this._id}-rootfilePath\"]:checked`);\n    if ( input.value != this._current.rootfilePath ) {\n      options.rootfilePath = input.value;\n      this._current.rootfilePath = input.value;\n    }\n  },\n\n  template: function() {\n    var template = `<fieldset>\n            <legend>Rendition</legend>\n    `;\n\n    this._control._reader.rootfiles.forEach(function(rootfile, i) {\n      template += `<label><input name=\"x${this._id}-rootfilePath\" type=\"radio\" id=\"x${this._id}-input-rootfilePath-${i}\" value=\"${rootfile.rootfilePath}\" />${rootfile.label || rootfile.accessMode || rootfile.rootfilePath}</label>`;\n    }.bind(this))\n\n    template += '</fieldset>';\n\n    return template;\n\n  },\n\n  EOT: true\n\n});\n\nPreferences.fieldset.Scale = Fieldset.extend({\n\n  initializeForm: function(form) {\n    if ( ! this._input ) {\n      this._input = form.querySelector(`#x${this._id}-input`);\n      this._output = form.querySelector(`#x${this._id}-output`);\n      this._preview = form.querySelector(`#x${this._id}-preview > div`);\n      this._actionReset = form.querySelector(`#x${this._id}-reset`);\n\n      this._input.addEventListener('input', this._updatePreview.bind(this));\n      this._input.addEventListener('change', this._updatePreview.bind(this));\n\n      this._actionReset.addEventListener('click', function(event) {\n        event.preventDefault();\n        this._input.value = 100;\n        this._updatePreview();\n      }.bind(this));\n    }\n\n    var scale = this._control._reader.options.scale || 100;\n    if ( ! scale ) { scale = 100; }\n    this._current.scale = scale;\n    this._input.value = scale;\n    this._updatePreview();\n  },\n\n  updateForm: function(form, options, saveable) {\n    // return { text_size: this._input.value };\n    options.scale = saveable.scale = this._input.value;\n    // options.text_size = this._input.value;\n    // return ( this._input.value != this._current.text_size );\n  },\n\n  template: function() {\n    return `<fieldset class=\"cozy-fieldset-text_size\">\n        <legend>Zoom In/Out</legend>\n        <div class=\"preview--scale\" id=\"x${this._id}-preview\" style=\"overflow: hidden; height: 5rem\">\n          <div>\n            ‘Yes, that’s it,’ said the Hatter with a sigh: ‘it’s always tea-time, and we’ve no time to wash the things between whiles.’\n          </div>\n        </div>\n        <p style=\"white-space: no-wrap\">\n          <span style=\"font-size: 150%\">⊖<span class=\"u-screenreader\"> Zoom Out</span></span>\n          <input name=\"scale\" type=\"range\" id=\"x${this._id}-input\" value=\"100\" min=\"50\" max=\"400\" step=\"10\" style=\"width: 75%; display: inline-block\" />\n          <span style=\"font-size: 150%\">⊕<span class=\"u-screenreader\">Zoom In </span></span>\n        </p>\n        <p>\n          <span>Scale: </span>\n          <output for=\"preferences-input-text_size\" id=\"x${this._id}-output\">100</output>\n          <button id=\"x${this._id}-reset\" class=\"reset button--inline\" style=\"margin-left: 8px\">Reset</button> \n        </p>\n      </fieldset>`;\n  },\n\n  _updatePreview: function() {\n    this._preview.style.transform = `scale(${( parseInt(this._input.value, 10) / 100 )}) translate(0,0)`;\n    this._output.value = `${this._input.value}%`;\n  },\n\n  EOT: true\n\n});\n\nexport var preferences = function(options) {\n  return new Preferences(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Widget = Control.extend({\n\n\n  options: {\n      // @option region: String = 'topright'\n      // The region of the control (one of the reader corners). Possible values are `'topleft'`,\n      // `'topright'`, `'bottomleft'` or `'bottomright'`\n  },\n\n  onAdd: function(reader) {\n    var container = this._container;\n    if ( container ) {\n      // NOOP\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n\n    }\n\n    this._onAddExtra(container);\n    this._updateTemplate(container);\n    this._updateClass(container);\n    this._bindEvents(container);\n\n    return container;\n  },\n\n  _updateTemplate: function(container) {\n    var data = this.data();\n    for(var slot in data) {\n      if ( data.hasOwnProperty(slot) ) {\n        var value = data[slot];\n        if ( typeof(value) == \"function\" ) { value = value(); }\n        var node = container.querySelector(`[data-slot=${slot}]`);\n        if ( node ) {\n          if ( node.hasAttribute('value') ) {\n            node.setAttribute('value', value);\n          } else {\n            node.innerHTML = value;\n          }\n        }\n      }\n    }\n  },\n\n  _updateClass: function(container) {\n    if ( this.options.className ) {\n      DomUtil.addClass(container, this.options.className);\n    }\n  },\n\n  _onAddExtra: function() { },\n\n  _bindEvents: function(container) {\n    var control = container.querySelector(\"[data-toggle=button]\");\n    if ( ! control ) { return ; }\n    DomEvent.disableClickPropagation(control);\n    DomEvent.on(control, 'click', DomEvent.stop);\n    DomEvent.on(control, 'click', this._action, this);\n  },\n\n  _action: function() {\n  },\n\n  data: function() {\n    return this.options.data || {};\n  },\n\n  EOT: true\n});\n\nWidget.Button = Widget.extend({\n  defaultTemplate: `<button data-toggle=\"button\" data-slot=\"label\"></button>`,\n\n  _action: function() {\n    this.options.onClick(this, this._reader);\n  },\n\n  EOT: true\n});\n\nWidget.Panel = Widget.extend({\n  defaultTemplate: `<div><span data-slot=\"text\"></span></div>`,\n\n\n  EOT: true\n});\n\nWidget.Toggle = Widget.extend({\n  defaultTemplate: `<button data-toggle=\"button\" data-slot=\"label\"></button>`,\n\n  _onAddExtra: function(container) {\n    this.state(this.options.states[0].stateName, container);\n\n    return container;\n  },\n\n  state: function(stateName, container) {\n    container = container || this._container;\n    this._resetState(container);\n    this._state = this.options.states.filter(function(s) { return s.stateName == stateName })[0];\n    this._updateClass(container);\n    this._updateTemplate(container);\n  },\n\n  _resetState: function(container) {\n    if ( ! this._state ) { return; }\n    if ( this._state.className ) {\n      DomUtil.removeClass(container, this._state.className);\n    }\n  },\n\n  _updateClass: function(container) {\n    if ( this._state.className ) {\n      DomUtil.addClass(container, this._state.className);\n    }\n  },\n\n  _action: function() {\n    this._state.onClick(this, this._reader);\n  },\n\n  data: function() {\n    return this._state.data || {};\n  },\n\n  EOT: true\n});\n\n// export var widget = function(options) {\n//   return new Widget(options);\n// }\n\nexport var widget = {\n  button: function(options) { return new Widget.Button(options); },\n  panel: function(options) { return new Widget.Panel(options); },\n  toggle: function(options) { return new Widget.Toggle(options); }\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Citation = Control.extend({\n  options: {\n    label: 'Citation',\n    html: '<span>Get Citation</span>'\n  },\n\n  defaultTemplate: `<button class=\"button--sm cozy-citation\" data-toggle=\"open\">Get Citation</button>`,\n\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._reader.on('updateContents', function(data) {\n      self._createPanel();\n    });\n\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n      self._modal.activate();\n    }, this)\n\n    return container;\n  },\n\n  _action: function() {\n    var self = this;\n    self._modal.activate();\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('button', className, container);\n    link.innerHTML = html;\n    link.title = title;\n\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n\n    return link;\n  },\n\n  _createPanel: function() {\n    var self = this;\n\n    var template = `<form>\n      <fieldset>\n        <legend>Select Citation Format</legend>\n      </fieldset>\n    </form>\n    <blockquote id=\"formatted\" style=\"padding: 8px; border-left: 4px solid black; background-color: #fff\"></blockquote>\n    <div class=\"alert alert-info\" id=\"message\" style=\"display: none\"></div>`;\n\n    this._modal = this._reader.modal({\n      template: template,\n      title: 'Copy Citation to Clipboard',\n      className: 'cozy-modal-citatation',\n      actions: [\n        {\n          label: 'Copy Citation',\n          callback: function(event) {\n            document.designMode = \"on\";\n            var formatted = self._modal._container.querySelector(\"#formatted\");\n\n            var range = document.createRange();\n            range.selectNode(formatted);\n            var sel = window.getSelection();\n            sel.removeAllRanges();\n            sel.addRange(range);\n\n            // formatted.select();\n\n            try {\n              var flag = document.execCommand('copy');\n            } catch(err) {\n              console.log(\"AHOY COPY FAILED\", err);\n            }\n\n            self._message.innerHTML = 'Success! Citation copied to your clipboard.';\n            self._message.style.display = 'block';\n            sel.removeAllRanges();\n            range.detach();\n            document.designMode = \"off\";\n          }\n        }\n      ],\n      region: 'left',\n      fraction: 1.0\n    });\n\n    this._form = this._modal._container.querySelector('form');\n    var fieldset = this._form.querySelector('fieldset');\n\n    var citations = this.options.citations || this._reader.metadata.citations;\n\n    citations.forEach(function(citation, index) {\n      var label = DomUtil.create('label', null, fieldset);\n      var input = DomUtil.create('input', null, label);\n      input.setAttribute('name', 'format');\n      input.setAttribute('value', citation.format);\n      input.setAttribute('type', 'radio');\n      if ( index == 0 ) {\n        input.setAttribute('checked', 'checked');\n      }\n      var text = document.createTextNode(\" \" + citation.format);\n      label.appendChild(text);\n      input.setAttribute('data-text', citation.text);\n    });\n\n    this._formatted = this._modal._container.querySelector(\"#formatted\");\n    this._message = this._modal._container.querySelector(\"#message\");\n    DomEvent.on(this._form, 'change', function(event) {\n      var target = event.target;\n      if ( target.tagName == 'INPUT' ) {\n        this._initializeForm();\n      }\n    }, this);\n\n    this._initializeForm();\n  },\n\n  _initializeForm: function() {\n    var formatted = this._formatCitation();\n    this._formatted.innerHTML = formatted;\n    this._message.style.display = 'none';\n    this._message.innerHTML = '';\n  },\n\n  _formatCitation: function(format) {\n    if ( format == null ) {\n      var selected = this._form.querySelector(\"input:checked\");\n      format = selected.value;\n    }\n    var selected = this._form.querySelector(\"input[value=\" + format + \"]\");\n    return selected.getAttribute('data-text');\n    // return selected.dataset.text;\n  },\n\n  EOT: true\n});\n\nexport var citation = function(options) {\n  return new Citation(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Search = Control.extend({\n  options: {\n    label: 'Search',\n    html: '<span>Search</span>'\n  },\n\n  defaultTemplate: `<form class=\"search\">\n    <label class=\"u-screenreader\" for=\"cozy-search-string\">Search in this text</label>\n    <input id=\"cozy-search-string\" name=\"search\" type=\"text\" placeholder=\"Search in this text...\"/>\n    <button class=\"button--sm\" data-toggle=\"open\" aria-label=\"Search\"><i class=\"icon-magnifying-glass oi\" data-glyph=\"magnifying-glass\" title=\"Search\" aria-hidden=\"true\"></i></button>\n  </form>`,\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    container.style.position = 'relative';\n\n    this._data = null;\n    this._canceled = false;\n    this._processing = false;\n\n    this._reader.on('ready', function() {\n\n      this._modal = this._reader.modal({\n        template: '<article></article>',\n        title: 'Search Results',\n        className: { container: 'cozy-modal-search' },\n        region: 'left',\n      });\n\n      this._modal.callbacks.onClose = function() {\n        if ( self._processing ) {\n          self._canceled = true;\n        }\n      };\n\n      this._article = this._modal._container.querySelector('article');\n\n      this._modal.on('click', 'a[href]', function(modal, target) {\n        target = target.getAttribute('href');\n        this._reader.tracking.action('search/go');\n        this._reader.gotoPage(target);\n        return true;\n      }.bind(this));\n\n      this._modal.on('closed', function() {\n        this._reader.tracking.action('contents/close');\n      }.bind(this))\n\n    }.bind(this));\n\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n\n      var searchString = this._container.querySelector(\"#cozy-search-string\").value;\n      searchString = searchString.replace(/^\\s*/, '').replace(/\\s*$/, '');\n\n      if ( ! searchString ) {\n        // just punt\n        return;\n      }\n\n      if ( searchString == this.searchString ) {\n        // cached results\n        self.openModalResults();\n      } else {\n        this.searchString = searchString;\n        self.openModalWaiting();\n        self.submitQuery();\n      }\n    }, this);\n\n    return container;\n  },\n\n  openModalWaiting: function() {\n    this._processing = true;\n    this._emptyArticle();\n    var value = this.searchString;\n    this._article.innerHTML = '<p>Submitting query for <em>' + value + '</em>...</p>' + this._reader.loaderTemplate();\n    this._modal.activate();\n  },\n\n  openModalResults: function() {\n    if ( this._canceled ) {\n      this._canceled = false;\n      return;\n    }\n    this._buildResults();\n    this._modal.activate();\n    this._reader.tracking.action(\"search/open\");\n  },\n\n  submitQuery: function() {\n    var self = this;\n\n    var url = this.options.searchUrl + this.searchString;\n\n    var request = new XMLHttpRequest();\n    request.open('GET', url, true);\n\n    request.onload = function() {\n      if (this.status >= 200 && this.status < 400) {\n        // Success!\n        var data = JSON.parse(this.response);\n        console.log(\"SEARCH DATA\", data);\n\n        self._data = data;\n\n      } else {\n        // We reached our target server, but it returned an error\n\n        self._data = null;\n        console.log(this.response);\n      }\n\n      self._reader.tracking.action(\"search/submitQuery\");\n      self.openModalResults();\n\n    };\n\n    request.onerror = function() {\n      // There was a connection error of some sort\n      self._data = null;\n      self.openModalResults();\n    };\n\n    request.send();\n\n  },\n\n  _emptyArticle: function() {\n    while (this._article && this._article.hasChildNodes()) {\n      this._article.removeChild(this._article.lastChild);\n    }\n  },\n\n  _buildResults: function() {\n    var self = this;\n    var content;\n\n    this._processing = false;\n\n    self._emptyArticle();\n\n    var reader = this._reader;\n    reader.annotations.reset();\n\n    if ( this._data ) {\n      var highlight = true\n      if (this._data.highlight_off == \"yes\") {\n        highlight = false;\n      }\n      if ( this._data.search_results.length ) {\n        content = DomUtil.create('ul');\n\n        this._data.search_results.forEach(function(result) {\n          var option = DomUtil.create('li');\n          var anchor = DomUtil.create('a', null, option);\n          var cfiRange = \"epubcfi(\" + result.cfi + \")\";\n\n          if (result.snippet) {\n            if (result.title) {\n              var chapterTitle = DomUtil.create('i');\n              chapterTitle.textContent = result.title + \": \";\n              anchor.appendChild(chapterTitle);\n            }\n            anchor.appendChild(document.createTextNode(result.snippet));\n\n            anchor.setAttribute(\"href\", cfiRange);\n            content.appendChild(option);\n          }\n          if (highlight) {\n            reader.annotations.highlight(cfiRange);\n          }\n        });\n      } else {\n        content = DomUtil.create(\"p\")\n        content.textContent = 'No results found for \"' + self.searchString + '\"';\n      }\n    } else {\n      content = DomUtil.create(\"p\")\n      content.textContent = 'There was a problem processing this query.';\n    }\n\n    self._article.appendChild(content);\n  },\n\n  EOT: true\n});\n\nexport var search = function(options) {\n  return new Search(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\n// Title + Chapter\n\nexport var BibliographicInformation = Control.extend({\n  options: {\n    label: 'Info',\n    direction: 'left',\n    html: '<span class=\"oi\" data-glyph=\"info\">Info</span>'\n  },\n\n  defaultTemplate: `<button class=\"button--sm cozy-bib-info oi\" data-glyph=\"info\" data-toggle=\"open\" aria-label=\"Bibliographic Information\"> Info</button>`,\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._reader.on('updateContents', function(data) {\n      self._createPanel();\n    });\n\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n      self._modal.activate();\n    }, this)\n\n    return container;\n  },\n\n  _createPanel: function() {\n    var self = this;\n\n    var template = `<dl>\n    </dl>`;\n\n    this._modal = this._reader.modal({\n      template: template,\n      title: 'Info',\n      region: 'left',\n      fraction: 1.0\n    });\n\n    var dl = this._modal._container.querySelector('dl');\n\n    var metadata_fields = [\n      [ 'title', 'Title' ],\n      [ 'creator', 'Author' ],\n      [ 'pubdate', 'Publication Date' ],\n      [ 'modified_date', 'Modified Date' ],\n      [ 'publisher', 'Publisher' ],\n      [ 'rights', 'Rights' ],\n      [ 'doi', 'DOI' ],\n      [ 'description', 'Description' ],\n    ];\n\n    var metadata_fields_seen = {};\n\n    var metadata = this._reader.metadata;\n\n    for(var idx in metadata_fields) {\n      var key = metadata_fields[idx][0];\n      var label = metadata_fields[idx][1];\n      if ( metadata[key] ) {\n        var value = metadata[key];\n        if ( key == 'pubdate' || key == 'modified_date' ) {\n          value = this._formatDate(value);\n          if ( ! value ) { continue; }\n          // value = d.toISOString().slice(0,10); // for YYYY-MM-DD\n        }\n        metadata_fields_seen[key] = true;\n        var dt = DomUtil.create('dt', 'cozy-bib-info-label', dl);\n        dt.innerHTML = label;\n        var dd = DomUtil.create('dd', 'cozy-bib-info-value cozy-bib-info-value-' + key, dl);\n        dd.innerHTML = value;\n      }\n    }\n\n  },\n\n  _formatDate: function(value) {\n    var match = value.match(/\\d{4}/);\n    if ( match ) {\n      return match[0];\n    }\n    return null;\n  },\n\n  EOT: true\n});\n\nexport var bibliographicInformation = function(options) {\n  return new BibliographicInformation(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Download = Control.extend({\n  options: {\n    label: 'Download Book',\n    html: '<span>Download Book</span>'\n  },\n\n  defaultTemplate: `<button class=\"button--sm cozy-download oi\" data-toggle=\"open\" data-glyph=\"data-transfer-download\"> Download Book</button>`,\n\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._reader.on('updateContents', function(data) {\n      self._createPanel();\n    });\n\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n      self._modal.activate();\n    }, this)\n\n    return container;\n  },\n\n  _createPanel: function() {\n    var self = this;\n\n    var template = `<form>\n      <fieldset>\n        <legend>Choose File Format</legend>\n      </fieldset>\n    </form>`;\n\n    this._modal = this._reader.modal({\n      template: template,\n      title: 'Download Book',\n      className: 'cozy-modal-download',\n      actions: [\n        {\n          label: 'Download',\n          callback: function(event) {\n            var selected = self._form.querySelector(\"input:checked\");\n            var href = selected.getAttribute('data-href');\n            self._configureDownloadForm(href);\n            self._form.submit();\n          }\n        }\n      ],\n      region: 'left',\n      fraction: 1.0\n    });\n\n    this._form = this._modal._container.querySelector('form');    \n    var fieldset = this._form.querySelector('fieldset');\n    this._reader.options.download_links.forEach(function(link, index) {\n      var label = DomUtil.create('label', null, fieldset);\n      var input = DomUtil.create('input', null, label);\n      input.setAttribute('name', 'format');\n      input.setAttribute('value', link.format);\n      input.setAttribute('data-href', link.href);\n      input.setAttribute('type', 'radio');\n      if ( index == 0 ) {\n        input.setAttribute('checked', 'checked');\n      }\n      var text = link.format;\n      if ( link.size ) {\n        text += \" (\" + link.size + \")\";\n      }\n      var text = document.createTextNode(\" \" + text);\n      label.appendChild(text);\n    });\n\n  },\n\n  _configureDownloadForm: function(href) {\n    var self = this;\n    self._form.setAttribute('method', 'GET');\n    self._form.setAttribute('action', href);\n    self._form.setAttribute('target', '_blank');\n  },\n\n\n  EOT: true\n});\n\nexport var download = function(options) {\n  return new Download(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Navigator = Control.extend({\n  onAdd: function(reader) {\n    var container = this._container;\n    if ( container ) {\n    } else {\n\n      var className = this._className('navigator'),\n          options = this.options;\n      \n      container = DomUtil.create('div', className);\n    }\n    this._setup(container);\n\n    this._reader.on('updateLocations', function(locations) {      \n      // if ( ! this._reader.currentLocation() || ! this._reader.currentLocation().start ) {\n      //   console.log(\"AHOY updateLocations NO START\", this._reader.currentLocation().then);\n      //   setTimeout(function() {\n      //     this._initializeNavigator(locations);\n      //   }.bind(this), 100);\n      //   return;\n      // }\n      this._initializeNavigator(locations);\n    }.bind(this));\n\n    return container;\n  },\n\n  _setup: function(container) {\n    this._control = container.querySelector(\"input[type=range]\");\n    if ( ! this._control ) {\n      this._createControl(container);\n    }\n    this._background = container.querySelector(\".cozy-navigator-range__background\");\n    this._status = container.querySelector(\".cozy-navigator-range__status\");\n    this._spanCurrentPercentage = container.querySelector(\".currentPercentage\");\n    this._spanCurrentLocation = container.querySelector(\".currentLocation\");\n    this._spanTotalLocations = container.querySelector(\".totalLocations\");\n\n    this._bindEvents();\n  },\n\n  _createControl: function (container) {\n    var template = `<div class=\"cozy-navigator-range\">\n        <label class=\"u-screenreader\" for=\"cozy-navigator-range-input\">Location: </label>\n        <input class=\"cozy-navigator-range__input\" id=\"cozy-navigator-range-input\" type=\"range\" name=\"locations-range-value\" min=\"0\" max=\"100\" aria-valuemin=\"0\" aria-valuemax=\"100\" aria-valuenow=\"0\" aria-valuetext=\"0% • Location 0 of ?\" value=\"0\" data-background-position=\"0\" />\n        <div class=\"cozy-navigator-range__background\"></div>\n      </div>\n      <div class=\"cozy-navigator-range__status\"><span class=\"currentPercentage\">0%</span> • Location <span class=\"currentLocation\">0</span> of <span class=\"totalLocations\">?</span></div>\n    `;\n\n    var body = new DOMParser().parseFromString(template, \"text/html\").body;\n    while ( body.children.length ) {\n      container.appendChild(body.children[0]);\n    }\n\n    this._control = container.querySelector(\"input[type=range]\");\n  },\n\n  _bindEvents: function() {\n    var self = this;\n\n    this._control.addEventListener(\"input\", function() {\n      self._update();\n    }, false);\n    this._control.addEventListener(\"change\", function() { self._action(); }, false);\n    this._control.addEventListener(\"mousedown\", function(){\n        self._mouseDown = true;\n    }, false);\n    this._control.addEventListener(\"mouseup\", function(){\n        self._mouseDown = false;\n    }, false);\n    this._control.addEventListener(\"keydown\", function(){\n      self._mouseDown = true;\n    }, false);\n    this._control.addEventListener(\"keyup\", function(){\n      self._mouseDown = false;\n    }, false);\n\n    this._reader.on('relocated', function(location) {\n      if ( ! self._initiated ) { return; }\n      if ( ! self._mouseDown ) {\n        self._control.value = Math.ceil(self._reader.locations.percentageFromCfi(self._reader.currentLocation().start.cfi) * 100);\n        self._update();\n      }\n    })\n\n  },\n\n  _action: function() {\n    var value = this._control.value;\n    var locations = this._reader.locations;\n    var cfi = locations.cfiFromPercentage(value / 100);\n    this._reader.tracking.action(\"navigator/go\");\n    this._reader.gotoPage(cfi);\n  },\n\n  _update: function() {\n    var self = this;\n\n    var current = this._reader.currentLocation();\n    if ( ! current || ! current.start ) {\n      setTimeout(function() {\n        this._update();\n      }.bind(this), 100);\n    }\n\n    var rangeBg = this._background;\n    var range = self._control;\n\n    var value = parseInt(range.value, 10);\n    var percentage = value;\n\n    rangeBg.setAttribute('style', 'background-position: ' + (-percentage) + '% 0%, left top;');\n    self._control.setAttribute('data-background-position', Math.ceil(percentage));\n\n    this._spanCurrentPercentage.innerHTML = percentage + '%';\n    if ( current && current.start ) {\n      var current_location = this._reader.locations.locationFromCfi(current.start.cfi);\n      this._spanCurrentLocation.innerHTML = ( current_location );\n    }\n    self._last_delta = self._last_value > value; self._last_value = value;\n  },\n\n  _initializeNavigator: function(locations) {\n    console.log(\"AHOY updateLocations PROCESSING LOCATION\");\n    this._initiated = true;\n    this._total = this._reader.locations.total;\n    if ( this._reader.currentLocation().start ) {\n      this._control.value = Math.ceil(this._reader.locations.percentageFromCfi(this._reader.currentLocation().start.cfi) * 100);\n      this._last_value = this._control.value;\n    } else {\n      this._last_value = this._control.value;\n    }\n\n    this._spanTotalLocations.innerHTML = this._total;\n\n    this._update();\n    setTimeout(function() {\n      DomUtil.addClass(this._container, 'initialized');\n    }.bind(this), 0);\n  },\n\n  EOT: true\n});\n\nexport var navigator = function(options) {\n  return new Navigator(options);\n}\n","import {Control, control} from './Control';\nimport {PageNext, PagePrevious, pageNext, pagePrevious, PageFirst, pageFirst, PageLast, pageLast} from './Control.Paging';\nimport {Contents, contents} from './Control.Contents';\nimport {Title, title} from './Control.Title';\nimport {PublicationMetadata, publicationMetadata} from './Control.PublicationMetadata';\nimport {Preferences, preferences} from './Control.Preferences';\nimport {Widget, widget} from './Control.Widget';\nimport {Citation, citation} from './Control.Citation';\nimport {Search, search} from './Control.Search';\nimport {BibliographicInformation, bibliographicInformation} from './Control.BibliographicInformation';\nimport {Download, download} from './Control.Download';\nimport {Navigator, navigator} from './Control.Navigator';\n\n// import {Zoom, zoom} from './Control.Zoom';\n// import {Attribution, attribution} from './Control.Attribution';\n\nControl.PageNext = PageNext;\nControl.PagePrevious = PagePrevious;\nControl.PageFirst = PageFirst;\nControl.PageLast = PageLast;\ncontrol.pagePrevious = pagePrevious;\ncontrol.pageNext = pageNext;\ncontrol.pageFirst = pageFirst;\ncontrol.pageLast = pageLast;\n\nControl.Contents = Contents;\ncontrol.contents = contents;\n\nControl.Title = Title;\ncontrol.title = title;\n\nControl.PublicationMetadata = PublicationMetadata;\ncontrol.publicationMetadata = publicationMetadata;\n\nControl.Preferences = Preferences;\ncontrol.preferences = preferences;\n\nControl.Widget = Widget;\ncontrol.widget = widget;\n\nControl.Citation = Citation;\ncontrol.citation = citation;\n\nControl.Search = Search;\ncontrol.search = search;\n\nControl.BibliographicInformation = BibliographicInformation;\ncontrol.bibliographicInformation = bibliographicInformation;\n\nControl.Download = Download;\ncontrol.download = download;\n\nControl.Navigator = Navigator;\ncontrol.navigator = navigator;\n\nexport {Control, control};\n","import {Evented} from './Events';\n\nvar Bus = Evented.extend({\n});\n\nvar instance;\nexport var bus = function() {\n  return instance || ( instance = new Bus() );\n}\n","import * as Browser from './Browser';\nexport {Browser};\n\nexport {Class} from './Class';\n\nimport {Evented} from './Events';\nexport {Evented};\nexport var Mixin = {Events: Evented.prototype};\n\nimport * as Util from './Util';\nexport {Util};\nexport {extend, bind, stamp, setOptions} from './Util';\nexport {bus} from './Bus';\n","\n// var ePub = window.ePub;\n// export {ePub};\n\nexport function ePub(href, options) {\n\tif ( window.require !== undefined ) {\n\t\twindow.ePub = require(\"ePub\");\n\t}\n  return window.ePub(href, options);\n}\n","'use strict';\n\nif (!process) {\n  var process = {\n    \"cwd\" : function () { return '/' }\n  };\n}\n\nfunction assertPath(path) {\n  if (typeof path !== 'string') {\n    throw new TypeError('Path must be a string. Received ' + path);\n  }\n}\n\n// Resolves . and .. elements in a path with directory names\nfunction normalizeStringPosix(path, allowAboveRoot) {\n  var res = '';\n  var lastSlash = -1;\n  var dots = 0;\n  var code;\n  for (var i = 0; i <= path.length; ++i) {\n    if (i < path.length)\n      code = path.charCodeAt(i);\n    else if (code === 47/*/*/)\n      break;\n    else\n      code = 47/*/*/;\n    if (code === 47/*/*/) {\n      if (lastSlash === i - 1 || dots === 1) {\n        // NOOP\n      } else if (lastSlash !== i - 1 && dots === 2) {\n        if (res.length < 2 ||\n            res.charCodeAt(res.length - 1) !== 46/*.*/ ||\n            res.charCodeAt(res.length - 2) !== 46/*.*/) {\n          if (res.length > 2) {\n            var start = res.length - 1;\n            var j = start;\n            for (; j >= 0; --j) {\n              if (res.charCodeAt(j) === 47/*/*/)\n                break;\n            }\n            if (j !== start) {\n              if (j === -1)\n                res = '';\n              else\n                res = res.slice(0, j);\n              lastSlash = i;\n              dots = 0;\n              continue;\n            }\n          } else if (res.length === 2 || res.length === 1) {\n            res = '';\n            lastSlash = i;\n            dots = 0;\n            continue;\n          }\n        }\n        if (allowAboveRoot) {\n          if (res.length > 0)\n            res += '/..';\n          else\n            res = '..';\n        }\n      } else {\n        if (res.length > 0)\n          res += '/' + path.slice(lastSlash + 1, i);\n        else\n          res = path.slice(lastSlash + 1, i);\n      }\n      lastSlash = i;\n      dots = 0;\n    } else if (code === 46/*.*/ && dots !== -1) {\n      ++dots;\n    } else {\n      dots = -1;\n    }\n  }\n  return res;\n}\n\nfunction _format(sep, pathObject) {\n  var dir = pathObject.dir || pathObject.root;\n  var base = pathObject.base ||\n    ((pathObject.name || '') + (pathObject.ext || ''));\n  if (!dir) {\n    return base;\n  }\n  if (dir === pathObject.root) {\n    return dir + base;\n  }\n  return dir + sep + base;\n}\n\nvar posix = {\n  // path.resolve([from ...], to)\n  resolve: function resolve() {\n    var resolvedPath = '';\n    var resolvedAbsolute = false;\n    var cwd;\n\n    for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n      var path;\n      if (i >= 0)\n        path = arguments[i];\n      else {\n        if (cwd === undefined)\n          cwd = process.cwd();\n        path = cwd;\n      }\n\n      assertPath(path);\n\n      // Skip empty entries\n      if (path.length === 0) {\n        continue;\n      }\n\n      resolvedPath = path + '/' + resolvedPath;\n      resolvedAbsolute = path.charCodeAt(0) === 47/*/*/;\n    }\n\n    // At this point the path should be resolved to a full absolute path, but\n    // handle relative paths to be safe (might happen when process.cwd() fails)\n\n    // Normalize the path\n    resolvedPath = normalizeStringPosix(resolvedPath, !resolvedAbsolute);\n\n    if (resolvedAbsolute) {\n      if (resolvedPath.length > 0)\n        return '/' + resolvedPath;\n      else\n        return '/';\n    } else if (resolvedPath.length > 0) {\n      return resolvedPath;\n    } else {\n      return '.';\n    }\n  },\n\n\n  normalize: function normalize(path) {\n    assertPath(path);\n\n    if (path.length === 0)\n      return '.';\n\n    var isAbsolute = path.charCodeAt(0) === 47/*/*/;\n    var trailingSeparator = path.charCodeAt(path.length - 1) === 47/*/*/;\n\n    // Normalize the path\n    path = normalizeStringPosix(path, !isAbsolute);\n\n    if (path.length === 0 && !isAbsolute)\n      path = '.';\n    if (path.length > 0 && trailingSeparator)\n      path += '/';\n\n    if (isAbsolute)\n      return '/' + path;\n    return path;\n  },\n\n\n  isAbsolute: function isAbsolute(path) {\n    assertPath(path);\n    return path.length > 0 && path.charCodeAt(0) === 47/*/*/;\n  },\n\n\n  join: function join() {\n    if (arguments.length === 0)\n      return '.';\n    var joined;\n    for (var i = 0; i < arguments.length; ++i) {\n      var arg = arguments[i];\n      assertPath(arg);\n      if (arg.length > 0) {\n        if (joined === undefined)\n          joined = arg;\n        else\n          joined += '/' + arg;\n      }\n    }\n    if (joined === undefined)\n      return '.';\n    return posix.normalize(joined);\n  },\n\n\n  relative: function relative(from, to) {\n    assertPath(from);\n    assertPath(to);\n\n    if (from === to)\n      return '';\n\n    from = posix.resolve(from);\n    to = posix.resolve(to);\n\n    if (from === to)\n      return '';\n\n    // Trim any leading backslashes\n    var fromStart = 1;\n    for (; fromStart < from.length; ++fromStart) {\n      if (from.charCodeAt(fromStart) !== 47/*/*/)\n        break;\n    }\n    var fromEnd = from.length;\n    var fromLen = (fromEnd - fromStart);\n\n    // Trim any leading backslashes\n    var toStart = 1;\n    for (; toStart < to.length; ++toStart) {\n      if (to.charCodeAt(toStart) !== 47/*/*/)\n        break;\n    }\n    var toEnd = to.length;\n    var toLen = (toEnd - toStart);\n\n    // Compare paths to find the longest common path from root\n    var length = (fromLen < toLen ? fromLen : toLen);\n    var lastCommonSep = -1;\n    var i = 0;\n    for (; i <= length; ++i) {\n      if (i === length) {\n        if (toLen > length) {\n          if (to.charCodeAt(toStart + i) === 47/*/*/) {\n            // We get here if `from` is the exact base path for `to`.\n            // For example: from='/foo/bar'; to='/foo/bar/baz'\n            return to.slice(toStart + i + 1);\n          } else if (i === 0) {\n            // We get here if `from` is the root\n            // For example: from='/'; to='/foo'\n            return to.slice(toStart + i);\n          }\n        } else if (fromLen > length) {\n          if (from.charCodeAt(fromStart + i) === 47/*/*/) {\n            // We get here if `to` is the exact base path for `from`.\n            // For example: from='/foo/bar/baz'; to='/foo/bar'\n            lastCommonSep = i;\n          } else if (i === 0) {\n            // We get here if `to` is the root.\n            // For example: from='/foo'; to='/'\n            lastCommonSep = 0;\n          }\n        }\n        break;\n      }\n      var fromCode = from.charCodeAt(fromStart + i);\n      var toCode = to.charCodeAt(toStart + i);\n      if (fromCode !== toCode)\n        break;\n      else if (fromCode === 47/*/*/)\n        lastCommonSep = i;\n    }\n\n    var out = '';\n    // Generate the relative path based on the path difference between `to`\n    // and `from`\n    for (i = fromStart + lastCommonSep + 1; i <= fromEnd; ++i) {\n      if (i === fromEnd || from.charCodeAt(i) === 47/*/*/) {\n        if (out.length === 0)\n          out += '..';\n        else\n          out += '/..';\n      }\n    }\n\n    // Lastly, append the rest of the destination (`to`) path that comes after\n    // the common path parts\n    if (out.length > 0)\n      return out + to.slice(toStart + lastCommonSep);\n    else {\n      toStart += lastCommonSep;\n      if (to.charCodeAt(toStart) === 47/*/*/)\n        ++toStart;\n      return to.slice(toStart);\n    }\n  },\n\n\n  _makeLong: function _makeLong(path) {\n    return path;\n  },\n\n\n  dirname: function dirname(path) {\n    assertPath(path);\n    if (path.length === 0)\n      return '.';\n    var code = path.charCodeAt(0);\n    var hasRoot = (code === 47/*/*/);\n    var end = -1;\n    var matchedSlash = true;\n    for (var i = path.length - 1; i >= 1; --i) {\n      code = path.charCodeAt(i);\n      if (code === 47/*/*/) {\n        if (!matchedSlash) {\n          end = i;\n          break;\n        }\n      } else {\n        // We saw the first non-path separator\n        matchedSlash = false;\n      }\n    }\n\n    if (end === -1)\n      return hasRoot ? '/' : '.';\n    if (hasRoot && end === 1)\n      return '//';\n    return path.slice(0, end);\n  },\n\n\n  basename: function basename(path, ext) {\n    if (ext !== undefined && typeof ext !== 'string')\n      throw new TypeError('\"ext\" argument must be a string');\n    assertPath(path);\n\n    var start = 0;\n    var end = -1;\n    var matchedSlash = true;\n    var i;\n\n    if (ext !== undefined && ext.length > 0 && ext.length <= path.length) {\n      if (ext.length === path.length && ext === path)\n        return '';\n      var extIdx = ext.length - 1;\n      var firstNonSlashEnd = -1;\n      for (i = path.length - 1; i >= 0; --i) {\n        var code = path.charCodeAt(i);\n        if (code === 47/*/*/) {\n          // If we reached a path separator that was not part of a set of path\n          // separators at the end of the string, stop now\n          if (!matchedSlash) {\n            start = i + 1;\n            break;\n          }\n        } else {\n          if (firstNonSlashEnd === -1) {\n            // We saw the first non-path separator, remember this index in case\n            // we need it if the extension ends up not matching\n            matchedSlash = false;\n            firstNonSlashEnd = i + 1;\n          }\n          if (extIdx >= 0) {\n            // Try to match the explicit extension\n            if (code === ext.charCodeAt(extIdx)) {\n              if (--extIdx === -1) {\n                // We matched the extension, so mark this as the end of our path\n                // component\n                end = i;\n              }\n            } else {\n              // Extension does not match, so our result is the entire path\n              // component\n              extIdx = -1;\n              end = firstNonSlashEnd;\n            }\n          }\n        }\n      }\n\n      if (start === end)\n        end = firstNonSlashEnd;\n      else if (end === -1)\n        end = path.length;\n      return path.slice(start, end);\n    } else {\n      for (i = path.length - 1; i >= 0; --i) {\n        if (path.charCodeAt(i) === 47/*/*/) {\n          // If we reached a path separator that was not part of a set of path\n          // separators at the end of the string, stop now\n          if (!matchedSlash) {\n            start = i + 1;\n            break;\n          }\n        } else if (end === -1) {\n          // We saw the first non-path separator, mark this as the end of our\n          // path component\n          matchedSlash = false;\n          end = i + 1;\n        }\n      }\n\n      if (end === -1)\n        return '';\n      return path.slice(start, end);\n    }\n  },\n\n\n  extname: function extname(path) {\n    assertPath(path);\n    var startDot = -1;\n    var startPart = 0;\n    var end = -1;\n    var matchedSlash = true;\n    // Track the state of characters (if any) we see before our first dot and\n    // after any path separator we find\n    var preDotState = 0;\n    for (var i = path.length - 1; i >= 0; --i) {\n      var code = path.charCodeAt(i);\n      if (code === 47/*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          startPart = i + 1;\n          break;\n        }\n        continue;\n      }\n      if (end === -1) {\n        // We saw the first non-path separator, mark this as the end of our\n        // extension\n        matchedSlash = false;\n        end = i + 1;\n      }\n      if (code === 46/*.*/) {\n        // If this is our first dot, mark it as the start of our extension\n        if (startDot === -1)\n          startDot = i;\n        else if (preDotState !== 1)\n          preDotState = 1;\n      } else if (startDot !== -1) {\n        // We saw a non-dot and non-path separator before our dot, so we should\n        // have a good chance at having a non-empty extension\n        preDotState = -1;\n      }\n    }\n\n    if (startDot === -1 ||\n        end === -1 ||\n        // We saw a non-dot character immediately before the dot\n        preDotState === 0 ||\n        // The (right-most) trimmed path component is exactly '..'\n        (preDotState === 1 &&\n         startDot === end - 1 &&\n         startDot === startPart + 1)) {\n      return '';\n    }\n    return path.slice(startDot, end);\n  },\n\n\n  format: function format(pathObject) {\n    if (pathObject === null || typeof pathObject !== 'object') {\n      throw new TypeError(\n        'Parameter \"pathObject\" must be an object, not ' + typeof(pathObject)\n      );\n    }\n    return _format('/', pathObject);\n  },\n\n\n  parse: function parse(path) {\n    assertPath(path);\n\n    var ret = { root: '', dir: '', base: '', ext: '', name: '' };\n    if (path.length === 0)\n      return ret;\n    var code = path.charCodeAt(0);\n    var isAbsolute = (code === 47/*/*/);\n    var start;\n    if (isAbsolute) {\n      ret.root = '/';\n      start = 1;\n    } else {\n      start = 0;\n    }\n    var startDot = -1;\n    var startPart = 0;\n    var end = -1;\n    var matchedSlash = true;\n    var i = path.length - 1;\n\n    // Track the state of characters (if any) we see before our first dot and\n    // after any path separator we find\n    var preDotState = 0;\n\n    // Get non-dir info\n    for (; i >= start; --i) {\n      code = path.charCodeAt(i);\n      if (code === 47/*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          startPart = i + 1;\n          break;\n        }\n        continue;\n      }\n      if (end === -1) {\n        // We saw the first non-path separator, mark this as the end of our\n        // extension\n        matchedSlash = false;\n        end = i + 1;\n      }\n      if (code === 46/*.*/) {\n        // If this is our first dot, mark it as the start of our extension\n        if (startDot === -1)\n          startDot = i;\n        else if (preDotState !== 1)\n          preDotState = 1;\n      } else if (startDot !== -1) {\n        // We saw a non-dot and non-path separator before our dot, so we should\n        // have a good chance at having a non-empty extension\n        preDotState = -1;\n      }\n    }\n\n    if (startDot === -1 ||\n        end === -1 ||\n        // We saw a non-dot character immediately before the dot\n        preDotState === 0 ||\n        // The (right-most) trimmed path component is exactly '..'\n        (preDotState === 1 &&\n         startDot === end - 1 &&\n         startDot === startPart + 1)) {\n      if (end !== -1) {\n        if (startPart === 0 && isAbsolute)\n          ret.base = ret.name = path.slice(1, end);\n        else\n          ret.base = ret.name = path.slice(startPart, end);\n      }\n    } else {\n      if (startPart === 0 && isAbsolute) {\n        ret.name = path.slice(1, startDot);\n        ret.base = path.slice(1, end);\n      } else {\n        ret.name = path.slice(startPart, startDot);\n        ret.base = path.slice(startPart, end);\n      }\n      ret.ext = path.slice(startDot, end);\n    }\n\n    if (startPart > 0)\n      ret.dir = path.slice(0, startPart - 1);\n    else if (isAbsolute)\n      ret.dir = '/';\n\n    return ret;\n  },\n\n\n  sep: '/',\n  delimiter: ':',\n  posix: null\n};\n\n\nmodule.exports = posix;\n","import * as Util from '../core/Util';\nimport {Reader} from './Reader';\nimport * as epubjs from '../epubjs';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as Browser from '../core/Browser';\n\nimport path from \"path-webpack\";\n\nReader.EpubJS = Reader.extend({\n\n  initialize: function(id, options) {\n    Reader.prototype.initialize.apply(this, arguments);\n    this._epubjs_ready = false;\n    window.xpath = path;\n  },\n\n  open: function(target, callback) {\n    var self = this;\n    if ( typeof(target) == 'function' ) {\n      callback = target;\n      target = undefined;\n    }\n    if ( callback == null ) {\n      callback = function() { };\n    }\n\n    // okay, we need to do some hacking to fetch the dang files\n    // but this isn't going to be done async\n    self.rootfiles = [];\n    var request = new XMLHttpRequest();\n    request.open('GET', this.options.href + \"/META-INF/container.xml\");\n    request.responseType = 'document';\n    request.onload = function() {\n      var containerDoc = request.responseXML;\n      var rootfiles = containerDoc.querySelectorAll(\"rootfile\");\n      if ( rootfiles.length > 1 ) {\n        console.log(\"AHOY ROOTFILES MULTIPLE RENDITIONS\", rootfiles.length);\n        for(var i = 0; i < rootfiles.length; i++) {\n          var rootfile = rootfiles[i];\n          var rootfilePath = rootfile.getAttribute('full-path');\n          var label = rootfile.getAttribute('rendition:label');\n          var layout = rootfile.getAttribute('rendition:layout');\n          self.rootfiles.push({\n            rootfilePath: rootfilePath,\n            label: label,\n            layout: layout\n          })\n        }\n      }\n    }\n    request.send();\n\n    this.options.rootfilePath = this.options.rootfilePath || sessionStorage.getItem('rootfilePath');\n\n    var book_href = this.options.href;\n    var book_options = { packagePath: this.options.rootfilePath };\n    if ( this.options.useArchive ) {\n      book_href = book_href.replace(/\\/(\\w+)\\/$/, '/$1/$1.sm.epub');\n      book_options.openAs = 'epub';\n    }\n    this._book = epubjs.ePub(book_href, book_options);\n    sessionStorage.removeItem('rootfilePath');\n    // this._book = epubjs.ePub(this.options.href);\n    this._book.loaded.navigation.then(function(toc) {\n      self._contents = toc;\n      self.metadata = self._book.package.metadata;\n      self.fire('updateContents', toc);\n      self.fire('updateTitle', self._book.package.metadata);\n    })\n    this._book.ready.then(function() {\n      self.draw(target, callback);\n      if ( self.metadata.layout == 'pre-paginated' ) {\n        // fake it with the spine\n        var locations = [];\n        self._book.spine.each(function(item) {\n          locations.push(`epubcfi(${item.cfiBase}!/4/2)`);\n          self.locations._locations.push(`epubcfi(${item.cfiBase}!/4/2)`);\n        });\n        self.locations.total = locations.length;\n        var t;\n        var f = function() {\n          if ( self._rendition && self._rendition.manager && self._rendition.manager.stage ) {\n            var location = self._rendition.currentLocation();\n            if ( location && location.start) {\n              self.fire('updateLocations', locations);\n              clearTimeout(t);\n              return;\n            }\n          }\n          t = setTimeout(f, 100);\n        }\n\n        t = setTimeout(f, 100);\n      } else {\n        self._book.locations.generate(1600).then(function(locations) {\n          // console.log(\"AHOY WUT\", locations);\n          self.fire('updateLocations', locations);\n        })\n      }\n    })\n    // .then(callback);\n  },\n\n  draw: function(target, callback) {\n    var self = this;\n\n    if ( self._rendition ) {\n      // self._unbindEvents();\n      var container = self._rendition.manager.container;\n      Object.keys(self._rendition.hooks).forEach(function(key) {\n        console.log(\"AHOY draw clearing\", key);\n        self._rendition.hooks[key].clear();\n      })\n      self._rendition.destroy();\n      self._rendition = null;\n    }\n\n    this.settings = { flow: this.options.flow };\n    this.settings.manager = this.options.manager || 'default';\n\n    if ( this.settings.flow == 'auto' && this.metadata.layout == 'pre-paginated' ) {\n      // dumb check to see if the window is _tall_ enough to put\n      // two pages side by side\n      if ( this._container.offsetHeight <= this.options.forceScrolledDocHeight ) {\n        this.settings.flow = 'scrolled-doc';\n        this.settings.manager = 'prepaginated';\n      }\n    }\n\n    if ( this.settings.flow == 'auto' || this.settings.flow == 'paginated' ) {\n      this._panes['epub'].style.overflow = 'hidden';\n      this.settings.manager = 'default';\n    } else {\n      this._panes['epub'].style.overflow = 'auto';\n      if ( this.settings.manager == 'default' ) {\n        this.settings.manager = 'continuous';\n      }\n    }\n\n    if ( ! callback ) {\n      callback = function() { };\n    }\n\n    if ( this.metadata.layout == 'pre-paginated' && this.settings.manager == 'continuous' ) {\n        this.settings.manager = 'prepaginated';\n    }\n\n    if ( this.settings.manager == 'prepaginated' ) {\n      this.settings.spread = 'none';\n    }\n\n    // would pre-paginated work better if we scaled the default view from the start? maybe?\n    if ( false && this.metadata.layout == 'pre-paginated' && this.settings.manager == 'default' ) {\n      this.settings.spread = 'none';\n      this._panes['epub'].style.overflow = 'auto';\n    }\n\n    self.settings.height = '100%';\n    self.settings.width = '100%';\n    self.settings['ignoreClass'] = 'annotator-hl';\n\n    if ( self.options.scale != '100' ) {\n      self.settings.scale = parseInt(self.options.scale, 10) / 100;\n    }\n\n    self._panes['book'].dataset.manager = this.settings.manager + ( this.settings.spread ? `-${this.settings.spread}` : '');\n\n    self._drawRendition(target, callback);\n  },\n\n  _drawRendition: function(target, callback) {\n    var self = this;\n\n    self._rendition = self._book.renderTo(self._panes['epub'], self.settings);\n    self._updateFontSize();\n    self._bindEvents();\n    self._drawn = true;\n\n    // if ( this.metadata.layout == 'pre-paginated' && this.settings.manager == 'prepaginated' ) {\n    //   this._panes['epub'].style.overflowX = 'hidden';\n    // }\n\n    var status_index = 0;\n    self._rendition.on('started', function() {\n\n      //var t;\n      //t = setInterval(function() {\n      //  if ( self._rendition.manager.stage && self.metadata.layout == 'pre-paginated' && self.settings.manager == 'default' ) {\n      //    self._rendition.manager.scale(1.75);\n      //    clearInterval(t)\n      // }\n      //}, 100);\n\n      self._rendition.manager.on(\"building\", function(status) {\n        if ( status ) {\n          status_index += 1;\n          self._panes['loader-status'].innerHTML = `<span>${Math.round((status_index / status.total) * 100.0)}%</span>`;\n        } else {\n          self._enableBookLoader(-1);\n        }\n      })\n      self._rendition.manager.on(\"built\", function() {\n        console.log(\"AHOY manager built\");\n        self._disableBookLoader(true);\n      })\n    })\n    // self._rendition.on('attached', attached_callback)\n\n    self._rendition.hooks.content.register(function(contents) {\n      self.fire('ready:contents', contents);\n      self.fire('readyContents', contents);\n      contents.document.addEventListener('keydown', (event) => {\n        const keyName = event.key;\n        self.fire('keyDown', { keyName: keyName, shiftKey: event.shiftKey, inner: true });\n        console.log('inner keydown event: ', keyName);\n      });\n    })\n\n    if ( target && target.start ) { target = target.start; }\n    if ( ! target && window.location.hash ) {\n      if ( window.location.hash.substr(1, 3) == '/6/' ) {\n        target = \"epubcfi(\" + window.location.hash.substr(1) + \")\";\n      } else {\n        target = window.location.hash.substr(2);\n        target = self._book.url.path().resolve(target);\n      }\n    }\n\n    self.gotoPage(target, function() {\n      window._loaded = true;\n      self._initializeReaderStyles();\n\n      if ( callback ) { callback(); }\n\n      self._epubjs_ready = true;\n\n      setTimeout(function() {\n        self.fire('opened');\n        self.fire('ready');\n        clearTimeout(self._queueTimeout);\n        self.tracking.event(\"openBook\", {\n          rootFilePath: self.options.rootFilePath,\n          flow: self.settings.flow,\n          manager: self.settings.manager\n        });\n      }, 100);\n\n    })\n  },\n\n  _scroll: function(delta) {\n    var self = this;\n    if ( self.options.flow == 'XXscrolled-doc' ) {\n      var container = self._rendition.manager.container;\n      var rect = container.getBoundingClientRect();\n      var scrollTop = container.scrollTop;\n      var newScrollTop = scrollTop;\n      var scrollBy = ( rect.height * 0.98 );\n      switch(delta) {\n        case 'PREV':\n          newScrollTop = -( scrollTop + scrollBy );\n          break;\n        case 'NEXT':\n          newScrollTop = ( scrollTop + scrollBy );\n          break;\n        case 'HOME':\n          newScrollTop = 0;\n          break;\n        case 'END':\n          newScrollTop = container.scrollHeight - scrollBy;\n          break;\n      }\n      container.scrollTop = newScrollTop;\n      return ( Math.floor(container.scrollTop) != Math.floor(scrollTop) );\n    }\n    return false;\n  },\n\n  _navigate: function(promise, callback) {\n    var self = this;\n    self._enableBookLoader(100);\n    promise.then(function() {\n      console.log(\"AHOY NAVIGATE FIN\");\n      self._disableBookLoader();\n      if ( callback ) { callback(); }\n    }).catch(function(e) {\n      self._disableBookLoader();\n      if ( callback ) { callback(); }\n      console.log(\"AHOY NAVIGATE ERROR\", e);\n      throw(e);\n    })\n  },\n\n  next: function() {\n    var self = this;\n    this.tracking.action('reader/go/next');\n    self._scroll('NEXT') || self._navigate(this._rendition.next());\n  },\n\n  prev: function() {\n    this.tracking.action('reader/go/previous');\n    this._scroll('PREV') || this._navigate(this._rendition.prev());\n  },\n\n  first: function() {\n    this.tracking.action('reader/go/first');\n    this._navigate(this._rendition.display(0), undefined);\n  },\n\n  last: function() {\n    var self = this;\n    this.tracking.action('reader/go/last');\n    var target = this._book.spine.length - 1;\n    this._navigate(this._rendition.display(target), undefined);\n  },\n\n  gotoPage: function(target, callback) {\n    if ( target != null ) {\n      var section = this._book.spine.get(target);\n      if ( ! section) {\n        // maybe it needs to be resolved\n        var guessed = target;\n        if ( guessed.indexOf(\"://\") < 0 ) {\n          var path1 = path.resolve(this._book.path.directory, this._book.package.navPath);\n          var path2 = path.resolve(path.dirname(path1), target);\n          guessed = this._book.canonical(path2);\n        }\n        if ( guessed.indexOf(\"#\") !== 0 ) {\n          guessed = guessed.split('#')[0];\n        }\n\n        this._book.spine.each(function(item) {\n          if ( item.canonical == guessed ) {\n            section = item;\n            target = section.href;\n            return;\n          }\n        })\n\n        console.log(\"AHOY GUESSED\", target);\n      } else if ( target.toString().match(/^\\d+$/) ) {\n        console.log(\"AHOY USING\", section.href);\n        target = section.href;\n      }\n\n      if ( ! section ) {\n        if ( ! this._epubjs_ready ) {\n          target = 0;\n        } else {\n          return;\n        }\n      }\n    }\n\n    console.log(\"AHOY gotoPage\", target);\n\n    var navigating = this._rendition.display(target).then(function() {\n      this._rendition.display(target);\n    }.bind(this));\n    this._navigate(navigating, callback);\n  },\n\n  percentageFromCfi: function(cfi) {\n    return this._book.percentageFromCfi(cfi);\n  },\n\n  destroy: function() {\n    if ( this._rendition ) {\n      try {\n        this._rendition.destroy();\n      } catch(e) {}\n    }\n    this._rendition = null;\n    this._drawn = false;\n  },\n\n  reopen: function(options, target) {\n    // different per reader?\n    var target = target || this.currentLocation();\n    if( target.start ) { target = target.start ; }\n    if ( target.cfi ) { target = target.cfi ; }\n\n    var doUpdate = false;\n    if ( options === true ) { doUpdate = true; options = {}; }\n    var changed = {};\n    Object.keys(options).forEach(function(key) {\n      if ( options[key] != this.options[key] ) {\n        doUpdate = true;\n        changed[key] = true;\n      }\n      // doUpdate = doUpdate || ( options[key] != this.options[key] );\n    }.bind(this));\n\n    if ( ! doUpdate ) {\n      return;\n    }\n\n    // performance hack\n    if ( Object.keys(changed).length == 1 && changed.scale ) {\n      reader.options.scale = options.scale;\n      this._updateScale();\n      return;\n    }\n\n    if ( options.rootfilePath && options.rootfilePath != this.options.rootfilePath ) {\n      // we need to REOPEN THE DANG BOOK\n      sessionStorage.setItem('rootfilePath', options.rootfilePath);\n      location.reload();\n      return;\n    }\n\n    Util.extend(this.options, options);\n\n    this.draw(target, function() {\n      this._updateFontSize();\n      this._updateScale();\n      this._updateTheme();\n      this._selectTheme(true);\n    }.bind(this))\n  },\n\n  currentLocation: function() {\n    if ( this._rendition && this._rendition.manager ) {\n      this._cached_location = this._rendition.currentLocation();\n    }\n    return this._cached_location;\n  },\n\n  _bindEvents: function() {\n    var self = this;\n\n    // add a stylesheet to stop images from breaking their columns\n    var add_max_img_styles = false;\n    if ( this._book.package.metadata.layout == 'pre-paginated' ) {\n      // NOOP\n    } else if ( this.options.flow == 'auto' || this.options.flow == 'paginated' ) {\n      add_max_img_styles = true;\n    }\n\n    var custom_stylesheet_rules = [];\n\n    // force 90% height instead of default 60%\n    if ( this.metadata.layout != 'pre-paginated' ) {\n      this._rendition.hooks.content.register(function(contents) {\n        contents.addStylesheetRules({\n          \"img\" : {\n            \"max-width\": (this._layout.columnWidth ? this._layout.columnWidth + \"px\" : \"100%\") + \"!important\",\n            \"max-height\": (this._layout.height ? (this._layout.height * 0.9) + \"px\" : \"90%\") + \"!important\",\n            \"object-fit\": \"contain\",\n            \"page-break-inside\": \"avoid\"\n          },\n          \"svg\" : {\n            \"max-width\": (this._layout.columnWidth ? this._layout.columnWidth + \"px\" : \"100%\") + \"!important\",\n            \"max-height\": (this._layout.height ? (this._layout.height * 0.9) + \"px\" : \"90%\") + \"!important\",\n            \"page-break-inside\": \"avoid\"\n          }\n        });\n      }.bind(this._rendition))\n    } else {\n      this._rendition.hooks.content.register(function(contents) {\n        contents.addStylesheetRules({\n          \"img\" : {\n            // \"border\": \"64px solid black !important\",\n            \"box-sizing\": \"border-box !important\"\n          },\n          \"figure\": {\n            \"box-sizing\": \"border-box !important\",\n            \"margin\": \"0 !important\"\n          }\n        });\n      }.bind(this._rendition));\n    }\n\n    this._updateFontSize();\n\n    if ( custom_stylesheet_rules.length ) {\n      this._rendition.hooks.content.register(function(view) {\n        view.addStylesheetRules(custom_stylesheet_rules);\n      })\n    }\n\n    this._rendition.on('resized', function(box) {\n      self.fire('resized', box);\n    })\n\n    this._rendition.on('relocated', function(location) {\n      self.fire('relocated', location);\n    })\n\n    this._rendition.on('displayerror', function(err) {\n      console.log(\"AHOY RENDITION DISPLAY ERROR\", err);\n    })\n\n    this._rendition.on(\"locationChanged\", function(location) {\n      var view = this.manager.current();\n      var section = view.section;\n      var current = this.book.navigation.get(section.href);\n\n      self.fire(\"updateSection\", current);\n      self.fire(\"updateLocation\", location);\n      // self.fire(\"relocated\", location);\n    });\n\n    this._rendition.on(\"rendered\", function(section, view) {\n\n      if ( view.contents ) {\n        // view.contents.on(\"xxlinkClicked\", function(href) {\n        //   console.log(\"AHOY CLICKED\", href);\n        //   var tmp = href.split(\"#\");\n        //   href = tmp[0];\n        //   var hash = tmp[1]\n        //   // var current = self.currentLocation().start.href;\n        //   // var section = self._book.spine.get(current.href);\n        //   console.log(\"AHOY CLICKED CHECK\", section.canonical, href);\n        //   if ( section.canonical.indexOf(href) < 0 ) {\n        //     self.gotoPage(href);\n        //     // self._rendition.display(href);\n\n        //   } else if ( hash ) {\n        //     // we're already on this page, so we need to scroll to this location\n        //     var node = view.contents.content.querySelector('#' + hash);\n        //     console.log(\"AHOY INTERNAL\", hash, view.contents, node);\n        //   }\n        //   // self._rendition.display(href);\n        // })\n      }\n\n      if(false) {\n        if ( ! self._rendition.manager.container.dataset.__scroll ) {\n          var ticking;\n          self._rendition.manager.container.addEventListener(\"scroll\", function(event) {\n            if ( self._rendition && self._rendition.manager ) {\n              var container = self._rendition.manager.container;\n              var mod = container.scrollLeft % parseInt(self._rendition.manager.layout.delta, 10);\n              console.log(\"AHOY DETECTED SCROLL\", mod, mod / self._rendition.manager.layout.delta);\n            }\n          });\n          self._rendition.manager.container.dataset.__scroll = true;\n        }\n      }\n\n      self.on('keyDown', function(data) {\n        if ( data.keyName == 'Tab' && data.inner ) {\n          var container = self._rendition.manager.container;\n          var mod;\n          var delta;\n          var x; var xyz;\n          setTimeout(function() {\n            var scrollLeft = container.scrollLeft;\n            mod = scrollLeft % parseInt(self._rendition.manager.layout.delta, 10);\n            if ( mod > 0 && ( mod / self._rendition.manager.layout.delta ) < 0.99 ) {\n              // var x = Math.floor(event.target.scrollLeft / parseInt(self._rendition.manager.layout.delta, 10)) + 1;\n              // var delta = ( x * self._rendition.manager.layout.delta) - event.target.scrollLeft;\n              x = Math.floor(container.scrollLeft / parseInt(self._rendition.manager.layout.delta, 10));\n              if ( data.shiftKey ) { x -= 0 ; }\n              else { x += 1; }\n              var y = container.scrollLeft;\n              delta = ( x * self._rendition.manager.layout.delta ) - y;\n              xyz = ( x * self._rendition.manager.layout.delta );\n              // if ( data.shiftKey ) { delta *= -1 ; }\n              if ( true || ! data.shiftKey ) {\n                self._rendition.manager.scrollBy(delta);\n              }\n            }\n            console.log(\"AHOY DOING THE SCROLLING\", data.shiftKey, scrollLeft, mod, x, xyz, delta);\n          }, 0);\n        }\n      })\n\n\n    })\n  },\n\n  _initializeReaderStyles: function() {\n    var self = this;\n    var themes = this.options.themes;\n    if ( themes ) {\n      themes.forEach(function(theme) {\n        self._rendition.themes.register(theme['klass'], theme.href ? theme.href : theme.rules);\n      })\n    }\n\n    // base for highlights\n    this._rendition.themes.override('.epubjs-hl', \"fill: yellow; fill-opacity: 0.3; mix-blend-mode: multiply;\");\n  },\n\n  _selectTheme: function(refresh) {\n    var theme = this.options.theme || 'default';\n    this._rendition.themes.select(theme);\n    if ( 0 && refresh ) {\n      var cfi = this.currentLocation().end.cfi;\n      this._rendition.manager.clear();\n      console.log(\"AHOY\", cfi);\n      this._rendition.display(cfi);\n    }\n  },\n\n  _updateFontSize: function() {\n    var text_size = this.options.text_size == 'auto' ? 100 : this.options.text_size;\n    this._rendition.themes.fontSize(`${text_size}%`);\n    // if ( this.options.text_size == 'large' ) {\n    //   this._rendition.themes.fontSize(this.options.fontSizeLarge);\n    // } else if ( this.options.text_size == 'small' ) {\n    //   this._rendition.themes.fontSize(this.options.fontSizeSmall);\n    // } else {\n    //   this._rendition.themes.fontSize(this.options.fontSizeDefault);\n    // }\n  },\n\n  _updateScale: function() {\n    var scale = this.options.scale;\n    if ( scale ) {\n      scale = parseInt(scale, 10) / 100.0;\n      this._rendition.scale(scale);\n    }\n  },\n\n  EOT: true\n\n})\n\nObject.defineProperty(Reader.EpubJS.prototype, 'metadata', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    return this._metadata;\n  },\n\n  set: function(data) {\n    this._metadata = Util.extend({}, data, this.options.metadata);\n  }\n});\n\nObject.defineProperty(Reader.EpubJS.prototype, 'annotations', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    if ( Browser.ie ) {\n      return {\n        reset: function() { /* NOOP */ },\n        highlight: function(cfiRange) { /* NOOP */ }\n      }\n    }\n    if ( ! this._rendition.annotations.reset ) {\n      this._rendition.annotations.reset = function(){\n        for(var hash in this._annotations) {\n            var cfiRange = decodeURI(hash);\n            this.remove(cfiRange);\n        }\n        this._annotationsBySectionIndex = {};\n      }.bind(this._rendition.annotations);\n    }\n    return this._rendition.annotations;\n  }\n});\n\nObject.defineProperty(Reader.EpubJS.prototype, 'locations', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    return this._book.locations;\n  }\n});\n\nwindow.Reader = Reader;\n\nexport function createReader(id, options) {\n  return new Reader.EpubJS(id, options);\n}\n","import * as Util from '../core/Util';\nimport {Reader} from './Reader';\nimport * as DomUtil from '../dom/DomUtil';\n\nReader.Mock = Reader.extend({\n\n  initialize: function(id, options) {\n    Reader.prototype.initialize.apply(this, arguments);\n  },\n\n  open: function(target, callback) {\n    var self = this;\n    this._book = {\n      metadata: {\n        title: 'The Mock Life',\n        creator: 'Alex Mock',\n        publisher: 'University Press',\n        location: 'Ann Arbor, MI',\n        pubdate: '2017-05-23'\n      },\n      contents: {\n        toc: [\n          {id: 1, href: \"/epubs/mock/ops/xhtml/TitlePage.xhtml\", label: \"Title\", parent: null},\n          {id: 2, href: \"/epubs/mock/ops/xhtml/Chapter01.xhtml\", label: \"Chapter 1\", parent: null},\n          {id: 3, href: \"/epubs/mock/ops/xhtml/Chapter02.xhtml\", label: \"Chapter 2\", parent: null},\n          {id: 4, href: \"/epubs/mock/ops/xhtml/Chapter03.xhtml\", label: \"Chapter 3\", parent: null},\n          {id: 5, href: \"/epubs/mock/ops/xhtml/Chapter04.xhtml\", label: \"Chapter 4\", parent: null},\n          {id: 6, href: \"/epubs/mock/ops/xhtml/Chapter05.xhtml\", label: \"Chapter 5\", parent: null},\n          {id: 7, href: \"/epubs/mock/ops/xhtml/Chapter06.xhtml\", label: \"Chapter 6\", parent: null},\n          {id: 8, href: \"/epubs/mock/ops/xhtml/Chapter07.xhtml\", label: \"Chapter 7\", parent: null},\n          {id: 9, href: \"/epubs/mock/ops/xhtml/Index.xhtml\", label: \"Index\", parent: null},\n        ]\n      }\n    };\n\n    this._locations = [\n      'epubcfi(/6/4[TitlePage.xhtml])',\n      'epubcfi(/6/4[Chapter01.xhtml])',\n      'epubcfi(/6/4[Chapter02.xhtml])',\n      'epubcfi(/6/4[Chapter03.xhtml])',\n      'epubcfi(/6/4[Chapter04.xhtml])',\n      'epubcfi(/6/4[Chapter05.xhtml])',\n      'epubcfi(/6/4[Chapter06.xhtml])',\n      'epubcfi(/6/4[Chapter07.xhtml])',\n      'epubcfi(/6/4[Chapter08.xhtml])',\n      'epubcfi(/6/4[Index.xhtml])',\n    ];\n\n    this.__currentIndex = 0;\n\n    this.metadata = this._book.metadata;\n    this.fire('updateContents', this._book.contents);\n    this.fire('updateTitle', this._metadata);\n    this.fire('updateLocations', this._locations);\n    this.draw(target, callback);\n  },\n\n  draw: function(target, callback) {\n    var self = this;\n    this.settings = { flow: this.options.flow };\n    this.settings.height = '100%';\n    this.settings.width = '99%';\n    // this.settings.width = '100%';\n    if ( this.options.flow == 'auto' ) {\n      this._panes['book'].style.overflow = 'hidden';\n    } else {\n      this._panes['book'].style.overflow = 'auto';\n    }\n    if ( typeof(target) == 'function' && cb === undefined ) {\n      callback = target;\n      target = undefined;\n    }\n    callback();\n    self.fire('ready');\n  },\n\n  next: function() {\n    // this._rendition.next();\n  },\n\n  prev: function() {\n    // this._rendition.prev();\n  },\n\n  first: function() {\n    // this._rendition.display(0);\n  },\n\n  last: function() {\n  },\n\n  gotoPage: function(target) {\n    if ( typeof(target) == \"string\" ) {\n      this.__currentIndex = this._locations.indexOf(target);\n    } else {\n      this.__currentIndex = target;\n    }\n    this.fire(\"relocated\", this.currentLocation());\n  },\n\n  destroy: function() {\n    // if ( this._rendition ) {\n    //   this._rendition.destroy();\n    // }\n    // this._rendition = null;\n  },\n\n  currentLocation: function() {\n    var cfi = this._locations[this.__currentIndex];\n    return {\n      start: { cfi: cfi, href: cfi },\n      end: { cfi: cfi, href: cfi }\n    }\n  },\n\n  _bindEvents: function() {\n    var self = this;\n\n  },\n\n  _updateTheme: function() {\n\n  },\n\n  EOT: true\n\n})\n\nObject.defineProperty(Reader.Mock.prototype, 'metadata', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    return this._metadata;\n  },\n\n  set: function(data) {\n    this._metadata = Util.extend({}, data, this.options.metadata);\n  }\n});\n\nObject.defineProperty(Reader.Mock.prototype, 'locations', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    var self = this;\n    return {\n      total: self._locations.length,\n      locationFromCfi: function(cfi) {\n        return self._locations.indexOf(cfi);\n      },\n      percentageFromCfi: function(cfi) {\n        var index = self.locations.locationFromCfi(cfi);\n        return ( index / self.locations.total );\n      },\n      cfiFromPercentage: function(percentage) {\n        var index = Math.ceil(percentage * 10);\n        return self._locations[index];\n      }\n    }\n  }\n});\n\nObject.defineProperty(Reader.Mock.prototype, 'annotations', {\n  get: function() {\n    return {\n      reset: function() {},\n      highlight: function() {}\n    }\n  }\n})\n\nexport function createReader(id, options) {\n  return new Reader.Mock(id, options);\n}\n","import {Reader} from './Reader';\nimport * as EpubJS from './Reader.EpubJS';\nimport * as Mock from './Reader.Mock';\n\nvar engines = {\n  epubjs: EpubJS.createReader,\n  mock: Mock.createReader\n}\n\nexport var reader = function(id, options) {\n  options = options || {};\n  var engine = options.engine || window.COZY_EPUB_ENGINE || 'epubjs';\n  var engine_href = options.engine_href || window.COZY_EPUB_ENGINE_HREF;\n  var _this = this;\n  var _arguments = arguments;\n\n  options.engine = engine;\n  options.engine_href = engine_href;\n\n  return engines[engine].apply(_this, [id, options]);\n}"],"names":["global","this","extend","dest","i","j","len","src","arguments","length","create","Object","F","proto","prototype","bind","fn","obj","slice","Array","apply","call","args","concat","lastId","stamp","_cozy_id","throttle","time","context","lock","wrapperFn","later","wrapNum","x","range","includeMax","max","min","d","falseFn","formatNum","num","digits","pow","Math","round","isNumeric","isNaN","parseFloat","isFinite","trim","str","replace","splitWords","split","setOptions","options","hasOwnProperty","getParamString","existingUrl","uppercase","params","push","encodeURIComponent","toUpperCase","indexOf","join","templateRe","template","data","key","value","undefined","Error","isArray","toString","array","el","emptyImageUrl","getPrefixed","name","window","lastTime","timeoutDefer","Date","timeToCall","setTimeout","requestFn","requestAnimationFrame","cancelFn","cancelAnimationFrame","id","clearTimeout","requestAnimFrame","immediate","cancelAnimFrame","loader","url","handler","_resolved","callbacks","error","then","cb","resolve","catch","reject","_argv","shift","retval","e","log","trace","element","document","createElement","onload","onerror","async","parent","attr","appendChild","Class","props","NewClass","initialize","callInitHooks","parentProto","__super__","Util","constructor","statics","includes","_initHooks","_initHooksCalled","include","mergeOptions","addInitHook","init","checkDeprecatedMixinEvents","cozy","Mixin","Evented","types","type","_on","_events","_off","typeListeners","newListener","ctx","listeners","l","_firingCount","splice","propagate","listens","event","target","_propagateEvent","_eventParents","once","off","on","fire","layer","addEventListener","removeEventListener","clearAllEventListeners","addOneTimeEventListener","fireEvent","hasEventListeners","style","documentElement","ie","ielt9","edge","navigator","webkit","userAgentContains","android","android23","opera","chrome","gecko","safari","phantom","opera12","win","platform","ie3d","webkit3d","WebKitCSSMatrix","gecko3d","any3d","L_DISABLE_3D","mobile","orientation","mobileWebkit","mobileWebkit3d","msPointer","PointerEvent","MSPointerEvent","pointer","touch","L_NO_TOUCH","DocumentTouch","mobileOpera","mobileGecko","retina","devicePixelRatio","screen","deviceXDPI","logicalXDPI","canvas","getContext","svg","vml","div","innerHTML","shape","firstChild","behavior","babelHelpers.typeof","adj","columnCount","classList","userAgent","toLowerCase","Point","y","point","clone","_add","toPoint","_subtract","_divideBy","_multiplyBy","_round","_floor","floor","_ceil","ceil","sqrt","abs","POINTER_DOWN","Browser","POINTER_MOVE","POINTER_UP","POINTER_CANCEL","TAG_WHITE_LIST","_pointers","_pointerDocListener","_pointersCount","addPointerListener","removePointerListener","_addPointerStart","onDown","pointerType","MSPOINTER_TYPE_MOUSE","tagName","_globalPointerDown","_globalPointerMove","_globalPointerUp","pointerId","_handlePointer","touches","changedTouches","_addPointerMove","onMove","buttons","_addPointerEnd","onUp","_touchstart","_touchend","_pre","addDoubleTapListener","last","doubleTap","delay","onTouchStart","count","now","delta","onTouchEnd","cancelBubble","newTouch","prop","removeDoubleTapListener","touchstart","touchend","dblclick","eventsKey","addOne","originalHandler","isExternalTarget","attachEvent","removeOne","detachEvent","stopPropagation","originalEvent","_stopped","disableScrollPropagation","disableClickPropagation","fakeStop","preventDefault","returnValue","stop","getMousePosition","container","clientX","clientY","rect","getBoundingClientRect","left","clientLeft","top","clientTop","wheelPxFactor","getWheelDelta","wheelDeltaY","deltaY","deltaMode","deltaX","deltaZ","wheelDelta","detail","skipEvents","skipped","events","related","relatedTarget","parentNode","err","lastClick","filterClick","timeStamp","elapsed","_simulatedClick","_simulated","Element","matches","ep","webkitMatchesSelector","msMatchesSelector","mozMatchesSelector","TRANSFORM","testProp","TRANSITION","TRANSITION_END","get","getElementById","getStyle","currentStyle","defaultView","css","getComputedStyle","className","remove","removeChild","empty","toFront","toBack","insertBefore","hasClass","contains","getClass","RegExp","test","addClass","classes","add","removeClass","setClass","baseVal","setOpacity","opacity","_setOpacityIE","filter","filterName","filters","item","Enabled","Opacity","isPropertySupported","setTransform","offset","scale","pos","setPosition","_leaflet_pos","getPosition","disableTextSelection","enableTextSelection","_userSelect","DomEvent","userSelectProperty","disableImageDrag","enableImageDrag","_outlineElement","_outlineStyle","preventOutline","tabIndex","outline","restoreOutline","freeGlobal","Symbol","root","symToStringTag","objectProto","nativeObjectToString","getRawTag","objectToString","isObject","baseGetTag","coreJsData","funcProto","funcToString","isMasked","isFunction","toSource","getValue","baseIsNative","defineProperty","getNative","eq","baseAssignValue","assignValue","nativeMax","identity","constant","shortOut","baseSetToString","setToString","overRest","isLength","MAX_SAFE_INTEGER","isArrayLike","isIndex","baseRest","isIterateeCall","isObjectLike","baseIsArguments","stubFalse","argsTag","funcTag","nodeUtil","baseUnary","baseIsTypedArray","isArguments","isBuffer","isTypedArray","baseTimes","overArg","isPrototype","nativeKeys","arrayLikeKeys","baseKeys","createAssigner","copyObject","keys","keyboardAllowed","val","fnMap","ret","eventNameMap","fullscreenchange","fullscreenerror","screenfull","elem","request","requestFullscreen","ALLOW_KEYBOARD_INPUT","exitFullscreen","isFullscreen","exit","callback","eventName","defineProperties","Boolean","fullscreenElement","fullscreenEnabled","Reader","self","_original_document_title","title","localStorage","getItem","assign","JSON","parse","_checkFeatureCompatibility","metadata","_initContainer","_initLayout","themes","forEach","theme","href","klass","rules","rule","new_rule","_updateTheme","_initEvents","_mode","mode","js","engine_href","_start","_loaded","open","saved_options","flow","setItem","stringify","_container","dataset","index","back","forward","enabled","toggle","DomUtil","_onScroll","_containerId","_fadeAnimated","fadeAnimation","engine","position","_initPanes","panes","_panes","prefix","_initBookLoader","_targets","tracking","reader","_action","_last_location_start","_reader","v","pop","action","location","start","cfi","onOff","transform3DLimit","_onMoveEnd","location_href","_ignoreHistory","pageview","tmp_href","substr","pushState","percentage","p","isTrusted","state","gotoPage","keyName","check","activeElement","localName","parentElement","IGNORE_TARGETS","shiftKey","next","prev","_scroll","scrollTop","scrollLeft","keyCode","srcElement","_fireDOMEvent","targets","synth","_findEventTargets","isMarker","containerPoint","latLngToContainerPoint","getLatLng","mouseEventToContainerPoint","layerPoint","containerPointToLayerPoint","latlng","layerPointToLatLng","nonBubblingEvents","h","clientHeight","paddingTop","paddingBottom","w","clientWidth","paddingRight","paddingLeft","height","width","_drawn","_resizeRequest","_checkMobileDevice","text_size","_isMobile","mobileMediaQuery","matchMedia","_clearBookLoaderTimeout","_force_progress","_loader_timeout","display","force","loader_template","loaderTemplate","body","DOMParser","parseFromString","children","Control","_locked","_id","getTime","parseInt","random","region","removeControl","addControl","onAdd","getRegion","area","getControlRegion","onRemove","screenX","screenY","getContainer","focus","widget","direction","control","addTo","_controlContainer","parts","tmp","slug","panel","slot","childElement","_classify","_controlRegions","PageControl","_control","querySelector","_className","_createButton","_fill","html","label","_bindEvents","link","setAttribute","s","unit","_unit","PagePrevious","PageNext","PageFirst","first","PageLast","pageNext","pagePrevious","pageFirst","pageLast","activeModal","FOCUSABLE_ELEMENTS","ACTIONABLE_ELEMENTS","Modal","onShow","onClose","_initializedEvents","actions","handlers","panelHTML","main","button_cls","modal","onClick","onKeydown","onModalTransition","button_id","button","close","closeModal","removeEventListeners","_resize","setFocusToFirstNode","addEventListeners","showModal","offsetHeight","offsetWidth","fraction","header","footer","nodes","querySelectorAll","map","focusableNodes","getFocusableNodes","maintainFocus","closeAfterAction","hasAttribute","actionableNodes","getActionableNodes","click","did_match","selector","getAttribute","focusedItemIndex","Contents","defaultTemplate","_modal","activate","_setupSkipLink","_process","items","tabindex","option","_createOption","subitems","toc","chapter","anchor","textContent","span","skipLink","ul","contents","Title","h1","_title","_divider","_section","bookTitle","PublicationMetadata","_publisher","_rights","publisher","rights","publicationMetadata","Preferences","_activated","updatePreferences","initializeForm","possible_fieldsets","layout","rootfiles","hasThemes","_fieldsets","cls","fieldset","fields","hasFields","field","inputs","input","checked","hint","_form","_createPanel","doUpdate","new_options","saveable_options","updateForm","deactivate","saveOptions","reopen","Fieldset","_current","TextSize","form","_input","_output","_preview","_updatePreview","saveable","fontSize","Display","scrolled_help","Theme","Rendition","rootfilePath","expr","rootfile","accessMode","Scale","_actionReset","transform","preferences","Widget","_onAddExtra","_updateTemplate","_updateClass","node","Button","Panel","Toggle","states","stateName","_resetState","_state","Citation","designMode","formatted","createRange","selectNode","sel","getSelection","removeAllRanges","addRange","flag","execCommand","_message","detach","citations","citation","format","text","createTextNode","_formatted","_initializeForm","_formatCitation","selected","Search","_data","_canceled","_processing","_article","searchString","openModalResults","openModalWaiting","submitQuery","_emptyArticle","_buildResults","searchUrl","XMLHttpRequest","status","response","send","hasChildNodes","lastChild","content","annotations","reset","highlight","highlight_off","search_results","result","cfiRange","snippet","chapterTitle","search","BibliographicInformation","dl","metadata_fields","metadata_fields_seen","idx","_formatDate","dt","dd","match","bibliographicInformation","Download","_configureDownloadForm","submit","download_links","size","download","Navigator","_setup","locations","_initializeNavigator","_createControl","_background","_status","_spanCurrentPercentage","_spanCurrentLocation","_spanTotalLocations","_update","_mouseDown","_initiated","percentageFromCfi","currentLocation","cfiFromPercentage","current","rangeBg","current_location","locationFromCfi","_last_delta","_last_value","_total","total","Bus","instance","bus","Events","ePub","require","EpubJS","_epubjs_ready","xpath","path","responseType","containerDoc","responseXML","sessionStorage","book_href","book_options","packagePath","useArchive","openAs","_book","epubjs","removeItem","loaded","navigation","_contents","package","ready","draw","spine","each","cfiBase","_locations","t","f","_rendition","manager","stage","generate","hooks","clear","destroy","settings","forceScrolledDocHeight","overflow","spread","_drawRendition","renderTo","_updateFontSize","status_index","_enableBookLoader","_disableBookLoader","register","inner","hash","_initializeReaderStyles","_queueTimeout","rootFilePath","newScrollTop","scrollBy","scrollHeight","promise","_navigate","section","guessed","path1","directory","navPath","path2","dirname","canonical","navigating","changed","_updateScale","reload","_selectTheme","_cached_location","add_max_img_styles","custom_stylesheet_rules","addStylesheetRules","_layout","columnWidth","view","box","book","mod","xyz","override","refresh","select","end","_metadata","_annotations","decodeURI","_annotationsBySectionIndex","createReader","Mock","__currentIndex","engines","COZY_EPUB_ENGINE","COZY_EPUB_ENGINE_HREF","_this","_arguments"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA,CAAC,SAAS,MAAM,EAAE;;;;;;;EAOhB,IAAI,0BAA0B,GAAG,WAAW;IAC1C,IAAI;MACF,OAAO,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC;KAC1B,CAAC,MAAM,KAAK,EAAE;MACb,OAAO,KAAK,CAAC;KACd;GACF,CAAC;;;EAGF,IAAI,iBAAiB,GAAG,0BAA0B,EAAE,CAAC;;EAErD,IAAI,cAAc,GAAG,SAAS,KAAK,EAAE;IACnC,IAAI,QAAQ,GAAG;MACb,IAAI,EAAE,WAAW;QACf,IAAI,KAAK,GAAG,KAAK,CAAC,KAAK,EAAE,CAAC;QAC1B,OAAO,EAAE,IAAI,EAAE,KAAK,KAAK,KAAK,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC;OACjD;KACF,CAAC;;IAEF,GAAG,iBAAiB,EAAE;MACpB,QAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,WAAW;QACrC,OAAO,QAAQ,CAAC;OACjB,CAAC;KACH;;IAED,OAAO,QAAQ,CAAC;GACjB,CAAC;;;;;;EAMF,IAAI,cAAc,GAAG,SAAS,KAAK,EAAE;IACnC,OAAO,kBAAkB,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;GACvD,CAAC;;EAEF,IAAI,gBAAgB,GAAG,SAAS,KAAK,EAAE;IACrC,OAAO,kBAAkB,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;GACtD,CAAC;;EAEF,IAAI,uBAAuB,EAAE,WAAW;;IAEtC,IAAI,eAAe,GAAG,SAAS,YAAY,EAAE;MAC3C,MAAM,CAAC,cAAc,CAAC,IAAI,EAAE,UAAU,EAAE,EAAE,KAAK,EAAE,EAAE,EAAE,CAAC,CAAC;;MAEvD,GAAG,OAAO,YAAY,KAAK,QAAQ,EAAE;QACnC,GAAG,YAAY,KAAK,EAAE,EAAE;UACtB,YAAY,GAAG,YAAY,CAAC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;UAC/C,IAAI,UAAU,GAAG,YAAY,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;UACzC,IAAI,SAAS,CAAC;UACd,IAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACzC,SAAS,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YACrC,IAAI,CAAC,MAAM;cACT,gBAAgB,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;cAC9B,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,IAAI,gBAAgB,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE;aAC7D,CAAC;WACH;SACF;OACF,MAAM,GAAG,YAAY,YAAY,eAAe,EAAE;QACjD,IAAI,KAAK,GAAG,IAAI,CAAC;QACjB,YAAY,CAAC,OAAO,CAAC,SAAS,KAAK,EAAE,IAAI,EAAE;UACzC,KAAK,CAAC,MAAM,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;SAC3B,CAAC,CAAC;OACJ;KACF,CAAC;;IAEF,IAAI,KAAK,GAAG,eAAe,CAAC,SAAS,CAAC;;IAEtC,KAAK,CAAC,MAAM,GAAG,SAAS,IAAI,EAAE,KAAK,EAAE;MACnC,GAAG,IAAI,IAAI,IAAI,CAAC,QAAQ,EAAE;QACxB,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,CAAC;OAC5C,MAAM;QACL,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,CAAC;OAC1C;KACF,CAAC;;IAEF,KAAK,CAAC,MAAM,GAAG,SAAS,IAAI,EAAE;MAC5B,OAAO,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;KAC5B,CAAC;;IAEF,KAAK,CAAC,GAAG,GAAG,SAAS,IAAI,EAAE;MACzB,OAAO,CAAC,IAAI,IAAI,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC;KAChE,CAAC;;IAEF,KAAK,CAAC,MAAM,GAAG,SAAS,IAAI,EAAE;MAC5B,OAAO,CAAC,IAAI,IAAI,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC;KACpE,CAAC;;IAEF,KAAK,CAAC,GAAG,GAAG,SAAS,IAAI,EAAE;MACzB,QAAQ,IAAI,IAAI,IAAI,CAAC,QAAQ,EAAE;KAChC,CAAC;;IAEF,KAAK,CAAC,GAAG,GAAG,SAAS,IAAI,EAAE,KAAK,EAAE;MAChC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,CAAC;KAC1C,CAAC;;IAEF,KAAK,CAAC,OAAO,GAAG,SAAS,QAAQ,EAAE,OAAO,EAAE;MAC1C,IAAI,OAAO,CAAC;MACZ,IAAI,IAAI,IAAI,IAAI,IAAI,CAAC,QAAQ,EAAE;QAC7B,GAAG,IAAI,CAAC,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE;UACrC,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;UAC9B,IAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACtC,QAAQ,CAAC,IAAI,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;WAChD;SACF;OACF;KACF,CAAC;;IAEF,KAAK,CAAC,IAAI,GAAG,WAAW;MACtB,IAAI,KAAK,GAAG,EAAE,CAAC;MACf,IAAI,CAAC,OAAO,CAAC,SAAS,KAAK,EAAE,IAAI,EAAE,EAAE,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC;MAC1D,OAAO,cAAc,CAAC,KAAK,CAAC,CAAC;KAC9B,CAAC;;IAEF,KAAK,CAAC,MAAM,GAAG,WAAW;MACxB,IAAI,KAAK,GAAG,EAAE,CAAC;MACf,IAAI,CAAC,OAAO,CAAC,SAAS,KAAK,EAAE,EAAE,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;MACrD,OAAO,cAAc,CAAC,KAAK,CAAC,CAAC;KAC9B,CAAC;;IAEF,KAAK,CAAC,OAAO,GAAG,WAAW;MACzB,IAAI,KAAK,GAAG,EAAE,CAAC;MACf,IAAI,CAAC,OAAO,CAAC,SAAS,KAAK,EAAE,IAAI,EAAE,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;MACnE,OAAO,cAAc,CAAC,KAAK,CAAC,CAAC;KAC9B,CAAC;;IAEF,GAAG,iBAAiB,EAAE;MACpB,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,KAAK,CAAC,OAAO,CAAC;KACxC;;IAED,KAAK,CAAC,QAAQ,GAAG,WAAW;MAC1B,IAAI,YAAY,GAAG,EAAE,CAAC;MACtB,IAAI,CAAC,OAAO,CAAC,SAAS,KAAK,EAAE,IAAI,EAAE;QACjC,GAAG,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE,YAAY,GAAG,GAAG,CAAC;QAC/C,YAAY,IAAI,cAAc,CAAC,IAAI,CAAC,GAAG,GAAG,GAAG,cAAc,CAAC,KAAK,CAAC,CAAC;OACpE,CAAC,CAAC;MACH,OAAO,YAAY,CAAC;KACrB,CAAC;;IAEF,MAAM,CAAC,eAAe,GAAG,eAAe,CAAC;GAC1C,CAAC;;EAEF,GAAG,EAAE,iBAAiB,IAAI,MAAM,CAAC,KAAK,IAAI,eAAe,CAAC,MAAM,CAAC,CAAC,QAAQ,EAAE,KAAK,KAAK,CAAC,EAAE;IACvF,uBAAuB,EAAE,CAAC;GAC3B;;;;CAIF;EACC,CAAC,OAAOA,cAAM,KAAK,WAAW,IAAIA,cAAM;OACnC,CAAC,OAAO,MAAM,KAAK,WAAW,IAAI,MAAM;OACxC,CAAC,OAAO,IAAI,KAAK,WAAW,IAAI,IAAI,GAAGC,cAAI,CAAC,CAAC;CACnD,CAAC;;AAEF,CAAC,SAAS,MAAM,EAAE;;;;;;;EAOhB,IAAI,qBAAqB,GAAG,WAAW;IACrC,IAAI;MACF,IAAI,CAAC,GAAG,IAAI,GAAG,CAAC,GAAG,EAAE,UAAU,CAAC,CAAC;MACjC,CAAC,CAAC,QAAQ,GAAG,OAAO,CAAC;MACrB,OAAO,CAAC,CAAC,CAAC,IAAI,KAAK,gBAAgB,KAAK,CAAC,CAAC,YAAY,CAAC;KACxD,CAAC,MAAM,CAAC,EAAE;MACT,OAAO,KAAK,CAAC;KACd;GACF,CAAC;;;EAGF,IAAI,WAAW,GAAG,WAAW;IAC3B,IAAI,IAAI,GAAG,MAAM,CAAC,GAAG,CAAC;;IAEtB,IAAI,GAAG,GAAG,SAAS,GAAG,EAAE,IAAI,EAAE;MAC5B,GAAG,OAAO,GAAG,KAAK,QAAQ,EAAE,GAAG,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;;MAE9C,IAAI,GAAG,GAAG,QAAQ,CAAC,cAAc,CAAC,kBAAkB,CAAC,EAAE,CAAC,CAAC;MACzD,MAAM,CAAC,GAAG,GAAG,GAAG,CAAC;MACjB,GAAG,IAAI,EAAE;QACP,IAAI,WAAW,GAAG,GAAG,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QAC5C,WAAW,CAAC,IAAI,GAAG,IAAI,CAAC;QACxB,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;OACnC;;MAED,IAAI,aAAa,GAAG,GAAG,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;MAC3C,aAAa,CAAC,IAAI,GAAG,GAAG,CAAC;MACzB,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;MACpC,aAAa,CAAC,IAAI,GAAG,aAAa,CAAC,IAAI,CAAC;;MAExC,GAAG,aAAa,CAAC,QAAQ,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE;QAClE,MAAM,IAAI,SAAS,CAAC,aAAa,CAAC,CAAC;OACpC;;MAED,MAAM,CAAC,cAAc,CAAC,IAAI,EAAE,gBAAgB,EAAE;QAC5C,KAAK,EAAE,aAAa;OACrB,CAAC,CAAC;KACJ,CAAC;;IAEF,IAAI,KAAK,GAAG,GAAG,CAAC,SAAS,CAAC;;IAE1B,IAAI,0BAA0B,GAAG,SAAS,aAAa,EAAE;MACvD,MAAM,CAAC,cAAc,CAAC,KAAK,EAAE,aAAa,EAAE;QAC1C,GAAG,EAAE,WAAW;UACd,OAAO,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC;SAC3C;QACD,GAAG,EAAE,SAAS,KAAK,EAAE;UACnB,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,GAAG,KAAK,CAAC;SAC5C;QACD,UAAU,EAAE,IAAI;OACjB,CAAC,CAAC;KACJ,CAAC;;IAEF,CAAC,MAAM,EAAE,MAAM,EAAE,UAAU,EAAE,MAAM,EAAE,UAAU,EAAE,QAAQ,CAAC;KACzD,OAAO,CAAC,SAAS,aAAa,EAAE;MAC/B,0BAA0B,CAAC,aAAa,CAAC,CAAC;KAC3C,CAAC,CAAC;;IAEH,MAAM,CAAC,gBAAgB,CAAC,KAAK,EAAE;;MAE7B,UAAU,EAAE;QACV,GAAG,EAAE,WAAW;UACd,IAAI,KAAK,GAAG,IAAI,CAAC;UACjB,OAAO,WAAW;YAChB,OAAO,KAAK,CAAC,IAAI,CAAC;WACnB,CAAC;SACH;OACF;;MAED,MAAM,GAAG;QACP,GAAG,EAAE,WAAW;UACd,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;SACnD;QACD,GAAG,EAAE,SAAS,KAAK,EAAE;UACnB,IAAI,CAAC,cAAc,CAAC,IAAI,GAAG,KAAK,CAAC;SAClC;QACD,UAAU,EAAE,IAAI;OACjB;;MAED,UAAU,GAAG;QACX,GAAG,EAAE,WAAW;UACd,OAAO,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;SAC3D;QACD,GAAG,EAAE,SAAS,KAAK,EAAE;UACnB,IAAI,CAAC,cAAc,CAAC,QAAQ,GAAG,KAAK,CAAC;SACtC;QACD,UAAU,EAAE,IAAI;OACjB;;MAED,QAAQ,EAAE;QACR,GAAG,EAAE,WAAW;;UAEd,IAAI,YAAY,GAAG,CAAC,OAAO,EAAE,EAAE,EAAE,QAAQ,EAAE,GAAG,EAAE,MAAM,EAAE,EAAE,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC;;;;UAI1F,IAAI,eAAe,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,IAAI,YAAY;YAC5D,IAAI,CAAC,cAAc,CAAC,IAAI,KAAK,EAAE,CAAA;;UAEjC,OAAO,IAAI,CAAC,cAAc,CAAC,QAAQ;YACjC,IAAI;YACJ,IAAI,CAAC,cAAc,CAAC,QAAQ;aAC3B,eAAe,IAAI,GAAG,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,IAAI,EAAE,CAAC,CAAC;SAC7D;QACD,UAAU,EAAE,IAAI;OACjB;;MAED,UAAU,EAAE;QACV,GAAG,EAAE,WAAW;UACd,OAAO,EAAE,CAAC;SACX;QACD,GAAG,EAAE,SAAS,KAAK,EAAE;SACpB;QACD,UAAU,EAAE,IAAI;OACjB;;MAED,UAAU,EAAE;QACV,GAAG,EAAE,WAAW;UACd,OAAO,EAAE,CAAC;SACX;QACD,GAAG,EAAE,SAAS,KAAK,EAAE;SACpB;QACD,UAAU,EAAE,IAAI;OACjB;;MAED,cAAc,EAAE;QACd,GAAG,EAAE,WAAW;UACd,IAAI,YAAY,GAAG,IAAI,eAAe,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;UACpD,IAAI,KAAK,GAAG,IAAI,CAAC;UACjB,CAAC,QAAQ,EAAE,QAAQ,EAAE,KAAK,CAAC,CAAC,OAAO,CAAC,SAAS,UAAU,EAAE;YACvD,IAAI,MAAM,GAAG,YAAY,CAAC,UAAU,CAAC,CAAC;YACtC,YAAY,CAAC,UAAU,CAAC,GAAG,WAAW;cACpC,MAAM,CAAC,KAAK,CAAC,YAAY,EAAE,SAAS,CAAC,CAAC;cACtC,KAAK,CAAC,MAAM,GAAG,YAAY,CAAC,QAAQ,EAAE,CAAC;aACxC,CAAC;WACH,CAAC,CAAC;UACH,OAAO,YAAY,CAAC;SACrB;QACD,UAAU,EAAE,IAAI;OACjB;KACF,CAAC,CAAC;;IAEH,GAAG,CAAC,eAAe,GAAG,SAAS,IAAI,EAAE;MACnC,OAAO,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;KACpD,CAAC;;IAEF,GAAG,CAAC,eAAe,GAAG,SAAS,GAAG,EAAE;MAClC,OAAO,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;KACpD,CAAC;;IAEF,MAAM,CAAC,GAAG,GAAG,GAAG,CAAC;;GAElB,CAAC;;EAEF,GAAG,CAAC,qBAAqB,EAAE,EAAE;IAC3B,WAAW,EAAE,CAAC;GACf;;EAED,GAAG,CAAC,MAAM,CAAC,QAAQ,KAAK,KAAK,CAAC,KAAK,EAAE,QAAQ,IAAI,MAAM,CAAC,QAAQ,CAAC,EAAE;IACjE,IAAI,SAAS,GAAG,WAAW;MACzB,OAAO,MAAM,CAAC,QAAQ,CAAC,QAAQ,GAAG,IAAI,GAAG,MAAM,CAAC,QAAQ,CAAC,QAAQ,IAAI,MAAM,CAAC,QAAQ,CAAC,IAAI,IAAI,GAAG,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,IAAI,EAAE,CAAC,CAAC;KAChI,CAAC;;IAEF,IAAI;MACF,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,QAAQ,EAAE,QAAQ,EAAE;QAC/C,GAAG,EAAE,SAAS;QACd,UAAU,EAAE,IAAI;OACjB,CAAC,CAAC;KACJ,CAAC,MAAM,CAAC,EAAE;MACT,WAAW,CAAC,WAAW;QACrB,MAAM,CAAC,QAAQ,CAAC,MAAM,GAAG,SAAS,EAAE,CAAC;OACtC,EAAE,GAAG,CAAC,CAAC;KACT;GACF;;CAEF;EACC,CAAC,OAAOD,cAAM,KAAK,WAAW,IAAIA,cAAM;OACnC,CAAC,OAAO,MAAM,KAAK,WAAW,IAAI,MAAM;OACxC,CAAC,OAAO,IAAI,KAAK,WAAW,IAAI,IAAI,GAAGC,cAAI,CAAC,CAAC;CACnD,CAAC;;AC3VF;;;;;;;;;;;;;AAaA,IAAI,UAAU,IAAI,MAAM,CAAC,IAAI,EAAE;;;;AAI/B,IAAI,EAAE,WAAW,IAAI,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;IAC7C,QAAQ,CAAC,eAAe,IAAI,EAAE,WAAW,IAAI,QAAQ,CAAC,eAAe,CAAC,4BAA4B,CAAC,GAAG,CAAC,CAAC,EAAE;;AAE9G,CAAC,UAAU,IAAI,EAAE;;AAEjB,YAAY,CAAC;;AAEb,IAAI,EAAE,SAAS,IAAI,IAAI,CAAC,EAAE,OAAO;;AAEjC;GACG,aAAa,GAAG,WAAW;GAC3B,SAAS,GAAG,WAAW;GACvB,YAAY,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC;GACtC,MAAM,GAAG,MAAM;GACf,OAAO,GAAG,MAAM,CAAC,SAAS,CAAC,CAAC,IAAI,IAAI,YAAY;EACjD,OAAO,IAAI,CAAC,OAAO,CAAC,YAAY,EAAE,EAAE,CAAC,CAAC;EACtC;GACC,UAAU,GAAG,KAAK,CAAC,SAAS,CAAC,CAAC,OAAO,IAAI,UAAU,IAAI,EAAE;EAC1D;KACG,CAAC,GAAG,CAAC;KACL,GAAG,GAAG,IAAI,CAAC,MAAM,CACnB;EACD,OAAO,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;GACpB,IAAI,CAAC,IAAI,IAAI,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK,IAAI,EAAE;IAClC,OAAO,CAAC,CAAC;IACT;GACD;EACD,OAAO,CAAC,CAAC,CAAC;EACV;;GAEC,KAAK,GAAG,UAAU,IAAI,EAAE,OAAO,EAAE;EAClC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;EACjB,IAAI,CAAC,IAAI,GAAG,YAAY,CAAC,IAAI,CAAC,CAAC;EAC/B,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;EACvB;GACC,qBAAqB,GAAG,UAAU,SAAS,EAAE,KAAK,EAAE;EACrD,IAAI,KAAK,KAAK,EAAE,EAAE;GACjB,MAAM,IAAI,KAAK;MACZ,YAAY;MACZ,4CAA4C;IAC9C,CAAC;GACF;EACD,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE;GACrB,MAAM,IAAI,KAAK;MACZ,uBAAuB;MACvB,sCAAsC;IACxC,CAAC;GACF;EACD,OAAO,UAAU,CAAC,IAAI,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;EACzC;GACC,SAAS,GAAG,UAAU,IAAI,EAAE;EAC7B;KACG,cAAc,GAAG,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;KAC/D,OAAO,GAAG,cAAc,GAAG,cAAc,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,EAAE;KAC3D,CAAC,GAAG,CAAC;KACL,GAAG,GAAG,OAAO,CAAC,MAAM,CACtB;EACD,OAAO,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;GACpB,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;GACtB;EACD,IAAI,CAAC,gBAAgB,GAAG,YAAY;GACnC,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC;GAC5C,CAAC;EACF;GACC,cAAc,GAAG,SAAS,CAAC,SAAS,CAAC,GAAG,EAAE;GAC1C,eAAe,GAAG,YAAY;EAC/B,OAAO,IAAI,SAAS,CAAC,IAAI,CAAC,CAAC;EAC3B,CACD;;;AAGD,KAAK,CAAC,SAAS,CAAC,GAAG,KAAK,CAAC,SAAS,CAAC,CAAC;AACpC,cAAc,CAAC,IAAI,GAAG,UAAU,CAAC,EAAE;CAClC,OAAO,IAAI,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC;CACvB,CAAC;AACF,cAAc,CAAC,QAAQ,GAAG,UAAU,KAAK,EAAE;CAC1C,KAAK,IAAI,EAAE,CAAC;CACZ,OAAO,qBAAqB,CAAC,IAAI,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC;CACjD,CAAC;AACF,cAAc,CAAC,GAAG,GAAG,YAAY;CAChC;IACG,MAAM,GAAG,SAAS;IAClB,CAAC,GAAG,CAAC;IACL,CAAC,GAAG,MAAM,CAAC,MAAM;IACjB,KAAK;IACL,OAAO,GAAG,KAAK,CACjB;CACD,GAAG;EACF,KAAK,GAAG,MAAM,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC;EACvB,IAAI,qBAAqB,CAAC,IAAI,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC,EAAE;GAC9C,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;GACjB,OAAO,GAAG,IAAI,CAAC;GACf;EACD;QACM,EAAE,CAAC,GAAG,CAAC,EAAE;;CAEhB,IAAI,OAAO,EAAE;EACZ,IAAI,CAAC,gBAAgB,EAAE,CAAC;EACxB;CACD,CAAC;AACF,cAAc,CAAC,MAAM,GAAG,YAAY;CACnC;IACG,MAAM,GAAG,SAAS;IAClB,CAAC,GAAG,CAAC;IACL,CAAC,GAAG,MAAM,CAAC,MAAM;IACjB,KAAK;IACL,OAAO,GAAG,KAAK;IACf,KAAK,CACP;CACD,GAAG;EACF,KAAK,GAAG,MAAM,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC;EACvB,KAAK,GAAG,qBAAqB,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;EAC3C,OAAO,KAAK,KAAK,CAAC,CAAC,EAAE;GACpB,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;GACtB,OAAO,GAAG,IAAI,CAAC;GACf,KAAK,GAAG,qBAAqB,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;GAC3C;EACD;QACM,EAAE,CAAC,GAAG,CAAC,EAAE;;CAEhB,IAAI,OAAO,EAAE;EACZ,IAAI,CAAC,gBAAgB,EAAE,CAAC;EACxB;CACD,CAAC;AACF,cAAc,CAAC,MAAM,GAAG,UAAU,KAAK,EAAE,KAAK,EAAE;CAC/C,KAAK,IAAI,EAAE,CAAC;;CAEZ;IACG,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC;IAC7B,MAAM,GAAG,MAAM;GAChB,KAAK,KAAK,IAAI,IAAI,QAAQ;;GAE1B,KAAK,KAAK,KAAK,IAAI,KAAK,CACzB;;CAED,IAAI,MAAM,EAAE;EACX,IAAI,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,CAAC;EACpB;;CAED,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,KAAK,KAAK,EAAE;EACtC,OAAO,KAAK,CAAC;EACb,MAAM;EACN,OAAO,CAAC,MAAM,CAAC;EACf;CACD,CAAC;AACF,cAAc,CAAC,QAAQ,GAAG,YAAY;CACrC,OAAO,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;CACtB,CAAC;;AAEF,IAAI,MAAM,CAAC,cAAc,EAAE;CAC1B,IAAI,iBAAiB,GAAG;IACrB,GAAG,EAAE,eAAe;IACpB,UAAU,EAAE,IAAI;IAChB,YAAY,EAAE,IAAI;EACpB,CAAC;CACF,IAAI;EACH,MAAM,CAAC,cAAc,CAAC,YAAY,EAAE,aAAa,EAAE,iBAAiB,CAAC,CAAC;EACtE,CAAC,OAAO,EAAE,EAAE;;;EAGZ,IAAI,EAAE,CAAC,MAAM,KAAK,SAAS,IAAI,EAAE,CAAC,MAAM,KAAK,CAAC,UAAU,EAAE;GACzD,iBAAiB,CAAC,UAAU,GAAG,KAAK,CAAC;GACrC,MAAM,CAAC,cAAc,CAAC,YAAY,EAAE,aAAa,EAAE,iBAAiB,CAAC,CAAC;GACtE;EACD;CACD,MAAM,IAAI,MAAM,CAAC,SAAS,CAAC,CAAC,gBAAgB,EAAE;CAC9C,YAAY,CAAC,gBAAgB,CAAC,aAAa,EAAE,eAAe,CAAC,CAAC;CAC9D;;CAEA,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE;;CAEf;;;;;AAKD,CAAC,YAAY;CACZ,YAAY,CAAC;;CAEb,IAAI,WAAW,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;;CAE9C,WAAW,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;;;;CAItC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;EAC1C,IAAI,YAAY,GAAG,SAAS,MAAM,EAAE;GACnC,IAAI,QAAQ,GAAG,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;;GAE9C,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,GAAG,SAAS,KAAK,EAAE;IAChD,IAAI,CAAC,EAAE,GAAG,GAAG,SAAS,CAAC,MAAM,CAAC;;IAE9B,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;KACzB,KAAK,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;KACrB,QAAQ,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;KAC3B;IACD,CAAC;GACF,CAAC;EACF,YAAY,CAAC,KAAK,CAAC,CAAC;EACpB,YAAY,CAAC,QAAQ,CAAC,CAAC;EACvB;;CAED,WAAW,CAAC,SAAS,CAAC,MAAM,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;;;;CAI1C,IAAI,WAAW,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;EACzC,IAAI,OAAO,GAAG,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC;;EAE5C,YAAY,CAAC,SAAS,CAAC,MAAM,GAAG,SAAS,KAAK,EAAE,KAAK,EAAE;GACtD,IAAI,CAAC,IAAI,SAAS,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,EAAE;IACvD,OAAO,KAAK,CAAC;IACb,MAAM;IACN,OAAO,OAAO,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;IACjC;GACD,CAAC;;EAEF;;CAED,WAAW,GAAG,IAAI,CAAC;CACnB,EAAE,EAAE;;CAEJ;;;;AC/OD;;;;;;;;AAQA,AAAO,SAASC,MAAT,CAAgBC,IAAhB,EAAsB;QACrBC,CAAJ,EAAOC,CAAP,EAAUC,GAAV,EAAeC,GAAf;;SAEKF,IAAI,CAAJ,EAAOC,MAAME,UAAUC,MAA5B,EAAoCJ,IAAIC,GAAxC,EAA6CD,GAA7C,EAAkD;cACxCG,UAAUH,CAAV,CAAN;aACKD,CAAL,IAAUG,GAAV,EAAe;iBACNH,CAAL,IAAUG,IAAIH,CAAJ,CAAV;;;WAGDD,IAAP;;;;;AAKJ,AAAO,IAAIO,SAASC,OAAOD,MAAP,IAAkB,YAAY;aACrCE,CAAT,GAAa;WACN,UAAUC,KAAV,EAAiB;UAClBC,SAAF,GAAcD,KAAd;eACO,IAAID,CAAJ,EAAP;KAFJ;CAFiC,EAA9B;;;;;AAWP,AAAO,SAASG,IAAT,CAAcC,EAAd,EAAkBC,GAAlB,EAAuB;QACtBC,QAAQC,MAAML,SAAN,CAAgBI,KAA5B;;QAEIF,GAAGD,IAAP,EAAa;eACFC,GAAGD,IAAH,CAAQK,KAAR,CAAcJ,EAAd,EAAkBE,MAAMG,IAAN,CAAWb,SAAX,EAAsB,CAAtB,CAAlB,CAAP;;;QAGAc,OAAOJ,MAAMG,IAAN,CAAWb,SAAX,EAAsB,CAAtB,CAAX;;WAEO,YAAY;eACRQ,GAAGI,KAAH,CAASH,GAAT,EAAcK,KAAKb,MAAL,GAAca,KAAKC,MAAL,CAAYL,MAAMG,IAAN,CAAWb,SAAX,CAAZ,CAAd,GAAmDA,SAAjE,CAAP;KADJ;;;;;AAOJ,AAAO,IAAIgB,SAAS,CAAb;;;;AAIP,AAAO,SAASC,KAAT,CAAeR,GAAf,EAAoB;;QAEnBS,QAAJ,GAAeT,IAAIS,QAAJ,IAAgB,EAAEF,MAAjC;WACOP,IAAIS,QAAX,CAHuB;;;;;;;;;;;AAc3B,AAAO,SAASC,QAAT,CAAkBX,EAAlB,EAAsBY,IAAtB,EAA4BC,OAA5B,EAAqC;QACpCC,IAAJ,EAAUR,IAAV,EAAgBS,SAAhB,EAA2BC,KAA3B;;YAEQ,iBAAY;;eAET,KAAP;YACIV,IAAJ,EAAU;sBACIF,KAAV,CAAgBS,OAAhB,EAAyBP,IAAzB;mBACO,KAAP;;KALR;;gBASY,qBAAY;YAChBQ,IAAJ,EAAU;;mBAECtB,SAAP;SAFJ,MAIO;;eAEAY,KAAH,CAASS,OAAT,EAAkBrB,SAAlB;uBACWwB,KAAX,EAAkBJ,IAAlB;mBACO,IAAP;;KATR;;WAaOG,SAAP;;;;;;;AAOJ,AAAO,SAASE,OAAT,CAAiBC,CAAjB,EAAoBC,KAApB,EAA2BC,UAA3B,EAAuC;QACtCC,MAAMF,MAAM,CAAN,CAAV;QACIG,MAAMH,MAAM,CAAN,CADV;QAEII,IAAIF,MAAMC,GAFd;WAGOJ,MAAMG,GAAN,IAAaD,UAAb,GAA0BF,CAA1B,GAA8B,CAAC,CAACA,IAAII,GAAL,IAAYC,CAAZ,GAAgBA,CAAjB,IAAsBA,CAAtB,GAA0BD,GAA/D;;;;;AAKJ,AAAO,SAASE,OAAT,GAAmB;WAAS,KAAP;;;;;AAI5B,AAAO,SAASC,SAAT,CAAmBC,GAAnB,EAAwBC,MAAxB,EAAgC;QAC/BC,MAAMC,KAAKD,GAAL,CAAS,EAAT,EAAaD,UAAU,CAAvB,CAAV;WACOE,KAAKC,KAAL,CAAWJ,MAAME,GAAjB,IAAwBA,GAA/B;;;;;AAKJ,AAAO,SAASG,SAAT,CAAmBL,GAAnB,EAAwB;WACtB,CAACM,MAAMC,WAAWP,GAAX,CAAN,CAAD,IAA2BQ,SAASR,GAAT,CAAlC;;;;;AAKF,AAAO,SAASS,IAAT,CAAcC,GAAd,EAAmB;WACfA,IAAID,IAAJ,GAAWC,IAAID,IAAJ,EAAX,GAAwBC,IAAIC,OAAJ,CAAY,YAAZ,EAA0B,EAA1B,CAA/B;;;;;AAKJ,AAAO,SAASC,UAAT,CAAoBF,GAApB,EAAyB;WACrBD,KAAKC,GAAL,EAAUG,KAAV,CAAgB,KAAhB,CAAP;;;;;AAKJ,AAAO,SAASC,UAAT,CAAoBvC,GAApB,EAAyBwC,OAAzB,EAAkC;QACjC,CAACxC,IAAIyC,cAAJ,CAAmB,SAAnB,CAAL,EAAoC;YAC5BD,OAAJ,GAAcxC,IAAIwC,OAAJ,GAAc/C,OAAOO,IAAIwC,OAAX,CAAd,GAAoC,EAAlD;;SAEC,IAAIrD,CAAT,IAAcqD,OAAd,EAAuB;YACfA,OAAJ,CAAYrD,CAAZ,IAAiBqD,QAAQrD,CAAR,CAAjB;;WAEGa,IAAIwC,OAAX;;;;;;;;AAQJ,AAAO,SAASE,cAAT,CAAwB1C,GAAxB,EAA6B2C,WAA7B,EAA0CC,SAA1C,EAAqD;QACpDC,SAAS,EAAb;SACK,IAAI1D,CAAT,IAAca,GAAd,EAAmB;eACR8C,IAAP,CAAYC,mBAAmBH,YAAYzD,EAAE6D,WAAF,EAAZ,GAA8B7D,CAAjD,IAAsD,GAAtD,GAA4D4D,mBAAmB/C,IAAIb,CAAJ,CAAnB,CAAxE;;WAEG,CAAE,CAACwD,WAAD,IAAgBA,YAAYM,OAAZ,CAAoB,GAApB,MAA6B,CAAC,CAA/C,GAAoD,GAApD,GAA0D,GAA3D,IAAkEJ,OAAOK,IAAP,CAAY,GAAZ,CAAzE;;;AAGJ,IAAIC,aAAa,qBAAjB;;;;;;;AAOA,AAAO,SAASC,QAAT,CAAkBjB,GAAlB,EAAuBkB,IAAvB,EAA6B;WACzBlB,IAAIC,OAAJ,CAAYe,UAAZ,EAAwB,UAAUhB,GAAV,EAAemB,GAAf,EAAoB;YAC3CC,QAAQF,KAAKC,GAAL,CAAZ;;YAEIC,UAAUC,SAAd,EAAyB;kBACf,IAAIC,KAAJ,CAAU,oCAAoCtB,GAA9C,CAAN;SADJ,MAGO,IAAI,OAAOoB,KAAP,KAAiB,UAArB,EAAiC;oBAC5BA,MAAMF,IAAN,CAAR;;eAEGE,KAAP;KATG,CAAP;;;;;AAeJ,AAAO,IAAIG,UAAUxD,MAAMwD,OAAN,IAAiB,UAAU1D,GAAV,EAAe;WACzCN,OAAOG,SAAP,CAAiB8D,QAAjB,CAA0BvD,IAA1B,CAA+BJ,GAA/B,MAAwC,gBAAhD;CADG;;;;AAMP,AAAO,SAASiD,OAAT,CAAiBW,KAAjB,EAAwBC,EAAxB,EAA4B;SAC1B,IAAI1E,IAAI,CAAb,EAAgBA,IAAIyE,MAAMpE,MAA1B,EAAkCL,GAAlC,EAAuC;YAC/ByE,MAAMzE,CAAN,MAAa0E,EAAjB,EAAqB;mBAAS1E,CAAP;;;WAEpB,CAAC,CAAR;;;;;;;AAOJ,AAAO,IAAI2E,gBAAgB,4DAApB;;;;AAIP,SAASC,WAAT,CAAqBC,IAArB,EAA2B;WAChBC,OAAO,WAAWD,IAAlB,KAA2BC,OAAO,QAAQD,IAAf,CAA3B,IAAmDC,OAAO,OAAOD,IAAd,CAA1D;;;AAGJ,IAAIE,WAAW,CAAf;;;AAGA,SAASC,YAAT,CAAsBpE,EAAtB,EAA0B;QAClBY,OAAO,CAAC,IAAIyD,IAAJ,EAAZ;QACIC,aAAazC,KAAKR,GAAL,CAAS,CAAT,EAAY,MAAMT,OAAOuD,QAAb,CAAZ,CADjB;;eAGWvD,OAAO0D,UAAlB;WACOJ,OAAOK,UAAP,CAAkBvE,EAAlB,EAAsBsE,UAAtB,CAAP;;;AAGJ,AAAO,IAAIE,YAAYN,OAAOO,qBAAP,IAAgCT,YAAY,uBAAZ,CAAhC,IAAwEI,YAAxF;AACP,AAAO,IAAIM,WAAWR,OAAOS,oBAAP,IAA+BX,YAAY,sBAAZ,CAA/B,IACdA,YAAY,6BAAZ,CADc,IACgC,UAAUY,EAAV,EAAc;WAASC,YAAP,CAAoBD,EAApB;CAD/D;;;;;;;;AASP,AAAO,SAASE,gBAAT,CAA0B9E,EAA1B,EAA8Ba,OAA9B,EAAuCkE,SAAvC,EAAkD;QACjDA,aAAaP,cAAcJ,YAA/B,EAA6C;WACtC/D,IAAH,CAAQQ,OAAR;KADJ,MAEO;eACI2D,UAAUnE,IAAV,CAAe6D,MAAf,EAAuBnE,KAAKC,EAAL,EAASa,OAAT,CAAvB,CAAP;;;;;;AAMR,AAAO,SAASmE,eAAT,CAAyBJ,EAAzB,EAA6B;QAC5BA,EAAJ,EAAQ;iBACKvE,IAAT,CAAc6D,MAAd,EAAsBU,EAAtB;;;;AAIR,AAAO,IAAIK,SAAS;QACZ,YAASC,GAAT,EAAc;YACVC,UAAU,EAAEC,WAAW,KAAb,EAAd;gBACQC,SAAR,GAAoB,EAApB;gBACQC,KAAR,GAAgB,EAAhB;gBACQC,IAAR,GAAe,UAASC,EAAT,EAAa;oBAChBH,SAAR,CAAkBtC,IAAlB,CAAuByC,EAAvB;gBACKL,QAAQC,SAAb,EAAyB;uBAASD,QAAQM,OAAR,EAAP;;mBACpBN,OAAP;SAHJ;gBAKQO,KAAR,GAAgB,UAASF,EAAT,EAAa;oBACjBF,KAAR,CAAcvC,IAAd,CAAmByC,EAAnB;gBACKL,QAAQC,SAAb,EAAyB;uBAASD,QAAQQ,MAAR,EAAP;;mBACpBR,OAAP;SAHJ;gBAKQM,OAAR,GAAkB,UAASG,KAAT,EAAgB;;oBAEtBR,SAAR,GAAoB,IAApB;mBACQD,QAAQE,SAAR,CAAkB5F,MAA1B,EAAmC;oBAC3B+F,KAAKL,QAAQE,SAAR,CAAkBQ,KAAlB,EAAT;oBACIC,MAAJ;oBACI;4BACQN,GAAGI,KAAH,CAAR;iBADJ,CAEE,OAAMG,CAAN,EAAS;4BACCC,GAAR,CAAYD,CAAZ;4BACQJ,MAAR,CAAeI,CAAf;;;;mBAIDZ,OAAP;SAdJ;;gBAiBQQ,MAAR,GAAiB,UAASI,CAAT,EAAY;mBACjBZ,QAAQG,KAAR,CAAc7F,MAAtB,EAA+B;oBACvB+F,KAAKL,QAAQG,KAAR,CAAcO,KAAd,EAAT;mBACGE,CAAH;;oBAEIC,GAAR,CAAYD,CAAZ;oBACQE,KAAR;mBACOd,OAAP;SAPJ;;YAUKD,OAAOzB,SAAZ,EAAwB;oBACZ2B,SAAR,GAAoB,IAApB;mBACOD,OAAP;;;YAGAe,UAAUC,SAASC,aAAT,CAAuB,QAAvB,CAAd;;gBAEQC,MAAR,GAAiB,YAAW;oBAClBZ,OAAR,CAAgBP,GAAhB;SADF;gBAGQoB,OAAR,GAAkB,YAAW;oBACnBZ,KAAR,CAActF,KAAd,CAAoBZ,SAApB;SADF;;gBAIQ+G,KAAR,GAAgB,IAAhB;YACIC,SAAS,MAAb;YACIC,OAAO,KAAX;gBACQA,IAAR,IAAgBvB,GAAhB;iBACSsB,MAAT,EAAiBE,WAAjB,CAA6BR,OAA7B;;gBAEQF,GAAR,CAAY,eAAZ,EAA6Bd,GAA7B;;eAEOC,OAAP;;CAhED;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3OA,SAASwB,KAAT,GAAiB;;AAExBA,MAAMzH,MAAN,GAAe,UAAU0H,KAAV,EAAiB;;;;;KAK3BC,WAAW,SAAXA,QAAW,GAAY;;;MAGtB,KAAKC,UAAT,EAAqB;QACfA,UAAL,CAAgB1G,KAAhB,CAAsB,IAAtB,EAA4BZ,SAA5B;;;;OAIIuH,aAAL;EARD;;KAWIC,cAAcH,SAASI,SAAT,GAAqB,KAAKnH,SAA5C;;KAEID,QAAQqH,MAAA,CAAYF,WAAZ,CAAZ;OACMG,WAAN,GAAoBN,QAApB;;UAES/G,SAAT,GAAqBD,KAArB;;;MAGK,IAAIT,CAAT,IAAc,IAAd,EAAoB;MACf,KAAKsD,cAAL,CAAoBtD,CAApB,KAA0BA,MAAM,WAApC,EAAiD;YACvCA,CAAT,IAAc,KAAKA,CAAL,CAAd;;;;;KAKEwH,MAAMQ,OAAV,EAAmB;QAClB,CAAYP,QAAZ,EAAsBD,MAAMQ,OAA5B;SACOR,MAAMQ,OAAb;;;;KAIGR,MAAMS,QAAV,EAAoB;6BACQT,MAAMS,QAAjC;QACA,CAAYjH,KAAZ,CAAkB,IAAlB,EAAwB,CAACP,KAAD,EAAQU,MAAR,CAAeqG,MAAMS,QAArB,CAAxB;SACOT,MAAMS,QAAb;;;;KAIGxH,MAAM4C,OAAV,EAAmB;QACZA,OAAN,GAAgByE,MAAA,CAAYA,MAAA,CAAYrH,MAAM4C,OAAlB,CAAZ,EAAwCmE,MAAMnE,OAA9C,CAAhB;;;;OAID,CAAY5C,KAAZ,EAAmB+G,KAAnB;;OAEMU,UAAN,GAAmB,EAAnB;;;OAGMP,aAAN,GAAsB,YAAY;;MAE7B,KAAKQ,gBAAT,EAA2B;;;;MAEvBP,YAAYD,aAAhB,EAA+B;eAClBA,aAAZ,CAA0B1G,IAA1B,CAA+B,IAA/B;;;OAGIkH,gBAAL,GAAwB,IAAxB;;OAEK,IAAInI,IAAI,CAAR,EAAWE,MAAMO,MAAMyH,UAAN,CAAiB7H,MAAvC,EAA+CL,IAAIE,GAAnD,EAAwDF,GAAxD,EAA6D;SACtDkI,UAAN,CAAiBlI,CAAjB,EAAoBiB,IAApB,CAAyB,IAAzB;;EAXF;;QAeOwG,QAAP;CArED;;;;AA2EAF,MAAMa,OAAN,GAAgB,UAAUZ,KAAV,EAAiB;OAChC,CAAY,KAAK9G,SAAjB,EAA4B8G,KAA5B;QACO,IAAP;CAFD;;;;AAOAD,MAAMc,YAAN,GAAqB,UAAUhF,OAAV,EAAmB;OACvC,CAAY,KAAK3C,SAAL,CAAe2C,OAA3B,EAAoCA,OAApC;QACO,IAAP;CAFD;;;;AAOAkE,MAAMe,WAAN,GAAoB,UAAU1H,EAAV,EAAc;;KAC7BM,OAAOH,MAAML,SAAN,CAAgBI,KAAhB,CAAsBG,IAAtB,CAA2Bb,SAA3B,EAAsC,CAAtC,CAAX;;KAEImI,OAAO,OAAO3H,EAAP,KAAc,UAAd,GAA2BA,EAA3B,GAAgC,YAAY;OACjDA,EAAL,EAASI,KAAT,CAAe,IAAf,EAAqBE,IAArB;EADD;;MAIKR,SAAL,CAAewH,UAAf,GAA4B,KAAKxH,SAAL,CAAewH,UAAf,IAA6B,EAAzD;MACKxH,SAAL,CAAewH,UAAf,CAA0BvE,IAA1B,CAA+B4E,IAA/B;QACO,IAAP;CATD;;AAYA,SAASC,0BAAT,CAAoCP,QAApC,EAA8C;KACzC,CAACQ,IAAD,IAAS,CAACA,KAAKC,KAAnB,EAA0B;;;;YAEfD,KAAKX,IAAL,CAAUvD,OAAV,CAAkB0D,QAAlB,IAA8BA,QAA9B,GAAyC,CAACA,QAAD,CAApD;;;;;;;;;;;;;;;;;ACxFM,IAAIU,UAAUpB,MAAMzH,MAAN,CAAa;;;;;;;;;KAS7B,YAAU8I,KAAV,EAAiBhI,EAAjB,EAAqBa,OAArB,EAA8B;;;MAG7B,QAAOmH,KAAP,yCAAOA,KAAP,OAAiB,QAArB,EAA+B;QACzB,IAAIC,IAAT,IAAiBD,KAAjB,EAAwB;;;SAGlBE,GAAL,CAASD,IAAT,EAAeD,MAAMC,IAAN,CAAf,EAA4BjI,EAA5B;;GAJF,MAOO;;WAEEkH,UAAA,CAAgBc,KAAhB,CAAR;;QAEK,IAAI5I,IAAI,CAAR,EAAWE,MAAM0I,MAAMvI,MAA5B,EAAoCL,IAAIE,GAAxC,EAA6CF,GAA7C,EAAkD;SAC5C8I,GAAL,CAASF,MAAM5I,CAAN,CAAT,EAAmBY,EAAnB,EAAuBa,OAAvB;;;;SAIK,IAAP;EA5BgC;;;;;;;;;;;;;MA0C5B,aAAUmH,KAAV,EAAiBhI,EAAjB,EAAqBa,OAArB,EAA8B;;MAE9B,CAACmH,KAAL,EAAY;;UAEJ,KAAKG,OAAZ;GAFD,MAIO,IAAI,QAAOH,KAAP,yCAAOA,KAAP,OAAiB,QAArB,EAA+B;QAChC,IAAIC,IAAT,IAAiBD,KAAjB,EAAwB;SAClBI,IAAL,CAAUH,IAAV,EAAgBD,MAAMC,IAAN,CAAhB,EAA6BjI,EAA7B;;GAFK,MAKA;WACEkH,UAAA,CAAgBc,KAAhB,CAAR;;QAEK,IAAI5I,IAAI,CAAR,EAAWE,MAAM0I,MAAMvI,MAA5B,EAAoCL,IAAIE,GAAxC,EAA6CF,GAA7C,EAAkD;SAC5CgJ,IAAL,CAAUJ,MAAM5I,CAAN,CAAV,EAAoBY,EAApB,EAAwBa,OAAxB;;;;SAIK,IAAP;EA7DgC;;;MAiE5B,aAAUoH,IAAV,EAAgBjI,EAAhB,EAAoBa,OAApB,EAA6B;OAC5BsH,OAAL,GAAe,KAAKA,OAAL,IAAgB,EAA/B;;;MAGIE,gBAAgB,KAAKF,OAAL,CAAaF,IAAb,CAApB;MACI,CAACI,aAAL,EAAoB;mBACH,EAAhB;QACKF,OAAL,CAAaF,IAAb,IAAqBI,aAArB;;;MAGGxH,YAAY,IAAhB,EAAsB;;aAEX4C,SAAV;;MAEG6E,cAAc,EAACtI,IAAIA,EAAL,EAASuI,KAAK1H,OAAd,EAAlB;MACI2H,YAAYH,aADhB;;;OAIK,IAAIjJ,IAAI,CAAR,EAAWE,MAAMkJ,UAAU/I,MAAhC,EAAwCL,IAAIE,GAA5C,EAAiDF,GAAjD,EAAsD;OACjDoJ,UAAUpJ,CAAV,EAAaY,EAAb,KAAoBA,EAApB,IAA0BwI,UAAUpJ,CAAV,EAAamJ,GAAb,KAAqB1H,OAAnD,EAA4D;;;;;YAKnDkC,IAAV,CAAeuF,WAAf;EAzFgC;;OA4F3B,cAAUL,IAAV,EAAgBjI,EAAhB,EAAoBa,OAApB,EAA6B;MAC9B2H,SAAJ,EACIpJ,CADJ,EAEIE,GAFJ;;MAII,CAAC,KAAK6I,OAAV,EAAmB;;;;cAEP,KAAKA,OAAL,CAAaF,IAAb,CAAZ;;MAEI,CAACO,SAAL,EAAgB;;;;MAIZ,CAACxI,EAAL,EAAS;;QAEHZ,IAAI,CAAJ,EAAOE,MAAMkJ,UAAU/I,MAA5B,EAAoCL,IAAIE,GAAxC,EAA6CF,GAA7C,EAAkD;cACvCA,CAAV,EAAaY,EAAb,GAAkBkH,OAAlB;;;UAGM,KAAKiB,OAAL,CAAaF,IAAb,CAAP;;;;MAIGpH,YAAY,IAAhB,EAAsB;aACX4C,SAAV;;;MAGG+E,SAAJ,EAAe;;;QAGTpJ,IAAI,CAAJ,EAAOE,MAAMkJ,UAAU/I,MAA5B,EAAoCL,IAAIE,GAAxC,EAA6CF,GAA7C,EAAkD;QAC7CqJ,IAAID,UAAUpJ,CAAV,CAAR;QACIqJ,EAAEF,GAAF,KAAU1H,OAAd,EAAuB;;;QACnB4H,EAAEzI,EAAF,KAASA,EAAb,EAAiB;;;OAGdA,EAAF,GAAOkH,OAAP;;SAEI,KAAKwB,YAAT,EAAuB;;WAEjBP,OAAL,CAAaF,IAAb,IAAqBO,YAAYA,UAAUtI,KAAV,EAAjC;;eAESyI,MAAV,CAAiBvJ,CAAjB,EAAoB,CAApB;;;;;;EAtI6B;;;;;;OAkJ3B,cAAU6I,IAAV,EAAgB3E,IAAhB,EAAsBsF,SAAtB,EAAiC;MAClC,CAAC,KAAKC,OAAL,CAAaZ,IAAb,EAAmBW,SAAnB,CAAL,EAAoC;UAAS,IAAP;;;MAElCE,QAAQ5B,MAAA,CAAY,EAAZ,EAAgB5D,IAAhB,EAAsB,EAAC2E,MAAMA,IAAP,EAAac,QAAQ,IAArB,EAAtB,CAAZ;;MAEI,KAAKZ,OAAT,EAAkB;OACbK,YAAY,KAAKL,OAAL,CAAaF,IAAb,CAAhB;;OAEIO,SAAJ,EAAe;SACTE,YAAL,GAAqB,KAAKA,YAAL,GAAoB,CAArB,IAA2B,CAA/C;SACK,IAAItJ,IAAI,CAAR,EAAWE,MAAMkJ,UAAU/I,MAAhC,EAAwCL,IAAIE,GAA5C,EAAiDF,GAAjD,EAAsD;SACjDqJ,IAAID,UAAUpJ,CAAV,CAAR;OACEY,EAAF,CAAKK,IAAL,CAAUoI,EAAEF,GAAF,IAAS,IAAnB,EAAyBO,KAAzB;;;SAGIJ,YAAL;;;;MAIEE,SAAJ,EAAe;;QAETI,eAAL,CAAqBF,KAArB;;;SAGM,IAAP;EA1KgC;;;;UA+KxB,iBAAUb,IAAV,EAAgBW,SAAhB,EAA2B;MAC/BJ,YAAY,KAAKL,OAAL,IAAgB,KAAKA,OAAL,CAAaF,IAAb,CAAhC;MACIO,aAAaA,UAAU/I,MAA3B,EAAmC;UAAS,IAAP;;;MAEjCmJ,SAAJ,EAAe;;QAET,IAAIhE,EAAT,IAAe,KAAKqE,aAApB,EAAmC;QAC9B,KAAKA,aAAL,CAAmBrE,EAAnB,EAAuBiE,OAAvB,CAA+BZ,IAA/B,EAAqCW,SAArC,CAAJ,EAAqD;YAAS,IAAP;;;;SAGlD,KAAP;EAzLgC;;;;OA8L3B,cAAUZ,KAAV,EAAiBhI,EAAjB,EAAqBa,OAArB,EAA8B;;MAE/B,QAAOmH,KAAP,yCAAOA,KAAP,OAAiB,QAArB,EAA+B;QACzB,IAAIC,IAAT,IAAiBD,KAAjB,EAAwB;SAClBkB,IAAL,CAAUjB,IAAV,EAAgBD,MAAMC,IAAN,CAAhB,EAA6BjI,EAA7B;;UAEM,IAAP;;;MAGGmF,UAAU+B,IAAA,CAAU,YAAY;QAE9BiC,GADL,CACSnB,KADT,EACgBhI,EADhB,EACoBa,OADpB,EAEKsI,GAFL,CAESnB,KAFT,EAEgB7C,OAFhB,EAEyBtE,OAFzB;GADa,EAIX,IAJW,CAAd;;;SAOO,KACFuI,EADE,CACCpB,KADD,EACQhI,EADR,EACYa,OADZ,EAEFuI,EAFE,CAECpB,KAFD,EAEQ7C,OAFR,EAEiBtE,OAFjB,CAAP;EA9MgC;;;;iBAqNjB,wBAAUZ,GAAV,EAAe;OACzBgJ,aAAL,GAAqB,KAAKA,aAAL,IAAsB,EAA3C;OACKA,aAAL,CAAmB/B,KAAA,CAAWjH,GAAX,CAAnB,IAAsCA,GAAtC;SACO,IAAP;EAxNgC;;;;oBA6Nd,2BAAUA,GAAV,EAAe;MAC7B,KAAKgJ,aAAT,EAAwB;UAChB,KAAKA,aAAL,CAAmB/B,KAAA,CAAWjH,GAAX,CAAnB,CAAP;;SAEM,IAAP;EAjOgC;;kBAoOhB,yBAAU8F,CAAV,EAAa;OACxB,IAAInB,EAAT,IAAe,KAAKqE,aAApB,EAAmC;QAC7BA,aAAL,CAAmBrE,EAAnB,EAAuByE,IAAvB,CAA4BtD,EAAEkC,IAA9B,EAAoCf,MAAA,CAAY,EAACoC,OAAOvD,EAAEgD,MAAV,EAAZ,EAA+BhD,CAA/B,CAApC,EAAuE,IAAvE;;;CAtOkB,CAAd;;AA2OP,IAAIlG,QAAQkI,QAAQjI,SAApB;;;;;;AAMAD,MAAM0J,gBAAN,GAAyB1J,MAAMuJ,EAA/B;;;;;;;AAOAvJ,MAAM2J,mBAAN,GAA4B3J,MAAM4J,sBAAN,GAA+B5J,MAAMsJ,GAAjE;;;;AAIAtJ,MAAM6J,uBAAN,GAAgC7J,MAAMqJ,IAAtC;;;;AAIArJ,MAAM8J,SAAN,GAAkB9J,MAAMwJ,IAAxB;;;;AAIAxJ,MAAM+J,iBAAN,GAA0B/J,MAAMgJ,OAAhC;;AC/RA;;;;;;;;;;;;;;;AAeA,IAAIgB,UAAQ1D,SAAS2D,eAAT,CAAyBD,KAArC;;;AAGA,AAAO,IAAIE,KAAK,mBAAmB7F,MAA5B;;;AAGP,AAAO,IAAI8F,QAAQD,MAAM,CAAC5D,SAASoD,gBAA5B;;;AAGP,AAAO,IAAIU,OAAO,iBAAiBC,SAAjB,IAA8B,EAAE,kBAAkB/D,QAApB,CAAzC;;;;AAIP,AAAO,IAAIgE,SAASC,kBAAkB,QAAlB,CAAb;;;;AAIP,AAAO,IAAIC,UAAUD,kBAAkB,SAAlB,CAAd;;;AAGP,AAAO,IAAIE,YAAYF,kBAAkB,WAAlB,KAAkCA,kBAAkB,WAAlB,CAAlD;;;AAGP,AAAO,IAAIG,QAAQ,CAAC,CAACrG,OAAOqG,KAArB;;;AAGP,AAAO,IAAIC,SAASJ,kBAAkB,QAAlB,CAAb;;;AAGP,AAAO,IAAIK,QAAQL,kBAAkB,OAAlB,KAA8B,CAACD,MAA/B,IAAyC,CAACI,KAA1C,IAAmD,CAACR,EAAhE;;;AAGP,AAAO,IAAIW,SAAS,CAACF,MAAD,IAAWJ,kBAAkB,QAAlB,CAAxB;;AAEP,AAAO,IAAIO,UAAUP,kBAAkB,SAAlB,CAAd;;;;AAIP,AAAO,IAAIQ,UAAU,iBAAiBf,OAA/B;;;AAGP,AAAO,IAAIgB,MAAMX,UAAUY,QAAV,CAAmB5H,OAAnB,CAA2B,KAA3B,MAAsC,CAAhD;;;AAGP,AAAO,IAAI6H,OAAOhB,MAAO,gBAAgBF,OAAlC;;;AAGP,AAAO,IAAImB,WAAY,qBAAqB9G,MAAtB,IAAkC,SAAS,IAAIA,OAAO+G,eAAX,EAA3C,IAA4E,CAACX,SAA5F;;;AAGP,AAAO,IAAIY,UAAU,oBAAoBrB,OAAlC;;;;AAIP,AAAO,IAAIsB,QAAQ,CAACjH,OAAOkH,YAAR,KAAyBL,QAAQC,QAAR,IAAoBE,OAA7C,KAAyD,CAACN,OAA1D,IAAqE,CAACD,OAAlF;;;AAGP,AAAO,IAAIU,SAAS,OAAOC,WAAP,KAAuB,WAAvB,IAAsClB,kBAAkB,QAAlB,CAAnD;;;AAGP,AAAO,IAAImB,eAAeF,UAAUlB,MAA7B;;;;AAIP,AAAO,IAAIqB,iBAAiBH,UAAUL,QAA/B;;;;AAIP,AAAO,IAAIS,YAAY,CAACvH,OAAOwH,YAAR,IAAwBxH,OAAOyH,cAA/C;;;;AAIP,AAAO,IAAIC,UAAU,CAAC,EAAE1H,OAAOwH,YAAP,IAAuBD,SAAzB,CAAf;;;;;;;AAOP,AAAO,IAAII,QAAQ,CAAC3H,OAAO4H,UAAR,KAAuBF,WAAW,kBAAkB1H,MAA7B,IACjCA,OAAO6H,aAAP,IAAwB5F,oBAAoBjC,OAAO6H,aADzC,CAAZ;;;AAIP,AAAO,IAAIC,cAAcX,UAAUd,KAA5B;;;;AAIP,AAAO,IAAI0B,cAAcZ,UAAUZ,KAA5B;;;;AAIP,AAAO,IAAIyB,SAAS,CAAChI,OAAOiI,gBAAP,IAA4BjI,OAAOkI,MAAP,CAAcC,UAAd,GAA2BnI,OAAOkI,MAAP,CAAcE,WAAtE,IAAsF,CAAnG;;;;AAKP,AAAO,IAAIC,SAAU,YAAY;WACtB,CAAC,CAACpG,SAASC,aAAT,CAAuB,QAAvB,EAAiCoG,UAA1C;CADiB,EAAd;;;;;AAOP,AAAO,IAAIC,MAAM,IAAV;;;;AAIP,AAAO,IAAIC,MAAM,CAACD,GAAD,IAAS,YAAY;QAC9B;YACIE,MAAMxG,SAASC,aAAT,CAAuB,KAAvB,CAAV;YACIwG,SAAJ,GAAgB,oBAAhB;;YAEIC,QAAQF,IAAIG,UAAhB;cACMjD,KAAN,CAAYkD,QAAZ,GAAuB,mBAAvB;;eAEOF,SAAUG,QAAOH,MAAMI,GAAb,MAAqB,QAAtC;KAPJ,CASE,OAAOlH,CAAP,EAAU;eACD,KAAP;;CAXkB,EAAnB;;AAeP,AAAO,IAAImH,cAAgB,iBAAiBrD,OAArC;AACP,AAAO,IAAIsD,YAAchH,SAAS2D,eAAT,CAAyBqD,SAAzB,KAAuC1J,SAAzD;;AAEP,SAAS2G,iBAAT,CAA2BhI,GAA3B,EAAgC;WACrB8H,UAAUkD,SAAV,CAAoBC,WAApB,GAAkCnK,OAAlC,CAA0Cd,GAA1C,KAAkD,CAAzD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxHG,SAASkL,KAAT,CAAepM,CAAf,EAAkBqM,CAAlB,EAAqBzL,KAArB,EAA4B;;MAE7BZ,CAAL,GAAUY,QAAQD,KAAKC,KAAL,CAAWZ,CAAX,CAAR,GAAwBA,CAAlC;;MAEKqM,CAAL,GAAUzL,QAAQD,KAAKC,KAAL,CAAWyL,CAAX,CAAR,GAAwBA,CAAlC;;;AAGDD,MAAMxN,SAAN,GAAkB;;;;QAIV,iBAAY;SACX,IAAIwN,KAAJ,CAAU,KAAKpM,CAAf,EAAkB,KAAKqM,CAAvB,CAAP;EALgB;;;;MAUZ,aAAUC,KAAV,EAAiB;;SAEd,KAAKC,KAAL,GAAaC,IAAb,CAAkBC,QAAQH,KAAR,CAAlB,CAAP;EAZgB;;OAeX,cAAUA,KAAV,EAAiB;;OAEjBtM,CAAL,IAAUsM,MAAMtM,CAAhB;OACKqM,CAAL,IAAUC,MAAMD,CAAhB;SACO,IAAP;EAnBgB;;;;WAwBP,kBAAUC,KAAV,EAAiB;SACnB,KAAKC,KAAL,GAAaG,SAAb,CAAuBD,QAAQH,KAAR,CAAvB,CAAP;EAzBgB;;YA4BN,mBAAUA,KAAV,EAAiB;OACtBtM,CAAL,IAAUsM,MAAMtM,CAAhB;OACKqM,CAAL,IAAUC,MAAMD,CAAhB;SACO,IAAP;EA/BgB;;;;WAoCP,kBAAU7L,GAAV,EAAe;SACjB,KAAK+L,KAAL,GAAaI,SAAb,CAAuBnM,GAAvB,CAAP;EArCgB;;YAwCN,mBAAUA,GAAV,EAAe;OACpBR,CAAL,IAAUQ,GAAV;OACK6L,CAAL,IAAU7L,GAAV;SACO,IAAP;EA3CgB;;;;aAgDL,oBAAUA,GAAV,EAAe;SACnB,KAAK+L,KAAL,GAAaK,WAAb,CAAyBpM,GAAzB,CAAP;EAjDgB;;cAoDJ,qBAAUA,GAAV,EAAe;OACtBR,CAAL,IAAUQ,GAAV;OACK6L,CAAL,IAAU7L,GAAV;SACO,IAAP;EAvDgB;;;;;;;UA+DR,iBAAU8L,KAAV,EAAiB;SAClB,IAAIF,KAAJ,CAAU,KAAKpM,CAAL,GAASsM,MAAMtM,CAAzB,EAA4B,KAAKqM,CAAL,GAASC,MAAMD,CAA3C,CAAP;EAhEgB;;;;;YAsEN,mBAAUC,KAAV,EAAiB;SACpB,IAAIF,KAAJ,CAAU,KAAKpM,CAAL,GAASsM,MAAMtM,CAAzB,EAA4B,KAAKqM,CAAL,GAASC,MAAMD,CAA3C,CAAP;EAvEgB;;;;QA4EV,iBAAY;SACX,KAAKE,KAAL,GAAaM,MAAb,EAAP;EA7EgB;;SAgFT,kBAAY;OACd7M,CAAL,GAASW,KAAKC,KAAL,CAAW,KAAKZ,CAAhB,CAAT;OACKqM,CAAL,GAAS1L,KAAKC,KAAL,CAAW,KAAKyL,CAAhB,CAAT;SACO,IAAP;EAnFgB;;;;QAwFV,iBAAY;SACX,KAAKE,KAAL,GAAaO,MAAb,EAAP;EAzFgB;;SA4FT,kBAAY;OACd9M,CAAL,GAASW,KAAKoM,KAAL,CAAW,KAAK/M,CAAhB,CAAT;OACKqM,CAAL,GAAS1L,KAAKoM,KAAL,CAAW,KAAKV,CAAhB,CAAT;SACO,IAAP;EA/FgB;;;;OAoGX,gBAAY;SACV,KAAKE,KAAL,GAAaS,KAAb,EAAP;EArGgB;;QAwGV,iBAAY;OACbhN,CAAL,GAASW,KAAKsM,IAAL,CAAU,KAAKjN,CAAf,CAAT;OACKqM,CAAL,GAAS1L,KAAKsM,IAAL,CAAU,KAAKZ,CAAf,CAAT;SACO,IAAP;EA3GgB;;;;aAgHL,oBAAUC,KAAV,EAAiB;UACpBG,QAAQH,KAAR,CAAR;;MAEItM,IAAIsM,MAAMtM,CAAN,GAAU,KAAKA,CAAvB;MACIqM,IAAIC,MAAMD,CAAN,GAAU,KAAKA,CADvB;;SAGO1L,KAAKuM,IAAL,CAAUlN,IAAIA,CAAJ,GAAQqM,IAAIA,CAAtB,CAAP;EAtHgB;;;;SA2HT,gBAAUC,KAAV,EAAiB;UAChBG,QAAQH,KAAR,CAAR;;SAEOA,MAAMtM,CAAN,KAAY,KAAKA,CAAjB,IACAsM,MAAMD,CAAN,KAAY,KAAKA,CADxB;EA9HgB;;;;WAoIP,kBAAUC,KAAV,EAAiB;UAClBG,QAAQH,KAAR,CAAR;;SAEO3L,KAAKwM,GAAL,CAASb,MAAMtM,CAAf,KAAqBW,KAAKwM,GAAL,CAAS,KAAKnN,CAAd,CAArB,IACAW,KAAKwM,GAAL,CAASb,MAAMD,CAAf,KAAqB1L,KAAKwM,GAAL,CAAS,KAAKd,CAAd,CAD5B;EAvIgB;;;;WA6IP,oBAAY;SACd,WACC9L,UAAU,KAAKP,CAAf,CADD,GACqB,IADrB,GAECO,UAAU,KAAK8L,CAAf,CAFD,GAEqB,GAF5B;;CA9IF;;;;;;;;;;;;AA8JA,AAAO,SAASI,OAAT,CAAiBzM,CAAjB,EAAoBqM,CAApB,EAAuBzL,KAAvB,EAA8B;KAChCZ,aAAaoM,KAAjB,EAAwB;SAChBpM,CAAP;;KAEGyC,QAAQzC,CAAR,CAAJ,EAAgB;SACR,IAAIoM,KAAJ,CAAUpM,EAAE,CAAF,CAAV,EAAgBA,EAAE,CAAF,CAAhB,CAAP;;KAEGA,MAAMuC,SAAN,IAAmBvC,MAAM,IAA7B,EAAmC;SAC3BA,CAAP;;KAEG,QAAOA,CAAP,yCAAOA,CAAP,OAAa,QAAb,IAAyB,OAAOA,CAAhC,IAAqC,OAAOA,CAAhD,EAAmD;SAC3C,IAAIoM,KAAJ,CAAUpM,EAAEA,CAAZ,EAAeA,EAAEqM,CAAjB,CAAP;;QAEM,IAAID,KAAJ,CAAUpM,CAAV,EAAaqM,CAAb,EAAgBzL,KAAhB,CAAP;;;AC/LD,IAAIwM,eAAiBC,SAAA,GAAoB,eAApB,GAAwC,aAA7D;IACIC,eAAiBD,SAAA,GAAoB,eAApB,GAAwC,aAD7D;IAEIE,aAAiBF,SAAA,GAAoB,aAApB,GAAwC,WAF7D;IAGIG,iBAAiBH,SAAA,GAAoB,iBAApB,GAAwC,eAH7D;IAIII,iBAAiB,CAAC,OAAD,EAAU,QAAV,EAAoB,QAApB,CAJrB;IAMIC,YAAY,EANhB;IAOIC,sBAAsB,KAP1B;;;AAUA,AAAO,IAAIC,iBAAiB,CAArB;;;;;AAKP,AAAO,SAASC,kBAAT,CAA4B9O,GAA5B,EAAiCgI,IAAjC,EAAuC9C,OAAvC,EAAgDP,EAAhD,EAAoD;KACtDqD,SAAS,YAAb,EAA2B;mBACThI,GAAjB,EAAsBkF,OAAtB,EAA+BP,EAA/B;EADD,MAGO,IAAIqD,SAAS,WAAb,EAA0B;kBAChBhI,GAAhB,EAAqBkF,OAArB,EAA8BP,EAA9B;EADM,MAGA,IAAIqD,SAAS,UAAb,EAAyB;iBAChBhI,GAAf,EAAoBkF,OAApB,EAA6BP,EAA7B;;;QAGM,IAAP;;;AAGD,AAAO,SAASoK,qBAAT,CAA+B/O,GAA/B,EAAoCgI,IAApC,EAA0CrD,EAA1C,EAA8C;KAChDO,UAAUlF,IAAI,cAAcgI,IAAd,GAAqBrD,EAAzB,CAAd;;KAEIqD,SAAS,YAAb,EAA2B;MACtBuB,mBAAJ,CAAwB8E,YAAxB,EAAsCnJ,OAAtC,EAA+C,KAA/C;EADD,MAGO,IAAI8C,SAAS,WAAb,EAA0B;MAC5BuB,mBAAJ,CAAwBgF,YAAxB,EAAsCrJ,OAAtC,EAA+C,KAA/C;EADM,MAGA,IAAI8C,SAAS,UAAb,EAAyB;MAC3BuB,mBAAJ,CAAwBiF,UAAxB,EAAoCtJ,OAApC,EAA6C,KAA7C;MACIqE,mBAAJ,CAAwBkF,cAAxB,EAAwCvJ,OAAxC,EAAiD,KAAjD;;;QAGM,IAAP;;;AAGD,SAAS8J,gBAAT,CAA0BhP,GAA1B,EAA+BkF,OAA/B,EAAwCP,EAAxC,EAA4C;KACvCsK,SAAShI,IAAA,CAAU,UAAUnB,CAAV,EAAa;MAC/BA,EAAEoJ,WAAF,KAAkB,OAAlB,IAA6BpJ,EAAEoJ,WAAF,KAAkBpJ,EAAEqJ,oBAAjD,IAAyErJ,EAAEoJ,WAAF,KAAkBpJ,EAAEqJ,oBAAjG,EAAuH;;;;OAIlHT,eAAezL,OAAf,CAAuB6C,EAAEgD,MAAF,CAASsG,OAAhC,IAA2C,CAA/C,EAAkD;kBACjD,CAAwBtJ,CAAxB;IADD,MAEO;;;;;iBAKOA,CAAf,EAAkBZ,OAAlB;EAZY,CAAb;;KAeI,wBAAwBP,EAA5B,IAAkCsK,MAAlC;KACI3F,gBAAJ,CAAqB+E,YAArB,EAAmCY,MAAnC,EAA2C,KAA3C;;;KAGI,CAACL,mBAAL,EAA0B;;WAEhB/E,eAAT,CAAyBP,gBAAzB,CAA0C+E,YAA1C,EAAwDgB,kBAAxD,EAA4E,IAA5E;WACSxF,eAAT,CAAyBP,gBAAzB,CAA0CiF,YAA1C,EAAwDe,kBAAxD,EAA4E,IAA5E;WACSzF,eAAT,CAAyBP,gBAAzB,CAA0CkF,UAA1C,EAAsDe,gBAAtD,EAAwE,IAAxE;WACS1F,eAAT,CAAyBP,gBAAzB,CAA0CmF,cAA1C,EAA0Dc,gBAA1D,EAA4E,IAA5E;;wBAEsB,IAAtB;;;;AAIF,SAASF,kBAAT,CAA4BvJ,CAA5B,EAA+B;WACpBA,EAAE0J,SAAZ,IAAyB1J,CAAzB;;;;AAID,SAASwJ,kBAAT,CAA4BxJ,CAA5B,EAA+B;KAC1B6I,UAAU7I,EAAE0J,SAAZ,CAAJ,EAA4B;YACjB1J,EAAE0J,SAAZ,IAAyB1J,CAAzB;;;;AAIF,SAASyJ,gBAAT,CAA0BzJ,CAA1B,EAA6B;QACrB6I,UAAU7I,EAAE0J,SAAZ,CAAP;;;;AAID,SAASC,cAAT,CAAwB3J,CAAxB,EAA2BZ,OAA3B,EAAoC;GACjCwK,OAAF,GAAY,EAAZ;MACK,IAAIvQ,CAAT,IAAcwP,SAAd,EAAyB;IACtBe,OAAF,CAAU5M,IAAV,CAAe6L,UAAUxP,CAAV,CAAf;;GAECwQ,cAAF,GAAmB,CAAC7J,CAAD,CAAnB;;SAEQA,CAAR;;;AAGD,SAAS8J,eAAT,CAAyB5P,GAAzB,EAA8BkF,OAA9B,EAAuCP,EAAvC,EAA2C;KACtCkL,SAAS,SAATA,MAAS,CAAU/J,CAAV,EAAa;;MAErB,CAACA,EAAEoJ,WAAF,KAAkBpJ,EAAEqJ,oBAApB,IAA4CrJ,EAAEoJ,WAAF,KAAkB,OAA/D,KAA2EpJ,EAAEgK,OAAF,KAAc,CAA7F,EAAgG;;;;iBAEjFhK,CAAf,EAAkBZ,OAAlB;EAJD;;KAOI,uBAAuBP,EAA3B,IAAiCkL,MAAjC;KACIvG,gBAAJ,CAAqBiF,YAArB,EAAmCsB,MAAnC,EAA2C,KAA3C;;;AAGD,SAASE,cAAT,CAAwB/P,GAAxB,EAA6BkF,OAA7B,EAAsCP,EAAtC,EAA0C;KACrCqL,OAAO,SAAPA,IAAO,CAAUlK,CAAV,EAAa;iBACRA,CAAf,EAAkBZ,OAAlB;EADD;;KAII,sBAAsBP,EAA1B,IAAgCqL,IAAhC;KACI1G,gBAAJ,CAAqBkF,UAArB,EAAiCwB,IAAjC,EAAuC,KAAvC;KACI1G,gBAAJ,CAAqBmF,cAArB,EAAqCuB,IAArC,EAA2C,KAA3C;;;AC5HD,IAAIC,cAAc3B,SAAA,GAAoB,eAApB,GAAsCA,OAAA,GAAkB,aAAlB,GAAkC,YAA1F;IACI4B,YAAY5B,SAAA,GAAoB,aAApB,GAAoCA,OAAA,GAAkB,WAAlB,GAAgC,UADpF;IAEI6B,OAAO,WAFX;;;AAKA,AAAO,SAASC,oBAAT,CAA8BpQ,GAA9B,EAAmCkF,OAAnC,EAA4CP,EAA5C,EAAgD;KAClD0L,IAAJ;KAAUzE,QAAV;KACI0E,YAAY,KADhB;KAEIC,QAAQ,GAFZ;;UAISC,YAAT,CAAsB1K,CAAtB,EAAyB;MACpB2K,KAAJ;;MAEInC,OAAJ,EAAqB;OACf,CAACA,IAAF,IAAmBxI,EAAEoJ,WAAF,KAAkB,OAAzC,EAAkD;;;WAC1CL,cAAR;GAFD,MAGO;WACE/I,EAAE4J,OAAF,CAAUlQ,MAAlB;;;MAGGiR,QAAQ,CAAZ,EAAe;;;;MAEXC,MAAMtM,KAAKsM,GAAL,EAAV;MACIC,QAAQD,OAAOL,QAAQK,GAAf,CADZ;;aAGQ5K,EAAE4J,OAAF,GAAY5J,EAAE4J,OAAF,CAAU,CAAV,CAAZ,GAA2B5J,CAAnC;cACa6K,QAAQ,CAAR,IAAaA,SAASJ,KAAnC;SACOG,GAAP;;;UAGQE,UAAT,CAAoB9K,CAApB,EAAuB;MAClBwK,aAAa,CAAC1E,SAAMiF,YAAxB,EAAsC;OACjCvC,OAAJ,EAAqB;QACf,CAACA,IAAF,IAAmBxI,EAAEoJ,WAAF,KAAkB,OAAzC,EAAkD;;;;QAE9C4B,WAAW,EAAf;QACIC,IADJ;QACU5R,CADV;;SAGKA,CAAL,IAAUyM,QAAV,EAAiB;YACTA,SAAMzM,CAAN,CAAP;cACSA,CAAT,IAAc4R,QAAQA,KAAKjR,IAAb,GAAoBiR,KAAKjR,IAAL,CAAU8L,QAAV,CAApB,GAAuCmF,IAArD;;eAEOD,QAAR;;YAEK9I,IAAN,GAAa,UAAb;WACQ4D,QAAR;UACO,IAAP;;;;KAIEuE,OAAOF,WAAP,GAAqBtL,EAAzB,IAA+B6L,YAA/B;KACIL,OAAOD,SAAP,GAAmBvL,EAAvB,IAA6BiM,UAA7B;KACIT,OAAO,UAAP,GAAoBxL,EAAxB,IAA8BO,OAA9B;;KAEIoE,gBAAJ,CAAqB2G,WAArB,EAAkCO,YAAlC,EAAgD,KAAhD;KACIlH,gBAAJ,CAAqB4G,SAArB,EAAgCU,UAAhC,EAA4C,KAA5C;;;;;;KAMItH,gBAAJ,CAAqB,UAArB,EAAiCpE,OAAjC,EAA0C,KAA1C;;QAEO,IAAP;;;AAGD,AAAO,SAAS8L,uBAAT,CAAiChR,GAAjC,EAAsC2E,EAAtC,EAA0C;KAC5CsM,aAAajR,IAAImQ,OAAOF,WAAP,GAAqBtL,EAAzB,CAAjB;KACIuM,WAAWlR,IAAImQ,OAAOD,SAAP,GAAmBvL,EAAvB,CADf;KAEIwM,WAAWnR,IAAImQ,OAAO,UAAP,GAAoBxL,EAAxB,CAFf;;KAII4E,mBAAJ,CAAwB0G,WAAxB,EAAqCgB,UAArC,EAAiD,KAAjD;KACI1H,mBAAJ,CAAwB2G,SAAxB,EAAmCgB,QAAnC,EAA6C,KAA7C;KACI,CAAC5C,IAAL,EAAmB;MACd/E,mBAAJ,CAAwB,UAAxB,EAAoC4H,QAApC,EAA8C,KAA9C;;;QAGM,IAAP;;;AC9DM,SAAShI,EAAT,CAAYnJ,GAAZ,EAAiB+H,KAAjB,EAAwBhI,EAAxB,EAA4Ba,OAA5B,EAAqC;;KAEvC,QAAOmH,KAAP,yCAAOA,KAAP,OAAiB,QAArB,EAA+B;OACzB,IAAIC,IAAT,IAAiBD,KAAjB,EAAwB;UAChB/H,GAAP,EAAYgI,IAAZ,EAAkBD,MAAMC,IAAN,CAAlB,EAA+BjI,EAA/B;;EAFF,MAIO;UACEkH,UAAA,CAAgBc,KAAhB,CAAR;;OAEK,IAAI5I,IAAI,CAAR,EAAWE,MAAM0I,MAAMvI,MAA5B,EAAoCL,IAAIE,GAAxC,EAA6CF,GAA7C,EAAkD;UAC1Ca,GAAP,EAAY+H,MAAM5I,CAAN,CAAZ,EAAsBY,EAAtB,EAA0Ba,OAA1B;;;;QAIK,IAAP;;;AAGD,IAAIwQ,YAAY,iBAAhB;;;;;;;;;;;;;;;AAeA,AAAO,SAASlI,GAAT,CAAalJ,GAAb,EAAkB+H,KAAlB,EAAyBhI,EAAzB,EAA6Ba,OAA7B,EAAsC;;KAExC,QAAOmH,KAAP,yCAAOA,KAAP,OAAiB,QAArB,EAA+B;OACzB,IAAIC,IAAT,IAAiBD,KAAjB,EAAwB;aACb/H,GAAV,EAAegI,IAAf,EAAqBD,MAAMC,IAAN,CAArB,EAAkCjI,EAAlC;;EAFF,MAIO,IAAIgI,KAAJ,EAAW;UACTd,UAAA,CAAgBc,KAAhB,CAAR;;OAEK,IAAI5I,IAAI,CAAR,EAAWE,MAAM0I,MAAMvI,MAA5B,EAAoCL,IAAIE,GAAxC,EAA6CF,GAA7C,EAAkD;aACvCa,GAAV,EAAe+H,MAAM5I,CAAN,CAAf,EAAyBY,EAAzB,EAA6Ba,OAA7B;;EAJK,MAMA;OACD,IAAIxB,CAAT,IAAcY,IAAIoR,SAAJ,CAAd,EAA8B;aACnBpR,GAAV,EAAeZ,CAAf,EAAkBY,IAAIoR,SAAJ,EAAehS,CAAf,CAAlB;;SAEMY,IAAIoR,SAAJ,CAAP;;;;AAIF,SAASC,MAAT,CAAgBrR,GAAhB,EAAqBgI,IAArB,EAA2BjI,EAA3B,EAA+Ba,OAA/B,EAAwC;KACnC+D,KAAKqD,OAAOf,KAAA,CAAWlH,EAAX,CAAP,IAAyBa,UAAU,MAAMqG,KAAA,CAAWrG,OAAX,CAAhB,GAAsC,EAA/D,CAAT;;KAEIZ,IAAIoR,SAAJ,KAAkBpR,IAAIoR,SAAJ,EAAezM,EAAf,CAAtB,EAA0C;SAAS,IAAP;;;KAExCO,UAAU,iBAAUY,CAAV,EAAa;SACnB/F,GAAGK,IAAH,CAAQQ,WAAWZ,GAAnB,EAAwB8F,KAAK7B,OAAO4E,KAApC,CAAP;EADD;;KAIIyI,kBAAkBpM,OAAtB;;KAEIoJ,OAAA,IAAmBtG,KAAK/E,OAAL,CAAa,OAAb,MAA0B,CAAjD,EAAoD;;qBAEhCjD,GAAnB,EAAwBgI,IAAxB,EAA8B9C,OAA9B,EAAuCP,EAAvC;EAFD,MAIO,IAAI2J,KAAA,IAAkBtG,SAAS,UAA3B,IAA0CoI,oBAA1C,IACA,EAAE9B,OAAA,IAAmBA,MAArB,CADJ,EAC0C;;;uBAG3BtO,GAArB,EAA0BkF,OAA1B,EAAmCP,EAAnC;EAJM,MAMA,IAAI,sBAAsB3E,GAA1B,EAA+B;;MAEjCgI,SAAS,YAAb,EAA2B;OACtBsB,gBAAJ,CAAqB,aAAatJ,GAAb,GAAmB,OAAnB,GAA6B,YAAlD,EAAgEkF,OAAhE,EAAyE,KAAzE;GADD,MAGO,IAAK8C,SAAS,YAAV,IAA4BA,SAAS,YAAzC,EAAwD;aACpD,iBAAUlC,CAAV,EAAa;QAClBA,KAAK7B,OAAO4E,KAAhB;QACI0I,iBAAiBvR,GAAjB,EAAsB8F,CAAtB,CAAJ,EAA8B;qBACbA,CAAhB;;IAHF;OAMIwD,gBAAJ,CAAqBtB,SAAS,YAAT,GAAwB,WAAxB,GAAsC,UAA3D,EAAuE9C,OAAvE,EAAgF,KAAhF;GAPM,MASA;OACF8C,SAAS,OAAT,IAAoBsG,OAAxB,EAAyC;cAC9B,iBAAUxI,CAAV,EAAa;iBACVA,CAAZ,EAAewL,eAAf;KADD;;OAIGhI,gBAAJ,CAAqBtB,IAArB,EAA2B9C,OAA3B,EAAoC,KAApC;;EApBK,MAuBA,IAAI,iBAAiBlF,GAArB,EAA0B;MAC5BwR,WAAJ,CAAgB,OAAOxJ,IAAvB,EAA6B9C,OAA7B;;;KAGGkM,SAAJ,IAAiBpR,IAAIoR,SAAJ,KAAkB,EAAnC;KACIA,SAAJ,EAAezM,EAAf,IAAqBO,OAArB;;;AAGD,SAASuM,SAAT,CAAmBzR,GAAnB,EAAwBgI,IAAxB,EAA8BjI,EAA9B,EAAkCa,OAAlC,EAA2C;;KAEtC+D,KAAKqD,OAAOf,KAAA,CAAWlH,EAAX,CAAP,IAAyBa,UAAU,MAAMqG,KAAA,CAAWrG,OAAX,CAAhB,GAAsC,EAA/D,CAAT;KACIsE,UAAUlF,IAAIoR,SAAJ,KAAkBpR,IAAIoR,SAAJ,EAAezM,EAAf,CADhC;;KAGI,CAACO,OAAL,EAAc;SAAS,IAAP;;;KAEZoJ,OAAA,IAAmBtG,KAAK/E,OAAL,CAAa,OAAb,MAA0B,CAAjD,EAAoD;wBAC7BjD,GAAtB,EAA2BgI,IAA3B,EAAiCrD,EAAjC;EADD,MAGO,IAAI2J,KAAA,IAAkBtG,SAAS,UAA3B,IAA0CgJ,uBAA9C,EAAuE;0BACrDhR,GAAxB,EAA6B2E,EAA7B;EADM,MAGA,IAAI,yBAAyB3E,GAA7B,EAAkC;;MAEpCgI,SAAS,YAAb,EAA2B;OACtBuB,mBAAJ,CAAwB,aAAavJ,GAAb,GAAmB,OAAnB,GAA6B,YAArD,EAAmEkF,OAAnE,EAA4E,KAA5E;GADD,MAGO;OACFqE,mBAAJ,CACCvB,SAAS,YAAT,GAAwB,WAAxB,GACAA,SAAS,YAAT,GAAwB,UAAxB,GAAqCA,IAFtC,EAE4C9C,OAF5C,EAEqD,KAFrD;;EANK,MAWA,IAAI,iBAAiBlF,GAArB,EAA0B;MAC5B0R,WAAJ,CAAgB,OAAO1J,IAAvB,EAA6B9C,OAA7B;;;KAGGkM,SAAJ,EAAezM,EAAf,IAAqB,IAArB;;;;;;;;;;AAUD,AAAO,SAASgN,eAAT,CAAyB7L,CAAzB,EAA4B;;KAE9BA,EAAE6L,eAAN,EAAuB;IACpBA,eAAF;EADD,MAEO,IAAI7L,EAAE8L,aAAN,EAAqB;;IACzBA,aAAF,CAAgBC,QAAhB,GAA2B,IAA3B;EADM,MAEA;IACJhB,YAAF,GAAiB,IAAjB;;SAEO/K,CAAR;;QAEO,IAAP;;;;;AAKD,AAAO,SAASgM,wBAAT,CAAkCjO,EAAlC,EAAsC;QACrCwN,OAAOxN,EAAP,EAAW,YAAX,EAAyB8N,eAAzB,CAAP;;;;;;AAMD,AAAO,SAASI,uBAAT,CAAiClO,EAAjC,EAAqC;IACxCA,EAAH,EAAO,+BAAP,EAAwC8N,eAAxC;QACO9N,EAAP,EAAW,OAAX,EAAoBmO,QAApB;QACO,IAAP;;;;;;;;AAQD,AAAO,SAASC,cAAT,CAAwBnM,CAAxB,EAA2B;KAC7BA,EAAEmM,cAAN,EAAsB;IACnBA,cAAF;EADD,MAEO;IACJC,WAAF,GAAgB,KAAhB;;QAEM,IAAP;;;;;AAKD,AAAO,SAASC,IAAT,CAAcrM,CAAd,EAAiB;gBACRA,CAAf;iBACgBA,CAAhB;QACO,IAAP;;;;;;AAMD,AAAO,SAASsM,gBAAT,CAA0BtM,CAA1B,EAA6BuM,SAA7B,EAAwC;KAC1C,CAACA,SAAL,EAAgB;SACR,IAAIhF,KAAJ,CAAUvH,EAAEwM,OAAZ,EAAqBxM,EAAEyM,OAAvB,CAAP;;;KAGGC,OAAOH,UAAUI,qBAAV,EAAX;;QAEO,IAAIpF,KAAJ,CACNvH,EAAEwM,OAAF,GAAYE,KAAKE,IAAjB,GAAwBL,UAAUM,UAD5B,EAEN7M,EAAEyM,OAAF,GAAYC,KAAKI,GAAjB,GAAuBP,UAAUQ,SAF3B,CAAP;;;;;AAOD,IAAIC,gBACFxE,GAAA,IAAeA,MAAhB,GAAkC,CAAlC,GACAA,KAAA,GAAgBrK,OAAOiI,gBAAvB,GAA0C,CAF3C;;;;;;;AASA,AAAO,SAAS6G,aAAT,CAAuBjN,CAAvB,EAA0B;QACxBwI,IAAD,GAAiBxI,EAAEkN,WAAF,GAAgB,CAAjC;GACGC,MAAF,IAAYnN,EAAEoN,SAAF,KAAgB,CAA7B,GAAkC,CAACpN,EAAEmN,MAAH,GAAYH,aAA9C;GACGG,MAAF,IAAYnN,EAAEoN,SAAF,KAAgB,CAA7B,GAAkC,CAACpN,EAAEmN,MAAH,GAAY,EAA9C;GACGA,MAAF,IAAYnN,EAAEoN,SAAF,KAAgB,CAA7B,GAAkC,CAACpN,EAAEmN,MAAH,GAAY,EAA9C;GACGE,MAAF,IAAYrN,EAAEsN,MAAf,GAAyB,CAAzB;GACEC,UAAF,GAAe,CAACvN,EAAEkN,WAAF,IAAiBlN,EAAEuN,UAApB,IAAkC,CAAjD;GACGC,MAAF,IAAY1R,KAAKwM,GAAL,CAAStI,EAAEwN,MAAX,IAAqB,KAAlC,GAA2C,CAACxN,EAAEwN,MAAH,GAAY,EAAvD;GACEA,MAAF,GAAWxN,EAAEwN,MAAF,GAAW,CAAC,KAAZ,GAAoB,EAA/B;EAPP;;;AAWD,IAAIC,aAAa,EAAjB;;AAEA,AAAO,SAASvB,QAAT,CAAkBlM,CAAlB,EAAqB;;YAEhBA,EAAEkC,IAAb,IAAqB,IAArB;;;AAGD,AAAO,SAASwL,OAAT,CAAiB1N,CAAjB,EAAoB;KACtB2N,SAASF,WAAWzN,EAAEkC,IAAb,CAAb;;YAEWlC,EAAEkC,IAAb,IAAqB,KAArB;QACOyL,MAAP;;;;AAID,AAAO,SAASlC,gBAAT,CAA0B1N,EAA1B,EAA8BiC,CAA9B,EAAiC;;KAEnC4N,UAAU5N,EAAE6N,aAAhB;;KAEI,CAACD,OAAL,EAAc;SAAS,IAAP;;;KAEZ;SACIA,WAAYA,YAAY7P,EAA/B,EAAoC;aACzB6P,QAAQE,UAAlB;;EAFF,CAIE,OAAOC,GAAP,EAAY;SACN,KAAP;;QAEOH,YAAY7P,EAApB;;;AAGD,IAAIiQ,SAAJ;;;AAGA,SAASC,WAAT,CAAqBjO,CAArB,EAAwBZ,OAAxB,EAAiC;KAC5B8O,YAAalO,EAAEkO,SAAF,IAAgBlO,EAAE8L,aAAF,IAAmB9L,EAAE8L,aAAF,CAAgBoC,SAApE;KACIC,UAAUH,aAAcE,YAAYF,SADxC;;;;;;;KAQKG,WAAWA,UAAU,GAArB,IAA4BA,UAAU,GAAvC,IAAgDnO,EAAEgD,MAAF,CAASoL,eAAT,IAA4B,CAACpO,EAAEqO,UAAnF,EAAgG;OAC1FrO,CAAL;;;aAGWkO,SAAZ;;SAEQlO,CAAR;;;;;AAKD,AAIA;;;;;;;;;;;;;;;;;;;ACvSC,IAAI,CAACsO,QAAQvU,SAAR,CAAkBwU,OAAvB,EAAgC;QACzBC,KAAKF,QAAQvU,SAAjB;;QAEIyU,GAAGC,qBAAP;WACKF,OAAH,GAAaC,GAAGC,qBAAhB;;QAEED,GAAGE,iBAAP;WACKH,OAAH,GAAaC,GAAGE,iBAAhB;;QAEEF,GAAGG,kBAAP;WACKJ,OAAH,GAAaC,GAAGG,kBAAhB;;;;;AAKN,AAAO,IAAIC,YAAYC,SACnB,CAAC,WAAD,EAAc,iBAAd,EAAiC,YAAjC,EAA+C,cAA/C,EAA+D,aAA/D,CADmB,CAAhB;;;;;;;AAQP,AAAO,IAAIC,aAAaD,SACpB,CAAC,kBAAD,EAAqB,YAArB,EAAmC,aAAnC,EAAkD,eAAlD,EAAmE,cAAnE,CADoB,CAAjB;;AAGP,AAAO,IAAIE,iBACPD,eAAe,kBAAf,IAAqCA,eAAe,aAApD,GAAoEA,aAAa,KAAjF,GAAyF,eADtF;;;;;AAOP,AAAO,SAASE,KAAT,CAAanQ,EAAb,EAAiB;WACb,OAAOA,EAAP,KAAc,QAAd,GAAyBuB,SAAS6O,cAAT,CAAwBpQ,EAAxB,CAAzB,GAAuDA,EAA9D;;;;;;AAMJ,AAAO,SAASqQ,QAAT,CAAkBnR,EAAlB,EAAsB+F,KAAtB,EAA6B;QAC5BrG,QAAQM,GAAG+F,KAAH,CAASA,KAAT,KAAoB/F,GAAGoR,YAAH,IAAmBpR,GAAGoR,YAAH,CAAgBrL,KAAhB,CAAnD;;QAEI,CAAC,CAACrG,KAAD,IAAUA,UAAU,MAArB,KAAgC2C,SAASgP,WAA7C,EAA0D;YAClDC,MAAMjP,SAASgP,WAAT,CAAqBE,gBAArB,CAAsCvR,EAAtC,EAA0C,IAA1C,CAAV;gBACQsR,MAAMA,IAAIvL,KAAJ,CAAN,GAAmB,IAA3B;;WAEGrG,UAAU,MAAV,GAAmB,IAAnB,GAA0BA,KAAjC;;;;;AAKJ,AAAO,SAAS9D,QAAT,CAAgB2P,OAAhB,EAAyBiG,SAAzB,EAAoChD,SAApC,EAA+C;QAC9CxO,KAAKqC,SAASC,aAAT,CAAuBiJ,OAAvB,CAAT;OACGiG,SAAH,GAAeA,aAAa,EAA5B;;QAEIhD,SAAJ,EAAe;kBACD5L,WAAV,CAAsB5C,EAAtB;;WAEGA,EAAP;;;;;AAKJ,AAAO,SAASyR,MAAT,CAAgBzR,EAAhB,EAAoB;QACnB0C,SAAS1C,GAAG+P,UAAhB;QACIrN,MAAJ,EAAY;eACDgP,WAAP,CAAmB1R,EAAnB;;;;;;AAMR,AAAO,SAAS2R,KAAT,CAAe3R,EAAf,EAAmB;WACfA,GAAGgJ,UAAV,EAAsB;WACf0I,WAAH,CAAe1R,GAAGgJ,UAAlB;;;;;;AAMR,AAAO,SAAS4I,OAAT,CAAiB5R,EAAjB,EAAqB;OACrB+P,UAAH,CAAcnN,WAAd,CAA0B5C,EAA1B;;;;;AAKJ,AAAO,SAAS6R,MAAT,CAAgB7R,EAAhB,EAAoB;QACnB0C,SAAS1C,GAAG+P,UAAhB;WACO+B,YAAP,CAAoB9R,EAApB,EAAwB0C,OAAOsG,UAA/B;;;;;AAKJ,AAAO,SAAS+I,QAAT,CAAkB/R,EAAlB,EAAsBG,IAAtB,EAA4B;QAC3BH,GAAGqJ,SAAH,KAAiB1J,SAArB,EAAgC;eACrBK,GAAGqJ,SAAH,CAAa2I,QAAb,CAAsB7R,IAAtB,CAAP;;QAEAqR,YAAYS,SAASjS,EAAT,CAAhB;WACOwR,UAAU7V,MAAV,GAAmB,CAAnB,IAAwB,IAAIuW,MAAJ,CAAW,YAAY/R,IAAZ,GAAmB,SAA9B,EAAyCgS,IAAzC,CAA8CX,SAA9C,CAA/B;;;;;AAKJ,AAAO,SAASY,QAAT,CAAkBpS,EAAlB,EAAsBG,IAAtB,EAA4B;QAC3BH,GAAGqJ,SAAH,KAAiB1J,SAArB,EAAgC;YACxB0S,UAAUjP,UAAA,CAAgBjD,IAAhB,CAAd;aACK,IAAI7E,IAAI,CAAR,EAAWE,MAAM6W,QAAQ1W,MAA9B,EAAsCL,IAAIE,GAA1C,EAA+CF,GAA/C,EAAoD;eAC7C+N,SAAH,CAAaiJ,GAAb,CAAiBD,QAAQ/W,CAAR,CAAjB;;KAHR,MAKO,IAAI,CAACyW,SAAS/R,EAAT,EAAaG,IAAb,CAAL,EAAyB;YACxBqR,YAAYS,SAASjS,EAAT,CAAhB;iBACSA,EAAT,EAAa,CAACwR,YAAYA,YAAY,GAAxB,GAA8B,EAA/B,IAAqCrR,IAAlD;;;;;;AAMR,AAAO,SAASoS,WAAT,CAAqBvS,EAArB,EAAyBG,IAAzB,EAA+B;QAC9BH,GAAGqJ,SAAH,KAAiB1J,SAArB,EAAgC;WACzB0J,SAAH,CAAaoI,MAAb,CAAoBtR,IAApB;KADJ,MAEO;iBACMH,EAAT,EAAaoD,IAAA,CAAU,CAAC,MAAM6O,SAASjS,EAAT,CAAN,GAAqB,GAAtB,EAA2BzB,OAA3B,CAAmC,MAAM4B,IAAN,GAAa,GAAhD,EAAqD,GAArD,CAAV,CAAb;;;;;;AAMR,AAAO,SAASqS,QAAT,CAAkBxS,EAAlB,EAAsBG,IAAtB,EAA4B;QAC3BH,GAAGwR,SAAH,CAAaiB,OAAb,KAAyB9S,SAA7B,EAAwC;WACjC6R,SAAH,GAAerR,IAAf;KADJ,MAEO;;WAEAqR,SAAH,CAAaiB,OAAb,GAAuBtS,IAAvB;;;;;;AAMR,AAAO,SAAS8R,QAAT,CAAkBjS,EAAlB,EAAsB;WAClBA,GAAGwR,SAAH,CAAaiB,OAAb,KAAyB9S,SAAzB,GAAqCK,GAAGwR,SAAxC,GAAoDxR,GAAGwR,SAAH,CAAaiB,OAAxE;;;;;;AAMJ,AAAO,SAASC,UAAT,CAAoB1S,EAApB,EAAwBN,KAAxB,EAA+B;QAC9B,aAAaM,GAAG+F,KAApB,EAA2B;WACpBA,KAAH,CAAS4M,OAAT,GAAmBjT,KAAnB;KADJ,MAEO,IAAI,YAAYM,GAAG+F,KAAnB,EAA0B;sBACf/F,EAAd,EAAkBN,KAAlB;;;;AAIR,SAASkT,aAAT,CAAuB5S,EAAvB,EAA2BN,KAA3B,EAAkC;QAC1BmT,SAAS,KAAb;QACIC,aAAa,kCADjB;;;QAII;iBACS9S,GAAG+S,OAAH,CAAWC,IAAX,CAAgBF,UAAhB,CAAT;KADJ,CAEE,OAAO7Q,CAAP,EAAU;;;YAGJvC,UAAU,CAAd,EAAiB;;;;;YAGb3B,KAAKC,KAAL,CAAW0B,QAAQ,GAAnB,CAAR;;QAEImT,MAAJ,EAAY;eACDI,OAAP,GAAkBvT,UAAU,GAA5B;eACOwT,OAAP,GAAiBxT,KAAjB;KAFJ,MAGO;WACAqG,KAAH,CAAS8M,MAAT,IAAmB,aAAaC,UAAb,GAA0B,WAA1B,GAAwCpT,KAAxC,GAAgD,GAAnE;;;;;;;;AAQR,AAAO,SAASoR,QAAT,CAAkBhO,KAAlB,EAAyB;QACxBiD,QAAQ1D,SAAS2D,eAAT,CAAyBD,KAArC;;SAEK,IAAIzK,IAAI,CAAb,EAAgBA,IAAIwH,MAAMnH,MAA1B,EAAkCL,GAAlC,EAAuC;YAC/BwH,MAAMxH,CAAN,KAAYyK,KAAhB,EAAuB;mBACZjD,MAAMxH,CAAN,CAAP;;;WAGD,KAAP;;;AAGJ,AAAO,SAAS6X,mBAAT,CAA6BjG,IAA7B,EAAmC;QAClCnH,QAAQ1D,SAAS2D,eAAT,CAAyBD,KAArC;WACOmH,QAAQnH,KAAf;;;;;;;AAOJ,AAAO,SAASqN,YAAT,CAAsBpT,EAAtB,EAA0BqT,MAA1B,EAAkCC,KAAlC,EAAyC;QACxCC,MAAMF,UAAU,IAAI7J,KAAJ,CAAU,CAAV,EAAa,CAAb,CAApB;;OAEGzD,KAAH,CAAS8K,SAAT,IACI,CAACpG,IAAA,GACG,eAAe8I,IAAInW,CAAnB,GAAuB,KAAvB,GAA+BmW,IAAI9J,CAAnC,GAAuC,KAD1C,GAEG,iBAAiB8J,IAAInW,CAArB,GAAyB,KAAzB,GAAiCmW,IAAI9J,CAArC,GAAyC,OAF7C,KAGC6J,QAAQ,YAAYA,KAAZ,GAAoB,GAA5B,GAAkC,EAHnC,CADJ;;;;;;;AAWJ,AAAO,SAASE,WAAT,CAAqBxT,EAArB,EAAyB0J,KAAzB,EAAgC;;;OAGhC+J,YAAH,GAAkB/J,KAAlB;;;QAGIe,KAAJ,EAAmB;qBACFzK,EAAb,EAAiB0J,KAAjB;KADJ,MAEO;WACA3D,KAAH,CAAS8I,IAAT,GAAgBnF,MAAMtM,CAAN,GAAU,IAA1B;WACG2I,KAAH,CAASgJ,GAAT,GAAerF,MAAMD,CAAN,GAAU,IAAzB;;;;;;AAMR,AAAO,SAASiK,WAAT,CAAqB1T,EAArB,EAAyB;;;;WAIrBA,GAAGyT,YAAH,IAAmB,IAAIjK,KAAJ,CAAU,CAAV,EAAa,CAAb,CAA1B;;;;;;;;;;;AAWJ,AAAO,IAAImK,oBAAJ;AACP,AAAO,IAAIC,mBAAJ;AACP,IAAIC,WAAJ;AACA,IAAI,mBAAmBxR,QAAvB,EAAiC;2BACN,gCAAY;UAC/B,CAAYjC,MAAZ,EAAoB,aAApB,EAAmC0T,cAAnC;KADJ;0BAGsB,+BAAY;WAC9B,CAAa1T,MAAb,EAAqB,aAArB,EAAoC0T,cAApC;KADJ;CAJJ,MAOO;QACCC,qBAAqBjD,SACrB,CAAC,YAAD,EAAe,kBAAf,EAAmC,aAAnC,EAAkD,eAAlD,EAAmE,cAAnE,CADqB,CAAzB;;2BAGuB,gCAAY;YAC3BiD,kBAAJ,EAAwB;gBAChBhO,QAAQ1D,SAAS2D,eAAT,CAAyBD,KAArC;0BACcA,MAAMgO,kBAAN,CAAd;kBACMA,kBAAN,IAA4B,MAA5B;;KAJR;0BAOsB,+BAAY;YAC1BA,kBAAJ,EAAwB;qBACX/N,eAAT,CAAyBD,KAAzB,CAA+BgO,kBAA/B,IAAqDF,WAArD;0BACclU,SAAd;;KAHR;;;;;;AAWJ,AAAO,SAASqU,gBAAT,GAA4B;MAC/B,CAAY5T,MAAZ,EAAoB,WAApB,EAAiC0T,cAAjC;;;;;AAKJ,AAAO,SAASG,eAAT,GAA2B;OAC9B,CAAa7T,MAAb,EAAqB,WAArB,EAAkC0T,cAAlC;;;AAGJ,IAAII,eAAJ;IAAqBC,aAArB;;;;;;AAMA,AAAO,SAASC,cAAT,CAAwBhS,OAAxB,EAAiC;WAC7BA,QAAQiS,QAAR,KAAqB,CAAC,CAA7B,EAAgC;kBAClBjS,QAAQ2N,UAAlB;;QAEA,CAAC3N,OAAD,IAAY,CAACA,QAAQ2D,KAAzB,EAAgC;;;;sBAEd3D,OAAlB;oBACgBA,QAAQ2D,KAAR,CAAcuO,OAA9B;YACQvO,KAAR,CAAcuO,OAAd,GAAwB,MAAxB;MACA,CAAYlU,MAAZ,EAAoB,SAApB,EAA+BmU,cAA/B;;;;;AAKJ,AAAO,SAASA,cAAT,GAA0B;QACzB,CAACL,eAAL,EAAsB;;;oBACNnO,KAAhB,CAAsBuO,OAAtB,GAAgCH,aAAhC;sBACkBxU,SAAlB;oBACgBA,SAAhB;OACA,CAAaS,MAAb,EAAqB,SAArB,EAAgCmU,cAAhC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzUJ;;;;;;;;;;;;;;;;;;;;;;;;;AAyBA,SAAS,QAAQ,CAAC,KAAK,EAAE;EACvB,IAAI,IAAI,GAAG,OAAO,KAAK,CAAC;EACxB,OAAO,KAAK,IAAI,IAAI,KAAK,IAAI,IAAI,QAAQ,IAAI,IAAI,IAAI,UAAU,CAAC,CAAC;CAClE;;AAED,cAAc,GAAG,QAAQ,CAAC;;AC7B1B,IAAI,UAAU,GAAG,OAAOrZ,cAAM,IAAI,QAAQ,IAAIA,cAAM,IAAIA,cAAM,CAAC,MAAM,KAAK,MAAM,IAAIA,cAAM,CAAC;;AAE3F,eAAc,GAAG,UAAU,CAAC;;ACA5B,IAAI,QAAQ,GAAG,OAAO,IAAI,IAAI,QAAQ,IAAI,IAAI,IAAI,IAAI,CAAC,MAAM,KAAK,MAAM,IAAI,IAAI,CAAC;;;AAGjF,IAAI,IAAI,GAAGsZ,WAAU,IAAI,QAAQ,IAAI,QAAQ,CAAC,aAAa,CAAC,EAAE,CAAC;;AAE/D,SAAc,GAAG,IAAI,CAAC;;ACLtB,IAAIC,QAAM,GAAGC,KAAI,CAAC,MAAM,CAAC;;AAEzB,WAAc,GAAGD,QAAM,CAAC;;ACFxB,IAAI,WAAW,GAAG,MAAM,CAAC,SAAS,CAAC;;;AAGnC,IAAI,cAAc,GAAG,WAAW,CAAC,cAAc,CAAC;;;;;;;AAOhD,IAAI,oBAAoB,GAAG,WAAW,CAAC,QAAQ,CAAC;;;AAGhD,IAAIE,gBAAc,GAAGF,OAAM,GAAGA,OAAM,CAAC,WAAW,GAAG,SAAS,CAAC;;;;;;;;;AAS7D,SAAS,SAAS,CAAC,KAAK,EAAE;EACxB,IAAI,KAAK,GAAG,cAAc,CAAC,IAAI,CAAC,KAAK,EAAEE,gBAAc,CAAC;MAClD,GAAG,GAAG,KAAK,CAACA,gBAAc,CAAC,CAAC;;EAEhC,IAAI;IACF,KAAK,CAACA,gBAAc,CAAC,GAAG,SAAS,CAAC;IAClC,IAAI,QAAQ,GAAG,IAAI,CAAC;GACrB,CAAC,OAAO,CAAC,EAAE,EAAE;;EAEd,IAAI,MAAM,GAAG,oBAAoB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;EAC9C,IAAI,QAAQ,EAAE;IACZ,IAAI,KAAK,EAAE;MACT,KAAK,CAACA,gBAAc,CAAC,GAAG,GAAG,CAAC;KAC7B,MAAM;MACL,OAAO,KAAK,CAACA,gBAAc,CAAC,CAAC;KAC9B;GACF;EACD,OAAO,MAAM,CAAC;CACf;;AAED,cAAc,GAAG,SAAS,CAAC;;AC7C3B;AACA,IAAIC,aAAW,GAAG,MAAM,CAAC,SAAS,CAAC;;;;;;;AAOnC,IAAIC,sBAAoB,GAAGD,aAAW,CAAC,QAAQ,CAAC;;;;;;;;;AAShD,SAAS,cAAc,CAAC,KAAK,EAAE;EAC7B,OAAOC,sBAAoB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;CACzC;;AAED,mBAAc,GAAG,cAAc,CAAC;;AChBhC,IAAI,OAAO,GAAG,eAAe;IACzB,YAAY,GAAG,oBAAoB,CAAC;;;AAGxC,IAAI,cAAc,GAAGJ,OAAM,GAAGA,OAAM,CAAC,WAAW,GAAG,SAAS,CAAC;;;;;;;;;AAS7D,SAAS,UAAU,CAAC,KAAK,EAAE;EACzB,IAAI,KAAK,IAAI,IAAI,EAAE;IACjB,OAAO,KAAK,KAAK,SAAS,GAAG,YAAY,GAAG,OAAO,CAAC;GACrD;EACD,OAAO,CAAC,cAAc,IAAI,cAAc,IAAI,MAAM,CAAC,KAAK,CAAC;MACrDK,UAAS,CAAC,KAAK,CAAC;MAChBC,eAAc,CAAC,KAAK,CAAC,CAAC;CAC3B;;AAED,eAAc,GAAG,UAAU,CAAC;;AC3B5B;;;;;;;;;;;;;;;;;;;;;;;;AAwBA,SAAS,YAAY,CAAC,KAAK,EAAE;EAC3B,OAAO,KAAK,IAAI,IAAI,IAAI,OAAO,KAAK,IAAI,QAAQ,CAAC;CAClD;;AAED,kBAAc,GAAG,YAAY,CAAC;;ACxB9B,IAAI,QAAQ,GAAG,wBAAwB;IACnC,OAAO,GAAG,mBAAmB;IAC7B,MAAM,GAAG,4BAA4B;IACrC,QAAQ,GAAG,gBAAgB,CAAC;;;;;;;;;;;;;;;;;;;AAmBhC,SAAS,UAAU,CAAC,KAAK,EAAE;EACzB,IAAI,CAACC,UAAQ,CAAC,KAAK,CAAC,EAAE;IACpB,OAAO,KAAK,CAAC;GACd;;;EAGD,IAAI,GAAG,GAAGC,WAAU,CAAC,KAAK,CAAC,CAAC;EAC5B,OAAO,GAAG,IAAI,OAAO,IAAI,GAAG,IAAI,MAAM,IAAI,GAAG,IAAI,QAAQ,IAAI,GAAG,IAAI,QAAQ,CAAC;CAC9E;;AAED,gBAAc,GAAG,UAAU,CAAC;;ACjC5B,IAAI,UAAU,GAAGP,KAAI,CAAC,oBAAoB,CAAC,CAAC;;AAE5C,eAAc,GAAG,UAAU,CAAC;;ACF5B,IAAI,UAAU,IAAI,WAAW;EAC3B,IAAI,GAAG,GAAG,QAAQ,CAAC,IAAI,CAACQ,WAAU,IAAIA,WAAU,CAAC,IAAI,IAAIA,WAAU,CAAC,IAAI,CAAC,QAAQ,IAAI,EAAE,CAAC,CAAC;EACzF,OAAO,GAAG,IAAI,gBAAgB,GAAG,GAAG,IAAI,EAAE,CAAC;CAC5C,EAAE,CAAC,CAAC;;;;;;;;;AASL,SAAS,QAAQ,CAAC,IAAI,EAAE;EACtB,OAAO,CAAC,CAAC,UAAU,KAAK,UAAU,IAAI,IAAI,CAAC,CAAC;CAC7C;;AAED,aAAc,GAAG,QAAQ,CAAC;;ACnB1B;AACA,IAAIC,WAAS,GAAG,QAAQ,CAAC,SAAS,CAAC;;;AAGnC,IAAIC,cAAY,GAAGD,WAAS,CAAC,QAAQ,CAAC;;;;;;;;;AAStC,SAAS,QAAQ,CAAC,IAAI,EAAE;EACtB,IAAI,IAAI,IAAI,IAAI,EAAE;IAChB,IAAI;MACF,OAAOC,cAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KAChC,CAAC,OAAO,CAAC,EAAE,EAAE;IACd,IAAI;MACF,QAAQ,IAAI,GAAG,EAAE,EAAE;KACpB,CAAC,OAAO,CAAC,EAAE,EAAE;GACf;EACD,OAAO,EAAE,CAAC;CACX;;AAED,aAAc,GAAG,QAAQ,CAAC;;AChB1B,IAAI,YAAY,GAAG,qBAAqB,CAAC;;;AAGzC,IAAI,YAAY,GAAG,6BAA6B,CAAC;;;AAGjD,IAAI,SAAS,GAAG,QAAQ,CAAC,SAAS;IAC9BR,aAAW,GAAG,MAAM,CAAC,SAAS,CAAC;;;AAGnC,IAAI,YAAY,GAAG,SAAS,CAAC,QAAQ,CAAC;;;AAGtC,IAAIhW,gBAAc,GAAGgW,aAAW,CAAC,cAAc,CAAC;;;AAGhD,IAAI,UAAU,GAAG,MAAM,CAAC,GAAG;EACzB,YAAY,CAAC,IAAI,CAAChW,gBAAc,CAAC,CAAC,OAAO,CAAC,YAAY,EAAE,MAAM,CAAC;GAC9D,OAAO,CAAC,wDAAwD,EAAE,OAAO,CAAC,GAAG,GAAG;CAClF,CAAC;;;;;;;;;;AAUF,SAAS,YAAY,CAAC,KAAK,EAAE;EAC3B,IAAI,CAACoW,UAAQ,CAAC,KAAK,CAAC,IAAIK,SAAQ,CAAC,KAAK,CAAC,EAAE;IACvC,OAAO,KAAK,CAAC;GACd;EACD,IAAI,OAAO,GAAGC,YAAU,CAAC,KAAK,CAAC,GAAG,UAAU,GAAG,YAAY,CAAC;EAC5D,OAAO,OAAO,CAAC,IAAI,CAACC,SAAQ,CAAC,KAAK,CAAC,CAAC,CAAC;CACtC;;AAED,iBAAc,GAAG,YAAY,CAAC;;AC9C9B;;;;;;;;AAQA,SAAS,QAAQ,CAAC,MAAM,EAAE,GAAG,EAAE;EAC7B,OAAO,MAAM,IAAI,IAAI,GAAG,SAAS,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;CACjD;;AAED,aAAc,GAAG,QAAQ,CAAC;;ACD1B,SAAS,SAAS,CAAC,MAAM,EAAE,GAAG,EAAE;EAC9B,IAAI,KAAK,GAAGC,SAAQ,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;EAClC,OAAOC,aAAY,CAAC,KAAK,CAAC,GAAG,KAAK,GAAG,SAAS,CAAC;CAChD;;AAED,cAAc,GAAG,SAAS,CAAC;;ACd3B,IAAIC,gBAAc,IAAI,WAAW;EAC/B,IAAI;IACF,IAAI,IAAI,GAAGC,UAAS,CAAC,MAAM,EAAE,gBAAgB,CAAC,CAAC;IAC/C,IAAI,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;IACjB,OAAO,IAAI,CAAC;GACb,CAAC,OAAO,CAAC,EAAE,EAAE;CACf,EAAE,CAAC,CAAC;;AAEL,mBAAc,GAAGD,gBAAc,CAAC;;ACChC,SAAS,eAAe,CAAC,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE;EAC3C,IAAI,GAAG,IAAI,WAAW,IAAIA,eAAc,EAAE;IACxCA,eAAc,CAAC,MAAM,EAAE,GAAG,EAAE;MAC1B,cAAc,EAAE,IAAI;MACpB,YAAY,EAAE,IAAI;MAClB,OAAO,EAAE,KAAK;MACd,UAAU,EAAE,IAAI;KACjB,CAAC,CAAC;GACJ,MAAM;IACL,MAAM,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;GACrB;CACF;;AAED,oBAAc,GAAG,eAAe,CAAC;;ACxBjC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgCA,SAAS,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE;EACxB,OAAO,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,IAAI,KAAK,KAAK,KAAK,CAAC,CAAC;CAChE;;AAED,QAAc,GAAG,EAAE,CAAC;;AChCpB,IAAId,aAAW,GAAG,MAAM,CAAC,SAAS,CAAC;;;AAGnC,IAAIhW,gBAAc,GAAGgW,aAAW,CAAC,cAAc,CAAC;;;;;;;;;;;;AAYhD,SAAS,WAAW,CAAC,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE;EACvC,IAAI,QAAQ,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;EAC3B,IAAI,EAAEhW,gBAAc,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,IAAIgX,IAAE,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;OACzD,KAAK,KAAK,SAAS,IAAI,EAAE,GAAG,IAAI,MAAM,CAAC,CAAC,EAAE;IAC7CC,gBAAe,CAAC,MAAM,EAAE,GAAG,EAAE,KAAK,CAAC,CAAC;GACrC;CACF;;AAED,gBAAc,GAAG,WAAW,CAAC;;ACd7B,SAAS,UAAU,CAAC,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,UAAU,EAAE;EACrD,IAAI,KAAK,GAAG,CAAC,MAAM,CAAC;EACpB,MAAM,KAAK,MAAM,GAAG,EAAE,CAAC,CAAC;;EAExB,IAAI,KAAK,GAAG,CAAC,CAAC;MACV,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;;EAE1B,OAAO,EAAE,KAAK,GAAG,MAAM,EAAE;IACvB,IAAI,GAAG,GAAG,KAAK,CAAC,KAAK,CAAC,CAAC;;IAEvB,IAAI,QAAQ,GAAG,UAAU;QACrB,UAAU,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,MAAM,CAAC,GAAG,CAAC,EAAE,GAAG,EAAE,MAAM,EAAE,MAAM,CAAC;QACzD,SAAS,CAAC;;IAEd,IAAI,QAAQ,KAAK,SAAS,EAAE;MAC1B,QAAQ,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;KACxB;IACD,IAAI,KAAK,EAAE;MACTA,gBAAe,CAAC,MAAM,EAAE,GAAG,EAAE,QAAQ,CAAC,CAAC;KACxC,MAAM;MACLC,YAAW,CAAC,MAAM,EAAE,GAAG,EAAE,QAAQ,CAAC,CAAC;KACpC;GACF;EACD,OAAO,MAAM,CAAC;CACf;;AAED,eAAc,GAAG,UAAU,CAAC;;ACvC5B;;;;;;;;;;;;;;;;AAgBA,SAAS,QAAQ,CAAC,KAAK,EAAE;EACvB,OAAO,KAAK,CAAC;CACd;;AAED,cAAc,GAAG,QAAQ,CAAC;;ACpB1B;;;;;;;;;;AAUA,SAAS,KAAK,CAAC,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE;EAClC,QAAQ,IAAI,CAAC,MAAM;IACjB,KAAK,CAAC,EAAE,OAAO,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IAClC,KAAK,CAAC,EAAE,OAAO,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;IAC3C,KAAK,CAAC,EAAE,OAAO,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;IACpD,KAAK,CAAC,EAAE,OAAO,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;GAC9D;EACD,OAAO,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;CAClC;;AAED,UAAc,GAAG,KAAK,CAAC;;ACjBvB,IAAIC,WAAS,GAAG,IAAI,CAAC,GAAG,CAAC;;;;;;;;;;;AAWzB,SAAS,QAAQ,CAAC,IAAI,EAAE,KAAK,EAAE,SAAS,EAAE;EACxC,KAAK,GAAGA,WAAS,CAAC,KAAK,KAAK,SAAS,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,IAAI,KAAK,EAAE,CAAC,CAAC,CAAC;EACtE,OAAO,WAAW;IAChB,IAAI,IAAI,GAAG,SAAS;QAChB,KAAK,GAAG,CAAC,CAAC;QACV,MAAM,GAAGA,WAAS,CAAC,IAAI,CAAC,MAAM,GAAG,KAAK,EAAE,CAAC,CAAC;QAC1C,KAAK,GAAG,KAAK,CAAC,MAAM,CAAC,CAAC;;IAE1B,OAAO,EAAE,KAAK,GAAG,MAAM,EAAE;MACvB,KAAK,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC,CAAC;KACpC;IACD,KAAK,GAAG,CAAC,CAAC,CAAC;IACX,IAAI,SAAS,GAAG,KAAK,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;IACjC,OAAO,EAAE,KAAK,GAAG,KAAK,EAAE;MACtB,SAAS,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC;KAChC;IACD,SAAS,CAAC,KAAK,CAAC,GAAG,SAAS,CAAC,KAAK,CAAC,CAAC;IACpC,OAAOzZ,MAAK,CAAC,IAAI,EAAE,IAAI,EAAE,SAAS,CAAC,CAAC;GACrC,CAAC;CACH;;AAED,aAAc,GAAG,QAAQ,CAAC;;ACnC1B;;;;;;;;;;;;;;;;;;;AAmBA,SAAS,QAAQ,CAAC,KAAK,EAAE;EACvB,OAAO,WAAW;IAChB,OAAO,KAAK,CAAC;GACd,CAAC;CACH;;AAED,cAAc,GAAG,QAAQ,CAAC;;ACb1B,IAAI,eAAe,GAAG,CAACoZ,eAAc,GAAGM,UAAQ,GAAG,SAAS,IAAI,EAAE,MAAM,EAAE;EACxE,OAAON,eAAc,CAAC,IAAI,EAAE,UAAU,EAAE;IACtC,cAAc,EAAE,IAAI;IACpB,YAAY,EAAE,KAAK;IACnB,OAAO,EAAEO,UAAQ,CAAC,MAAM,CAAC;IACzB,UAAU,EAAE,IAAI;GACjB,CAAC,CAAC;CACJ,CAAC;;AAEF,oBAAc,GAAG,eAAe,CAAC;;ACrBjC;AACA,IAAI,SAAS,GAAG,GAAG;IACf,QAAQ,GAAG,EAAE,CAAC;;;AAGlB,IAAI,SAAS,GAAG,IAAI,CAAC,GAAG,CAAC;;;;;;;;;;;AAWzB,SAAS,QAAQ,CAAC,IAAI,EAAE;EACtB,IAAI,KAAK,GAAG,CAAC;MACT,UAAU,GAAG,CAAC,CAAC;;EAEnB,OAAO,WAAW;IAChB,IAAI,KAAK,GAAG,SAAS,EAAE;QACnB,SAAS,GAAG,QAAQ,IAAI,KAAK,GAAG,UAAU,CAAC,CAAC;;IAEhD,UAAU,GAAG,KAAK,CAAC;IACnB,IAAI,SAAS,GAAG,CAAC,EAAE;MACjB,IAAI,EAAE,KAAK,IAAI,SAAS,EAAE;QACxB,OAAO,SAAS,CAAC,CAAC,CAAC,CAAC;OACrB;KACF,MAAM;MACL,KAAK,GAAG,CAAC,CAAC;KACX;IACD,OAAO,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;GACzC,CAAC;CACH;;AAED,aAAc,GAAG,QAAQ,CAAC;;ACzB1B,IAAI,WAAW,GAAGC,SAAQ,CAACC,gBAAe,CAAC,CAAC;;AAE5C,gBAAc,GAAG,WAAW,CAAC;;ACD7B,SAAS,QAAQ,CAAC,IAAI,EAAE,KAAK,EAAE;EAC7B,OAAOC,YAAW,CAACC,SAAQ,CAAC,IAAI,EAAE,KAAK,EAAEL,UAAQ,CAAC,EAAE,IAAI,GAAG,EAAE,CAAC,CAAC;CAChE;;AAED,aAAc,GAAG,QAAQ,CAAC;;AChB1B;AACA,IAAI,gBAAgB,GAAG,gBAAgB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4BxC,SAAS,QAAQ,CAAC,KAAK,EAAE;EACvB,OAAO,OAAO,KAAK,IAAI,QAAQ;IAC7B,KAAK,GAAG,CAAC,CAAC,IAAI,KAAK,GAAG,CAAC,IAAI,CAAC,IAAI,KAAK,IAAI,gBAAgB,CAAC;CAC7D;;AAED,cAAc,GAAG,QAAQ,CAAC;;ACN1B,SAAS,WAAW,CAAC,KAAK,EAAE;EAC1B,OAAO,KAAK,IAAI,IAAI,IAAIM,UAAQ,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAChB,YAAU,CAAC,KAAK,CAAC,CAAC;CACtE;;AAED,iBAAc,GAAG,WAAW,CAAC;;AChC7B;AACA,IAAIiB,kBAAgB,GAAG,gBAAgB,CAAC;;;AAGxC,IAAI,QAAQ,GAAG,kBAAkB,CAAC;;;;;;;;;;AAUlC,SAAS,OAAO,CAAC,KAAK,EAAE,MAAM,EAAE;EAC9B,MAAM,GAAG,MAAM,IAAI,IAAI,GAAGA,kBAAgB,GAAG,MAAM,CAAC;EACpD,OAAO,CAAC,CAAC,MAAM;KACZ,OAAO,KAAK,IAAI,QAAQ,IAAI,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;KACjD,KAAK,GAAG,CAAC,CAAC,IAAI,KAAK,GAAG,CAAC,IAAI,CAAC,IAAI,KAAK,GAAG,MAAM,CAAC,CAAC;CACpD;;AAED,YAAc,GAAG,OAAO,CAAC;;ACNzB,SAAS,cAAc,CAAC,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE;EAC5C,IAAI,CAACvB,UAAQ,CAAC,MAAM,CAAC,EAAE;IACrB,OAAO,KAAK,CAAC;GACd;EACD,IAAI,IAAI,GAAG,OAAO,KAAK,CAAC;EACxB,IAAI,IAAI,IAAI,QAAQ;WACXwB,aAAW,CAAC,MAAM,CAAC,IAAIC,QAAO,CAAC,KAAK,EAAE,MAAM,CAAC,MAAM,CAAC;WACpD,IAAI,IAAI,QAAQ,IAAI,KAAK,IAAI,MAAM,CAAC;QACvC;IACJ,OAAOb,IAAE,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE,KAAK,CAAC,CAAC;GACjC;EACD,OAAO,KAAK,CAAC;CACd;;AAED,mBAAc,GAAG,cAAc,CAAC;;ACnBhC,SAAS,cAAc,CAAC,QAAQ,EAAE;EAChC,OAAOc,SAAQ,CAAC,SAAS,MAAM,EAAE,OAAO,EAAE;IACxC,IAAI,KAAK,GAAG,CAAC,CAAC;QACV,MAAM,GAAG,OAAO,CAAC,MAAM;QACvB,UAAU,GAAG,MAAM,GAAG,CAAC,GAAG,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,GAAG,SAAS;QACzD,KAAK,GAAG,MAAM,GAAG,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC;;IAEhD,UAAU,GAAG,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,IAAI,OAAO,UAAU,IAAI,UAAU;SAC/D,MAAM,EAAE,EAAE,UAAU;QACrB,SAAS,CAAC;;IAEd,IAAI,KAAK,IAAIC,eAAc,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,EAAE;MAC1D,UAAU,GAAG,MAAM,GAAG,CAAC,GAAG,SAAS,GAAG,UAAU,CAAC;MACjD,MAAM,GAAG,CAAC,CAAC;KACZ;IACD,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC;IACxB,OAAO,EAAE,KAAK,GAAG,MAAM,EAAE;MACvB,IAAI,MAAM,GAAG,OAAO,CAAC,KAAK,CAAC,CAAC;MAC5B,IAAI,MAAM,EAAE;QACV,QAAQ,CAAC,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,UAAU,CAAC,CAAC;OAC7C;KACF;IACD,OAAO,MAAM,CAAC;GACf,CAAC,CAAC;CACJ;;AAED,mBAAc,GAAG,cAAc,CAAC;;ACpChC;AACA,IAAI/B,aAAW,GAAG,MAAM,CAAC,SAAS,CAAC;;;;;;;;;AASnC,SAAS,WAAW,CAAC,KAAK,EAAE;EAC1B,IAAI,IAAI,GAAG,KAAK,IAAI,KAAK,CAAC,WAAW;MACjC,KAAK,GAAG,CAAC,OAAO,IAAI,IAAI,UAAU,IAAI,IAAI,CAAC,SAAS,KAAKA,aAAW,CAAC;;EAEzE,OAAO,KAAK,KAAK,KAAK,CAAC;CACxB;;AAED,gBAAc,GAAG,WAAW,CAAC;;ACjB7B;;;;;;;;;AASA,SAAS,SAAS,CAAC,CAAC,EAAE,QAAQ,EAAE;EAC9B,IAAI,KAAK,GAAG,CAAC,CAAC;MACV,MAAM,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;;EAEtB,OAAO,EAAE,KAAK,GAAG,CAAC,EAAE;IAClB,MAAM,CAAC,KAAK,CAAC,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC;GACjC;EACD,OAAO,MAAM,CAAC;CACf;;AAED,cAAc,GAAG,SAAS,CAAC;;ACf3B,IAAI,OAAO,GAAG,oBAAoB,CAAC;;;;;;;;;AASnC,SAAS,eAAe,CAAC,KAAK,EAAE;EAC9B,OAAOgC,cAAY,CAAC,KAAK,CAAC,IAAI3B,WAAU,CAAC,KAAK,CAAC,IAAI,OAAO,CAAC;CAC5D;;AAED,oBAAc,GAAG,eAAe,CAAC;;ACbjC,IAAIL,aAAW,GAAG,MAAM,CAAC,SAAS,CAAC;;;AAGnC,IAAIhW,gBAAc,GAAGgW,aAAW,CAAC,cAAc,CAAC;;;AAGhD,IAAI,oBAAoB,GAAGA,aAAW,CAAC,oBAAoB,CAAC;;;;;;;;;;;;;;;;;;;;AAoB5D,IAAI,WAAW,GAAGiC,gBAAe,CAAC,WAAW,EAAE,OAAO,SAAS,CAAC,EAAE,EAAE,CAAC,GAAGA,gBAAe,GAAG,SAAS,KAAK,EAAE;EACxG,OAAOD,cAAY,CAAC,KAAK,CAAC,IAAIhY,gBAAc,CAAC,IAAI,CAAC,KAAK,EAAE,QAAQ,CAAC;IAChE,CAAC,oBAAoB,CAAC,IAAI,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;CAC/C,CAAC;;AAEF,iBAAc,GAAG,WAAW,CAAC;;ACnC7B;;;;;;;;;;;;;;;;;;;;;;;AAuBA,IAAIiB,SAAO,GAAG,KAAK,CAAC,OAAO,CAAC;;AAE5B,aAAc,GAAGA,SAAO,CAAC;;ACzBzB;;;;;;;;;;;;;AAaA,SAAS,SAAS,GAAG;EACnB,OAAO,KAAK,CAAC;CACd;;AAED,eAAc,GAAG,SAAS,CAAC;;;;ACb3B,IAAI,WAAW,GAAG,QAAc,IAAI,QAAQ,IAAI,OAAO,IAAI,CAAC,OAAO,CAAC,QAAQ,IAAI,OAAO,CAAC;;;AAGxF,IAAI,UAAU,GAAG,WAAW,IAAI,QAAa,IAAI,QAAQ,IAAI,MAAM,IAAI,CAAC,MAAM,CAAC,QAAQ,IAAI,MAAM,CAAC;;;AAGlG,IAAI,aAAa,GAAG,UAAU,IAAI,UAAU,CAAC,OAAO,KAAK,WAAW,CAAC;;;AAGrE,IAAI,MAAM,GAAG,aAAa,GAAG6U,KAAI,CAAC,MAAM,GAAG,SAAS,CAAC;;;AAGrD,IAAI,cAAc,GAAG,MAAM,GAAG,MAAM,CAAC,QAAQ,GAAG,SAAS,CAAC;;;;;;;;;;;;;;;;;;;AAmB1D,IAAI,QAAQ,GAAG,cAAc,IAAIoC,WAAS,CAAC;;AAE3C,cAAc,GAAG,QAAQ,CAAC;;;AChC1B,IAAIC,SAAO,GAAG,oBAAoB;IAC9B,QAAQ,GAAG,gBAAgB;IAC3B,OAAO,GAAG,kBAAkB;IAC5B,OAAO,GAAG,eAAe;IACzB,QAAQ,GAAG,gBAAgB;IAC3BC,SAAO,GAAG,mBAAmB;IAC7B,MAAM,GAAG,cAAc;IACvB,SAAS,GAAG,iBAAiB;IAC7B,SAAS,GAAG,iBAAiB;IAC7B,SAAS,GAAG,iBAAiB;IAC7B,MAAM,GAAG,cAAc;IACvB,SAAS,GAAG,iBAAiB;IAC7B,UAAU,GAAG,kBAAkB,CAAC;;AAEpC,IAAI,cAAc,GAAG,sBAAsB;IACvC,WAAW,GAAG,mBAAmB;IACjC,UAAU,GAAG,uBAAuB;IACpC,UAAU,GAAG,uBAAuB;IACpC,OAAO,GAAG,oBAAoB;IAC9B,QAAQ,GAAG,qBAAqB;IAChC,QAAQ,GAAG,qBAAqB;IAChC,QAAQ,GAAG,qBAAqB;IAChC,eAAe,GAAG,4BAA4B;IAC9C,SAAS,GAAG,sBAAsB;IAClC,SAAS,GAAG,sBAAsB,CAAC;;;AAGvC,IAAI,cAAc,GAAG,EAAE,CAAC;AACxB,cAAc,CAAC,UAAU,CAAC,GAAG,cAAc,CAAC,UAAU,CAAC;AACvD,cAAc,CAAC,OAAO,CAAC,GAAG,cAAc,CAAC,QAAQ,CAAC;AAClD,cAAc,CAAC,QAAQ,CAAC,GAAG,cAAc,CAAC,QAAQ,CAAC;AACnD,cAAc,CAAC,eAAe,CAAC,GAAG,cAAc,CAAC,SAAS,CAAC;AAC3D,cAAc,CAAC,SAAS,CAAC,GAAG,IAAI,CAAC;AACjC,cAAc,CAACD,SAAO,CAAC,GAAG,cAAc,CAAC,QAAQ,CAAC;AAClD,cAAc,CAAC,cAAc,CAAC,GAAG,cAAc,CAAC,OAAO,CAAC;AACxD,cAAc,CAAC,WAAW,CAAC,GAAG,cAAc,CAAC,OAAO,CAAC;AACrD,cAAc,CAAC,QAAQ,CAAC,GAAG,cAAc,CAACC,SAAO,CAAC;AAClD,cAAc,CAAC,MAAM,CAAC,GAAG,cAAc,CAAC,SAAS,CAAC;AAClD,cAAc,CAAC,SAAS,CAAC,GAAG,cAAc,CAAC,SAAS,CAAC;AACrD,cAAc,CAAC,MAAM,CAAC,GAAG,cAAc,CAAC,SAAS,CAAC;AAClD,cAAc,CAAC,UAAU,CAAC,GAAG,KAAK,CAAC;;;;;;;;;AASnC,SAAS,gBAAgB,CAAC,KAAK,EAAE;EAC/B,OAAOJ,cAAY,CAAC,KAAK,CAAC;IACxBN,UAAQ,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,cAAc,CAACrB,WAAU,CAAC,KAAK,CAAC,CAAC,CAAC;CACjE;;AAED,qBAAc,GAAG,gBAAgB,CAAC;;AC3DlC;;;;;;;AAOA,SAAS,SAAS,CAAC,IAAI,EAAE;EACvB,OAAO,SAAS,KAAK,EAAE;IACrB,OAAO,IAAI,CAAC,KAAK,CAAC,CAAC;GACpB,CAAC;CACH;;AAED,cAAc,GAAG,SAAS,CAAC;;;;ACV3B,IAAI,WAAW,GAAG,QAAc,IAAI,QAAQ,IAAI,OAAO,IAAI,CAAC,OAAO,CAAC,QAAQ,IAAI,OAAO,CAAC;;;AAGxF,IAAI,UAAU,GAAG,WAAW,IAAI,QAAa,IAAI,QAAQ,IAAI,MAAM,IAAI,CAAC,MAAM,CAAC,QAAQ,IAAI,MAAM,CAAC;;;AAGlG,IAAI,aAAa,GAAG,UAAU,IAAI,UAAU,CAAC,OAAO,KAAK,WAAW,CAAC;;;AAGrE,IAAI,WAAW,GAAG,aAAa,IAAIT,WAAU,CAAC,OAAO,CAAC;;;AAGtD,IAAI,QAAQ,IAAI,WAAW;EACzB,IAAI;IACF,OAAO,WAAW,IAAI,WAAW,CAAC,OAAO,IAAI,WAAW,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;GAC1E,CAAC,OAAO,CAAC,EAAE,EAAE;CACf,EAAE,CAAC,CAAC;;AAEL,cAAc,GAAG,QAAQ,CAAC;;;AChB1B,IAAI,gBAAgB,GAAGyC,SAAQ,IAAIA,SAAQ,CAAC,YAAY,CAAC;;;;;;;;;;;;;;;;;;;AAmBzD,IAAI,YAAY,GAAG,gBAAgB,GAAGC,UAAS,CAAC,gBAAgB,CAAC,GAAGC,iBAAgB,CAAC;;AAErF,kBAAc,GAAG,YAAY,CAAC;;AClB9B,IAAIvC,aAAW,GAAG,MAAM,CAAC,SAAS,CAAC;;;AAGnC,IAAIhW,gBAAc,GAAGgW,aAAW,CAAC,cAAc,CAAC;;;;;;;;;;AAUhD,SAAS,aAAa,CAAC,KAAK,EAAE,SAAS,EAAE;EACvC,IAAI,KAAK,GAAG/U,SAAO,CAAC,KAAK,CAAC;MACtB,KAAK,GAAG,CAAC,KAAK,IAAIuX,aAAW,CAAC,KAAK,CAAC;MACpC,MAAM,GAAG,CAAC,KAAK,IAAI,CAAC,KAAK,IAAIC,UAAQ,CAAC,KAAK,CAAC;MAC5C,MAAM,GAAG,CAAC,KAAK,IAAI,CAAC,KAAK,IAAI,CAAC,MAAM,IAAIC,cAAY,CAAC,KAAK,CAAC;MAC3D,WAAW,GAAG,KAAK,IAAI,KAAK,IAAI,MAAM,IAAI,MAAM;MAChD,MAAM,GAAG,WAAW,GAAGC,UAAS,CAAC,KAAK,CAAC,MAAM,EAAE,MAAM,CAAC,GAAG,EAAE;MAC3D,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC;;EAE3B,KAAK,IAAI,GAAG,IAAI,KAAK,EAAE;IACrB,IAAI,CAAC,SAAS,IAAI3Y,gBAAc,CAAC,IAAI,CAAC,KAAK,EAAE,GAAG,CAAC;QAC7C,EAAE,WAAW;;WAEV,GAAG,IAAI,QAAQ;;YAEd,MAAM,KAAK,GAAG,IAAI,QAAQ,IAAI,GAAG,IAAI,QAAQ,CAAC,CAAC;;YAE/C,MAAM,KAAK,GAAG,IAAI,QAAQ,IAAI,GAAG,IAAI,YAAY,IAAI,GAAG,IAAI,YAAY,CAAC,CAAC;;WAE3E6X,QAAO,CAAC,GAAG,EAAE,MAAM,CAAC;SACtB,CAAC,EAAE;MACN,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;KAClB;GACF;EACD,OAAO,MAAM,CAAC;CACf;;AAED,kBAAc,GAAG,aAAa,CAAC;;AChD/B;;;;;;;;AAQA,SAAS,OAAO,CAAC,IAAI,EAAE,SAAS,EAAE;EAChC,OAAO,SAAS,GAAG,EAAE;IACnB,OAAO,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC;GAC7B,CAAC;CACH;;AAED,YAAc,GAAG,OAAO,CAAC;;ACXzB,IAAI,UAAU,GAAGe,QAAO,CAAC,MAAM,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;;AAE9C,eAAc,GAAG,UAAU,CAAC;;ACD5B,IAAI5C,aAAW,GAAG,MAAM,CAAC,SAAS,CAAC;;;AAGnC,IAAIhW,gBAAc,GAAGgW,aAAW,CAAC,cAAc,CAAC;;;;;;;;;AAShD,SAAS,QAAQ,CAAC,MAAM,EAAE;EACxB,IAAI,CAAC6C,YAAW,CAAC,MAAM,CAAC,EAAE;IACxB,OAAOC,WAAU,CAAC,MAAM,CAAC,CAAC;GAC3B;EACD,IAAI,MAAM,GAAG,EAAE,CAAC;EAChB,KAAK,IAAI,GAAG,IAAI,MAAM,CAAC,MAAM,CAAC,EAAE;IAC9B,IAAI9Y,gBAAc,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,IAAI,GAAG,IAAI,aAAa,EAAE;MAC5D,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;KAClB;GACF;EACD,OAAO,MAAM,CAAC;CACf;;AAED,aAAc,GAAG,QAAQ,CAAC;;ACG1B,SAAS,IAAI,CAAC,MAAM,EAAE;EACpB,OAAO4X,aAAW,CAAC,MAAM,CAAC,GAAGmB,cAAa,CAAC,MAAM,CAAC,GAAGC,SAAQ,CAAC,MAAM,CAAC,CAAC;CACvE;;AAED,UAAc,GAAG,IAAI,CAAC;;AC5BtB,IAAIhD,aAAW,GAAG,MAAM,CAAC,SAAS,CAAC;;;AAGnC,IAAIhW,gBAAc,GAAGgW,aAAW,CAAC,cAAc,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkChD,IAAI,MAAM,GAAGiD,eAAc,CAAC,SAAS,MAAM,EAAE,MAAM,EAAE;EACnD,IAAIJ,YAAW,CAAC,MAAM,CAAC,IAAIjB,aAAW,CAAC,MAAM,CAAC,EAAE;IAC9CsB,WAAU,CAAC,MAAM,EAAEC,MAAI,CAAC,MAAM,CAAC,EAAE,MAAM,CAAC,CAAC;IACzC,OAAO;GACR;EACD,KAAK,IAAI,GAAG,IAAI,MAAM,EAAE;IACtB,IAAInZ,gBAAc,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,EAAE;MACpCkX,YAAW,CAAC,MAAM,EAAE,GAAG,EAAE,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;KACvC;GACF;CACF,CAAC,CAAC;;AAEH,YAAc,GAAG,MAAM,CAAC;;ACzDxB,IAAIzT,aAAW,OAAOjC,MAAP,KAAkB,WAAlB,IAAiC,OAAOA,OAAOiC,QAAd,KAA2B,WAA5D,GAA0EjC,OAAOiC,QAAjF,GAA4F,EAA3G;AACA,IAAI2V,kBAAkB,OAAOzH,OAAP,KAAmB,WAAnB,IAAkC,0BAA0BA,OAAlF;;AAEA,IAAIrU,KAAM,YAAY;MAChB+b,GAAJ;;MAEIC,QAAQ,CACV,CACE,mBADF,EAEE,gBAFF,EAGE,mBAHF,EAIE,mBAJF,EAKE,kBALF,EAME,iBANF,CADU;;GAWR,yBADF,EAEE,sBAFF,EAGE,yBAHF,EAIE,yBAJF,EAKE,wBALF,EAME,uBANF,CAVU;;GAqBR,yBADF,EAEE,wBAFF,EAGE,gCAHF,EAIE,wBAJF,EAKE,wBALF,EAME,uBANF,CApBU,EA6BV,CACE,sBADF,EAEE,qBAFF,EAGE,sBAHF,EAIE,sBAJF,EAKE,qBALF,EAME,oBANF,CA7BU,EAqCV,CACE,qBADF,EAEE,kBAFF,EAGE,qBAHF,EAIE,qBAJF,EAKE,oBALF,EAME,mBANF,CArCU,CAAZ;;MA+CI5c,IAAI,CAAR;MACIqJ,IAAIuT,MAAMvc,MAAd;MACIwc,MAAM,EAAV;;SAEO7c,IAAIqJ,CAAX,EAAcrJ,GAAd,EAAmB;UACX4c,MAAM5c,CAAN,CAAN;QACI2c,OAAOA,IAAI,CAAJ,KAAU5V,UAArB,EAA+B;WACxB/G,IAAI,CAAT,EAAYA,IAAI2c,IAAItc,MAApB,EAA4BL,GAA5B,EAAiC;YAC3B4c,MAAM,CAAN,EAAS5c,CAAT,CAAJ,IAAmB2c,IAAI3c,CAAJ,CAAnB;;aAEK6c,GAAP;;;;SAIG,KAAP;CAhEO,EAAT;;AAmEA,IAAIC,eAAe;UACTlc,GAAGmc,gBADM;SAEVnc,GAAGoc;CAFZ;;AAKA,IAAIC,aAAa;WACN,iBAAUC,IAAV,EAAgB;QACnBC,UAAUvc,GAAGwc,iBAAjB;;WAEOF,QAAQnW,WAAS2D,eAAxB;;;;;;QAMI,oBAAoBmM,IAApB,CAAyB/L,UAAUkD,SAAnC,CAAJ,EAAmD;WAC5CmP,OAAL;KADF,MAEO;WACAA,OAAL,EAAcT,mBAAmBzH,QAAQoI,oBAAzC;;GAbW;QAgBT,gBAAY;eACPzc,GAAG0c,cAAZ;GAjBa;UAmBP,gBAAUJ,IAAV,EAAgB;QAClB,KAAKK,YAAT,EAAuB;WAChBC,IAAL;KADF,MAEO;WACAL,OAAL,CAAaD,IAAb;;GAvBW;YA0BL,kBAAUO,QAAV,EAAoB;SACvBzT,EAAL,CAAQ,QAAR,EAAkByT,QAAlB;GA3Ba;WA6BN,iBAAUA,QAAV,EAAoB;SACtBzT,EAAL,CAAQ,OAAR,EAAiByT,QAAjB;GA9Ba;MAgCX,YAAU/T,KAAV,EAAiB+T,QAAjB,EAA2B;QACzBC,YAAYZ,aAAapT,KAAb,CAAhB;QACIgU,SAAJ,EAAe;iBACJvT,gBAAT,CAA0BuT,SAA1B,EAAqCD,QAArC,EAA+C,KAA/C;;GAnCW;OAsCV,aAAU/T,KAAV,EAAiB+T,QAAjB,EAA2B;QAC1BC,YAAYZ,aAAapT,KAAb,CAAhB;QACIgU,SAAJ,EAAe;iBACJtT,mBAAT,CAA6BsT,SAA7B,EAAwCD,QAAxC,EAAkD,KAAlD;;GAzCW;OA4CV7c;CA5CP;;AA+CAL,OAAOod,gBAAP,CAAwBV,UAAxB,EAAoC;gBACpB;SACP,eAAY;aACRW,QAAQ7W,WAASnG,GAAGid,iBAAZ,CAAR,CAAP;;GAH8B;WAMzB;gBACK,IADL;SAEF,eAAY;aACR9W,WAASnG,GAAGid,iBAAZ,CAAP;;GAT8B;WAYzB;gBACK,IADL;SAEF,eAAY;;aAERD,QAAQ7W,WAASnG,GAAGkd,iBAAZ,CAAR,CAAP;;;CAhBN,EAqBA;;AC/GO,IAAIC,SAASpV,QAAQ7I,MAAR,CAAe;WACxB;aACE,CACP,QADO,EAEP,aAFO,EAGP,cAHO,EAIP,MAJO,EAKP,eALO,EAMP,gBANO,EAOP,QAPO,CADF;cAUG,EAVH;UAWD,MAXC;YAYC,QAZD;mBAaQ,MAbR;mBAcQ,KAdR;qBAeU,MAfV;iBAgBM,IAhBN;eAiBI,GAjBJ;sBAkBW,2DAlBX;4BAmBiB,IAnBjB;WAoBA,SApBA;kBAqBO,EArBP;YAsBC;GAvBuB;;cA0BrB,oBAAS0F,EAAT,EAAanC,OAAb,EAAsB;QAC5B2a,OAAO,IAAX;;SAEKC,wBAAL,GAAgClX,SAASmX,KAAzC;;QAEKC,aAAaC,OAAb,CAAqB,cAArB,CAAL,EAA4C;gBAChCC,SAAOhb,OAAP,EAAgBib,KAAKC,KAAL,CAAWJ,aAAaC,OAAb,CAAqB,cAArB,CAAX,CAAhB,CAAV;;cAEQtW,UAAA,CAAgB,IAAhB,EAAsBzE,OAAtB,CAAV;;SAEKmb,0BAAL;;SAEKC,QAAL,GAAgB,KAAKpb,OAAL,CAAaob,QAA7B,CAZgC;;SAc3BC,cAAL,CAAoBlZ,EAApB;SACKmZ,WAAL;;QAEK,KAAKtb,OAAL,CAAaub,MAAb,IAAuB,KAAKvb,OAAL,CAAaub,MAAb,CAAoBve,MAApB,GAA6B,CAAzD,EAA6D;WACpDgD,OAAL,CAAaub,MAAb,CAAoBC,OAApB,CAA4B,UAASC,KAAT,EAAgB;YACnCA,MAAMC,IAAX,EAAkB;;;YACdC,QAAQF,MAAME,KAAlB;YACIC,QAAQ,EAAZ;aACI,IAAIC,IAAR,IAAgBJ,MAAMG,KAAtB,EAA6B;cACrBE,WAAW,MAAMH,KAArB;cACKE,QAAQ,MAAb,EAAsB;uBAAa,SAASC,QAApB;WAAxB,MACK;wBAAc,MAAMD,IAAlB;;gBACDC,QAAN,IAAkBL,MAAMG,KAAN,CAAYC,IAAZ,CAAlB;;cAEED,KAAN,GAAcA,KAAd;OAVJ;;;SAcCG,YAAL;;;;;SAKKC,WAAL;;SAEK1X,aAAL;;SAEK2X,KAAL,GAAa,KAAKjc,OAAL,CAAakc,IAA1B;GAnE+B;;SAsE1B,eAAS5V,MAAT,EAAiBvD,EAAjB,EAAqB;QACtB4X,OAAO,IAAX;;QAEK,OAAOrU,MAAP,IAAkB,UAAlB,IAAgCvD,OAAO/B,SAA5C,EAAwD;WACjDsF,MAAL;eACStF,SAAT;;;UAGF,CAAYmb,EAAZ,CAAe,KAAKnc,OAAL,CAAaoc,WAA5B,EAAyCtZ,IAAzC,CAA8C,YAAW;WAClDuZ,MAAL,CAAY/V,MAAZ,EAAoBvD,EAApB;WACKuZ,OAAL,GAAe,IAAf;KAFF;GA9E+B;;UAoFzB,gBAAShW,MAAT,EAAiBvD,EAAjB,EAAqB;QACvB4X,OAAO,IAAX;aACSrU,UAAU,CAAnB;;;;;;SAMKiW,IAAL,CAAUjW,MAAV,EAAkBvD,EAAlB;GA5F+B;;UA+FzB,gBAAS/C,OAAT,EAAkBsG,MAAlB,EAA0B;;GA/FD;;eAmGpB,qBAAStG,OAAT,EAAkB;QACzBwc,gBAAgB,EAApB;aACOA,aAAP,EAAsBxc,OAAtB;QACKwc,cAAcC,IAAd,IAAsB,MAA3B,EAAoC;;aAE3BD,cAAcC,IAArB;;iBAEWC,OAAb,CAAqB,cAArB,EAAqCzB,KAAK0B,SAAL,CAAeH,aAAf,CAArC;GA1G+B;;gBA6GnB,wBAAW;eACvB,CAAoB,KAAKI,UAAzB,EAAqC,iBAAkB,KAAKA,UAAL,CAAgBC,OAAhB,CAAwBpB,KAAxB,IAAiC,SAAnD,CAArC;YACA,CAAiB,KAAKmB,UAAtB,EAAkC,gBAAgB,KAAK5c,OAAL,CAAayb,KAA/D;SACKmB,UAAL,CAAgBC,OAAhB,CAAwBpB,KAAxB,GAAgC,KAAKzb,OAAL,CAAayb,KAA7C;GAhH+B;;QAmH3B,cAASnV,MAAT,EAAiB;;GAnHU;;QAuH3B,gBAAW;;GAvHgB;;QA2H3B,gBAAW;;GA3HgB;;WA+HxB,iBAASwW,KAAT,EAAgB;;GA/HQ;;YAmIvB,kBAASxW,MAAT,EAAiB;;GAnIM;;UAuIzB,kBAAW;YACTyW,IAAR;GAxI+B;;aA2ItB,qBAAW;YACZC,OAAR;GA5I+B;;qBA+Id,6BAAW;QACvBpD,WAAWqD,OAAhB,EAA0B;;iBAEbC,MAAX,CAAkB,KAAKN,UAAvB;;GAlJ6B;;cAsJrB,sBAAW,EAtJU;;kBA0JjB,wBAAUza,EAAV,EAAc;QACxB0N,YAAY,KAAK+M,UAAL,GAAkBO,KAAA,CAAYhb,EAAZ,CAAlC;;QAEI,CAAC0N,SAAL,EAAgB;YACR,IAAI5O,KAAJ,CAAU,6BAAV,CAAN;KADF,MAEO,IAAI4O,UAAU5R,QAAd,EAAwB;YACvB,IAAIgD,KAAJ,CAAU,0CAAV,CAAN;;;MAGF,CAAY4O,SAAZ,EAAuB,QAAvB,EAAiC,KAAKuN,SAAtC,EAAiD,IAAjD;SACKC,YAAL,GAAoB5Y,KAAA,CAAWoL,SAAX,CAApB;GApK+B;;eAuKpB,uBAAY;QACnBA,YAAY,KAAK+M,UAArB;;SAEKU,aAAL,GAAqB,KAAKtd,OAAL,CAAaud,aAAb,IAA8BzR,KAAnD;;YAEA,CAAiB+D,SAAjB,EAA4B,oBACzB/D,KAAA,GAAgB,aAAhB,GAAgC,EADP,KAEzBA,MAAA,GAAiB,cAAjB,GAAkC,EAFT,KAGzBA,KAAA,GAAgB,aAAhB,GAAgC,EAHP,KAIzBA,MAAA,GAAiB,cAAjB,GAAkC,EAJT,KAKzB,KAAKwR,aAAL,GAAqB,iBAArB,GAAyC,EALhB,IAM1B,eAN0B,GAMR,KAAKtd,OAAL,CAAawd,MANL,GAO1B,cAP0B,GAOT,KAAKxd,OAAL,CAAayb,KAPhC;;QASIgC,WAAWN,QAAA,CAAiBtN,SAAjB,EAA4B,UAA5B,CAAf;;SAEK6N,UAAL;;QAEK,CAAE5R,WAAP,EAA6B;WACtB9L,OAAL,CAAayc,IAAb,GAAoB,cAApB;;GA1L6B;;cA8LrB,sBAAY;QAClB9B,OAAO,IAAX;;QAEIgD,QAAQ,KAAKC,MAAL,GAAc,EAA1B;;QAEI5X,IAAI,OAAR;QACI6J,YAAY,KAAK+M,UAArB;;QAEIiB,SAAS,cAAb;;YAEA,CAAiBhO,SAAjB,EAA4B,gBAA5B;UACM,KAAN,IAAesN,QAAA,CAAe,KAAf,EAAsBU,SAAS,KAA/B,EAAsChO,SAAtC,CAAf;UACM,MAAN,IAAgBsN,QAAA,CAAe,KAAf,EAAsBU,SAAS,MAA/B,EAAuChO,SAAvC,CAAhB;UACM,QAAN,IAAkBsN,QAAA,CAAe,KAAf,EAAsBU,SAAS,QAA/B,EAAyChO,SAAzC,CAAlB;;UAEM,MAAN,IAAgBsN,QAAA,CAAe,KAAf,EAAsBU,SAAS,MAA/B,EAAuCF,MAAM,MAAN,CAAvC,CAAhB;UACM,YAAN,IAAsBR,QAAA,CAAe,KAAf,EAAsBU,SAAS,YAA/B,EAA6CF,MAAM,MAAN,CAA7C,CAAtB;UACM,OAAN,IAAiBR,QAAA,CAAe,KAAf,EAAsBU,SAAS,OAA/B,EAAwCF,MAAM,MAAN,CAAxC,CAAjB;UACM,MAAN,IAAgBR,QAAA,CAAe,KAAf,EAAsBU,SAAS,MAA/B,EAAuCF,MAAM,YAAN,CAAvC,CAAhB;UACM,QAAN,IAAkBR,QAAA,CAAe,KAAf,EAAsBU,SAAS,cAA/B,EAA+CF,MAAM,MAAN,CAA/C,CAAlB;UACM,MAAN,IAAgBR,QAAA,CAAe,KAAf,EAAsBU,SAAS,WAA/B,EAA4CF,MAAM,MAAN,CAA5C,CAAhB;SACKG,eAAL;GAnN+B;;kBAsNjB,0BAAY;QACtB,CAAC,KAAKxB,OAAV,EAAmB;YACX,IAAIrb,KAAJ,CAAU,gCAAV,CAAN;;GAxN6B;;;;;eA+NpB,qBAAU6R,SAAV,EAAkB;SACxBiL,QAAL,GAAgB,EAAhB;SACKA,QAAL,CAActZ,KAAA,CAAW,KAAKmY,UAAhB,CAAd,IAA6C,IAA7C;;SAEKoB,QAAL,GAAgB,UAASC,MAAT,EAAiB;UAC3BC,UAAU,EAAd;UACIC,oBAAJ;UACIC,UAAUH,MAAd;aACO;gBACG,gBAASI,CAAT,EAAY;cACbA,CAAL,EAAS;sBACG,CAACA,CAAD,CAAV;iBACKhY,KAAL,CAAWgY,CAAX;;WAFF,MAIO;mBACEH,QAAQI,GAAR,EAAP;;SAPC;;eAWE,eAASC,MAAT,EAAiB1d,IAAjB,EAAuB;cACvBA,QAAQ,IAAb,EAAoB;mBAAS,EAAP;;eACjB0d,MAAL,GAAcA,MAAd;kBACQ3X,IAAR,CAAa,aAAb,EAA4B/F,IAA5B;SAdG;;kBAiBK,kBAAS2d,QAAT,EAAmB;cACtBA,SAASC,KAAT,IAAkBN,oBAAvB,EAA8C;mCACrBK,SAASC,KAAhC;;oBAEQ7X,IAAR,CAAa,eAAb,EAA8B,EAAE8X,KAAKF,SAASC,KAAhB,EAAuB/C,MAAM8C,SAAS9C,IAAtC,EAA4C6C,QAAQ,KAAKA,MAAL,EAApD,EAA9B;mBACO,IAAP;;iBAEK,KAAP;;OAxBJ;KAJc,CA+Bd,IA/Bc,CAAhB;;QAiCII,QAAQ7L,YAASqC,GAAT,GAAwBA,EAApC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAgCIrJ,KAAA,IAAiB,KAAK9L,OAAL,CAAa4e,gBAAlC,EAAoD;OACjD9L,YAAS,KAAKpM,GAAd,GAAoB,KAAKC,EAA1B,EAA8B/I,IAA9B,CAAmC,IAAnC,EAAyC,SAAzC,EAAoD,KAAKihB,UAAzD;;;QAGElE,OAAO,IAAX;QACIf,WAAWqD,OAAf,EAAwB;iBACXtW,EAAX,CAAc,QAAd,EAAwB,YAAW;;;;gBAIzBpD,GAAR,CAAY,wBAAZ,EAAsCqW,WAAWM,YAAX,GAA0B,KAA1B,GAAkC,IAAxE;OAJF;;;SAQGvT,EAAL,CAAQ,gBAAR,EAA0B,UAAS6X,QAAT,EAAmB;UACvCM,gBAAgBN,SAASC,KAA7B;;UAEK9D,KAAKoE,cAAV,EAA2B;aACpBA,cAAL,GAAsB,KAAtB;;;;UAIGpE,KAAKqD,QAAL,CAAcgB,QAAd,CAAuBR,QAAvB,CAAL,EAAwC;YAClCS,WAAWxd,OAAO+c,QAAP,CAAgB9C,IAAhB,CAAqB5b,KAArB,CAA2B,GAA3B,CAAf;iBACS,CAAT,IAAc0e,SAASC,KAAT,CAAeS,MAAf,CAAsB,CAAtB,EAAyBV,SAASC,KAAT,CAAezhB,MAAf,GAAwB,CAAxB,GAA4B,CAArD,CAAd;gBACQmiB,SAAR,CAAkB,EAAET,KAAKF,SAASC,KAAhB,EAAlB,EAA2C,EAA3C,EAA+CQ,SAASve,IAAT,CAAc,GAAd,CAA/C;;YAEK8d,SAASY,UAAd,EAA2B;cACrBC,IAAIjgB,KAAKsM,IAAL,CAAU8S,SAASY,UAAT,GAAsB,GAAhC,CAAR;mBACSvE,KAAT,GAAoBF,KAAKC,wBAAzB,WAAuDyE,CAAvD;;;KAfN;;WAoBOvY,gBAAP,CAAwB,UAAxB,EAAoC,UAAST,KAAT,EAAgB;UAC7CA,MAAMiZ,SAAN,IAAmBjZ,MAAMkZ,KAAN,KAAgB,IAAxC,EAA+C;aACxCR,cAAL,GAAsB,IAAtB;aACKS,QAAL,CAAcnZ,MAAMkZ,KAAN,CAAYb,GAA1B;;KAHJ;;aAOS5X,gBAAT,CAA0B,SAA1B,EAAqC,UAAST,KAAT,EAAgB;UAC/CoZ,UAAUpZ,MAAMvF,GAApB;UACIwF,SAASD,MAAMC,MAAnB;;;UAGIoZ,QAAQhc,SAASic,aAArB;aACQD,MAAME,SAAN,IAAmB,MAA3B,EAAoC;YAC7BF,MAAMhV,SAAN,CAAgB2I,QAAhB,CAAyB,eAAzB,CAAL,EAAiD;;;gBAGzCqM,MAAMG,aAAd;;;UAGEC,iBAAiB,CAAE,OAAF,EAAW,QAAX,CAArB;UACKA,eAAerf,OAAf,CAAuB6F,OAAOsZ,SAA9B,KAA4C,CAAjD,EAAqD;;;;WAIhDhZ,IAAL,CAAU,SAAV,EAAqB,EAAE6Y,SAASA,OAAX,EAAoBM,UAAU1Z,MAAM0Z,QAApC,EAArB;KAlBF;;SAqBKpZ,EAAL,CAAQ,SAAR,EAAmB,UAAS9F,IAAT,EAAe;cACzBA,KAAK4e,OAAZ;aACO,YAAL;aACK,UAAL;eACOO,IAAL;;aAEG,WAAL;aACK,QAAL;eACOC,IAAL;;aAEG,MAAL;eACOC,OAAL,CAAa,MAAb;;aAEG,KAAL;eACOA,OAAL,CAAa,KAAb;;;KAdN;GAlW+B;;;;;;;;;;aA8XtB,qBAAY;SAChBtD,UAAL,CAAgBuD,SAAhB,GAA6B,CAA7B;SACKvD,UAAL,CAAgBwD,UAAhB,GAA6B,CAA7B;GAhY+B;;mBAmYhB,yBAAU9c,CAAV,EAAa;QACxB,CAAC,KAAKgZ,OAAN,IAAiBnH,OAAA,CAAiB7R,CAAjB,CAArB,EAA0C;;;;QAEtCkC,OAAOlC,EAAEkC,IAAF,KAAW,UAAX,IAAyBlC,EAAE+c,OAAF,KAAc,EAAvC,GAA4C,OAA5C,GAAsD/c,EAAEkC,IAAnE;;QAEIA,SAAS,WAAb,EAA0B;;oBAExB,CAAuBlC,EAAEgD,MAAF,IAAYhD,EAAEgd,UAArC;;;SAGGC,aAAL,CAAmBjd,CAAnB,EAAsBkC,IAAtB;GA7Y+B;;iBAgZlB,uBAAUlC,CAAV,EAAakC,IAAb,EAAmBgb,OAAnB,EAA4B;;QAErCld,EAAEkC,IAAF,KAAW,OAAf,EAAwB;;;;;;UAMlBib,QAAQhc,MAAA,CAAY,EAAZ,EAAgBnB,CAAhB,CAAZ;YACMkC,IAAN,GAAa,UAAb;WACK+a,aAAL,CAAmBE,KAAnB,EAA0BA,MAAMjb,IAAhC,EAAsCgb,OAAtC;;;QAGEld,EAAE+L,QAAN,EAAgB;;;;;cAGN,CAACmR,WAAW,EAAZ,EAAgB1iB,MAAhB,CAAuB,KAAK4iB,iBAAL,CAAuBpd,CAAvB,EAA0BkC,IAA1B,CAAvB,CAAV;;QAEI,CAACgb,QAAQxjB,MAAb,EAAqB;;;;QAEjBsJ,SAASka,QAAQ,CAAR,CAAb;QACIhb,SAAS,aAAT,IAA0Bc,OAAOF,OAAP,CAAeZ,IAAf,EAAqB,IAArB,CAA9B,EAA0D;oBACxD,CAAwBlC,CAAxB;;;QAGEzC,OAAO;qBACMyC;KADjB;;QAIIA,EAAEkC,IAAF,KAAW,UAAf,EAA2B;UACrBmb,WAAYra,OAAOtG,OAAP,IAAkB,UAAUsG,OAAOtG,OAAnD;WACK4gB,cAAL,GAAsBD,WAClB,KAAKE,sBAAL,CAA4Bva,OAAOwa,SAAP,EAA5B,CADkB,GACgC,KAAKC,0BAAL,CAAgCzd,CAAhC,CADtD;WAEK0d,UAAL,GAAkB,KAAKC,0BAAL,CAAgCpgB,KAAK+f,cAArC,CAAlB;WACKM,MAAL,GAAcP,WAAWra,OAAOwa,SAAP,EAAX,GAAgC,KAAKK,kBAAL,CAAwBtgB,KAAKmgB,UAA7B,CAA9C;;;SAGG,IAAIrkB,IAAI,CAAb,EAAgBA,IAAI6jB,QAAQxjB,MAA5B,EAAoCL,GAApC,EAAyC;cAC/BA,CAAR,EAAWiK,IAAX,CAAgBpB,IAAhB,EAAsB3E,IAAtB,EAA4B,IAA5B;UACIA,KAAKuO,aAAL,CAAmBC,QAAnB,IACDmR,QAAQ7jB,CAAR,EAAWqD,OAAX,CAAmBohB,iBAAnB,IAAwC3c,OAAA,CAAa+b,QAAQ7jB,CAAR,EAAWqD,OAAX,CAAmBohB,iBAAhC,EAAmD5b,IAAnD,MAA6D,CAAC,CADzG,EAC6G;;;;GAxbhF;;yBA4bV,iCAAW;;QAE5B4B,QAAQ3F,OAAOmR,gBAAP,CAAwB,KAAKgL,MAAL,CAAY,MAAZ,CAAxB,CAAZ;QACIyD,IAAI,KAAKzD,MAAL,CAAY,MAAZ,EAAoB0D,YAApB,GAAmC9hB,WAAW4H,MAAMma,UAAjB,CAAnC,GAAkE/hB,WAAW4H,MAAMoa,aAAjB,CAA1E;QACIC,IAAI,KAAK7D,MAAL,CAAY,MAAZ,EAAoB8D,WAApB,GAAkCliB,WAAW4H,MAAMua,YAAjB,CAAlC,GAAmEniB,WAAW4H,MAAMwa,WAAjB,CAA3E;WACO,EAAEC,QAAQziB,KAAKoM,KAAL,CAAW6V,IAAI,IAAf,CAAV,EAAgCS,OAAO1iB,KAAKoM,KAAL,CAAWiW,IAAI,IAAf,CAAvC,EAAP;GAjc+B;;kBAocjB,wBAASzhB,OAAT,EAAkB;;QAE5B2a,OAAO,IAAX;;QAEK,CAAEA,KAAKoH,MAAZ,EAAqB;;;;mBAErB,CAAqB,KAAKC,cAA1B;;QAEI,CAAE,KAAK1F,OAAX,EAAoB;aAAS,IAAP;;;SAEjB1V,IAAL,CAAU,SAAV;GA9c+B;;mBAidhB,2BAAW,EAjdK;;eAqdpB,uBAAW,EArdS;;8BAydL,sCAAW;QAChC,CAAEuW,mBAAA,CAA4B,aAA5B,CAAF,IAAgD,KAAK8E,kBAAL,EAArD,EAAiF;;WAE1EjiB,OAAL,CAAayc,IAAb,GAAoB,cAApB;;QAEG,KAAKwF,kBAAL,EAAL,EAAiC;;;;WAI1BjiB,OAAL,CAAakiB,SAAb,GAAyB,GAAzB;;GAle6B;;sBAseb,8BAAW;QACxB,KAAKC,SAAL,KAAmBnhB,SAAxB,EAAoC;WAC7BmhB,SAAL,GAAiB,KAAjB;UACK,KAAKniB,OAAL,CAAaoiB,gBAAlB,EAAqC;aAC9BD,SAAL,GAAiB1gB,OAAO4gB,UAAP,CAAkB,KAAKriB,OAAL,CAAaoiB,gBAA/B,EAAiDvQ,OAAlE;;;WAGG,KAAKsQ,SAAZ;GA7e+B;;qBAgfd,6BAAkB;QAATpU,KAAS,uEAAH,CAAG;;QAC/B4M,OAAO,IAAX;SACK2H,uBAAL;QACKvU,QAAQ,CAAb,EAAiB;cACP,CAAR;WACKwU,eAAL,GAAuB,IAAvB;;SAEGC,eAAL,GAAuB1gB,WAAW,YAAW;WACtC8b,MAAL,CAAY,QAAZ,EAAsBxW,KAAtB,CAA4Bqb,OAA5B,GAAsC,OAAtC;KADqB,EAEpB1U,KAFoB,CAAvB;GAvf+B;;sBA4fb,8BAAsB;QAAb2U,KAAa,uEAAP,KAAO;;QACpC/H,OAAO,IAAX;SACK2H,uBAAL;QACK,CAAE3H,KAAK4H,eAAP,IAA0BG,KAA/B,EAAuC;WAChC9E,MAAL,CAAY,QAAZ,EAAsBxW,KAAtB,CAA4Bqb,OAA5B,GAAsC,MAAtC;WACKF,eAAL,GAAuB,KAAvB;WACK3E,MAAL,CAAY,eAAZ,EAA6BzT,SAA7B,GAAyC,EAAzC;;GAlgB6B;;2BAsgBR,mCAAW;QAC9BwQ,OAAO,IAAX;QACKA,KAAK6H,eAAV,EAA4B;mBACb7H,KAAK6H,eAAlB;WACKA,eAAL,GAAuB,IAAvB;;GA1gB6B;;mBA8gBhB,2BAAW;;QAEtB5hB,cAAW,KAAKZ,OAAL,CAAa2iB,eAAb,IAAgC,KAAKC,cAAL,EAA/C;;QAEIC,OAAO,IAAIC,SAAJ,GAAgBC,eAAhB,CAAgCniB,WAAhC,EAA0C,WAA1C,EAAuDiiB,IAAlE;WACQA,KAAKG,QAAL,CAAchmB,MAAtB,EAA+B;WACxB4gB,MAAL,CAAY,QAAZ,EAAsB3Z,WAAtB,CAAkC4e,KAAKG,QAAL,CAAc,CAAd,CAAlC;;SAEGpF,MAAL,CAAY,eAAZ,IAA+BT,QAAA,CAAe,KAAf,EAAsB,iCAAtB,EAAyD,KAAKS,MAAL,CAAY,QAAZ,CAAzD,CAA/B;GAthB+B;;kBAyhBjB,0BAAW;;GAzhBM;;OAsiB5B;CAtiBa,CAAb,CAyiBP,AAAO;;AC3jBA,IAAIqF,UAAU/e,MAAMzH,MAAN,CAAa;;;aAGrB;;;;KAHqB;;gBASlB,oBAAUuD,OAAV,EAAmB;kBAC3B,CAAgB,IAAhB,EAAsBA,OAAtB;YACKA,QAAQ6P,SAAb,EAAyB;iBAChB+M,UAAL,GAAkB5c,QAAQ6P,SAA1B;iBACKqT,OAAL,GAAe,IAAf;;aAECC,GAAL,GAAY,IAAIvhB,IAAJ,EAAD,CAAawhB,OAAb,KAAyB,GAAzB,GAA+BC,SAASjkB,KAAKkkB,MAAL,CAAa,IAAI1hB,IAAJ,EAAD,CAAawhB,OAAb,EAAZ,IAAsC,IAA/C,EAAqD,EAArD,CAA1C;KAf0B;;;;;;;;eAwBnB,qBAAY;eACZ,KAAKpjB,OAAL,CAAaujB,MAApB;KAzB0B;;;;eA8BnB,mBAAUA,MAAV,EAAkB;YACrBtF,SAAS,KAAKG,OAAlB;;YAEIH,MAAJ,EAAY;mBACDuF,aAAP,CAAqB,IAArB;;;aAGCxjB,OAAL,CAAaujB,MAAb,GAAsBA,MAAtB;;YAEItF,MAAJ,EAAY;mBACDwF,UAAP,CAAkB,IAAlB;;;eAGG,IAAP;KA3C0B;;;;kBAgDhB,wBAAY;eACf,KAAK7G,UAAZ;KAjD0B;;;;WAsDvB,eAAUqB,MAAV,EAAkB;aAChBnL,MAAL;aACKsL,OAAL,GAAeH,MAAf;;YAEIpO,YAAY,KAAK+M,UAAL,GAAkB,KAAK8G,KAAL,CAAWzF,MAAX,CAAlC;;gBAEA,CAAiBpO,SAAjB,EAA4B,cAA5B;;YAEK,CAAE,KAAKqT,OAAZ,EAAsB;gBACdK,SAAS,KAAKI,SAAL,EAAb;gBACIC,OAAO3F,OAAO4F,gBAAP,CAAwBN,MAAxB,CAAX;iBACKtf,WAAL,CAAiB4L,SAAjB;;;eAGG,IAAP;KApE0B;;;;YAyEtB,qBAAY;YACZ,CAAC,KAAKuO,OAAV,EAAmB;mBACR,IAAP;;;YAGA,CAAE,KAAKxB,UAAX,EAAuB;mBACZ,IAAP;;;YAGC,CAAE,KAAKsG,OAAZ,EAAsB;kBAClB,CAAe,KAAKtG,UAApB;;;YAGA,KAAKkH,QAAT,EAAmB;iBACVA,QAAL,CAAc,KAAK1F,OAAnB;;;aAGCA,OAAL,GAAe,IAAf;;eAEO,IAAP;KA5F0B;;mBA+Ff,uBAAU9a,CAAV,EAAa;;YAEpB,KAAK8a,OAAL,IAAgB9a,CAAhB,IAAqBA,EAAEygB,OAAF,GAAY,CAAjC,IAAsCzgB,EAAE0gB,OAAF,GAAY,CAAtD,EAAyD;iBAChD5F,OAAL,CAAa6F,YAAb,GAA4BC,KAA5B;;KAlGsB;;gBAsGlB,oBAASC,MAAT,EAAiB;YACrBtR,YAAY,CAAE,cAAF,CAAhB;YACK,KAAK7S,OAAL,CAAaokB,SAAlB,EAA8B;sBAChB9jB,IAAV,CAAe,kBAAkB,KAAKN,OAAL,CAAaokB,SAA9C;;YAECD,MAAL,EAAc;sBACA7jB,IAAV,CAAe,kBAAkB6jB,MAAjC;;eAEGtR,UAAUnS,IAAV,CAAe,GAAf,CAAP;;CA9Ga,CAAd;;AAkHP,AAAO,IAAI2jB,UAAU,SAAVA,OAAU,CAAUrkB,OAAV,EAAmB;WAC7B,IAAIijB,OAAJ,CAAYjjB,OAAZ,CAAP;CADG;;;;;;;;;;;;;;;;;AAmBP0a,OAAO3V,OAAP,CAAe;;;gBAGC,oBAAUsf,OAAV,EAAmB;gBACnBC,KAAR,CAAc,IAAd;eACO,IAAP;KALO;;;;mBAUI,uBAAUD,OAAV,EAAmB;gBACtBvR,MAAR;eACO,IAAP;KAZO;;yBAeU,+BAAW;YACxB9M,IAAI,OAAR;YACK,CAAE,KAAKue,iBAAZ,EAAgC;iBACvBA,iBAAL,GACIpH,QAAA,CAAe,KAAf,EAAsBnX,IAAI,mBAA1B,EAA+C,KAAK4W,UAApD,CADJ;;eAGG,KAAK2H,iBAAZ;KArBO;;sBAwBO,0BAAUje,MAAV,EAAkB;;YAE3B,CAAE,KAAKsX,MAAL,CAAYtX,MAAZ,CAAP,EAA6B;;;gBAGrBke,QAAQle,OAAOxG,KAAP,CAAa,GAAb,CAAZ;gBACI2kB,MAAM,EAAV;gBACI1gB,SAAS,KAAK6Y,UAAlB;gBACIne,IAAI,CAAR;mBACQ+lB,MAAMxnB,MAAd,EAAuB;oBACf0nB,OAAOF,MAAMphB,KAAN,EAAX;oBACI9C,IAAJ,CAASokB,IAAT;oBACIC,QAAQF,IAAI/jB,IAAJ,CAAS,GAAT,CAAZ;oBACImS,YAAY,gBAAgB6R,IAAhC;oBACK,CAAE,KAAK9G,MAAL,CAAY+G,KAAZ,CAAP,EAA4B;yBACnB/G,MAAL,CAAY+G,KAAZ,IAAqBxH,QAAA,CAAe,KAAf,EAAsBtK,SAAtB,EAAiC9O,MAAjC,CAArB;;yBAEK,KAAK6Z,MAAL,CAAY+G,KAAZ,CAAT;qBACK,CAAL;oBACKlmB,IAAI,GAAT,EAAe;;;;;eAGhB,KAAKmf,MAAL,CAAYtX,MAAZ,CAAP;KA9CO;;wBAiDS,4BAAUA,MAAV,EAAkB;;YAE9Bme,MAAMne,OAAOxG,KAAP,CAAa,GAAb,CAAV;YACIyjB,SAASkB,IAAIrhB,KAAJ,EAAb;YACIwhB,OAAOH,IAAInG,GAAJ,MAAa,OAAxB;;YAEIzO,YAAY,KAAK+N,MAAL,CAAY2F,MAAZ,CAAhB;YACK,CAAE,KAAK3F,MAAL,CAAYtX,MAAZ,CAAP,EAA6B;gBACrBuM,YAAY,UAAU0Q,MAAV,GAAmB,mBAAnB,GAAyCqB,IAAzD;gBACK,CAAE,KAAKhH,MAAL,CAAY2F,SAAS,GAAT,GAAeqB,IAA3B,CAAP,EAA0C;oBAClC1a,MAAMiT,QAAA,CAAe,KAAf,EAAsBtK,SAAtB,CAAV;oBACK+R,QAAQ,MAAR,IAAkBA,QAAQ,QAA/B,EAA0C;wBAClCC,eAAe,KAAKjH,MAAL,CAAY2F,MAAZ,EAAoBlZ,UAAvC;yBACKuT,MAAL,CAAY2F,MAAZ,EAAoBpQ,YAApB,CAAiCjJ,GAAjC,EAAsC2a,YAAtC;iBAFJ,MAGO;yBACEjH,MAAL,CAAY2F,MAAZ,EAAoBtf,WAApB,CAAgCiG,GAAhC;;qBAEC0T,MAAL,CAAY2F,SAAS,GAAT,GAAeqB,IAA3B,IAAmC1a,GAAnC;;wBAEQ,KAAK4a,SAAL,CAAeL,GAAf,CAAZ;iBACK7G,MAAL,CAAYtX,MAAZ,IAAsB6W,QAAA,CAAe,KAAf,EAAsBtK,SAAtB,EAAiC,KAAK+K,MAAL,CAAY2F,SAAS,GAAT,GAAeqB,IAA3B,CAAjC,CAAtB;;;eAGG,KAAKhH,MAAL,CAAYtX,MAAZ,CAAP;KAxEO;;eA2EA,mBAASme,GAAT,EAAc;YACjBze,IAAI,OAAR;YACI6M,YAAY,EAAhB;aACI,IAAIlW,CAAR,IAAa8nB,GAAb,EAAkB;sBACJnkB,IAAV,CAAe0F,IAAIye,IAAI9nB,CAAJ,CAAnB;;oBAEQkW,UAAUnS,IAAV,CAAe,GAAf,CAAZ;eACOmS,SAAP;KAlFO;;yBAqFU,+BAAY;aACxB,IAAIlW,CAAT,IAAc,KAAKooB,eAAnB,EAAoC;kBAChC,CAAe,KAAKA,eAAL,CAAqBpoB,CAArB,CAAf;;cAEJ,CAAe,KAAK4nB,iBAApB;eACO,KAAKQ,eAAZ;eACO,KAAKR,iBAAZ;;CA3FR;;AC9IA,IAAIS,cAAc/B,QAAQxmB,MAAR,CAAe;SACxB,eAASwhB,MAAT,EAAiB;QAClBpO,YAAY,KAAK+M,UAArB;QACK/M,SAAL,EAAiB;WACVoV,QAAL,GAAgBpV,UAAUqV,aAAV,CAAwB,kBAAkB,KAAKllB,OAAL,CAAaokB,SAA/B,GAA2C,GAAnE,CAAhB;KADF,MAEO;;UAEDvR,YAAY,KAAKsS,UAAL,EAAhB;UACInlB,UAAU,KAAKA,OADnB;kBAEYmd,QAAA,CAAe,KAAf,EAAsBtK,SAAtB,CAAZ,EAEA,KAAKoS,QAAL,GAAiB,KAAKG,aAAL,CAAmB,KAAKC,KAAL,CAAWrlB,QAAQslB,IAAR,IAAgBtlB,QAAQulB,KAAnC,CAAnB,EAA8D,KAAKF,KAAL,CAAWrlB,QAAQulB,KAAnB,CAA9D,EACT1S,SADS,EACEhD,SADF,CAFjB;;SAKG2V,WAAL;;WAEO3V,SAAP;GAhB6B;;iBAmBhB,uBAAUyV,IAAV,EAAgBzK,KAAhB,EAAuBhI,SAAvB,EAAkChD,SAAlC,EAA6C;QACtD4V,OAAOtI,QAAA,CAAe,GAAf,EAAoBtK,SAApB,EAA+BhD,SAA/B,CAAX;SACK1F,SAAL,GAAiBmb,IAAjB;SACK5J,IAAL,GAAY,GAAZ;SACKb,KAAL,GAAaA,KAAb;;;;;SAKK6K,YAAL,CAAkB,MAAlB,EAA0B,QAA1B;SACKA,YAAL,CAAkB,YAAlB,EAAgC7K,KAAhC;;WAEO4K,IAAP;GA/B6B;;eAkClB,uBAAW;QAClB9K,OAAO,IAAX;2BACA,CAAiC,KAAKsK,QAAtC;MACA,CAAY,KAAKA,QAAjB,EAA2B,OAA3B,EAAoC9P,IAApC;MACA,CAAY,KAAK8P,QAAjB,EAA2B,OAA3B,EAAoC,KAAK/G,OAAzC,EAAkD,IAAlD;;SAEKE,OAAL,CAAazX,EAAb,CAAgB,QAAhB,EAA0B,UAAS9F,IAAT,EAAe;;UAEnCykB,OAAO3K,KAAK3a,OAAL,CAAaslB,IAAb,IAAqB3K,KAAK3a,OAAL,CAAaulB,KAA7C;WACKN,QAAL,CAAc9a,SAAd,GAA0BwQ,KAAK0K,KAAL,CAAWC,IAAX,CAA1B;WACKL,QAAL,CAAcS,YAAd,CAA2B,OAA3B,EAAoC/K,KAAK0K,KAAL,CAAW1K,KAAK3a,OAAL,CAAaulB,KAAxB,CAApC;WACKN,QAAL,CAAcS,YAAd,CAA2B,YAA3B,EAAyC/K,KAAK0K,KAAL,CAAW1K,KAAK3a,OAAL,CAAaulB,KAAxB,CAAzC;KALF;GAxC6B;;SAkDxB,iBAAW;WACP,KAAKnH,OAAL,CAAape,OAAb,CAAqByc,IAArB,IAA6B,cAA/B,GAAkD,SAAlD,GAA8D,MAArE;GAnD6B;;SAsDxB,eAASkJ,CAAT,EAAY;QACbC,OAAO,KAAKC,KAAL,EAAX;WACOF,EAAE/lB,OAAF,CAAU,aAAV,EAAyBgmB,IAAzB,CAAP;GAxD6B;;UA2DvB,kBAAW;WACV,KAAK5lB,OAAL,CAAaulB,KAAb,GAAqB,GAArB,IAA6B,KAAKnH,OAAL,CAAape,OAAb,CAAqByc,IAArB,IAA6B,cAA1D,IAA6E,SAA7E,GAAyF,MAAhG;GA5D6B;;OA+D1B;CA/DW,CAAlB;;AAkEA,AAAO,IAAIqJ,eAAed,YAAYvoB,MAAZ,CAAmB;WAClC;YACC,WADD;eAEI,UAFJ;WAGA,kBAHA;UAID;GALmC;;WAQlC,iBAAS6G,CAAT,EAAY;SACd8a,OAAL,CAAa6B,IAAb;;CATsB,CAAnB;;AAaP,AAAO,IAAI8F,WAAWf,YAAYvoB,MAAZ,CAAmB;WAC9B;YACC,YADD;eAEI,MAFJ;WAGA,cAHA;UAID;GAL+B;;WAQ9B,iBAAS6G,CAAT,EAAY;SACd8a,OAAL,CAAa4B,IAAb;;CATkB,CAAf;;AAaP,AAAO,IAAIgG,YAAYhB,YAAYvoB,MAAZ,CAAmB;WAC/B;eACI,OADJ;WAEA;GAH+B;WAK/B,iBAAS6G,CAAT,EAAY;SACZ8a,OAAL,CAAa6H,KAAb;;CANiB,CAAhB;;AAUP,AAAO,IAAIC,WAAWlB,YAAYvoB,MAAZ,CAAmB;WAC9B;eACI,MADJ;WAEA;GAH8B;WAK9B,iBAAS6G,CAAT,EAAY;SACZ8a,OAAL,CAAavQ,IAAb;;CANgB,CAAf;;AAUP,AAAO,IAAIsY,WAAW,SAAXA,QAAW,CAASnmB,OAAT,EAAkB;SAC/B,IAAI+lB,QAAJ,CAAa/lB,OAAb,CAAP;CADK;;AAIP,AAAO,IAAIomB,eAAe,SAAfA,YAAe,CAASpmB,OAAT,EAAkB;SACnC,IAAI8lB,YAAJ,CAAiB9lB,OAAjB,CAAP;CADK;;AAIP,AAAO,IAAIqmB,YAAY,SAAZA,SAAY,CAASrmB,OAAT,EAAkB;SAChC,IAAIgmB,SAAJ,CAAchmB,OAAd,CAAP;CADK;;AAIP,AAAO,IAAIsmB,WAAW,SAAXA,QAAW,CAAStmB,OAAT,EAAkB;SAC/B,IAAIkmB,QAAJ,CAAalmB,OAAb,CAAP;CADK;;ACzHP,IAAIumB,WAAJ;AACA,AAGA,IAAMC,qBAAqB,CACvB,SADuB,EAEvB,YAFuB,EAGvB,4CAHuB,EAIvB,wBAJuB,EAKvB,0BALuB,EAMvB,wBANuB,EAOvB,QAPuB,EAQvB,QARuB,EASvB,OATuB,EAUvB,mBAVuB,EAWvB,iCAXuB,CAA3B;;AAcA,IAAMC,sBAAsB,CACxB,SADwB,EAExB,YAFwB,EAGxB,sCAHwB,EAIxB,wBAJwB,CAA5B;;AAOA,AAAO,IAAIC,QAAQxiB,MAAMzH,MAAN,CAAa;WACrB;;;YAGC,MAHD;cAIG,CAJH;WAKA,IALA;eAMI,EANJ;aAOE,IAPF;eAQI,EAAEkqB,QAAQ,kBAAW,EAArB,EAAyBC,SAAS,mBAAW,EAA7C,EARJ;cASG;GAVkB;;cAalB,oBAAU5mB,OAAV,EAAmB;cACnByE,UAAA,CAAgB,IAAhB,EAAsBzE,OAAtB,CAAV;SACKmjB,GAAL,GAAY,IAAIvhB,IAAJ,EAAD,CAAawhB,OAAb,KAAyB,GAAzB,GAA+BC,SAASjkB,KAAKkkB,MAAL,CAAa,IAAI1hB,IAAJ,EAAD,CAAawhB,OAAb,EAAZ,IAAsC,IAA/C,EAAqD,EAArD,CAA1C;SACKyD,kBAAL,GAA0B,KAA1B;SACKjkB,SAAL,GAAiBoY,SAAO,EAAP,EAAW,KAAKhb,OAAL,CAAa4C,SAAxB,CAAjB;SACKkkB,OAAL,GAAe,KAAK9mB,OAAL,CAAa8mB,OAAb,GAAuB9L,SAAO,EAAP,EAAW,KAAKhb,OAAL,CAAa8mB,OAAxB,CAAvB,GAA0D,IAAzE;SACKC,QAAL,GAAgB/L,SAAO,EAAP,EAAW,KAAKhb,OAAL,CAAa+mB,QAAxB,CAAhB;QACK,OAAO,KAAK/mB,OAAL,CAAa6S,SAApB,IAAkC,QAAvC,EAAkD;WAC3C7S,OAAL,CAAa6S,SAAb,GAAyB,EAAEhD,WAAW,KAAK7P,OAAL,CAAa6S,SAA1B,EAAzB;;GArB0B;;SAyBvB,eAASoL,MAAT,EAAiB;QAClBtD,OAAO,IAAX;SACKyD,OAAL,GAAeH,MAAf;QACIrd,cAAW,KAAKZ,OAAL,CAAaY,QAA5B;;QAEIomB,qDAAkD,KAAKhnB,OAAL,CAAaujB,MAAb,IAAuB,MAAzE,qBAA8F,KAAKJ,GAAnG,iCAAkI,KAAKA,GAAvI,sDAA2L,KAAKA,GAAhM,gJAE+B,KAAKnjB,OAAL,CAAa6S,SAAb,CAAuBhD,SAAvB,GAAmC,KAAK7P,OAAL,CAAa6S,SAAb,CAAuBhD,SAA1D,GAAsE,EAFrG,kEAEmK,KAAKsT,GAFxK,wCAE8M,KAAKA,GAFnN,4BAE6O,KAAKA,GAFlP,oJAK2C,KAAKA,GALhD,gBAK8D,KAAKnjB,OAAL,CAAa6a,KAL3E,wGAMmF,KAAKsI,GANxF,gHAQkC,KAAKnjB,OAAL,CAAa6S,SAAb,CAAuBoU,IAAvB,GAA8B,KAAKjnB,OAAL,CAAa6S,SAAb,CAAuBoU,IAArD,GAA4D,EAR9F,qBAQ+G,KAAK9D,GARpH,kCASQviB,WATR,0BAAJ;;QAYK,KAAKZ,OAAL,CAAa8mB,OAAlB,EAA4B;mBACb,gCAAb;WACI,IAAInqB,CAAR,IAAa,KAAKqD,OAAL,CAAa8mB,OAA1B,EAAmC;YAC7BvI,SAAS,KAAKve,OAAL,CAAa8mB,OAAb,CAAqBnqB,CAArB,CAAb;YACIuqB,aAAa3I,OAAO1L,SAAP,IAAoB,iBAArC;6CACmC,KAAKsQ,GAAxC,SAA+CxmB,CAA/C,mCAA8EuqB,UAA9E,UAA6F3I,OAAOgH,KAApG;;mBAEW,WAAb;;;iBAGW,0BAAb;;QAEI1C,OAAO,IAAIC,SAAJ,GAAgBC,eAAhB,CAAgCiE,SAAhC,EAA2C,WAA3C,EAAwDnE,IAAnE;;SAEKsE,KAAL,GAAalJ,OAAOrB,UAAP,CAAkB3Y,WAAlB,CAA8B4e,KAAKG,QAAL,CAAc,CAAd,CAA9B,CAAb;SACKpG,UAAL,GAAkB,KAAKuK,KAAvB,CAhCsB;;SAkCjBtX,SAAL,GAAiB,KAAKsX,KAAL,CAAWjC,aAAX,CAAyB,mBAAzB,CAAjB;SACKM,WAAL;WACO,IAAP;GA7D4B;;eAgEjB,uBAAW;;;QAClB7K,OAAO,IAAX;SACKyM,OAAL,GAAe,KAAKA,OAAL,CAAa9pB,IAAb,CAAkB,IAAlB,CAAf;SACK+pB,SAAL,GAAiB,KAAKA,SAAL,CAAe/pB,IAAf,CAAoB,IAApB,CAAjB;SACKgqB,iBAAL,GAAyB,KAAKA,iBAAL,CAAuBhqB,IAAvB,CAA4B,IAA5B,CAAzB;;SAEK6pB,KAAL,CAAWrgB,gBAAX,CAA4B,eAA5B,EAA6C,YAAW,EAAX,CAC3CxJ,IAD2C,CACtC,IADsC,CAA7C;;;QAIK,KAAKwpB,OAAV,EAAoB;;YAEZvI,SAAS,MAAKuI,OAAL,CAAanqB,CAAb,CAAb;YACI4qB,YAAY,aAAa,MAAKpE,GAAlB,GAAwB,GAAxB,GAA8BxmB,CAA9C;YACI6qB,SAAS,MAAKL,KAAL,CAAWjC,aAAX,CAAyBqC,SAAzB,CAAb;YACKC,MAAL,EAAc;YACZ,CAAYA,MAAZ,EAAoB,OAApB,EAA6B,UAASnhB,KAAT,EAAgB;kBACrCoJ,cAAN;mBACO2K,QAAP,CAAgB/T,KAAhB;gBACKkY,OAAOkJ,KAAZ,EAAoB;mBACbC,UAAL;;WAJJ;;;;WALA,IAAI/qB,CAAR,IAAa,KAAKmqB,OAAlB,EAA2B;;;;GA3ED;;cA4FlB,sBAAW;SAChBY,UAAL;GA7F4B;;cAgGlB,sBAAW;QACjB/M,OAAO,IAAX;SACKwM,KAAL,CAAWzB,YAAX,CAAwB,aAAxB,EAAuC,MAAvC;SACKiC,oBAAL;QACK,KAAKhI,aAAV,EAA0B;WACnBA,aAAL,CAAmBuE,KAAnB;;SAEGthB,SAAL,CAAegkB,OAAf,CAAuB,KAAKO,KAA5B;GAvG4B;;aA0GnB,qBAAW;SACfxH,aAAL,GAAqBjc,SAASic,aAA9B;SACKiI,OAAL;SACKT,KAAL,CAAWzB,YAAX,CAAwB,aAAxB,EAAuC,OAAvC;SACKmC,mBAAL;SACKC,iBAAL;SACKllB,SAAL,CAAe+jB,MAAf,CAAsB,KAAKQ,KAA3B;GAhH4B;;YAmHpB,oBAAW;WACZ,KAAKY,SAAL,EAAP;QACIpN,OAAO,IAAX;kBACc,IAAd;YACA,CAAiBA,KAAKyD,OAAL,CAAaxB,UAA9B,EAA0C,qBAA1C;SACKgL,OAAL;YACA,CAAiB,KAAKxJ,OAAL,CAAaxB,UAA9B,EAA0C,eAA1C;eACW,YAAW;cACpB,CAAiBjC,KAAKiC,UAAtB,EAAkC,QAAlC;iBACA,CAAoBjC,KAAKyD,OAAL,CAAaxB,UAAjC,EAA6C,qBAA7C;WACKA,UAAL,CAAgB8I,YAAhB,CAA6B,aAA7B,EAA4C,OAA5C;WACKmC,mBAAL;KAJF,EAKG,EALH;GA1H4B;;qBAkIX,6BAAY;;;;SAIxBV,KAAL,CAAWrgB,gBAAX,CAA4B,OAA5B,EAAqC,KAAKsgB,OAA1C;aACStgB,gBAAT,CAA0B,SAA1B,EAAqC,KAAKugB,SAA1C;sFACkFvnB,KAAlF,CAAwF,GAAxF,EAA6F0b,OAA7F,CAAqG,UAASnV,KAAT,EAAgB;WAC9G8gB,KAAL,CAAWrgB,gBAAX,CAA4BT,KAA5B,EAAmC,KAAKihB,iBAAxC;KADmG,CAEnGhqB,IAFmG,CAE9F,IAF8F,CAArG;GAxI4B;;wBA6IR,gCAAY;SAC3B6pB,KAAL,CAAWpgB,mBAAX,CAA+B,YAA/B,EAA6C,KAAKqgB,OAAlD;SACKD,KAAL,CAAWpgB,mBAAX,CAA+B,OAA/B,EAAwC,KAAKqgB,OAA7C;sFACkFtnB,KAAlF,CAAwF,GAAxF,EAA6F0b,OAA7F,CAAqG,UAASnV,KAAT,EAAgB;WAC9G8gB,KAAL,CAAWpgB,mBAAX,CAA+BV,KAA/B,EAAsC,KAAKihB,iBAA3C;KADmG,CAEnGhqB,IAFmG,CAE9F,IAF8F,CAArG;aAGSyJ,mBAAT,CAA6B,SAA7B,EAAwC,KAAKsgB,SAA7C;GAnJ4B;;WAsJrB,mBAAW;QACdxX,YAAY,KAAKuO,OAAL,CAAaxB,UAA7B;SACK/M,SAAL,CAAezI,KAAf,CAAqBya,MAArB,GAA8BhS,UAAUmY,YAAV,GAAyB,IAAvD;YACQzkB,GAAR,CAAY,YAAZ,EAA0B,KAAKsM,SAAL,CAAezI,KAAf,CAAqBya,MAA/C;QACK,CAAE,KAAK7hB,OAAL,CAAa6S,SAAb,CAAuBhD,SAA9B,EAA2C;WACpCA,SAAL,CAAezI,KAAf,CAAqB0a,KAArB,GAA6B,KAAK9hB,OAAL,CAAa8hB,KAAb,IAAsBuB,SAASxT,UAAUoY,WAAV,GAAwB,KAAKjoB,OAAL,CAAakoB,QAA9C,IAA0D,IAA7G;;;QAGEC,SAAS,KAAKtY,SAAL,CAAeqV,aAAf,CAA6B,QAA7B,CAAb;QACIkD,SAAS,KAAKvY,SAAL,CAAeqV,aAAf,CAA6B,QAA7B,CAAb;QACI+B,OAAO,KAAKpX,SAAL,CAAeqV,aAAf,CAA6B,MAA7B,CAAX;QACIrD,SAAS,KAAKhS,SAAL,CAAeyR,YAAf,GAA8B6G,OAAO7G,YAAlD;QACK8G,MAAL,EAAc;gBACFA,OAAO9G,YAAjB;;SAEGla,KAAL,CAAWya,MAAX,GAAoBA,SAAS,IAA7B;GArK4B;;qBAwKX,6BAAW;QACtBwG,QAAQ,KAAKlB,KAAL,CAAWmB,gBAAX,CAA4B9B,kBAA5B,CAAd;WACOtpB,OAAOkc,IAAP,CAAYiP,KAAZ,EAAmBE,GAAnB,CAAuB,UAACznB,GAAD;aAASunB,MAAMvnB,GAAN,CAAT;KAAvB,CAAP;GA1K4B;;uBA6KT,+BAAW;QAC1B0nB,iBAAiB,KAAKC,iBAAL,EAArB;QACKD,eAAexrB,MAApB,EAA6B;qBACZ,CAAf,EAAkBknB,KAAlB;KADF,MAEO;kBACOtH,UAAZ,CAAuBsH,KAAvB;;GAlL0B;;sBAsLV,8BAAW;QACvBmE,QAAQ,KAAKlB,KAAL,CAAWmB,gBAAX,CAA4B7B,mBAA5B,CAAd;WACOvpB,OAAOkc,IAAP,CAAYiP,KAAZ,EAAmBE,GAAnB,CAAuB,UAACznB,GAAD;aAASunB,MAAMvnB,GAAN,CAAT;KAAvB,CAAP;GAxL4B;;aA2LnB,mBAASuF,KAAT,EAAgB;QACpBA,MAAMga,OAAN,IAAiB,EAAtB,EAA2B;WAAOqH,UAAL;;QACxBrhB,MAAMga,OAAN,IAAiB,CAAtB,EAA0B;WACnBqI,aAAL,CAAmBriB,KAAnB;;GA9L0B;;WAkMrB,iBAASA,KAAT,EAAgB;;QAEnBsiB,mBAAmB,KAAvB;QACIriB,SAASD,MAAMC,MAAnB;;;;;;;;;QASIA,OAAOsiB,YAAP,CAAoB,kBAApB,CAAJ,EAA6C;WACtChiB,IAAL,CAAU,QAAV;WACK8gB,UAAL;;;;;;QAMEmB,kBAAkB,KAAKC,kBAAL,EAAtB;WACQD,gBAAgBpoB,OAAhB,CAAwB6F,MAAxB,IAAkC,CAAlC,IAAuCA,UAAU,KAAK6gB,KAA9D,EAAsE;eAC3D7gB,OAAOuZ,aAAhB;;;;QAIGgJ,gBAAgBpoB,OAAhB,CAAwB6F,MAAxB,IAAkC,CAAvC,EAA2C;;;;QAIvC,KAAKygB,QAAL,CAAcgC,KAAlB,EAAyB;UACnBC,YAAY,KAAhB;WACI,IAAIC,QAAR,IAAoB,KAAKlC,QAAL,CAAcgC,KAAlC,EAAyC;YAClCziB,OAAOuL,OAAP,CAAeoX,QAAf,CAAL,EAAgC;6BACX,KAAKlC,QAAL,CAAcgC,KAAd,CAAoBE,QAApB,EAA8B,IAA9B,EAAoC3iB,MAApC,CAAnB;;;;;;QAMFqiB,oBAAoBriB,OAAOsiB,YAAP,CAAoB,kBAApB,CAAxB,EAAiE,KAAKlB,UAAL;;UAE3DjY,cAAN;GA5O4B;;qBA+OX,2BAASpJ,KAAT,EAAgB;QAC5B,KAAK8gB,KAAL,CAAW+B,YAAX,CAAwB,aAAxB,KAA0C,MAA/C,EAAwD;WACjD9K,OAAL,CAAaxX,IAAb,CAAkB,cAAlB;KADF,MAEO;WACAwX,OAAL,CAAaxX,IAAb,CAAkB,cAAlB;;GAnP0B;;MAuP1B,eAASP,KAAT,EAAgB4iB,QAAhB,EAA0BvmB,OAA1B,EAAmC;QACjC,CAAE,KAAKqkB,QAAL,CAAc1gB,KAAd,CAAN,EAA6B;WACtB0gB,QAAL,CAAc1gB,KAAd,IAAuB,EAAvB;;QAEE,OAAO4iB,QAAP,IAAoB,UAAxB,EAAoC;gBACxBA,QAAV;iBACW,GAAX;;SAEGlC,QAAL,CAAc1gB,KAAd,EAAqB4iB,QAArB,IAAiCvmB,OAAjC;GA/P4B;;QAkQxB,cAAS2D,KAAT,EAAgB;QACf,KAAK0gB,QAAL,CAAc1gB,KAAd,KAAwB,KAAK0gB,QAAL,CAAc1gB,KAAd,EAAqB,GAArB,CAA7B,EAAyD;WAClD0gB,QAAL,CAAc1gB,KAAd,EAAqB,GAArB,EAA0B,IAA1B;;GApQ0B;;iBAwQf,uBAASA,KAAT,EAAgB;QACzBmiB,iBAAiB,KAAKC,iBAAL,EAArB;QACIU,mBAAmBX,eAAe/nB,OAAf,CAAuBiD,SAASic,aAAhC,CAAvB;QACItZ,MAAM0Z,QAAN,IAAkBoJ,qBAAqB,CAA3C,EAA8C;qBAC7BX,eAAexrB,MAAf,GAAwB,CAAvC,EAA0CknB,KAA1C;YACMzU,cAAN;;;QAGE,CAACpJ,MAAM0Z,QAAP,IAAmBoJ,qBAAqBX,eAAexrB,MAAf,GAAwB,CAApE,EAAuE;qBACtD,CAAf,EAAkBknB,KAAlB;YACMzU,cAAN;;GAlR0B;;OAsRzB;CAtRY,CAAZ;;AAyRPiL,OAAO3V,OAAP,CAAe;SACN,eAAU/E,OAAV,EAAmB;QACpBmnB,QAAQ,IAAIT,KAAJ,CAAU1mB,OAAV,CAAZ;WACOmnB,MAAM7C,KAAN,CAAY,IAAZ,CAAP;;GAHW;;OAOR;CAPP;;ACpTO,IAAI8E,WAAWnG,QAAQxmB,MAAR,CAAe;;sMAAA;;SAI5B,eAASwhB,MAAT,EAAiB;QAClBtD,OAAO,IAAX;QACI9K,YAAY,KAAK+M,UAArB;QACK/M,SAAL,EAAiB;WACVoV,QAAL,GAAgBpV,UAAUqV,aAAV,CAAwB,kBAAkB,KAAKllB,OAAL,CAAaokB,SAA/B,GAA2C,GAAnE,CAAhB;KADF,MAEO;;UAEDvR,YAAY,KAAKsS,UAAL,EAAhB;UACInlB,UAAU,KAAKA,OADnB;;kBAGYmd,QAAA,CAAe,KAAf,EAAsBtK,SAAtB,CAAZ;;UAEIjS,WAAW,KAAKZ,OAAL,CAAaY,QAAb,IAAyB,KAAKyoB,eAA7C;;UAEIxG,OAAO,IAAIC,SAAJ,GAAgBC,eAAhB,CAAgCniB,QAAhC,EAA0C,WAA1C,EAAuDiiB,IAAlE;aACQA,KAAKG,QAAL,CAAchmB,MAAtB,EAA+B;kBACnBiH,WAAV,CAAsB4e,KAAKG,QAAL,CAAc,CAAd,CAAtB;;;;SAICiC,QAAL,GAAgBpV,UAAUqV,aAAV,CAAwB,oBAAxB,CAAhB;SACKD,QAAL,CAAcS,YAAd,CAA2B,IAA3B,EAAiC,YAAY,KAAKvC,GAAlD;cACU/b,KAAV,CAAgBqW,QAAhB,GAA2B,UAA3B;;SAEKW,OAAL,CAAazX,EAAb,CAAgB,gBAAhB,EAAkC,UAAS9F,IAAT,EAAe;;QAE/C,CAAY,KAAKokB,QAAjB,EAA2B,OAA3B,EAAoC,UAAS5e,KAAT,EAAgB;cAC5CoJ,cAAN;aACK2O,OAAL,CAAaJ,QAAb,CAAsBO,MAAtB,CAA6B,eAA7B;aACK+K,MAAL,CAAYC,QAAZ;OAHF,EAIG,IAJH;;WAMKD,MAAL,GAAc,KAAKlL,OAAL,CAAa+I,KAAb,CAAmB;kBACrB,WADqB;eAExB,UAFwB;gBAGvB,MAHuB;mBAIpB;OAJC,CAAd;;WAOKmC,MAAL,CAAY3iB,EAAZ,CAAe,OAAf,EAAwB,SAAxB,EAAmC,UAASwgB,KAAT,EAAgB7gB,MAAhB,EAAwB;iBAChDA,OAAO4iB,YAAP,CAAoB,WAApB,CAAT;aACK9K,OAAL,CAAaJ,QAAb,CAAsBO,MAAtB,CAA6B,aAA7B;aACKH,OAAL,CAAaoB,QAAb,CAAsBlZ,MAAtB;eACO,IAAP;OAJiC,CAKjChJ,IALiC,CAK5B,IAL4B,CAAnC;;WAOKgsB,MAAL,CAAY3iB,EAAZ,CAAe,QAAf,EAAyB,YAAW;aAC7ByX,OAAL,CAAaJ,QAAb,CAAsBO,MAAtB,CAA6B,gBAA7B;OADF;;WAIKiL,cAAL;;UAEIzlB,SAAS4W,KAAK2O,MAAL,CAAY1M,UAAZ,CAAuBsI,aAAvB,CAAqC,IAArC,CAAb;;;;;;;;;;;;;UAaIuE,WAAW,SAAXA,QAAW,CAASC,KAAT,EAAgBC,QAAhB,EAA0B5lB,MAA1B,EAAkC;cACzCyX,OAAN,CAAc,UAASnH,IAAT,EAAe;cACvBuV,SAASjP,KAAKkP,aAAL,CAAmBxV,IAAnB,EAAyBsV,QAAzB,EAAmC5lB,MAAnC,CAAb;cACKsQ,KAAKyV,QAAL,CAAc9sB,MAAnB,EAA4B;qBACjBqX,KAAKyV,QAAd,EAAwBH,WAAW,CAAnC,EAAsCC,MAAtC;;SAHJ;OADF;eAQS/oB,KAAKkpB,GAAd,EAAmB,CAAnB,EAAsBhmB,MAAtB;KAjDgC,CAkDhCzG,IAlDgC,CAkD3B,IAlD2B,CAAlC;;WAoDOuS,SAAP;GAhFiC;;eAAA,yBAmFrBma,OAnFqB,EAmFZL,QAnFY,EAmFF5lB,MAnFE,EAmFM;;QAKnC6lB,SAASzM,QAAA,CAAe,IAAf,CAAb;QACK6M,QAAQtO,IAAb,EAAoB;UACduO,SAAS9M,QAAA,CAAe,GAAf,EAAoB,IAApB,EAA0ByM,MAA1B,CAAb;aACOM,WAAP,GAAqBF,QAAQzE,KAA7B;;;aAGOG,YAAP,CAAoB,MAApB,EAA4BsE,QAAQtO,IAApC;aACOgK,YAAP,CAAoB,WAApB,EAAiCsE,QAAQtO,IAAzC;KANF,MAOO;UACDyO,OAAOhN,QAAA,CAAe,MAAf,EAAuB,IAAvB,EAA6ByM,MAA7B,CAAX;WACKM,WAAL,GAAmBF,QAAQzE,KAA3B;;;QAGGxhB,OAAO6I,OAAP,IAAkB,IAAvB,EAA8B;;UAExB6X,MAAM1gB,OAAOmhB,aAAP,CAAqB,IAArB,CAAV;UACK,CAAET,GAAP,EAAa;cACLtH,QAAA,CAAe,IAAf,EAAqB,IAArB,EAA2BpZ,MAA3B,CAAN;;eAEO0gB,GAAT;;;WAGKxgB,WAAP,CAAmB2lB,MAAnB;WACOA,MAAP;GA/GiC;;;kBAkHnB,0BAAW;QACpB,CAAE,KAAK5pB,OAAL,CAAaoqB,QAApB,EAA+B;;;;QAE3B9jB,SAAS5C,SAASwhB,aAAT,CAAuB,KAAKllB,OAAL,CAAaoqB,QAApC,CAAb;QACK,CAAE9jB,MAAP,EAAgB;;;;QAEZmf,OAAO/hB,SAASC,aAAT,CAAuB,GAAvB,CAAX;SACKumB,WAAL,GAAmB,kBAAnB;SACKxE,YAAL,CAAkB,MAAlB,EAA0B,aAAa,KAAKvC,GAA5C;;QAEIkH,KAAK/jB,OAAO4e,aAAP,CAAqB,IAArB,CAAT;QACKmF,EAAL,EAAU;;eAEC3mB,SAASC,aAAT,CAAuB,IAAvB,CAAT;SACGM,WAAH,CAAeqC,MAAf;;WAEKrC,WAAP,CAAmBwhB,IAAnB;SACK3e,gBAAL,CAAsB,OAAtB,EAA+B,UAAST,KAAT,EAAgB;YACvCoJ,cAAN;YACMN,eAAN;WACK8V,QAAL,CAAc8D,KAAd;KAH6B,CAI7BzrB,IAJ6B,CAIxB,IAJwB,CAA/B;GAnIiC;;OA2I9B;CA3Ie,CAAf;;AA8IP,AAAO,IAAIgtB,WAAW,SAAXA,QAAW,CAAStqB,OAAT,EAAkB;SAC/B,IAAIopB,QAAJ,CAAappB,OAAb,CAAP;CADK;;AC7IA,IAAIuqB,QAAQtH,QAAQxmB,MAAR,CAAe;SACzB,eAASwhB,MAAT,EAAiB;QAClBtD,OAAO,IAAX;QACI9H,YAAY,KAAKsS,UAAL,EAAhB;QACItV,YAAYsN,QAAA,CAAe,KAAf,EAAsBtK,SAAtB,CADhB;QAEI7S,UAAU,KAAKA,OAFnB;;;;;QAOIwqB,KAAKrN,QAAA,CAAe,IAAf,EAAqB,SAArB,EAAgCtN,SAAhC,CAAT;cACA,CAAmB2a,EAAnB,EAAuB,CAAvB;SACKC,MAAL,GAActN,QAAA,CAAe,MAAf,EAAuB,YAAvB,EAAqCqN,EAArC,CAAd;SACKE,QAAL,GAAgBvN,QAAA,CAAe,MAAf,EAAuB,cAAvB,EAAuCqN,EAAvC,CAAhB;SACKE,QAAL,CAAcR,WAAd,GAA4B,KAA5B;SACKS,QAAL,GAAgBxN,QAAA,CAAe,MAAf,EAAuB,cAAvB,EAAuCqN,EAAvC,CAAhB;;;;;;;;;;;;;;;SAeKpM,OAAL,CAAazX,EAAb,CAAgB,aAAhB,EAA+B,UAAS9F,IAAT,EAAe;UACvCA,IAAL,EAAY;aACL4pB,MAAL,CAAYP,WAAZ,GAA0BrpB,KAAKga,KAAL,IAAcha,KAAK+pB,SAA7C;kBACA,CAAmBjQ,KAAKgQ,QAAxB,EAAkC,CAAlC;kBACA,CAAmBhQ,KAAK+P,QAAxB,EAAkC,CAAlC;kBACA,CAAmBF,EAAnB,EAAuB,CAAvB;;KALJ;;WASO3a,SAAP;GAvC8B;;iBA0CjB,uBAAUyV,IAAV,EAAgBzK,KAAhB,EAAuBhI,SAAvB,EAAkChD,SAAlC,EAA6CtS,EAA7C,EAAiD;QAC1DkoB,OAAOtI,QAAA,CAAe,GAAf,EAAoBtK,SAApB,EAA+BhD,SAA/B,CAAX;SACK1F,SAAL,GAAiBmb,IAAjB;SACK5J,IAAL,GAAY,GAAZ;SACKb,KAAL,GAAaA,KAAb;;;;;SAKK6K,YAAL,CAAkB,MAAlB,EAA0B,QAA1B;SACKA,YAAL,CAAkB,YAAlB,EAAgC7K,KAAhC;;2BAEA,CAAiC4K,IAAjC;MACA,CAAYA,IAAZ,EAAkB,OAAlB,EAA2BtQ,IAA3B;MACA,CAAYsQ,IAAZ,EAAkB,OAAlB,EAA2BloB,EAA3B,EAA+B,IAA/B;;;WAGOkoB,IAAP;GA3D8B;;OA8D3B;CA9DY,CAAZ;;AAiEP,AAAO,IAAI5K,QAAQ,SAARA,KAAQ,CAAS7a,OAAT,EAAkB;SAC5B,IAAIuqB,KAAJ,CAAUvqB,OAAV,CAAP;CADK;;ACjEA,IAAI6qB,sBAAsB5H,QAAQxmB,MAAR,CAAe;SACvC,eAASwhB,MAAT,EAAiB;QAClBtD,OAAO,IAAX;QACI9H,YAAY,KAAKsS,UAAL,EAAhB;QACItV,YAAYsN,QAAA,CAAe,KAAf,EAAsBtK,SAAtB,CADhB;QAEI7S,UAAU,KAAKA,OAFnB;;;;;SAOK8qB,UAAL,GAAkB3N,QAAA,CAAe,KAAf,EAAsB,gBAAtB,EAAwCtN,SAAxC,CAAlB;SACKkb,OAAL,GAAe5N,QAAA,CAAe,KAAf,EAAsB,aAAtB,EAAqCtN,SAArC,CAAf;;SAEKuO,OAAL,CAAazX,EAAb,CAAgB,aAAhB,EAA+B,UAAS9F,IAAT,EAAe;UACvCA,IAAL,EAAY;aACLiqB,UAAL,CAAgBZ,WAAhB,GAA8BrpB,KAAKmqB,SAAnC;aACKD,OAAL,CAAab,WAAb,GAA2BrpB,KAAKoqB,MAAhC;;KAHJ;;WAOOpb,SAAP;GApB4C;;iBAuB/B,uBAAUyV,IAAV,EAAgBzK,KAAhB,EAAuBhI,SAAvB,EAAkChD,SAAlC,EAA6CtS,EAA7C,EAAiD;QAC1DkoB,OAAOtI,QAAA,CAAe,GAAf,EAAoBtK,SAApB,EAA+BhD,SAA/B,CAAX;SACK1F,SAAL,GAAiBmb,IAAjB;SACK5J,IAAL,GAAY,GAAZ;SACKb,KAAL,GAAaA,KAAb;;;;;SAKK6K,YAAL,CAAkB,MAAlB,EAA0B,QAA1B;SACKA,YAAL,CAAkB,YAAlB,EAAgC7K,KAAhC;;2BAEA,CAAiC4K,IAAjC;MACA,CAAYA,IAAZ,EAAkB,OAAlB,EAA2BtQ,IAA3B;MACA,CAAYsQ,IAAZ,EAAkB,OAAlB,EAA2BloB,EAA3B,EAA+B,IAA/B;;;WAGOkoB,IAAP;GAxC4C;;OA2CzC;CA3C0B,CAA1B;;AA8CP,AAAO,IAAIyF,sBAAsB,SAAtBA,mBAAsB,CAASlrB,OAAT,EAAkB;SAC1C,IAAI6qB,mBAAJ,CAAwB7qB,OAAxB,CAAP;CADK;;AC3CA,IAAImrB,cAAclI,QAAQxmB,MAAR,CAAe;WAC7B;WACA,aADA;eAEI,KAFJ;UAGD;GAJ8B;;SAO/B,eAASwhB,MAAT,EAAiB;QAClBtD,OAAO,IAAX;QACI9H,YAAY,KAAKsS,UAAL,CAAgB,aAAhB,CAAhB;QACItV,YAAYsN,QAAA,CAAe,KAAf,EAAsBtK,SAAtB,CADhB;QAEI7S,UAAU,KAAKA,OAFnB;;SAIKorB,UAAL,GAAkB,KAAlB;SACKnG,QAAL,GAAgB,KAAKG,aAAL,CAAmBplB,QAAQslB,IAAR,IAAgBtlB,QAAQulB,KAA3C,EAAkDvlB,QAAQulB,KAA1D,EACR1S,SADQ,EACGhD,SADH,EACc,KAAKqO,OADnB,CAAhB;;;SAIKoL,MAAL,GAAc,KAAKlL,OAAL,CAAa+I,KAAb,CAAmB;;aAExB,aAFwB;iBAGpB,wBAHoB;eAItB,CACP;eACS,cADT;kBAEY,kBAAS9gB,KAAT,EAAgB;eACnBglB,iBAAL,CAAuBhlB,KAAvB;;OAJG,CAJsB;cAYvB;KAZI,CAAd;;WAgBOwJ,SAAP;GAlCoC;;WAqC7B,mBAAW;QACd8K,OAAO,IAAX;SACK2Q,cAAL;SACKhC,MAAL,CAAYC,QAAZ;GAxCoC;;iBA2CvB,uBAAUjE,IAAV,EAAgBzK,KAAhB,EAAuBhI,SAAvB,EAAkChD,SAAlC,EAA6CtS,EAA7C,EAAiD;QAC1DkoB,OAAOtI,QAAA,CAAe,QAAf,EAAyBtK,SAAzB,EAAoChD,SAApC,CAAX;SACK1F,SAAL,GAAiBmb,IAAjB;SACKzK,KAAL,GAAaA,KAAb;;;;;SAKK6K,YAAL,CAAkB,MAAlB,EAA0B,QAA1B;SACKA,YAAL,CAAkB,YAAlB,EAAgC7K,KAAhC;;2BAEA,CAAiC4K,IAAjC;MACA,CAAYA,IAAZ,EAAkB,OAAlB,EAA2BtQ,IAA3B;MACA,CAAYsQ,IAAZ,EAAkB,OAAlB,EAA2BloB,EAA3B,EAA+B,IAA/B;;WAEOkoB,IAAP;GA1DoC;;gBA6DxB,wBAAW;QACnB9K,OAAO,IAAX;QACK,KAAK2O,MAAL,CAAY1M,UAAZ,CAAuBsI,aAAvB,CAAqC,MAArC,CAAL,EAAoD;;;;QAEhDtkB,cAAW,EAAf;;QAEI2qB,qBAAqB,EAAzB;QACK,KAAKnN,OAAL,CAAahD,QAAb,CAAsBoQ,MAAtB,IAAgC,eAArC,EAAuD;;yBAElClrB,IAAnB,CAAwB,OAAxB;KAFF,MAGO;yBACcA,IAAnB,CAAwB,UAAxB;;uBAEiBA,IAAnB,CAAwB,SAAxB;;QAEK,KAAK8d,OAAL,CAAaqN,SAAb,IAA0B,KAAKrN,OAAL,CAAaqN,SAAb,CAAuBzuB,MAAvB,GAAgC,CAA/D,EAAmE;;yBAE9CsD,IAAnB,CAAwB,WAAxB;;;QAGG,KAAK8d,OAAL,CAAape,OAAb,CAAqBub,MAArB,IAA+B,KAAK6C,OAAL,CAAape,OAAb,CAAqBub,MAArB,CAA4Bve,MAA5B,GAAqC,CAAzE,EAA6E;WACtEgD,OAAL,CAAa0rB,SAAb,GAAyB,IAAzB;yBACmBprB,IAAnB,CAAwB,OAAxB;;;SAGGqrB,UAAL,GAAkB,EAAlB;uBACmBnQ,OAAnB,CAA2B,UAASoQ,GAAT,EAAc;UACnCC,WAAW,IAAIV,YAAYU,QAAZ,CAAqBD,GAArB,CAAJ,CAA8B,IAA9B,CAAf;qBACYC,SAASjrB,QAAT,EAAZ;WACK+qB,UAAL,CAAgBrrB,IAAhB,CAAqBurB,QAArB;KAHyB,CAIzBvuB,IAJyB,CAIpB,IAJoB,CAA3B;;QAMK,KAAK0C,OAAL,CAAa8rB,MAAlB,EAA2B;WACpB9rB,OAAL,CAAa+rB,SAAb,GAAyB,IAAzB;WACI,IAAIpvB,CAAR,IAAa,KAAKqD,OAAL,CAAa8rB,MAA1B,EAAkC;YAC5BE,QAAQ,KAAKhsB,OAAL,CAAa8rB,MAAb,CAAoBnvB,CAApB,CAAZ;YACIwF,KAAK,wBAAwBxF,CAAjC;+EAEYqvB,MAAMzG,KADlB;aAGI,IAAI3oB,CAAR,IAAaovB,MAAMC,MAAnB,EAA2B;cACrBC,QAAQF,MAAMC,MAAN,CAAarvB,CAAb,CAAZ;cACIuvB,UAAUD,MAAMnrB,KAAN,IAAeirB,MAAMjrB,KAArB,GAA6B,oBAA7B,GAAoD,EAAlE;mEACoDpE,CAApD,SAAyDC,CAAzD,8BAAmFovB,MAAMxqB,IAAzF,iBAAyG0qB,MAAMnrB,KAA/G,UAAyHorB,OAAzH,UAAqID,MAAM3G,KAA3I;;YAEGyG,MAAMI,IAAX,EAAkB;qEACsCJ,MAAMI,IAA5D;;;;;kBAKK,WAAWxrB,WAAX,GAAsB,SAAjC;;;;;;;;;;;;;;;;;SAiBK0oB,MAAL,CAAY1M,UAAZ,CAAuBsI,aAAvB,CAAqC,MAArC,EAA6C/a,SAA7C,GAAyDvJ,WAAzD;SACKyrB,KAAL,GAAa,KAAK/C,MAAL,CAAY1M,UAAZ,CAAuBsI,aAAvB,CAAqC,MAArC,CAAb;GAlIoC;;kBAqItB,0BAAW;SACpBoH,YAAL;SACKX,UAAL,CAAgBnQ,OAAhB,CAAwB,UAASqQ,QAAT,EAAmB;eAChCP,cAAT,CAAwB,KAAKe,KAA7B;KADsB,CAEtB/uB,IAFsB,CAEjB,IAFiB,CAAxB;GAvIoC;;qBA4InB,2BAAS+I,KAAT,EAAgB;UAC3BoJ,cAAN;;QAEI8c,WAAW,KAAf;QACIC,cAAc,EAAlB;QACIC,mBAAmB,EAAvB;SACKd,UAAL,CAAgBnQ,OAAhB,CAAwB,UAASqQ,QAAT,EAAmB;;;eAGhCa,UAAT,CAAoB,KAAKL,KAAzB,EAAgCG,WAAhC,EAA6CC,gBAA7C;KAHsB,CAItBnvB,IAJsB,CAIjB,IAJiB,CAAxB;;QAMK,KAAK0C,OAAL,CAAa+rB,SAAlB,EAA8B;WACxB,IAAIpvB,CAAR,IAAa,KAAKqD,OAAL,CAAa8rB,MAA1B,EAAkC;YAC5BE,QAAQ,KAAKhsB,OAAL,CAAa8rB,MAAb,CAAoBnvB,CAApB,CAAZ;YACIwF,KAAK,wBAAwBxF,CAAjC;YACIuvB,QAAQ,KAAKG,KAAL,CAAWnH,aAAX,mBAAyC8G,MAAMxqB,IAA/C,gBAAZ;YACK0qB,MAAMnrB,KAAN,IAAeirB,MAAMjrB,KAA1B,EAAkC;gBAC1BA,KAAN,GAAcmrB,MAAMnrB,KAApB;gBACMqZ,QAAN,CAAe4R,MAAMjrB,KAArB;;;;;SAKDuoB,MAAL,CAAYqD,UAAZ;;eAEW,YAAW;WACfvO,OAAL,CAAawO,WAAb,CAAyBH,gBAAzB;WACKrO,OAAL,CAAayO,MAAb,CAAoBL,WAApB;KAFS,CAGTlvB,IAHS,CAGJ,IAHI,CAAX,EAGc,GAHd;GAtKoC;;OA4KjC;CA5KkB,CAAlB;;AA+KP6tB,YAAYU,QAAZ,GAAuB,EAAvB;;AAEA,IAAIiB,WAAW5oB,MAAMzH,MAAN,CAAa;;WAEjB,EAFiB;;cAId,oBAAU4nB,UAAV,EAAmBrkB,OAAnB,EAA4B;cACpC,CAAgB,IAAhB,EAAsBA,OAAtB;SACKilB,QAAL,GAAgBZ,UAAhB;SACK0I,QAAL,GAAgB,EAAhB;SACK5J,GAAL,GAAY,IAAIvhB,IAAJ,EAAD,CAAawhB,OAAb,KAAyB,GAAzB,GAA+BC,SAASjkB,KAAKkkB,MAAL,CAAa,IAAI1hB,IAAJ,EAAD,CAAawhB,OAAb,EAAZ,IAAsC,IAA/C,EAAqD,EAArD,CAA1C;GARsB;;YAWhB,uBAAW,EAXK;;OAerB;;CAfQ,CAAf;;AAoBA+H,YAAYU,QAAZ,CAAqBmB,QAArB,GAAgCF,SAASrwB,MAAT,CAAgB;;kBAE9B,wBAASwwB,IAAT,EAAe;QACxB,CAAE,KAAKC,MAAZ,EAAqB;WACdA,MAAL,GAAcD,KAAK/H,aAAL,QAAwB,KAAK/B,GAA7B,YAAd;WACKgK,OAAL,GAAeF,KAAK/H,aAAL,QAAwB,KAAK/B,GAA7B,aAAf;WACKiK,QAAL,GAAgBH,KAAK/H,aAAL,QAAwB,KAAK/B,GAA7B,cAAhB;;WAEK+J,MAAL,CAAYpmB,gBAAZ,CAA6B,OAA7B,EAAsC,KAAKumB,cAAL,CAAoB/vB,IAApB,CAAyB,IAAzB,CAAtC;WACK4vB,MAAL,CAAYpmB,gBAAZ,CAA6B,QAA7B,EAAuC,KAAKumB,cAAL,CAAoB/vB,IAApB,CAAyB,IAAzB,CAAvC;;;QAGE4kB,YAAY,KAAK+C,QAAL,CAAc7G,OAAd,CAAsBpe,OAAtB,CAA8BkiB,SAA9B,IAA2C,GAA3D;QACKA,aAAa,MAAlB,EAA2B;kBAAc,GAAZ;;SACxB6K,QAAL,CAAc7K,SAAd,GAA0BA,SAA1B;SACKgL,MAAL,CAAYnsB,KAAZ,GAAoBmhB,SAApB;SACKmL,cAAL;GAhB4C;;cAmBlC,oBAASJ,IAAT,EAAejtB,OAAf,EAAwBstB,QAAxB,EAAkC;;YAEpCpL,SAAR,GAAoBoL,SAASpL,SAAT,GAAqB,KAAKgL,MAAL,CAAYnsB,KAArD;;;GArB4C;;YA0BpC,uBAAW;6IAGwB,KAAKoiB,GAFhD,uUAOkD,KAAKA,GAPvD,0PAYuD,KAAKA,GAZ5D;GA3B4C;;kBA4C9B,0BAAW;SACpBiK,QAAL,CAAchmB,KAAd,CAAoBmmB,QAApB,GAAoClK,SAAS,KAAK6J,MAAL,CAAYnsB,KAArB,EAA4B,EAA5B,IAAkC,GAAtE;SACKosB,OAAL,CAAapsB,KAAb,GAAwB,KAAKmsB,MAAL,CAAYnsB,KAApC;GA9C4C;;OAiDzC;;CAjDyB,CAAhC;;AAqDAoqB,YAAYU,QAAZ,CAAqB2B,OAArB,GAA+BV,SAASrwB,MAAT,CAAgB;;kBAE7B,wBAASwwB,IAAT,EAAe;QACzBxQ,OAAO,KAAKwI,QAAL,CAAc7G,OAAd,CAAsBpe,OAAtB,CAA8Byc,IAA9B,IAAsC,KAAKwI,QAAL,CAAc7G,OAAd,CAAsBhD,QAAtB,CAA+BqB,IAArE,IAA6E,MAAxF;;;QAGIyP,QAAQe,KAAK/H,aAAL,QAAwB,KAAK/B,GAA7B,eAA0C1G,IAA1C,CAAZ;UACM0P,OAAN,GAAgB,IAAhB;SACKY,QAAL,CAActQ,IAAd,GAAqBA,IAArB;GAR2C;;cAYjC,oBAASwQ,IAAT,EAAejtB,OAAf,EAAwBstB,QAAxB,EAAkC;QACxCpB,QAAQe,KAAK/H,aAAL,mBAAmC,KAAK/B,GAAxC,qBAAZ;YACQ1G,IAAR,GAAeyP,MAAMnrB,KAArB;QACKf,QAAQyc,IAAR,IAAgB,MAArB,EAA8B;eACnBA,IAAT,GAAgBzc,QAAQyc,IAAxB;;;;;;;GAhByC;;YAyBnC,uBAAW;QACfgR,gBAAgB,EAApB;QACK,KAAKxI,QAAL,CAAc7G,OAAd,CAAsBhD,QAAtB,CAA+BoQ,MAA/B,IAAyC,eAA9C,EAAgE;sBAC9C,2HAAhB;;mGAI6B,KAAKrI,GAFpC,iCAEmE,KAAKA,GAFxE,uNAG+B,KAAKA,GAHpC,iCAGmE,KAAKA,GAHxE,sGAI+B,KAAKA,GAJpC,iCAImE,KAAKA,GAJxE,2DAIiIsK,aAJjI;GA9B2C;;OAsCxC;;CAtCwB,CAA/B;;AA0CAtC,YAAYU,QAAZ,CAAqB6B,KAArB,GAA6BZ,SAASrwB,MAAT,CAAgB;;kBAE3B,wBAASwwB,IAAT,EAAe;QACzBxR,QAAQ,KAAKwJ,QAAL,CAAc7G,OAAd,CAAsBpe,OAAtB,CAA8Byb,KAA9B,IAAuC,SAAnD;;QAEIyQ,QAAQe,KAAK/H,aAAL,QAAwB,KAAK/B,GAA7B,qBAAgD1H,KAAhD,CAAZ;UACM0Q,OAAN,GAAgB,IAAhB;SACKY,QAAL,CAActR,KAAd,GAAsBA,KAAtB;GAPyC;;cAU/B,oBAASwR,IAAT,EAAejtB,OAAf,EAAwBstB,QAAxB,EAAkC;QACxCpB,QAAQe,KAAK/H,aAAL,mBAAmC,KAAK/B,GAAxC,sBAAZ;YACQ1H,KAAR,GAAgB6R,SAAS7R,KAAT,GAAiByQ,MAAMnrB,KAAvC;;GAZyC;;YAgBjC,uBAAW;QACfH,oGAE2B,KAAKuiB,GAFhC,kCAEgE,KAAKA,GAFrE,4DAAJ;;SAIK8B,QAAL,CAAc7G,OAAd,CAAsBpe,OAAtB,CAA8Bub,MAA9B,CAAqCC,OAArC,CAA6C,UAASC,KAAT,EAAgB;+CACvB,KAAK0H,GAAzC,kCAAyE,KAAKA,GAA9E,qBAAiG1H,MAAME,KAAvG,iBAAwHF,MAAME,KAA9H,YAA0IF,MAAMja,IAAhJ;KAD2C,CAE3ClE,IAF2C,CAEtC,IAFsC,CAA7C;;mBAIY,aAAZ;;WAEOsD,WAAP;GA3ByC;;OA+BtC;;CA/BsB,CAA7B;;AAmCAuqB,YAAYU,QAAZ,CAAqB8B,SAArB,GAAiCb,SAASrwB,MAAT,CAAgB;;kBAE/B,wBAASwwB,IAAT,EAAe;QACzBxB,YAAY,KAAKxG,QAAL,CAAc7G,OAAd,CAAsBqN,SAAtC;QACImC,eAAe,KAAK3I,QAAL,CAAc7G,OAAd,CAAsBpe,OAAtB,CAA8B4tB,YAAjD;QACIC,OAAOD,4BAA0BA,YAA1B,UAA6C,cAAxD;QACI1B,QAAQe,KAAK/H,aAAL,mBAAmC,KAAK/B,GAAxC,uBAA6D0K,IAA7D,CAAZ;UACM1B,OAAN,GAAgB,IAAhB;SACKY,QAAL,CAAca,YAAd,GAA6BA,gBAAgBnC,UAAU,CAAV,EAAamC,YAA1D;GAR6C;;cAWnC,oBAASX,IAAT,EAAejtB,OAAf,EAAwBstB,QAAxB,EAAkC;QACxCpB,QAAQe,KAAK/H,aAAL,mBAAmC,KAAK/B,GAAxC,6BAAZ;QACK+I,MAAMnrB,KAAN,IAAe,KAAKgsB,QAAL,CAAca,YAAlC,EAAiD;cACvCA,YAAR,GAAuB1B,MAAMnrB,KAA7B;WACKgsB,QAAL,CAAca,YAAd,GAA6B1B,MAAMnrB,KAAnC;;GAf2C;;YAmBrC,uBAAW;QACfH,wEAAJ;;SAIKqkB,QAAL,CAAc7G,OAAd,CAAsBqN,SAAtB,CAAgCjQ,OAAhC,CAAwC,UAASsS,QAAT,EAAmBnxB,CAAnB,EAAsB;+CACxB,KAAKwmB,GAAzC,yCAAgF,KAAKA,GAArF,4BAA+GxmB,CAA/G,iBAA4HmxB,SAASF,YAArI,aAAwJE,SAASvI,KAAT,IAAkBuI,SAASC,UAA3B,IAAyCD,SAASF,YAA1M;KADsC,CAEtCtwB,IAFsC,CAEjC,IAFiC,CAAxC;;mBAIY,aAAZ;;WAEOsD,WAAP;GA9B6C;;OAkC1C;;CAlC0B,CAAjC;;AAsCAuqB,YAAYU,QAAZ,CAAqBmC,KAArB,GAA6BlB,SAASrwB,MAAT,CAAgB;;kBAE3B,wBAASwwB,IAAT,EAAe;QACxB,CAAE,KAAKC,MAAZ,EAAqB;WACdA,MAAL,GAAcD,KAAK/H,aAAL,QAAwB,KAAK/B,GAA7B,YAAd;WACKgK,OAAL,GAAeF,KAAK/H,aAAL,QAAwB,KAAK/B,GAA7B,aAAf;WACKiK,QAAL,GAAgBH,KAAK/H,aAAL,QAAwB,KAAK/B,GAA7B,oBAAhB;WACK8K,YAAL,GAAoBhB,KAAK/H,aAAL,QAAwB,KAAK/B,GAA7B,YAApB;;WAEK+J,MAAL,CAAYpmB,gBAAZ,CAA6B,OAA7B,EAAsC,KAAKumB,cAAL,CAAoB/vB,IAApB,CAAyB,IAAzB,CAAtC;WACK4vB,MAAL,CAAYpmB,gBAAZ,CAA6B,QAA7B,EAAuC,KAAKumB,cAAL,CAAoB/vB,IAApB,CAAyB,IAAzB,CAAvC;;WAEK2wB,YAAL,CAAkBnnB,gBAAlB,CAAmC,OAAnC,EAA4C,UAAST,KAAT,EAAgB;cACpDoJ,cAAN;aACKyd,MAAL,CAAYnsB,KAAZ,GAAoB,GAApB;aACKssB,cAAL;OAH0C,CAI1C/vB,IAJ0C,CAIrC,IAJqC,CAA5C;;;QAOEqX,QAAQ,KAAKsQ,QAAL,CAAc7G,OAAd,CAAsBpe,OAAtB,CAA8B2U,KAA9B,IAAuC,GAAnD;QACK,CAAEA,KAAP,EAAe;cAAU,GAAR;;SACZoY,QAAL,CAAcpY,KAAd,GAAsBA,KAAtB;SACKuY,MAAL,CAAYnsB,KAAZ,GAAoB4T,KAApB;SACK0Y,cAAL;GAvByC;;cA0B/B,oBAASJ,IAAT,EAAejtB,OAAf,EAAwBstB,QAAxB,EAAkC;;YAEpC3Y,KAAR,GAAgB2Y,SAAS3Y,KAAT,GAAiB,KAAKuY,MAAL,CAAYnsB,KAA7C;;;GA5ByC;;YAiCjC,uBAAW;2IAGoB,KAAKoiB,GAF5C,wdAS8C,KAAKA,GATnD,8TAcuD,KAAKA,GAd5D,sDAeqB,KAAKA,GAf1B;GAlCyC;;kBAsD3B,0BAAW;SACpBiK,QAAL,CAAchmB,KAAd,CAAoB8mB,SAApB,cAA2C7K,SAAS,KAAK6J,MAAL,CAAYnsB,KAArB,EAA4B,EAA5B,IAAkC,GAA7E;SACKosB,OAAL,CAAapsB,KAAb,GAAwB,KAAKmsB,MAAL,CAAYnsB,KAApC;GAxDyC;;OA2DtC;;CA3DsB,CAA7B;;AA+DA,AAAO,IAAIotB,cAAc,SAAdA,WAAc,CAASnuB,OAAT,EAAkB;SAClC,IAAImrB,WAAJ,CAAgBnrB,OAAhB,CAAP;CADK;;ACjbA,IAAIouB,SAASnL,QAAQxmB,MAAR,CAAe;;WAGxB;;;;GAHwB;;SAS1B,eAASwhB,MAAT,EAAiB;QAClBpO,YAAY,KAAK+M,UAArB;QACK/M,SAAL,EAAiB;;KAAjB,MAEO;;UAEDgD,YAAY,KAAKsS,UAAL,EAAhB;UACInlB,UAAU,KAAKA,OADnB;;kBAGYmd,QAAA,CAAe,KAAf,EAAsBtK,SAAtB,CAAZ;;UAEIjS,WAAW,KAAKZ,OAAL,CAAaY,QAAb,IAAyB,KAAKyoB,eAA7C;UACIxG,OAAO,IAAIC,SAAJ,GAAgBC,eAAhB,CAAgCniB,QAAhC,EAA0C,WAA1C,EAAuDiiB,IAAlE;aACQA,KAAKG,QAAL,CAAchmB,MAAtB,EAA+B;kBACnBiH,WAAV,CAAsB4e,KAAKG,QAAL,CAAc,CAAd,CAAtB;;;;SAKCqL,WAAL,CAAiBxe,SAAjB;SACKye,eAAL,CAAqBze,SAArB;SACK0e,YAAL,CAAkB1e,SAAlB;SACK2V,WAAL,CAAiB3V,SAAjB;;WAEOA,SAAP;GAjC+B;;mBAoChB,yBAASA,SAAT,EAAoB;QAC/BhP,OAAO,KAAKA,IAAL,EAAX;SACI,IAAI+jB,IAAR,IAAgB/jB,IAAhB,EAAsB;UACfA,KAAKZ,cAAL,CAAoB2kB,IAApB,CAAL,EAAiC;YAC3B7jB,QAAQF,KAAK+jB,IAAL,CAAZ;YACK,OAAO7jB,KAAP,IAAiB,UAAtB,EAAmC;kBAAUA,OAAR;;YACjCytB,OAAO3e,UAAUqV,aAAV,iBAAsCN,IAAtC,OAAX;YACK4J,IAAL,EAAY;cACLA,KAAK5F,YAAL,CAAkB,OAAlB,CAAL,EAAkC;iBAC3BlD,YAAL,CAAkB,OAAlB,EAA2B3kB,KAA3B;WADF,MAEO;iBACAoJ,SAAL,GAAiBpJ,KAAjB;;;;;GA/CuB;;gBAsDnB,sBAAS8O,SAAT,EAAoB;QAC3B,KAAK7P,OAAL,CAAa6S,SAAlB,EAA8B;cAC5B,CAAiBhD,SAAjB,EAA4B,KAAK7P,OAAL,CAAa6S,SAAzC;;GAxD6B;;eA4DpB,uBAAW,EA5DS;;eA8DpB,qBAAShD,SAAT,EAAoB;QAC3BwU,aAAUxU,UAAUqV,aAAV,CAAwB,sBAAxB,CAAd;QACK,CAAEb,UAAP,EAAiB;;;2BACjB,CAAiCA,UAAjC;MACA,CAAYA,UAAZ,EAAqB,OAArB,EAA8BlP,IAA9B;MACA,CAAYkP,UAAZ,EAAqB,OAArB,EAA8B,KAAKnG,OAAnC,EAA4C,IAA5C;GAnE+B;;WAsExB,mBAAW,EAtEa;;QAyE3B,gBAAW;WACR,KAAKle,OAAL,CAAaa,IAAb,IAAqB,EAA5B;GA1E+B;;OA6E5B;CA7Ea,CAAb;;AAgFPutB,OAAOK,MAAP,GAAgBL,OAAO3xB,MAAP,CAAc;6EAAA;;WAGnB,mBAAW;SACbuD,OAAL,CAAaonB,OAAb,CAAqB,IAArB,EAA2B,KAAKhJ,OAAhC;GAJ0B;;OAOvB;CAPS,CAAhB;;AAUAgQ,OAAOM,KAAP,GAAeN,OAAO3xB,MAAP,CAAc;8DAAA;;OAItB;CAJQ,CAAf;;AAOA2xB,OAAOO,MAAP,GAAgBP,OAAO3xB,MAAP,CAAc;6EAAA;;eAGf,qBAASoT,SAAT,EAAoB;SAC1B0P,KAAL,CAAW,KAAKvf,OAAL,CAAa4uB,MAAb,CAAoB,CAApB,EAAuBC,SAAlC,EAA6Chf,SAA7C;;WAEOA,SAAP;GAN0B;;SASrB,eAASgf,SAAT,EAAoBhf,SAApB,EAA+B;gBACxBA,aAAa,KAAK+M,UAA9B;SACKkS,WAAL,CAAiBjf,SAAjB;SACKkf,MAAL,GAAc,KAAK/uB,OAAL,CAAa4uB,MAAb,CAAoB1a,MAApB,CAA2B,UAASyR,CAAT,EAAY;aAASA,EAAEkJ,SAAF,IAAeA,SAAtB;KAAzC,EAA4E,CAA5E,CAAd;SACKN,YAAL,CAAkB1e,SAAlB;SACKye,eAAL,CAAqBze,SAArB;GAd0B;;eAiBf,qBAASA,SAAT,EAAoB;QAC1B,CAAE,KAAKkf,MAAZ,EAAqB;;;QAChB,KAAKA,MAAL,CAAYlc,SAAjB,EAA6B;iBAC3B,CAAoBhD,SAApB,EAA+B,KAAKkf,MAAL,CAAYlc,SAA3C;;GApBwB;;gBAwBd,sBAAShD,SAAT,EAAoB;QAC3B,KAAKkf,MAAL,CAAYlc,SAAjB,EAA6B;cAC3B,CAAiBhD,SAAjB,EAA4B,KAAKkf,MAAL,CAAYlc,SAAxC;;GA1BwB;;WA8BnB,mBAAW;SACbkc,MAAL,CAAY3H,OAAZ,CAAoB,IAApB,EAA0B,KAAKhJ,OAA/B;GA/B0B;;QAkCtB,gBAAW;WACR,KAAK2Q,MAAL,CAAYluB,IAAZ,IAAoB,EAA3B;GAnC0B;;OAsCvB;CAtCS,CAAhB;;;;;;AA6CA,AAAO,IAAIsjB,SAAS;UACV,gBAASnkB,OAAT,EAAkB;WAAS,IAAIouB,OAAOK,MAAX,CAAkBzuB,OAAlB,CAAP;GADV;SAEX,eAASA,OAAT,EAAkB;WAAS,IAAIouB,OAAOM,KAAX,CAAiB1uB,OAAjB,CAAP;GAFT;UAGV,gBAASA,OAAT,EAAkB;WAAS,IAAIouB,OAAOO,MAAX,CAAkB3uB,OAAlB,CAAP;;CAHvB;;AC9IA,IAAIgvB,WAAW/L,QAAQxmB,MAAR,CAAe;WAC1B;WACA,UADA;UAED;GAH2B;;sGAAA;;SAS5B,eAASwhB,MAAT,EAAiB;QAClBtD,OAAO,IAAX;QACI9K,YAAY,KAAK+M,UAArB;QACK/M,SAAL,EAAiB;WACVoV,QAAL,GAAgBpV,UAAUqV,aAAV,CAAwB,kBAAkB,KAAKllB,OAAL,CAAaokB,SAA/B,GAA2C,GAAnE,CAAhB;KADF,MAEO;;UAEDvR,YAAY,KAAKsS,UAAL,EAAhB;UACInlB,UAAU,KAAKA,OADnB;;kBAGYmd,QAAA,CAAe,KAAf,EAAsBtK,SAAtB,CAAZ;;UAEIjS,WAAW,KAAKZ,OAAL,CAAaY,QAAb,IAAyB,KAAKyoB,eAA7C;;UAEIxG,OAAO,IAAIC,SAAJ,GAAgBC,eAAhB,CAAgCniB,QAAhC,EAA0C,WAA1C,EAAuDiiB,IAAlE;aACQA,KAAKG,QAAL,CAAchmB,MAAtB,EAA+B;kBACnBiH,WAAV,CAAsB4e,KAAKG,QAAL,CAAc,CAAd,CAAtB;;;;SAIC5E,OAAL,CAAazX,EAAb,CAAgB,gBAAhB,EAAkC,UAAS9F,IAAT,EAAe;WAC1CyrB,YAAL;KADF;;SAKKrH,QAAL,GAAgBpV,UAAUqV,aAAV,CAAwB,oBAAxB,CAAhB;MACA,CAAY,KAAKD,QAAjB,EAA2B,OAA3B,EAAoC,UAAS5e,KAAT,EAAgB;YAC5CoJ,cAAN;WACK6Z,MAAL,CAAYC,QAAZ;KAFF,EAGG,IAHH;;WAKO1Z,SAAP;GAxCiC;;WA2C1B,mBAAW;QACd8K,OAAO,IAAX;SACK2O,MAAL,CAAYC,QAAZ;GA7CiC;;iBAgDpB,uBAAUjE,IAAV,EAAgBzK,KAAhB,EAAuBhI,SAAvB,EAAkChD,SAAlC,EAA6CtS,EAA7C,EAAiD;QAC1DkoB,OAAOtI,QAAA,CAAe,QAAf,EAAyBtK,SAAzB,EAAoChD,SAApC,CAAX;SACK1F,SAAL,GAAiBmb,IAAjB;SACKzK,KAAL,GAAaA,KAAb;;SAEK6K,YAAL,CAAkB,MAAlB,EAA0B,QAA1B;SACKA,YAAL,CAAkB,YAAlB,EAAgC7K,KAAhC;;2BAEA,CAAiC4K,IAAjC;MACA,CAAYA,IAAZ,EAAkB,OAAlB,EAA2BtQ,IAA3B;MACA,CAAYsQ,IAAZ,EAAkB,OAAlB,EAA2BloB,EAA3B,EAA+B,IAA/B;;WAEOkoB,IAAP;GA5DiC;;gBA+DrB,wBAAW;QACnB9K,OAAO,IAAX;;QAEI/Z,4TAAJ;;SAQK0oB,MAAL,GAAc,KAAKlL,OAAL,CAAa+I,KAAb,CAAmB;gBACrBvmB,QADqB;aAExB,4BAFwB;iBAGpB,uBAHoB;eAItB,CACP;eACS,eADT;kBAEY,kBAASyF,KAAT,EAAgB;mBACf4oB,UAAT,GAAsB,IAAtB;cACIC,YAAYvU,KAAK2O,MAAL,CAAY1M,UAAZ,CAAuBsI,aAAvB,CAAqC,YAArC,CAAhB;;cAEIxmB,QAAQgF,SAASyrB,WAAT,EAAZ;gBACMC,UAAN,CAAiBF,SAAjB;cACIG,MAAM5tB,OAAO6tB,YAAP,EAAV;cACIC,eAAJ;cACIC,QAAJ,CAAa9wB,KAAb;;;;cAII;gBACE+wB,OAAO/rB,SAASgsB,WAAT,CAAqB,MAArB,CAAX;WADF,CAEE,OAAMre,GAAN,EAAW;oBACH9N,GAAR,CAAY,kBAAZ,EAAgC8N,GAAhC;;;eAGGse,QAAL,CAAcxlB,SAAd,GAA0B,6CAA1B;eACKwlB,QAAL,CAAcvoB,KAAd,CAAoBqb,OAApB,GAA8B,OAA9B;cACI8M,eAAJ;gBACMK,MAAN;mBACSX,UAAT,GAAsB,KAAtB;;OAzBG,CAJsB;cAiCvB,MAjCuB;gBAkCrB;KAlCE,CAAd;;SAqCK5C,KAAL,GAAa,KAAK/C,MAAL,CAAY1M,UAAZ,CAAuBsI,aAAvB,CAAqC,MAArC,CAAb;QACI2G,WAAW,KAAKQ,KAAL,CAAWnH,aAAX,CAAyB,UAAzB,CAAf;;QAEI2K,YAAY,KAAK7vB,OAAL,CAAa6vB,SAAb,IAA0B,KAAKzR,OAAL,CAAahD,QAAb,CAAsByU,SAAhE;;cAEUrU,OAAV,CAAkB,UAASsU,QAAT,EAAmBhT,KAAnB,EAA0B;UACtCyI,QAAQpI,QAAA,CAAe,OAAf,EAAwB,IAAxB,EAA8B0O,QAA9B,CAAZ;UACIK,QAAQ/O,QAAA,CAAe,OAAf,EAAwB,IAAxB,EAA8BoI,KAA9B,CAAZ;YACMG,YAAN,CAAmB,MAAnB,EAA2B,QAA3B;YACMA,YAAN,CAAmB,OAAnB,EAA4BoK,SAASC,MAArC;YACMrK,YAAN,CAAmB,MAAnB,EAA2B,OAA3B;UACK5I,SAAS,CAAd,EAAkB;cACV4I,YAAN,CAAmB,SAAnB,EAA8B,SAA9B;;UAEEsK,OAAOtsB,SAASusB,cAAT,CAAwB,MAAMH,SAASC,MAAvC,CAAX;YACM9rB,WAAN,CAAkB+rB,IAAlB;YACMtK,YAAN,CAAmB,WAAnB,EAAgCoK,SAASE,IAAzC;KAXF;;SAcKE,UAAL,GAAkB,KAAK5G,MAAL,CAAY1M,UAAZ,CAAuBsI,aAAvB,CAAqC,YAArC,CAAlB;SACKyK,QAAL,GAAgB,KAAKrG,MAAL,CAAY1M,UAAZ,CAAuBsI,aAAvB,CAAqC,UAArC,CAAhB;MACA,CAAY,KAAKmH,KAAjB,EAAwB,QAAxB,EAAkC,UAAShmB,KAAT,EAAgB;UAC5CC,SAASD,MAAMC,MAAnB;UACKA,OAAOsG,OAAP,IAAkB,OAAvB,EAAiC;aAC1BujB,eAAL;;KAHJ,EAKG,IALH;;SAOKA,eAAL;GA3IiC;;mBA8IlB,2BAAW;QACtBjB,YAAY,KAAKkB,eAAL,EAAhB;SACKF,UAAL,CAAgB/lB,SAAhB,GAA4B+kB,SAA5B;SACKS,QAAL,CAAcvoB,KAAd,CAAoBqb,OAApB,GAA8B,MAA9B;SACKkN,QAAL,CAAcxlB,SAAd,GAA0B,EAA1B;GAlJiC;;mBAqJlB,yBAAS4lB,MAAT,EAAiB;QAC3BA,UAAU,IAAf,EAAsB;UAChBM,WAAW,KAAKhE,KAAL,CAAWnH,aAAX,CAAyB,eAAzB,CAAf;eACSmL,SAAStvB,KAAlB;;QAEEsvB,WAAW,KAAKhE,KAAL,CAAWnH,aAAX,CAAyB,iBAAiB6K,MAAjB,GAA0B,GAAnD,CAAf;WACOM,SAASnH,YAAT,CAAsB,WAAtB,CAAP;;GA3JiC;;OA+J9B;CA/Je,CAAf;;AAkKP,AAAO,IAAI4G,WAAW,SAAXA,QAAW,CAAS9vB,OAAT,EAAkB;SAC/B,IAAIgvB,QAAJ,CAAahvB,OAAb,CAAP;CADK;;AClKA,IAAIswB,SAASrN,QAAQxmB,MAAR,CAAe;WACxB;WACA,QADA;UAED;GAHyB;;2aAAA;;SAY1B,eAASwhB,MAAT,EAAiB;QAClBtD,OAAO,IAAX;QACI9K,YAAY,KAAK+M,UAArB;QACK/M,SAAL,EAAiB;WACVoV,QAAL,GAAgBpV,UAAUqV,aAAV,CAAwB,kBAAkB,KAAKllB,OAAL,CAAaokB,SAA/B,GAA2C,GAAnE,CAAhB;KADF,MAEO;;UAEDvR,YAAY,KAAKsS,UAAL,EAAhB;UACInlB,UAAU,KAAKA,OADnB;;kBAGYmd,QAAA,CAAe,KAAf,EAAsBtK,SAAtB,CAAZ;;UAEIjS,WAAW,KAAKZ,OAAL,CAAaY,QAAb,IAAyB,KAAKyoB,eAA7C;;UAEIxG,OAAO,IAAIC,SAAJ,GAAgBC,eAAhB,CAAgCniB,QAAhC,EAA0C,WAA1C,EAAuDiiB,IAAlE;aACQA,KAAKG,QAAL,CAAchmB,MAAtB,EAA+B;kBACnBiH,WAAV,CAAsB4e,KAAKG,QAAL,CAAc,CAAd,CAAtB;;;;SAICiC,QAAL,GAAgBpV,UAAUqV,aAAV,CAAwB,oBAAxB,CAAhB;cACU9d,KAAV,CAAgBqW,QAAhB,GAA2B,UAA3B;;SAEK8S,KAAL,GAAa,IAAb;SACKC,SAAL,GAAiB,KAAjB;SACKC,WAAL,GAAmB,KAAnB;;SAEKrS,OAAL,CAAazX,EAAb,CAAgB,OAAhB,EAAyB,YAAW;;WAE7B2iB,MAAL,GAAc,KAAKlL,OAAL,CAAa+I,KAAb,CAAmB;kBACrB,qBADqB;eAExB,gBAFwB;mBAGpB,EAAEtX,WAAW,mBAAb,EAHoB;gBAIvB;OAJI,CAAd;;WAOKyZ,MAAL,CAAY1mB,SAAZ,CAAsBgkB,OAAtB,GAAgC,YAAW;YACpCjM,KAAK8V,WAAV,EAAwB;eACjBD,SAAL,GAAiB,IAAjB;;OAFJ;;WAMKE,QAAL,GAAgB,KAAKpH,MAAL,CAAY1M,UAAZ,CAAuBsI,aAAvB,CAAqC,SAArC,CAAhB;;WAEKoE,MAAL,CAAY3iB,EAAZ,CAAe,OAAf,EAAwB,SAAxB,EAAmC,UAASwgB,KAAT,EAAgB7gB,MAAhB,EAAwB;iBAChDA,OAAO4iB,YAAP,CAAoB,MAApB,CAAT;aACK9K,OAAL,CAAaJ,QAAb,CAAsBO,MAAtB,CAA6B,WAA7B;aACKH,OAAL,CAAaoB,QAAb,CAAsBlZ,MAAtB;eACO,IAAP;OAJiC,CAKjChJ,IALiC,CAK5B,IAL4B,CAAnC;;WAOKgsB,MAAL,CAAY3iB,EAAZ,CAAe,QAAf,EAAyB,YAAW;aAC7ByX,OAAL,CAAaJ,QAAb,CAAsBO,MAAtB,CAA6B,gBAA7B;OADuB,CAEvBjhB,IAFuB,CAElB,IAFkB,CAAzB;KAxBuB,CA4BvBA,IA5BuB,CA4BlB,IA5BkB,CAAzB;;MA8BA,CAAY,KAAK2nB,QAAjB,EAA2B,OAA3B,EAAoC,UAAS5e,KAAT,EAAgB;YAC5CoJ,cAAN;;UAEIkhB,eAAe,KAAK/T,UAAL,CAAgBsI,aAAhB,CAA8B,qBAA9B,EAAqDnkB,KAAxE;qBACe4vB,aAAa/wB,OAAb,CAAqB,MAArB,EAA6B,EAA7B,EAAiCA,OAAjC,CAAyC,MAAzC,EAAiD,EAAjD,CAAf;;UAEK,CAAE+wB,YAAP,EAAsB;;;;;UAKjBA,gBAAgB,KAAKA,YAA1B,EAAyC;;aAElCC,gBAAL;OAFF,MAGO;aACAD,YAAL,GAAoBA,YAApB;aACKE,gBAAL;aACKC,WAAL;;KAjBJ,EAmBG,IAnBH;;WAqBOjhB,SAAP;GA1F+B;;oBA6Ff,4BAAW;SACtB4gB,WAAL,GAAmB,IAAnB;SACKM,aAAL;QACIhwB,QAAQ,KAAK4vB,YAAjB;SACKD,QAAL,CAAcvmB,SAAd,GAA0B,iCAAiCpJ,KAAjC,GAAyC,cAAzC,GAA0D,KAAKqd,OAAL,CAAawE,cAAb,EAApF;SACK0G,MAAL,CAAYC,QAAZ;GAlG+B;;oBAqGf,4BAAW;QACtB,KAAKiH,SAAV,EAAsB;WACfA,SAAL,GAAiB,KAAjB;;;SAGGQ,aAAL;SACK1H,MAAL,CAAYC,QAAZ;SACKnL,OAAL,CAAaJ,QAAb,CAAsBO,MAAtB,CAA6B,aAA7B;GA5G+B;;eA+GpB,uBAAW;QAClB5D,OAAO,IAAX;;QAEIlY,MAAM,KAAKzC,OAAL,CAAaixB,SAAb,GAAyB,KAAKN,YAAxC;;QAEI7W,UAAU,IAAIoX,cAAJ,EAAd;YACQ3U,IAAR,CAAa,KAAb,EAAoB9Z,GAApB,EAAyB,IAAzB;;YAEQmB,MAAR,GAAiB,YAAW;UACtB,KAAKutB,MAAL,IAAe,GAAf,IAAsB,KAAKA,MAAL,GAAc,GAAxC,EAA6C;;YAEvCtwB,OAAOoa,KAAKC,KAAL,CAAW,KAAKkW,QAAhB,CAAX;gBACQ7tB,GAAR,CAAY,aAAZ,EAA2B1C,IAA3B;;aAEK0vB,KAAL,GAAa1vB,IAAb;OALF,MAOO;;;aAGA0vB,KAAL,GAAa,IAAb;gBACQhtB,GAAR,CAAY,KAAK6tB,QAAjB;;;WAGGhT,OAAL,CAAaJ,QAAb,CAAsBO,MAAtB,CAA6B,oBAA7B;WACKqS,gBAAL;KAhBF;;YAoBQ/sB,OAAR,GAAkB,YAAW;;WAEtB0sB,KAAL,GAAa,IAAb;WACKK,gBAAL;KAHF;;YAMQS,IAAR;GAjJ+B;;iBAqJlB,yBAAW;WACjB,KAAKX,QAAL,IAAiB,KAAKA,QAAL,CAAcY,aAAd,EAAxB,EAAuD;WAChDZ,QAAL,CAAc3d,WAAd,CAA0B,KAAK2d,QAAL,CAAca,SAAxC;;GAvJ6B;;iBA2JlB,yBAAW;QACpB5W,OAAO,IAAX;QACI6W,OAAJ;;SAEKf,WAAL,GAAmB,KAAnB;;SAEKM,aAAL;;QAEI9S,SAAS,KAAKG,OAAlB;WACOqT,WAAP,CAAmBC,KAAnB;;QAEK,KAAKnB,KAAV,EAAkB;UACZoB,YAAY,IAAhB;UACI,KAAKpB,KAAL,CAAWqB,aAAX,IAA4B,KAAhC,EAAuC;oBACzB,KAAZ;;UAEG,KAAKrB,KAAL,CAAWsB,cAAX,CAA0B70B,MAA/B,EAAwC;kBAC5BmgB,QAAA,CAAe,IAAf,CAAV;;aAEKoT,KAAL,CAAWsB,cAAX,CAA0BrW,OAA1B,CAAkC,UAASsW,MAAT,EAAiB;cAC7ClI,SAASzM,QAAA,CAAe,IAAf,CAAb;cACI8M,SAAS9M,QAAA,CAAe,GAAf,EAAoB,IAApB,EAA0ByM,MAA1B,CAAb;cACImI,WAAW,aAAaD,OAAOpT,GAApB,GAA0B,GAAzC;;cAEIoT,OAAOE,OAAX,EAAoB;gBACdF,OAAOjX,KAAX,EAAkB;kBACZoX,eAAe9U,QAAA,CAAe,GAAf,CAAnB;2BACa+M,WAAb,GAA2B4H,OAAOjX,KAAP,GAAe,IAA1C;qBACO5W,WAAP,CAAmBguB,YAAnB;;mBAEKhuB,WAAP,CAAmBP,SAASusB,cAAT,CAAwB6B,OAAOE,OAA/B,CAAnB;;mBAEOtM,YAAP,CAAoB,MAApB,EAA4BqM,QAA5B;oBACQ9tB,WAAR,CAAoB2lB,MAApB;;cAEE+H,SAAJ,EAAe;mBACNF,WAAP,CAAmBE,SAAnB,CAA6BI,QAA7B;;SAjBJ;OAHF,MAuBO;kBACK5U,QAAA,CAAe,GAAf,CAAV;gBACQ+M,WAAR,GAAsB,2BAA2BvP,KAAKgW,YAAhC,GAA+C,GAArE;;KA9BJ,MAgCO;gBACKxT,QAAA,CAAe,GAAf,CAAV;cACQ+M,WAAR,GAAsB,4CAAtB;;;SAGGwG,QAAL,CAAczsB,WAAd,CAA0ButB,OAA1B;GA3M+B;;OA8M5B;CA9Ma,CAAb;;AAiNP,AAAO,IAAIU,SAAS,SAATA,MAAS,CAASlyB,OAAT,EAAkB;SAC7B,IAAIswB,MAAJ,CAAWtwB,OAAX,CAAP;CADK;;AC/MA,IAAImyB,2BAA2BlP,QAAQxmB,MAAR,CAAe;WAC1C;WACA,MADA;eAEI,MAFJ;UAGD;GAJ2C;;2JAAA;;SAS5C,eAASwhB,MAAT,EAAiB;QAClBtD,OAAO,IAAX;QACI9K,YAAY,KAAK+M,UAArB;QACK/M,SAAL,EAAiB;WACVoV,QAAL,GAAgBpV,UAAUqV,aAAV,CAAwB,kBAAkB,KAAKllB,OAAL,CAAaokB,SAA/B,GAA2C,GAAnE,CAAhB;KADF,MAEO;;UAEDvR,YAAY,KAAKsS,UAAL,EAAhB;UACInlB,UAAU,KAAKA,OADnB;;kBAGYmd,QAAA,CAAe,KAAf,EAAsBtK,SAAtB,CAAZ;;UAEIjS,WAAW,KAAKZ,OAAL,CAAaY,QAAb,IAAyB,KAAKyoB,eAA7C;;UAEIxG,OAAO,IAAIC,SAAJ,GAAgBC,eAAhB,CAAgCniB,QAAhC,EAA0C,WAA1C,EAAuDiiB,IAAlE;aACQA,KAAKG,QAAL,CAAchmB,MAAtB,EAA+B;kBACnBiH,WAAV,CAAsB4e,KAAKG,QAAL,CAAc,CAAd,CAAtB;;;;SAIC5E,OAAL,CAAazX,EAAb,CAAgB,gBAAhB,EAAkC,UAAS9F,IAAT,EAAe;WAC1CyrB,YAAL;KADF;;SAKKrH,QAAL,GAAgBpV,UAAUqV,aAAV,CAAwB,oBAAxB,CAAhB;MACA,CAAY,KAAKD,QAAjB,EAA2B,OAA3B,EAAoC,UAAS5e,KAAT,EAAgB;YAC5CoJ,cAAN;WACK6Z,MAAL,CAAYC,QAAZ;KAFF,EAGG,IAHH;;WAKO1Z,SAAP;GAxCiD;;gBA2CrC,wBAAW;QACnB8K,OAAO,IAAX;;QAEI/Z,4BAAJ;;SAGK0oB,MAAL,GAAc,KAAKlL,OAAL,CAAa+I,KAAb,CAAmB;gBACrBvmB,QADqB;aAExB,MAFwB;cAGvB,MAHuB;gBAIrB;KAJE,CAAd;;QAOIwxB,KAAK,KAAK9I,MAAL,CAAY1M,UAAZ,CAAuBsI,aAAvB,CAAqC,IAArC,CAAT;;QAEImN,kBAAkB,CACpB,CAAE,OAAF,EAAW,OAAX,CADoB,EAEpB,CAAE,SAAF,EAAa,QAAb,CAFoB,EAGpB,CAAE,SAAF,EAAa,kBAAb,CAHoB,EAIpB,CAAE,eAAF,EAAmB,eAAnB,CAJoB,EAKpB,CAAE,WAAF,EAAe,WAAf,CALoB,EAMpB,CAAE,QAAF,EAAY,QAAZ,CANoB,EAOpB,CAAE,KAAF,EAAS,KAAT,CAPoB,EAQpB,CAAE,aAAF,EAAiB,aAAjB,CARoB,CAAtB;;QAWIC,uBAAuB,EAA3B;;QAEIlX,WAAW,KAAKgD,OAAL,CAAahD,QAA5B;;SAEI,IAAImX,GAAR,IAAeF,eAAf,EAAgC;UAC1BvxB,MAAMuxB,gBAAgBE,GAAhB,EAAqB,CAArB,CAAV;UACIhN,QAAQ8M,gBAAgBE,GAAhB,EAAqB,CAArB,CAAZ;UACKnX,SAASta,GAAT,CAAL,EAAqB;YACfC,QAAQqa,SAASta,GAAT,CAAZ;YACKA,OAAO,SAAP,IAAoBA,OAAO,eAAhC,EAAkD;kBACxC,KAAK0xB,WAAL,CAAiBzxB,KAAjB,CAAR;cACK,CAAEA,KAAP,EAAe;;;;;6BAGID,GAArB,IAA4B,IAA5B;YACI2xB,KAAKtV,QAAA,CAAe,IAAf,EAAqB,qBAArB,EAA4CiV,EAA5C,CAAT;WACGjoB,SAAH,GAAeob,KAAf;YACImN,KAAKvV,QAAA,CAAe,IAAf,EAAqB,6CAA6Crc,GAAlE,EAAuEsxB,EAAvE,CAAT;WACGjoB,SAAH,GAAepJ,KAAf;;;GAvF6C;;eA6FtC,qBAASA,KAAT,EAAgB;QACvB4xB,QAAQ5xB,MAAM4xB,KAAN,CAAY,OAAZ,CAAZ;QACKA,KAAL,EAAa;aACJA,MAAM,CAAN,CAAP;;WAEK,IAAP;GAlGiD;;OAqG9C;CArG+B,CAA/B;;AAwGP,AAAO,IAAIC,2BAA2B,SAA3BA,wBAA2B,CAAS5yB,OAAT,EAAkB;SAC/C,IAAImyB,wBAAJ,CAA6BnyB,OAA7B,CAAP;CADK;;AC1GA,IAAI6yB,WAAW5P,QAAQxmB,MAAR,CAAe;WAC1B;WACA,eADA;UAED;GAH2B;;+IAAA;;SAS5B,eAASwhB,MAAT,EAAiB;QAClBtD,OAAO,IAAX;QACI9K,YAAY,KAAK+M,UAArB;QACK/M,SAAL,EAAiB;WACVoV,QAAL,GAAgBpV,UAAUqV,aAAV,CAAwB,kBAAkB,KAAKllB,OAAL,CAAaokB,SAA/B,GAA2C,GAAnE,CAAhB;KADF,MAEO;;UAEDvR,YAAY,KAAKsS,UAAL,EAAhB;UACInlB,UAAU,KAAKA,OADnB;;kBAGYmd,QAAA,CAAe,KAAf,EAAsBtK,SAAtB,CAAZ;;UAEIjS,WAAW,KAAKZ,OAAL,CAAaY,QAAb,IAAyB,KAAKyoB,eAA7C;;UAEIxG,OAAO,IAAIC,SAAJ,GAAgBC,eAAhB,CAAgCniB,QAAhC,EAA0C,WAA1C,EAAuDiiB,IAAlE;aACQA,KAAKG,QAAL,CAAchmB,MAAtB,EAA+B;kBACnBiH,WAAV,CAAsB4e,KAAKG,QAAL,CAAc,CAAd,CAAtB;;;;SAIC5E,OAAL,CAAazX,EAAb,CAAgB,gBAAhB,EAAkC,UAAS9F,IAAT,EAAe;WAC1CyrB,YAAL;KADF;;SAKKrH,QAAL,GAAgBpV,UAAUqV,aAAV,CAAwB,oBAAxB,CAAhB;MACA,CAAY,KAAKD,QAAjB,EAA2B,OAA3B,EAAoC,UAAS5e,KAAT,EAAgB;YAC5CoJ,cAAN;WACK6Z,MAAL,CAAYC,QAAZ;KAFF,EAGG,IAHH;;WAKO1Z,SAAP;GAxCiC;;gBA2CrB,wBAAW;QACnB8K,OAAO,IAAX;;QAEI/Z,kHAAJ;;SAMK0oB,MAAL,GAAc,KAAKlL,OAAL,CAAa+I,KAAb,CAAmB;gBACrBvmB,QADqB;aAExB,eAFwB;iBAGpB,qBAHoB;eAItB,CACP;eACS,UADT;kBAEY,kBAASyF,KAAT,EAAgB;cACpBgqB,WAAW1V,KAAK0R,KAAL,CAAWnH,aAAX,CAAyB,eAAzB,CAAf;cACIxJ,OAAO2U,SAASnH,YAAT,CAAsB,WAAtB,CAAX;eACK4J,sBAAL,CAA4BpX,IAA5B;eACK2Q,KAAL,CAAW0G,MAAX;;OAPG,CAJsB;cAevB,MAfuB;gBAgBrB;KAhBE,CAAd;;SAmBK1G,KAAL,GAAa,KAAK/C,MAAL,CAAY1M,UAAZ,CAAuBsI,aAAvB,CAAqC,MAArC,CAAb;QACI2G,WAAW,KAAKQ,KAAL,CAAWnH,aAAX,CAAyB,UAAzB,CAAf;SACK9G,OAAL,CAAape,OAAb,CAAqBgzB,cAArB,CAAoCxX,OAApC,CAA4C,UAASiK,IAAT,EAAe3I,KAAf,EAAsB;UAC5DyI,QAAQpI,QAAA,CAAe,OAAf,EAAwB,IAAxB,EAA8B0O,QAA9B,CAAZ;UACIK,QAAQ/O,QAAA,CAAe,OAAf,EAAwB,IAAxB,EAA8BoI,KAA9B,CAAZ;YACMG,YAAN,CAAmB,MAAnB,EAA2B,QAA3B;YACMA,YAAN,CAAmB,OAAnB,EAA4BD,KAAKsK,MAAjC;YACMrK,YAAN,CAAmB,WAAnB,EAAgCD,KAAK/J,IAArC;YACMgK,YAAN,CAAmB,MAAnB,EAA2B,OAA3B;UACK5I,SAAS,CAAd,EAAkB;cACV4I,YAAN,CAAmB,SAAnB,EAA8B,SAA9B;;UAEEsK,OAAOvK,KAAKsK,MAAhB;UACKtK,KAAKwN,IAAV,EAAiB;gBACP,OAAOxN,KAAKwN,IAAZ,GAAmB,GAA3B;;UAEEjD,OAAOtsB,SAASusB,cAAT,CAAwB,MAAMD,IAA9B,CAAX;YACM/rB,WAAN,CAAkB+rB,IAAlB;KAfF;GAzEiC;;0BA6FX,gCAAStU,IAAT,EAAe;QACjCf,OAAO,IAAX;SACK0R,KAAL,CAAW3G,YAAX,CAAwB,QAAxB,EAAkC,KAAlC;SACK2G,KAAL,CAAW3G,YAAX,CAAwB,QAAxB,EAAkChK,IAAlC;SACK2Q,KAAL,CAAW3G,YAAX,CAAwB,QAAxB,EAAkC,QAAlC;GAjGiC;;OAqG9B;CArGe,CAAf;;AAwGP,AAAO,IAAIwN,WAAW,SAAXA,QAAW,CAASlzB,OAAT,EAAkB;SAC/B,IAAI6yB,QAAJ,CAAa7yB,OAAb,CAAP;CADK;;ACxGA,IAAImzB,YAAYlQ,QAAQxmB,MAAR,CAAe;SAC7B,eAASwhB,MAAT,EAAiB;QAClBpO,YAAY,KAAK+M,UAArB;QACK/M,SAAL,EAAiB,EAAjB,MACO;;UAEDgD,YAAY,KAAKsS,UAAL,CAAgB,WAAhB,CAAhB;UACInlB,UAAU,KAAKA,OADnB;;kBAGYmd,QAAA,CAAe,KAAf,EAAsBtK,SAAtB,CAAZ;;SAEGugB,MAAL,CAAYvjB,SAAZ;;SAEKuO,OAAL,CAAazX,EAAb,CAAgB,iBAAhB,EAAmC,UAAS0sB,SAAT,EAAoB;;;;;;;;WAQhDC,oBAAL,CAA0BD,SAA1B;KARiC,CASjC/1B,IATiC,CAS5B,IAT4B,CAAnC;;WAWOuS,SAAP;GAxBkC;;UA2B5B,gBAASA,SAAT,EAAoB;SACrBoV,QAAL,GAAgBpV,UAAUqV,aAAV,CAAwB,mBAAxB,CAAhB;QACK,CAAE,KAAKD,QAAZ,EAAuB;WAChBsO,cAAL,CAAoB1jB,SAApB;;SAEG2jB,WAAL,GAAmB3jB,UAAUqV,aAAV,CAAwB,mCAAxB,CAAnB;SACKuO,OAAL,GAAe5jB,UAAUqV,aAAV,CAAwB,+BAAxB,CAAf;SACKwO,sBAAL,GAA8B7jB,UAAUqV,aAAV,CAAwB,oBAAxB,CAA9B;SACKyO,oBAAL,GAA4B9jB,UAAUqV,aAAV,CAAwB,kBAAxB,CAA5B;SACK0O,mBAAL,GAA2B/jB,UAAUqV,aAAV,CAAwB,iBAAxB,CAA3B;;SAEKM,WAAL;GAtCkC;;kBAyCpB,wBAAU3V,SAAV,EAAqB;QAC/BjP,6rBAAJ;;QAQIiiB,OAAO,IAAIC,SAAJ,GAAgBC,eAAhB,CAAgCniB,QAAhC,EAA0C,WAA1C,EAAuDiiB,IAAlE;WACQA,KAAKG,QAAL,CAAchmB,MAAtB,EAA+B;gBACnBiH,WAAV,CAAsB4e,KAAKG,QAAL,CAAc,CAAd,CAAtB;;;SAGGiC,QAAL,GAAgBpV,UAAUqV,aAAV,CAAwB,mBAAxB,CAAhB;GAvDkC;;eA0DvB,uBAAW;QAClBvK,OAAO,IAAX;;SAEKsK,QAAL,CAAcne,gBAAd,CAA+B,OAA/B,EAAwC,YAAW;WAC5C+sB,OAAL;KADF,EAEG,KAFH;SAGK5O,QAAL,CAAcne,gBAAd,CAA+B,QAA/B,EAAyC,YAAW;WAAOoX,OAAL;KAAtD,EAAyE,KAAzE;SACK+G,QAAL,CAAcne,gBAAd,CAA+B,WAA/B,EAA4C,YAAU;WAC7CgtB,UAAL,GAAkB,IAAlB;KADJ,EAEG,KAFH;SAGK7O,QAAL,CAAcne,gBAAd,CAA+B,SAA/B,EAA0C,YAAU;WAC3CgtB,UAAL,GAAkB,KAAlB;KADJ,EAEG,KAFH;SAGK7O,QAAL,CAAcne,gBAAd,CAA+B,SAA/B,EAA0C,YAAU;WAC7CgtB,UAAL,GAAkB,IAAlB;KADF,EAEG,KAFH;SAGK7O,QAAL,CAAcne,gBAAd,CAA+B,OAA/B,EAAwC,YAAU;WAC3CgtB,UAAL,GAAkB,KAAlB;KADF,EAEG,KAFH;;SAIK1V,OAAL,CAAazX,EAAb,CAAgB,WAAhB,EAA6B,UAAS6X,QAAT,EAAmB;UACzC,CAAE7D,KAAKoZ,UAAZ,EAAyB;;;UACpB,CAAEpZ,KAAKmZ,UAAZ,EAAyB;aAClB7O,QAAL,CAAclkB,KAAd,GAAsB3B,KAAKsM,IAAL,CAAUiP,KAAKyD,OAAL,CAAaiV,SAAb,CAAuBW,iBAAvB,CAAyCrZ,KAAKyD,OAAL,CAAa6V,eAAb,GAA+BxV,KAA/B,CAAqCC,GAA9E,IAAqF,GAA/F,CAAtB;aACKmV,OAAL;;KAJJ;GA9EkC;;WAwF3B,mBAAW;QACd9yB,QAAQ,KAAKkkB,QAAL,CAAclkB,KAA1B;QACIsyB,YAAY,KAAKjV,OAAL,CAAaiV,SAA7B;QACI3U,MAAM2U,UAAUa,iBAAV,CAA4BnzB,QAAQ,GAApC,CAAV;SACKqd,OAAL,CAAaJ,QAAb,CAAsBO,MAAtB,CAA6B,cAA7B;SACKH,OAAL,CAAaoB,QAAb,CAAsBd,GAAtB;GA7FkC;;WAgG3B,mBAAW;QACd/D,OAAO,IAAX;;QAEIwZ,UAAU,KAAK/V,OAAL,CAAa6V,eAAb,EAAd;QACK,CAAEE,OAAF,IAAa,CAAEA,QAAQ1V,KAA5B,EAAoC;iBACvB,YAAW;aACfoV,OAAL;OADS,CAETv2B,IAFS,CAEJ,IAFI,CAAX,EAEc,GAFd;;;QAKE82B,UAAU,KAAKZ,WAAnB;QACI90B,QAAQic,KAAKsK,QAAjB;;QAEIlkB,QAAQsiB,SAAS3kB,MAAMqC,KAAf,EAAsB,EAAtB,CAAZ;QACIqe,aAAare,KAAjB;;YAEQ2kB,YAAR,CAAqB,OAArB,EAA8B,0BAA2B,CAACtG,UAA5B,GAA0C,iBAAxE;SACK6F,QAAL,CAAcS,YAAd,CAA2B,0BAA3B,EAAuDtmB,KAAKsM,IAAL,CAAU0T,UAAV,CAAvD;;SAEKsU,sBAAL,CAA4BvpB,SAA5B,GAAwCiV,aAAa,GAArD;QACK+U,WAAWA,QAAQ1V,KAAxB,EAAgC;UAC1B4V,mBAAmB,KAAKjW,OAAL,CAAaiV,SAAb,CAAuBiB,eAAvB,CAAuCH,QAAQ1V,KAAR,CAAcC,GAArD,CAAvB;WACKiV,oBAAL,CAA0BxpB,SAA1B,GAAwCkqB,gBAAxC;;SAEGE,WAAL,GAAmB5Z,KAAK6Z,WAAL,GAAmBzzB,KAAtC,CAA6C4Z,KAAK6Z,WAAL,GAAmBzzB,KAAnB;GAxHX;;wBA2Hd,8BAASsyB,SAAT,EAAoB;YAChC9vB,GAAR,CAAY,0CAAZ;SACKwwB,UAAL,GAAkB,IAAlB;SACKU,MAAL,GAAc,KAAKrW,OAAL,CAAaiV,SAAb,CAAuBqB,KAArC;QACK,KAAKtW,OAAL,CAAa6V,eAAb,GAA+BxV,KAApC,EAA4C;WACrCwG,QAAL,CAAclkB,KAAd,GAAsB3B,KAAKsM,IAAL,CAAU,KAAK0S,OAAL,CAAaiV,SAAb,CAAuBW,iBAAvB,CAAyC,KAAK5V,OAAL,CAAa6V,eAAb,GAA+BxV,KAA/B,CAAqCC,GAA9E,IAAqF,GAA/F,CAAtB;WACK8V,WAAL,GAAmB,KAAKvP,QAAL,CAAclkB,KAAjC;KAFF,MAGO;WACAyzB,WAAL,GAAmB,KAAKvP,QAAL,CAAclkB,KAAjC;;;SAGG6yB,mBAAL,CAAyBzpB,SAAzB,GAAqC,KAAKsqB,MAA1C;;SAEKZ,OAAL;eACW,YAAW;cACpB,CAAiB,KAAKjX,UAAtB,EAAkC,aAAlC;KADS,CAETtf,IAFS,CAEJ,IAFI,CAAX,EAEc,CAFd;GAzIkC;;OA8I/B;CA9IgB,CAAhB;;AAiJP,AAAO,IAAImK,cAAY,SAAZA,SAAY,CAASzH,OAAT,EAAkB;SAChC,IAAImzB,SAAJ,CAAcnzB,OAAd,CAAP;CADK;;ACtIPijB,QAAQ8C,QAAR,GAAmBA,QAAnB;AACA9C,QAAQ6C,YAAR,GAAuBA,YAAvB;AACA7C,QAAQ+C,SAAR,GAAoBA,SAApB;AACA/C,QAAQiD,QAAR,GAAmBA,QAAnB;AACA7B,QAAQ+B,YAAR,GAAuBA,YAAvB;AACA/B,QAAQ8B,QAAR,GAAmBA,QAAnB;AACA9B,QAAQgC,SAAR,GAAoBA,SAApB;AACAhC,QAAQiC,QAAR,GAAmBA,QAAnB;;AAEArD,QAAQmG,QAAR,GAAmBA,QAAnB;AACA/E,QAAQiG,QAAR,GAAmBA,QAAnB;;AAEArH,QAAQsH,KAAR,GAAgBA,KAAhB;AACAlG,QAAQxJ,KAAR,GAAgBA,KAAhB;;AAEAoI,QAAQ4H,mBAAR,GAA8BA,mBAA9B;AACAxG,QAAQ6G,mBAAR,GAA8BA,mBAA9B;;AAEAjI,QAAQkI,WAAR,GAAsBA,WAAtB;AACA9G,QAAQ8J,WAAR,GAAsBA,WAAtB;;AAEAlL,QAAQmL,MAAR,GAAiBA,MAAjB;AACA/J,QAAQF,MAAR,GAAiBA,MAAjB;;AAEAlB,QAAQ+L,QAAR,GAAmBA,QAAnB;AACA3K,QAAQyL,QAAR,GAAmBA,QAAnB;;AAEA7M,QAAQqN,MAAR,GAAiBA,MAAjB;AACAjM,QAAQ6N,MAAR,GAAiBA,MAAjB;;AAEAjP,QAAQkP,wBAAR,GAAmCA,wBAAnC;AACA9N,QAAQuO,wBAAR,GAAmCA,wBAAnC;;AAEA3P,QAAQ4P,QAAR,GAAmBA,QAAnB;AACAxO,QAAQ6O,QAAR,GAAmBA,QAAnB;;AAEAjQ,QAAQkQ,SAAR,GAAoBA,SAApB;AACA9O,QAAQ5c,SAAR,GAAoBA,WAApB,CAEA;;ACrDA,IAAIktB,MAAMrvB,QAAQ7I,MAAR,CAAe,EAAf,CAAV;;AAGA,IAAIm4B,QAAJ;AACA,AAAO,IAAIC,MAAM,SAANA,GAAM,GAAW;SACnBD,aAAcA,WAAW,IAAID,GAAJ,EAAzB,CAAP;CADK;;ACCA,IAAItvB,QAAQ,EAACyvB,QAAQxvB,QAAQjI,SAAjB,EAAZ,CAEP,AACA,AACA,AACA;;ACXA;;;AAGA,AAAO,SAAS03B,IAAT,CAAcrZ,IAAd,EAAoB1b,OAApB,EAA6B;KAC9ByB,OAAOuzB,OAAP,KAAmBh0B,SAAxB,EAAoC;SAC5B+zB,IAAP,GAAcC,QAAQ,MAAR,CAAd;;QAEOvzB,OAAOszB,IAAP,CAAYrZ,IAAZ,EAAkB1b,OAAlB,CAAP;;;ACNF,IAAI,CAAC,OAAO,EAAE;EACZ,IAAI,OAAO,GAAG;IACZ,KAAK,GAAG,YAAY,EAAE,OAAO,GAAG,EAAE;GACnC,CAAC;CACH;;AAED,SAAS,UAAU,CAAC,IAAI,EAAE;EACxB,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;IAC5B,MAAM,IAAI,SAAS,CAAC,kCAAkC,GAAG,IAAI,CAAC,CAAC;GAChE;CACF;;;AAGD,SAAS,oBAAoB,CAAC,IAAI,EAAE,cAAc,EAAE;EAClD,IAAI,GAAG,GAAG,EAAE,CAAC;EACb,IAAI,SAAS,GAAG,CAAC,CAAC,CAAC;EACnB,IAAI,IAAI,GAAG,CAAC,CAAC;EACb,IAAI,IAAI,CAAC;EACT,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;IACrC,IAAI,CAAC,GAAG,IAAI,CAAC,MAAM;MACjB,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;SACvB,IAAI,IAAI,KAAK,EAAE;MAClB,MAAM;;MAEN,IAAI,GAAG,EAAE,MAAM;IACjB,IAAI,IAAI,KAAK,EAAE,OAAO;MACpB,IAAI,SAAS,KAAK,CAAC,GAAG,CAAC,IAAI,IAAI,KAAK,CAAC,EAAE;;OAEtC,MAAM,IAAI,SAAS,KAAK,CAAC,GAAG,CAAC,IAAI,IAAI,KAAK,CAAC,EAAE;QAC5C,IAAI,GAAG,CAAC,MAAM,GAAG,CAAC;YACd,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,MAAM,GAAG,CAAC,CAAC,KAAK,EAAE;YACrC,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,MAAM,GAAG,CAAC,CAAC,KAAK,EAAE,OAAO;UAC9C,IAAI,GAAG,CAAC,MAAM,GAAG,CAAC,EAAE;YAClB,IAAI,KAAK,GAAG,GAAG,CAAC,MAAM,GAAG,CAAC,CAAC;YAC3B,IAAI,CAAC,GAAG,KAAK,CAAC;YACd,OAAO,CAAC,IAAI,CAAC,EAAE,EAAE,CAAC,EAAE;cAClB,IAAI,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC,KAAK,EAAE;gBAC1B,MAAM;aACT;YACD,IAAI,CAAC,KAAK,KAAK,EAAE;cACf,IAAI,CAAC,KAAK,CAAC,CAAC;gBACV,GAAG,GAAG,EAAE,CAAC;;gBAET,GAAG,GAAG,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;cACxB,SAAS,GAAG,CAAC,CAAC;cACd,IAAI,GAAG,CAAC,CAAC;cACT,SAAS;aACV;WACF,MAAM,IAAI,GAAG,CAAC,MAAM,KAAK,CAAC,IAAI,GAAG,CAAC,MAAM,KAAK,CAAC,EAAE;YAC/C,GAAG,GAAG,EAAE,CAAC;YACT,SAAS,GAAG,CAAC,CAAC;YACd,IAAI,GAAG,CAAC,CAAC;YACT,SAAS;WACV;SACF;QACD,IAAI,cAAc,EAAE;UAClB,IAAI,GAAG,CAAC,MAAM,GAAG,CAAC;YAChB,GAAG,IAAI,KAAK,CAAC;;YAEb,GAAG,GAAG,IAAI,CAAC;SACd;OACF,MAAM;QACL,IAAI,GAAG,CAAC,MAAM,GAAG,CAAC;UAChB,GAAG,IAAI,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC;;UAE1C,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC;OACtC;MACD,SAAS,GAAG,CAAC,CAAC;MACd,IAAI,GAAG,CAAC,CAAC;KACV,MAAM,IAAI,IAAI,KAAK,EAAE,SAAS,IAAI,KAAK,CAAC,CAAC,EAAE;MAC1C,EAAE,IAAI,CAAC;KACR,MAAM;MACL,IAAI,GAAG,CAAC,CAAC,CAAC;KACX;GACF;EACD,OAAO,GAAG,CAAC;CACZ;;AAED,SAAS,OAAO,CAAC,GAAG,EAAE,UAAU,EAAE;EAChC,IAAI,GAAG,GAAG,UAAU,CAAC,GAAG,IAAI,UAAU,CAAC,IAAI,CAAC;EAC5C,IAAI,IAAI,GAAG,UAAU,CAAC,IAAI;KACvB,CAAC,UAAU,CAAC,IAAI,IAAI,EAAE,KAAK,UAAU,CAAC,GAAG,IAAI,EAAE,CAAC,CAAC,CAAC;EACrD,IAAI,CAAC,GAAG,EAAE;IACR,OAAO,IAAI,CAAC;GACb;EACD,IAAI,GAAG,KAAK,UAAU,CAAC,IAAI,EAAE;IAC3B,OAAO,GAAG,GAAG,IAAI,CAAC;GACnB;EACD,OAAO,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC;CACzB;;AAED,IAAI,KAAK,GAAG;;EAEV,OAAO,EAAE,SAAS,OAAO,GAAG;IAC1B,IAAI,YAAY,GAAG,EAAE,CAAC;IACtB,IAAI,gBAAgB,GAAG,KAAK,CAAC;IAC7B,IAAI,GAAG,CAAC;;IAER,KAAK,IAAI,CAAC,GAAG,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,gBAAgB,EAAE,CAAC,EAAE,EAAE;MACpE,IAAI,IAAI,CAAC;MACT,IAAI,CAAC,IAAI,CAAC;QACR,IAAI,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;WACjB;QACH,IAAI,GAAG,KAAK,SAAS;UACnB,GAAG,GAAG,OAAO,CAAC,GAAG,EAAE,CAAC;QACtB,IAAI,GAAG,GAAG,CAAC;OACZ;;MAED,UAAU,CAAC,IAAI,CAAC,CAAC;;;MAGjB,IAAI,IAAI,CAAC,MAAM,KAAK,CAAC,EAAE;QACrB,SAAS;OACV;;MAED,YAAY,GAAG,IAAI,GAAG,GAAG,GAAG,YAAY,CAAC;MACzC,gBAAgB,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,KAAK,EAAE,MAAM;KACnD;;;;;;IAMD,YAAY,GAAG,oBAAoB,CAAC,YAAY,EAAE,CAAC,gBAAgB,CAAC,CAAC;;IAErE,IAAI,gBAAgB,EAAE;MACpB,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC;QACzB,OAAO,GAAG,GAAG,YAAY,CAAC;;QAE1B,OAAO,GAAG,CAAC;KACd,MAAM,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE;MAClC,OAAO,YAAY,CAAC;KACrB,MAAM;MACL,OAAO,GAAG,CAAC;KACZ;GACF;;;EAGD,SAAS,EAAE,SAAS,SAAS,CAAC,IAAI,EAAE;IAClC,UAAU,CAAC,IAAI,CAAC,CAAC;;IAEjB,IAAI,IAAI,CAAC,MAAM,KAAK,CAAC;MACnB,OAAO,GAAG,CAAC;;IAEb,IAAI,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,KAAK,EAAE,CAAM;IAChD,IAAI,iBAAiB,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,KAAK,EAAE,CAAM;;;IAGrE,IAAI,GAAG,oBAAoB,CAAC,IAAI,EAAE,CAAC,UAAU,CAAC,CAAC;;IAE/C,IAAI,IAAI,CAAC,MAAM,KAAK,CAAC,IAAI,CAAC,UAAU;MAClC,IAAI,GAAG,GAAG,CAAC;IACb,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,IAAI,iBAAiB;MACtC,IAAI,IAAI,GAAG,CAAC;;IAEd,IAAI,UAAU;MACZ,OAAO,GAAG,GAAG,IAAI,CAAC;IACpB,OAAO,IAAI,CAAC;GACb;;;EAGD,UAAU,EAAE,SAAS,UAAU,CAAC,IAAI,EAAE;IACpC,UAAU,CAAC,IAAI,CAAC,CAAC;IACjB,OAAO,IAAI,CAAC,MAAM,GAAG,CAAC,IAAI,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,KAAK,EAAE,MAAM;GAC1D;;;EAGD,IAAI,EAAE,SAAS,IAAI,GAAG;IACpB,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC;MACxB,OAAO,GAAG,CAAC;IACb,IAAI,MAAM,CAAC;IACX,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;MACzC,IAAI,GAAG,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;MACvB,UAAU,CAAC,GAAG,CAAC,CAAC;MAChB,IAAI,GAAG,CAAC,MAAM,GAAG,CAAC,EAAE;QAClB,IAAI,MAAM,KAAK,SAAS;UACtB,MAAM,GAAG,GAAG,CAAC;;UAEb,MAAM,IAAI,GAAG,GAAG,GAAG,CAAC;OACvB;KACF;IACD,IAAI,MAAM,KAAK,SAAS;MACtB,OAAO,GAAG,CAAC;IACb,OAAO,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;GAChC;;;EAGD,QAAQ,EAAE,SAAS,QAAQ,CAAC,IAAI,EAAE,EAAE,EAAE;IACpC,UAAU,CAAC,IAAI,CAAC,CAAC;IACjB,UAAU,CAAC,EAAE,CAAC,CAAC;;IAEf,IAAI,IAAI,KAAK,EAAE;MACb,OAAO,EAAE,CAAC;;IAEZ,IAAI,GAAG,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;IAC3B,EAAE,GAAG,KAAK,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;;IAEvB,IAAI,IAAI,KAAK,EAAE;MACb,OAAO,EAAE,CAAC;;;IAGZ,IAAI,SAAS,GAAG,CAAC,CAAC;IAClB,OAAO,SAAS,GAAG,IAAI,CAAC,MAAM,EAAE,EAAE,SAAS,EAAE;MAC3C,IAAI,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,KAAK,EAAE;QACnC,MAAM;KACT;IACD,IAAI,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC;IAC1B,IAAI,OAAO,IAAI,OAAO,GAAG,SAAS,CAAC,CAAC;;;IAGpC,IAAI,OAAO,GAAG,CAAC,CAAC;IAChB,OAAO,OAAO,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,OAAO,EAAE;MACrC,IAAI,EAAE,CAAC,UAAU,CAAC,OAAO,CAAC,KAAK,EAAE;QAC/B,MAAM;KACT;IACD,IAAI,KAAK,GAAG,EAAE,CAAC,MAAM,CAAC;IACtB,IAAI,KAAK,IAAI,KAAK,GAAG,OAAO,CAAC,CAAC;;;IAG9B,IAAI,MAAM,IAAI,OAAO,GAAG,KAAK,GAAG,OAAO,GAAG,KAAK,CAAC,CAAC;IACjD,IAAI,aAAa,GAAG,CAAC,CAAC,CAAC;IACvB,IAAI,CAAC,GAAG,CAAC,CAAC;IACV,OAAO,CAAC,IAAI,MAAM,EAAE,EAAE,CAAC,EAAE;MACvB,IAAI,CAAC,KAAK,MAAM,EAAE;QAChB,IAAI,KAAK,GAAG,MAAM,EAAE;UAClB,IAAI,EAAE,CAAC,UAAU,CAAC,OAAO,GAAG,CAAC,CAAC,KAAK,EAAE,OAAO;;;YAG1C,OAAO,EAAE,CAAC,KAAK,CAAC,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;WAClC,MAAM,IAAI,CAAC,KAAK,CAAC,EAAE;;;YAGlB,OAAO,EAAE,CAAC,KAAK,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC;WAC9B;SACF,MAAM,IAAI,OAAO,GAAG,MAAM,EAAE;UAC3B,IAAI,IAAI,CAAC,UAAU,CAAC,SAAS,GAAG,CAAC,CAAC,KAAK,EAAE,OAAO;;;YAG9C,aAAa,GAAG,CAAC,CAAC;WACnB,MAAM,IAAI,CAAC,KAAK,CAAC,EAAE;;;YAGlB,aAAa,GAAG,CAAC,CAAC;WACnB;SACF;QACD,MAAM;OACP;MACD,IAAI,QAAQ,GAAG,IAAI,CAAC,UAAU,CAAC,SAAS,GAAG,CAAC,CAAC,CAAC;MAC9C,IAAI,MAAM,GAAG,EAAE,CAAC,UAAU,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC;MACxC,IAAI,QAAQ,KAAK,MAAM;QACrB,MAAM;WACH,IAAI,QAAQ,KAAK,EAAE;QACtB,aAAa,GAAG,CAAC,CAAC;KACrB;;IAED,IAAI,GAAG,GAAG,EAAE,CAAC;;;IAGb,KAAK,CAAC,GAAG,SAAS,GAAG,aAAa,GAAG,CAAC,EAAE,CAAC,IAAI,OAAO,EAAE,EAAE,CAAC,EAAE;MACzD,IAAI,CAAC,KAAK,OAAO,IAAI,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,KAAK,EAAE,OAAO;QACnD,IAAI,GAAG,CAAC,MAAM,KAAK,CAAC;UAClB,GAAG,IAAI,IAAI,CAAC;;UAEZ,GAAG,IAAI,KAAK,CAAC;OAChB;KACF;;;;IAID,IAAI,GAAG,CAAC,MAAM,GAAG,CAAC;MAChB,OAAO,GAAG,GAAG,EAAE,CAAC,KAAK,CAAC,OAAO,GAAG,aAAa,CAAC,CAAC;SAC5C;MACH,OAAO,IAAI,aAAa,CAAC;MACzB,IAAI,EAAE,CAAC,UAAU,CAAC,OAAO,CAAC,KAAK,EAAE;QAC/B,EAAE,OAAO,CAAC;MACZ,OAAO,EAAE,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;KAC1B;GACF;;;EAGD,SAAS,EAAE,SAAS,SAAS,CAAC,IAAI,EAAE;IAClC,OAAO,IAAI,CAAC;GACb;;;EAGD,OAAO,EAAE,SAAS,OAAO,CAAC,IAAI,EAAE;IAC9B,UAAU,CAAC,IAAI,CAAC,CAAC;IACjB,IAAI,IAAI,CAAC,MAAM,KAAK,CAAC;MACnB,OAAO,GAAG,CAAC;IACb,IAAI,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;IAC9B,IAAI,OAAO,IAAI,IAAI,KAAK,EAAE,MAAM,CAAC;IACjC,IAAI,GAAG,GAAG,CAAC,CAAC,CAAC;IACb,IAAI,YAAY,GAAG,IAAI,CAAC;IACxB,KAAK,IAAI,CAAC,GAAG,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,EAAE,CAAC,EAAE;MACzC,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;MAC1B,IAAI,IAAI,KAAK,EAAE,OAAO;QACpB,IAAI,CAAC,YAAY,EAAE;UACjB,GAAG,GAAG,CAAC,CAAC;UACR,MAAM;SACP;OACF,MAAM;;QAEL,YAAY,GAAG,KAAK,CAAC;OACtB;KACF;;IAED,IAAI,GAAG,KAAK,CAAC,CAAC;MACZ,OAAO,OAAO,GAAG,GAAG,GAAG,GAAG,CAAC;IAC7B,IAAI,OAAO,IAAI,GAAG,KAAK,CAAC;MACtB,OAAO,IAAI,CAAC;IACd,OAAO,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC;GAC3B;;;EAGD,QAAQ,EAAE,SAAS,QAAQ,CAAC,IAAI,EAAE,GAAG,EAAE;IACrC,IAAI,GAAG,KAAK,SAAS,IAAI,OAAO,GAAG,KAAK,QAAQ;MAC9C,MAAM,IAAI,SAAS,CAAC,iCAAiC,CAAC,CAAC;IACzD,UAAU,CAAC,IAAI,CAAC,CAAC;;IAEjB,IAAI,KAAK,GAAG,CAAC,CAAC;IACd,IAAI,GAAG,GAAG,CAAC,CAAC,CAAC;IACb,IAAI,YAAY,GAAG,IAAI,CAAC;IACxB,IAAI,CAAC,CAAC;;IAEN,IAAI,GAAG,KAAK,SAAS,IAAI,GAAG,CAAC,MAAM,GAAG,CAAC,IAAI,GAAG,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,EAAE;MACpE,IAAI,GAAG,CAAC,MAAM,KAAK,IAAI,CAAC,MAAM,IAAI,GAAG,KAAK,IAAI;QAC5C,OAAO,EAAE,CAAC;MACZ,IAAI,MAAM,GAAG,GAAG,CAAC,MAAM,GAAG,CAAC,CAAC;MAC5B,IAAI,gBAAgB,GAAG,CAAC,CAAC,CAAC;MAC1B,KAAK,CAAC,GAAG,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,EAAE,CAAC,EAAE;QACrC,IAAI,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;QAC9B,IAAI,IAAI,KAAK,EAAE,OAAO;;;UAGpB,IAAI,CAAC,YAAY,EAAE;YACjB,KAAK,GAAG,CAAC,GAAG,CAAC,CAAC;YACd,MAAM;WACP;SACF,MAAM;UACL,IAAI,gBAAgB,KAAK,CAAC,CAAC,EAAE;;;YAG3B,YAAY,GAAG,KAAK,CAAC;YACrB,gBAAgB,GAAG,CAAC,GAAG,CAAC,CAAC;WAC1B;UACD,IAAI,MAAM,IAAI,CAAC,EAAE;;YAEf,IAAI,IAAI,KAAK,GAAG,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE;cACnC,IAAI,EAAE,MAAM,KAAK,CAAC,CAAC,EAAE;;;gBAGnB,GAAG,GAAG,CAAC,CAAC;eACT;aACF,MAAM;;;cAGL,MAAM,GAAG,CAAC,CAAC,CAAC;cACZ,GAAG,GAAG,gBAAgB,CAAC;aACxB;WACF;SACF;OACF;;MAED,IAAI,KAAK,KAAK,GAAG;QACf,GAAG,GAAG,gBAAgB,CAAC;WACpB,IAAI,GAAG,KAAK,CAAC,CAAC;QACjB,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC;MACpB,OAAO,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;KAC/B,MAAM;MACL,KAAK,CAAC,GAAG,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,EAAE,CAAC,EAAE;QACrC,IAAI,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,KAAK,EAAE,OAAO;;;UAGlC,IAAI,CAAC,YAAY,EAAE;YACjB,KAAK,GAAG,CAAC,GAAG,CAAC,CAAC;YACd,MAAM;WACP;SACF,MAAM,IAAI,GAAG,KAAK,CAAC,CAAC,EAAE;;;UAGrB,YAAY,GAAG,KAAK,CAAC;UACrB,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC;SACb;OACF;;MAED,IAAI,GAAG,KAAK,CAAC,CAAC;QACZ,OAAO,EAAE,CAAC;MACZ,OAAO,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;KAC/B;GACF;;;EAGD,OAAO,EAAE,SAAS,OAAO,CAAC,IAAI,EAAE;IAC9B,UAAU,CAAC,IAAI,CAAC,CAAC;IACjB,IAAI,QAAQ,GAAG,CAAC,CAAC,CAAC;IAClB,IAAI,SAAS,GAAG,CAAC,CAAC;IAClB,IAAI,GAAG,GAAG,CAAC,CAAC,CAAC;IACb,IAAI,YAAY,GAAG,IAAI,CAAC;;;IAGxB,IAAI,WAAW,GAAG,CAAC,CAAC;IACpB,KAAK,IAAI,CAAC,GAAG,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,EAAE,CAAC,EAAE;MACzC,IAAI,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;MAC9B,IAAI,IAAI,KAAK,EAAE,OAAO;;;QAGpB,IAAI,CAAC,YAAY,EAAE;UACjB,SAAS,GAAG,CAAC,GAAG,CAAC,CAAC;UAClB,MAAM;SACP;QACD,SAAS;OACV;MACD,IAAI,GAAG,KAAK,CAAC,CAAC,EAAE;;;QAGd,YAAY,GAAG,KAAK,CAAC;QACrB,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC;OACb;MACD,IAAI,IAAI,KAAK,EAAE,OAAO;;QAEpB,IAAI,QAAQ,KAAK,CAAC,CAAC;UACjB,QAAQ,GAAG,CAAC,CAAC;aACV,IAAI,WAAW,KAAK,CAAC;UACxB,WAAW,GAAG,CAAC,CAAC;OACnB,MAAM,IAAI,QAAQ,KAAK,CAAC,CAAC,EAAE;;;QAG1B,WAAW,GAAG,CAAC,CAAC,CAAC;OAClB;KACF;;IAED,IAAI,QAAQ,KAAK,CAAC,CAAC;QACf,GAAG,KAAK,CAAC,CAAC;;QAEV,WAAW,KAAK,CAAC;;SAEhB,WAAW,KAAK,CAAC;SACjB,QAAQ,KAAK,GAAG,GAAG,CAAC;SACpB,QAAQ,KAAK,SAAS,GAAG,CAAC,CAAC,EAAE;MAChC,OAAO,EAAE,CAAC;KACX;IACD,OAAO,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;GAClC;;;EAGD,MAAM,EAAE,SAAS,MAAM,CAAC,UAAU,EAAE;IAClC,IAAI,UAAU,KAAK,IAAI,IAAI,OAAO,UAAU,KAAK,QAAQ,EAAE;MACzD,MAAM,IAAI,SAAS;QACjB,gDAAgD,GAAG,OAAO,UAAU,CAAC;OACtE,CAAC;KACH;IACD,OAAO,OAAO,CAAC,GAAG,EAAE,UAAU,CAAC,CAAC;GACjC;;;EAGD,KAAK,EAAE,SAAS,KAAK,CAAC,IAAI,EAAE;IAC1B,UAAU,CAAC,IAAI,CAAC,CAAC;;IAEjB,IAAI,GAAG,GAAG,EAAE,IAAI,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE,CAAC;IAC7D,IAAI,IAAI,CAAC,MAAM,KAAK,CAAC;MACnB,OAAO,GAAG,CAAC;IACb,IAAI,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;IAC9B,IAAI,UAAU,IAAI,IAAI,KAAK,EAAE,MAAM,CAAC;IACpC,IAAI,KAAK,CAAC;IACV,IAAI,UAAU,EAAE;MACd,GAAG,CAAC,IAAI,GAAG,GAAG,CAAC;MACf,KAAK,GAAG,CAAC,CAAC;KACX,MAAM;MACL,KAAK,GAAG,CAAC,CAAC;KACX;IACD,IAAI,QAAQ,GAAG,CAAC,CAAC,CAAC;IAClB,IAAI,SAAS,GAAG,CAAC,CAAC;IAClB,IAAI,GAAG,GAAG,CAAC,CAAC,CAAC;IACb,IAAI,YAAY,GAAG,IAAI,CAAC;IACxB,IAAI,CAAC,GAAG,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC;;;;IAIxB,IAAI,WAAW,GAAG,CAAC,CAAC;;;IAGpB,OAAO,CAAC,IAAI,KAAK,EAAE,EAAE,CAAC,EAAE;MACtB,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;MAC1B,IAAI,IAAI,KAAK,EAAE,OAAO;;;QAGpB,IAAI,CAAC,YAAY,EAAE;UACjB,SAAS,GAAG,CAAC,GAAG,CAAC,CAAC;UAClB,MAAM;SACP;QACD,SAAS;OACV;MACD,IAAI,GAAG,KAAK,CAAC,CAAC,EAAE;;;QAGd,YAAY,GAAG,KAAK,CAAC;QACrB,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC;OACb;MACD,IAAI,IAAI,KAAK,EAAE,OAAO;;QAEpB,IAAI,QAAQ,KAAK,CAAC,CAAC;UACjB,QAAQ,GAAG,CAAC,CAAC;aACV,IAAI,WAAW,KAAK,CAAC;UACxB,WAAW,GAAG,CAAC,CAAC;OACnB,MAAM,IAAI,QAAQ,KAAK,CAAC,CAAC,EAAE;;;QAG1B,WAAW,GAAG,CAAC,CAAC,CAAC;OAClB;KACF;;IAED,IAAI,QAAQ,KAAK,CAAC,CAAC;QACf,GAAG,KAAK,CAAC,CAAC;;QAEV,WAAW,KAAK,CAAC;;SAEhB,WAAW,KAAK,CAAC;SACjB,QAAQ,KAAK,GAAG,GAAG,CAAC;SACpB,QAAQ,KAAK,SAAS,GAAG,CAAC,CAAC,EAAE;MAChC,IAAI,GAAG,KAAK,CAAC,CAAC,EAAE;QACd,IAAI,SAAS,KAAK,CAAC,IAAI,UAAU;UAC/B,GAAG,CAAC,IAAI,GAAG,GAAG,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC;;UAEzC,GAAG,CAAC,IAAI,GAAG,GAAG,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC;OACpD;KACF,MAAM;MACL,IAAI,SAAS,KAAK,CAAC,IAAI,UAAU,EAAE;QACjC,GAAG,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC;QACnC,GAAG,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC;OAC/B,MAAM;QACL,GAAG,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;QAC3C,GAAG,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC;OACvC;MACD,GAAG,CAAC,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;KACrC;;IAED,IAAI,SAAS,GAAG,CAAC;MACf,GAAG,CAAC,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,SAAS,GAAG,CAAC,CAAC,CAAC;SACpC,IAAI,UAAU;MACjB,GAAG,CAAC,GAAG,GAAG,GAAG,CAAC;;IAEhB,OAAO,GAAG,CAAC;GACZ;;;EAGD,GAAG,EAAE,GAAG;EACR,SAAS,EAAE,GAAG;EACd,KAAK,EAAE,IAAI;CACZ,CAAC;;;AAGF,QAAc,GAAG,KAAK,CAAC;;ACjiBvB0a,OAAOua,MAAP,GAAgBva,OAAOje,MAAP,CAAc;;cAEhB,oBAAS0F,EAAT,EAAanC,OAAb,EAAsB;WACzB3C,SAAP,CAAiBgH,UAAjB,CAA4B1G,KAA5B,CAAkC,IAAlC,EAAwCZ,SAAxC;SACKm4B,aAAL,GAAqB,KAArB;WACOC,KAAP,GAAeC,IAAf;GAL0B;;QAQtB,cAAS9uB,MAAT,EAAiB8T,QAAjB,EAA2B;QAC3BO,OAAO,IAAX;QACK,OAAOrU,MAAP,IAAkB,UAAvB,EAAoC;iBACvBA,MAAX;eACStF,SAAT;;QAEGoZ,YAAY,IAAjB,EAAwB;iBACX,oBAAW,EAAtB;;;;;SAKGqR,SAAL,GAAiB,EAAjB;QACI3R,UAAU,IAAIoX,cAAJ,EAAd;YACQ3U,IAAR,CAAa,KAAb,EAAoB,KAAKvc,OAAL,CAAa0b,IAAb,GAAoB,yBAAxC;YACQ2Z,YAAR,GAAuB,UAAvB;YACQzxB,MAAR,GAAiB,YAAW;UACtB0xB,eAAexb,QAAQyb,WAA3B;UACI9J,YAAY6J,aAAahN,gBAAb,CAA8B,UAA9B,CAAhB;UACKmD,UAAUzuB,MAAV,GAAmB,CAAxB,EAA4B;gBAClBuG,GAAR,CAAY,oCAAZ,EAAkDkoB,UAAUzuB,MAA5D;aACI,IAAIL,IAAI,CAAZ,EAAeA,IAAI8uB,UAAUzuB,MAA7B,EAAqCL,GAArC,EAA0C;cACpCmxB,WAAWrC,UAAU9uB,CAAV,CAAf;cACIixB,eAAeE,SAAS5E,YAAT,CAAsB,WAAtB,CAAnB;cACI3D,QAAQuI,SAAS5E,YAAT,CAAsB,iBAAtB,CAAZ;cACIsC,SAASsC,SAAS5E,YAAT,CAAsB,kBAAtB,CAAb;eACKuC,SAAL,CAAenrB,IAAf,CAAoB;0BACJstB,YADI;mBAEXrI,KAFW;oBAGViG;WAHV;;;KAVN;YAkBQ6F,IAAR;;SAEKrxB,OAAL,CAAa4tB,YAAb,GAA4B,KAAK5tB,OAAL,CAAa4tB,YAAb,IAA6B4H,eAAeza,OAAf,CAAuB,cAAvB,CAAzD;;QAEI0a,YAAY,KAAKz1B,OAAL,CAAa0b,IAA7B;QACIga,eAAe,EAAEC,aAAa,KAAK31B,OAAL,CAAa4tB,YAA5B,EAAnB;QACK,KAAK5tB,OAAL,CAAa41B,UAAlB,EAA+B;kBACjBH,UAAU71B,OAAV,CAAkB,YAAlB,EAAgC,gBAAhC,CAAZ;mBACai2B,MAAb,GAAsB,MAAtB;;SAEGC,KAAL,GAAaC,IAAA,CAAYN,SAAZ,EAAuBC,YAAvB,CAAb;mBACeM,UAAf,CAA0B,cAA1B;;SAEKF,KAAL,CAAWG,MAAX,CAAkBC,UAAlB,CAA6BpzB,IAA7B,CAAkC,UAASinB,GAAT,EAAc;WACzCoM,SAAL,GAAiBpM,GAAjB;WACK3O,QAAL,GAAgBT,KAAKmb,KAAL,CAAWM,OAAX,CAAmBhb,QAAnC;WACKxU,IAAL,CAAU,gBAAV,EAA4BmjB,GAA5B;WACKnjB,IAAL,CAAU,aAAV,EAAyB+T,KAAKmb,KAAL,CAAWM,OAAX,CAAmBhb,QAA5C;KAJF;SAMK0a,KAAL,CAAWO,KAAX,CAAiBvzB,IAAjB,CAAsB,YAAW;WAC1BwzB,IAAL,CAAUhwB,MAAV,EAAkB8T,QAAlB;UACKO,KAAKS,QAAL,CAAcoQ,MAAd,IAAwB,eAA7B,EAA+C;;YAEzC6H,YAAY,EAAhB;aACKyC,KAAL,CAAWS,KAAX,CAAiBC,IAAjB,CAAsB,UAASniB,IAAT,EAAe;oBACzB/T,IAAV,cAA0B+T,KAAKoiB,OAA/B;eACKpD,SAAL,CAAeqD,UAAf,CAA0Bp2B,IAA1B,cAA0C+T,KAAKoiB,OAA/C;SAFF;aAIKpD,SAAL,CAAeqB,KAAf,GAAuBrB,UAAUr2B,MAAjC;YACI25B,CAAJ;YACIC,IAAI,SAAJA,CAAI,GAAW;cACZjc,KAAKkc,UAAL,IAAmBlc,KAAKkc,UAAL,CAAgBC,OAAnC,IAA8Cnc,KAAKkc,UAAL,CAAgBC,OAAhB,CAAwBC,KAA3E,EAAmF;gBAC7EvY,WAAW7D,KAAKkc,UAAL,CAAgB5C,eAAhB,EAAf;gBACKzV,YAAYA,SAASC,KAA1B,EAAiC;mBAC1B7X,IAAL,CAAU,iBAAV,EAA6BysB,SAA7B;2BACasD,CAAb;;;;cAIA70B,WAAW80B,CAAX,EAAc,GAAd,CAAJ;SATF;;YAYI90B,WAAW80B,CAAX,EAAc,GAAd,CAAJ;OArBF,MAsBO;aACAd,KAAL,CAAWzC,SAAX,CAAqB2D,QAArB,CAA8B,IAA9B,EAAoCl0B,IAApC,CAAyC,UAASuwB,SAAT,EAAoB;;eAEtDzsB,IAAL,CAAU,iBAAV,EAA6BysB,SAA7B;SAFF;;KAzBJ;;GA7D0B;;QA+FtB,cAAS/sB,MAAT,EAAiB8T,QAAjB,EAA2B;QAC3BO,OAAO,IAAX;;QAEKA,KAAKkc,UAAV,EAAuB;;UAEjBhnB,YAAY8K,KAAKkc,UAAL,CAAgBC,OAAhB,CAAwBjnB,SAAxC;aACOuJ,IAAP,CAAYuB,KAAKkc,UAAL,CAAgBI,KAA5B,EAAmCzb,OAAnC,CAA2C,UAAS1a,GAAT,EAAc;gBAC/CyC,GAAR,CAAY,oBAAZ,EAAkCzC,GAAlC;aACK+1B,UAAL,CAAgBI,KAAhB,CAAsBn2B,GAAtB,EAA2Bo2B,KAA3B;OAFF;WAIKL,UAAL,CAAgBM,OAAhB;WACKN,UAAL,GAAkB,IAAlB;;;SAGGO,QAAL,GAAgB,EAAE3a,MAAM,KAAKzc,OAAL,CAAayc,IAArB,EAAhB;SACK2a,QAAL,CAAcN,OAAd,GAAwB,KAAK92B,OAAL,CAAa82B,OAAb,IAAwB,SAAhD;;QAEK,KAAKM,QAAL,CAAc3a,IAAd,IAAsB,MAAtB,IAAgC,KAAKrB,QAAL,CAAcoQ,MAAd,IAAwB,eAA7D,EAA+E;;;UAGxE,KAAK5O,UAAL,CAAgBoL,YAAhB,IAAgC,KAAKhoB,OAAL,CAAaq3B,sBAAlD,EAA2E;aACpED,QAAL,CAAc3a,IAAd,GAAqB,cAArB;aACK2a,QAAL,CAAcN,OAAd,GAAwB,cAAxB;;;;QAIC,KAAKM,QAAL,CAAc3a,IAAd,IAAsB,MAAtB,IAAgC,KAAK2a,QAAL,CAAc3a,IAAd,IAAsB,WAA3D,EAAyE;WAClEmB,MAAL,CAAY,MAAZ,EAAoBxW,KAApB,CAA0BkwB,QAA1B,GAAqC,QAArC;WACKF,QAAL,CAAcN,OAAd,GAAwB,SAAxB;KAFF,MAGO;WACAlZ,MAAL,CAAY,MAAZ,EAAoBxW,KAApB,CAA0BkwB,QAA1B,GAAqC,MAArC;UACK,KAAKF,QAAL,CAAcN,OAAd,IAAyB,SAA9B,EAA0C;aACnCM,QAAL,CAAcN,OAAd,GAAwB,YAAxB;;;;QAIC,CAAE1c,QAAP,EAAkB;iBACL,oBAAW,EAAtB;;;QAGG,KAAKgB,QAAL,CAAcoQ,MAAd,IAAwB,eAAxB,IAA2C,KAAK4L,QAAL,CAAcN,OAAd,IAAyB,YAAzE,EAAwF;WAC/EM,QAAL,CAAcN,OAAd,GAAwB,cAAxB;;;QAGC,KAAKM,QAAL,CAAcN,OAAd,IAAyB,cAA9B,EAA+C;WACxCM,QAAL,CAAcG,MAAd,GAAuB,MAAvB;;;;QAIG,SAAS,KAAKnc,QAAL,CAAcoQ,MAAd,IAAwB,eAAjC,IAAoD,KAAK4L,QAAL,CAAcN,OAAd,IAAyB,SAAlF,EAA8F;WACvFM,QAAL,CAAcG,MAAd,GAAuB,MAAvB;WACK3Z,MAAL,CAAY,MAAZ,EAAoBxW,KAApB,CAA0BkwB,QAA1B,GAAqC,MAArC;;;SAGGF,QAAL,CAAcvV,MAAd,GAAuB,MAAvB;SACKuV,QAAL,CAActV,KAAd,GAAsB,MAAtB;SACKsV,QAAL,CAAc,aAAd,IAA+B,cAA/B;;QAEKzc,KAAK3a,OAAL,CAAa2U,KAAb,IAAsB,KAA3B,EAAmC;WAC5ByiB,QAAL,CAAcziB,KAAd,GAAsB0O,SAAS1I,KAAK3a,OAAL,CAAa2U,KAAtB,EAA6B,EAA7B,IAAmC,GAAzD;;;SAGGiJ,MAAL,CAAY,MAAZ,EAAoBf,OAApB,CAA4Bia,OAA5B,GAAsC,KAAKM,QAAL,CAAcN,OAAd,IAA0B,KAAKM,QAAL,CAAcG,MAAd,SAA2B,KAAKH,QAAL,CAAcG,MAAzC,GAAoD,EAA9E,CAAtC;;SAEKC,cAAL,CAAoBlxB,MAApB,EAA4B8T,QAA5B;GA/J0B;;kBAkKZ,wBAAS9T,MAAT,EAAiB8T,QAAjB,EAA2B;QACrCO,OAAO,IAAX;;SAEKkc,UAAL,GAAkBlc,KAAKmb,KAAL,CAAW2B,QAAX,CAAoB9c,KAAKiD,MAAL,CAAY,MAAZ,CAApB,EAAyCjD,KAAKyc,QAA9C,CAAlB;SACKM,eAAL;SACKlS,WAAL;SACKzD,MAAL,GAAc,IAAd;;;;;;QAMI4V,eAAe,CAAnB;SACKd,UAAL,CAAgBlwB,EAAhB,CAAmB,SAAnB,EAA8B,YAAW;;;;;;;;;;WAUlCkwB,UAAL,CAAgBC,OAAhB,CAAwBnwB,EAAxB,CAA2B,UAA3B,EAAuC,UAASwqB,MAAT,EAAiB;YACjDA,MAAL,EAAc;0BACI,CAAhB;eACKvT,MAAL,CAAY,eAAZ,EAA6BzT,SAA7B,cAAkD/K,KAAKC,KAAL,CAAYs4B,eAAexG,OAAOuD,KAAvB,GAAgC,KAA3C,CAAlD;SAFF,MAGO;eACAkD,iBAAL,CAAuB,CAAC,CAAxB;;OALJ;WAQKf,UAAL,CAAgBC,OAAhB,CAAwBnwB,EAAxB,CAA2B,OAA3B,EAAoC,YAAW;gBACrCpD,GAAR,CAAY,oBAAZ;aACKs0B,kBAAL,CAAwB,IAAxB;OAFF;KAlBF;;;SAyBKhB,UAAL,CAAgBI,KAAhB,CAAsBzF,OAAtB,CAA8BsG,QAA9B,CAAuC,UAASxN,QAAT,EAAmB;WACnD1jB,IAAL,CAAU,gBAAV,EAA4B0jB,QAA5B;WACK1jB,IAAL,CAAU,eAAV,EAA2B0jB,QAA3B;eACS5mB,QAAT,CAAkBoD,gBAAlB,CAAmC,SAAnC,EAA8C,UAACT,KAAD,EAAW;YACjDoZ,UAAUpZ,MAAMvF,GAAtB;aACK8F,IAAL,CAAU,SAAV,EAAqB,EAAE6Y,SAASA,OAAX,EAAoBM,UAAU1Z,MAAM0Z,QAApC,EAA8CgY,OAAO,IAArD,EAArB;gBACQx0B,GAAR,CAAY,uBAAZ,EAAqCkc,OAArC;OAHF;KAHF;;QAUKnZ,UAAUA,OAAOmY,KAAtB,EAA8B;eAAWnY,OAAOmY,KAAhB;;QAC3B,CAAEnY,MAAF,IAAY7E,OAAO+c,QAAP,CAAgBwZ,IAAjC,EAAwC;UACjCv2B,OAAO+c,QAAP,CAAgBwZ,IAAhB,CAAqB9Y,MAArB,CAA4B,CAA5B,EAA+B,CAA/B,KAAqC,KAA1C,EAAkD;iBACvC,aAAazd,OAAO+c,QAAP,CAAgBwZ,IAAhB,CAAqB9Y,MAArB,CAA4B,CAA5B,CAAb,GAA8C,GAAvD;OADF,MAEO;iBACIzd,OAAO+c,QAAP,CAAgBwZ,IAAhB,CAAqB9Y,MAArB,CAA4B,CAA5B,CAAT;iBACSvE,KAAKmb,KAAL,CAAWrzB,GAAX,CAAe2yB,IAAf,GAAsBpyB,OAAtB,CAA8BsD,MAA9B,CAAT;;;;SAICkZ,QAAL,CAAclZ,MAAd,EAAsB,YAAW;aACxBgW,OAAP,GAAiB,IAAjB;WACK2b,uBAAL;;UAEK7d,QAAL,EAAgB;;;;WAEX8a,aAAL,GAAqB,IAArB;;iBAEW,YAAW;aACftuB,IAAL,CAAU,QAAV;aACKA,IAAL,CAAU,OAAV;qBACa+T,KAAKud,aAAlB;aACKla,QAAL,CAAc3X,KAAd,CAAoB,UAApB,EAAgC;wBAChBsU,KAAK3a,OAAL,CAAam4B,YADG;gBAExBxd,KAAKyc,QAAL,CAAc3a,IAFU;mBAGrB9B,KAAKyc,QAAL,CAAcN;SAHzB;OAJF,EASG,GATH;KARF;GA5N0B;;WAkPnB,iBAAS3oB,KAAT,EAAgB;QACnBwM,OAAO,IAAX;QACKA,KAAK3a,OAAL,CAAayc,IAAb,IAAqB,gBAA1B,EAA6C;UACvC5M,YAAY8K,KAAKkc,UAAL,CAAgBC,OAAhB,CAAwBjnB,SAAxC;UACIG,OAAOH,UAAUI,qBAAV,EAAX;UACIkQ,YAAYtQ,UAAUsQ,SAA1B;UACIiY,eAAejY,SAAnB;UACIkY,WAAaroB,KAAK6R,MAAL,GAAc,IAA/B;cACO1T,KAAP;aACO,MAAL;yBACiB,EAAGgS,YAAYkY,QAAf,CAAf;;aAEG,MAAL;yBACmBlY,YAAYkY,QAA7B;;aAEG,MAAL;yBACiB,CAAf;;aAEG,KAAL;yBACiBxoB,UAAUyoB,YAAV,GAAyBD,QAAxC;;;gBAGMlY,SAAV,GAAsBiY,YAAtB;aACSh5B,KAAKoM,KAAL,CAAWqE,UAAUsQ,SAArB,KAAmC/gB,KAAKoM,KAAL,CAAW2U,SAAX,CAA5C;;WAEK,KAAP;GA3Q0B;;aA8QjB,mBAASoY,OAAT,EAAkBne,QAAlB,EAA4B;QACjCO,OAAO,IAAX;SACKid,iBAAL,CAAuB,GAAvB;YACQ90B,IAAR,CAAa,YAAW;cACdS,GAAR,CAAY,mBAAZ;WACKs0B,kBAAL;UACKzd,QAAL,EAAgB;;;KAHlB,EAIGnX,KAJH,CAIS,UAASK,CAAT,EAAY;WACdu0B,kBAAL;UACKzd,QAAL,EAAgB;;;cACR7W,GAAR,CAAY,qBAAZ,EAAmCD,CAAnC;YACMA,CAAN;KARF;GAjR0B;;QA6RtB,gBAAW;QACXqX,OAAO,IAAX;SACKqD,QAAL,CAAcO,MAAd,CAAqB,gBAArB;SACK2B,OAAL,CAAa,MAAb,KAAwBvF,KAAK6d,SAAL,CAAe,KAAK3B,UAAL,CAAgB7W,IAAhB,EAAf,CAAxB;GAhS0B;;QAmStB,gBAAW;SACVhC,QAAL,CAAcO,MAAd,CAAqB,oBAArB;SACK2B,OAAL,CAAa,MAAb,KAAwB,KAAKsY,SAAL,CAAe,KAAK3B,UAAL,CAAgB5W,IAAhB,EAAf,CAAxB;GArS0B;;SAwSrB,iBAAW;SACXjC,QAAL,CAAcO,MAAd,CAAqB,iBAArB;SACKia,SAAL,CAAe,KAAK3B,UAAL,CAAgBpU,OAAhB,CAAwB,CAAxB,CAAf,EAA2CzhB,SAA3C;GA1S0B;;QA6StB,gBAAW;QACX2Z,OAAO,IAAX;SACKqD,QAAL,CAAcO,MAAd,CAAqB,gBAArB;QACIjY,SAAS,KAAKwvB,KAAL,CAAWS,KAAX,CAAiBv5B,MAAjB,GAA0B,CAAvC;SACKw7B,SAAL,CAAe,KAAK3B,UAAL,CAAgBpU,OAAhB,CAAwBnc,MAAxB,CAAf,EAAgDtF,SAAhD;GAjT0B;;YAoTlB,kBAASsF,MAAT,EAAiB8T,QAAjB,EAA2B;QAC9B9T,UAAU,IAAf,EAAsB;UAChBmyB,UAAU,KAAK3C,KAAL,CAAWS,KAAX,CAAiBjkB,GAAjB,CAAqBhM,MAArB,CAAd;UACK,CAAEmyB,OAAP,EAAgB;;YAEVC,UAAUpyB,MAAd;YACKoyB,QAAQj4B,OAAR,CAAgB,KAAhB,IAAyB,CAA9B,EAAkC;cAC5Bk4B,QAAQvD,KAAKpyB,OAAL,CAAa,KAAK8yB,KAAL,CAAWV,IAAX,CAAgBwD,SAA7B,EAAwC,KAAK9C,KAAL,CAAWM,OAAX,CAAmByC,OAA3D,CAAZ;cACIC,QAAQ1D,KAAKpyB,OAAL,CAAaoyB,KAAK2D,OAAL,CAAaJ,KAAb,CAAb,EAAkCryB,MAAlC,CAAZ;oBACU,KAAKwvB,KAAL,CAAWkD,SAAX,CAAqBF,KAArB,CAAV;;YAEGJ,QAAQj4B,OAAR,CAAgB,GAAhB,MAAyB,CAA9B,EAAkC;oBACtBi4B,QAAQ54B,KAAR,CAAc,GAAd,EAAmB,CAAnB,CAAV;;;aAGGg2B,KAAL,CAAWS,KAAX,CAAiBC,IAAjB,CAAsB,UAASniB,IAAT,EAAe;cAC9BA,KAAK2kB,SAAL,IAAkBN,OAAvB,EAAiC;sBACrBrkB,IAAV;qBACSokB,QAAQ/c,IAAjB;;;SAHJ;;gBAQQnY,GAAR,CAAY,cAAZ,EAA4B+C,MAA5B;OApBF,MAqBO,IAAKA,OAAOnF,QAAP,GAAkBwxB,KAAlB,CAAwB,OAAxB,CAAL,EAAwC;gBACrCpvB,GAAR,CAAY,YAAZ,EAA0Bk1B,QAAQ/c,IAAlC;iBACS+c,QAAQ/c,IAAjB;;;UAGG,CAAE+c,OAAP,EAAiB;YACV,CAAE,KAAKvD,aAAZ,EAA4B;mBACjB,CAAT;SADF,MAEO;;;;;;YAMH3xB,GAAR,CAAY,eAAZ,EAA6B+C,MAA7B;;QAEI2yB,aAAa,KAAKpC,UAAL,CAAgBpU,OAAhB,CAAwBnc,MAAxB,EAAgCxD,IAAhC,CAAqC,YAAW;WAC1D+zB,UAAL,CAAgBpU,OAAhB,CAAwBnc,MAAxB;KADoD,CAEpDhJ,IAFoD,CAE/C,IAF+C,CAArC,CAAjB;SAGKk7B,SAAL,CAAeS,UAAf,EAA2B7e,QAA3B;GA/V0B;;qBAkWT,2BAASsE,GAAT,EAAc;WACxB,KAAKoX,KAAL,CAAW9B,iBAAX,CAA6BtV,GAA7B,CAAP;GAnW0B;;WAsWnB,mBAAW;QACb,KAAKmY,UAAV,EAAuB;UACjB;aACGA,UAAL,CAAgBM,OAAhB;OADF,CAEE,OAAM7zB,CAAN,EAAS;;SAERuzB,UAAL,GAAkB,IAAlB;SACK9U,MAAL,GAAc,KAAd;GA7W0B;;UAgXpB,gBAAS/hB,OAAT,EAAkBsG,MAAlB,EAA0B;;QAE5BA,SAASA,UAAU,KAAK2tB,eAAL,EAAvB;QACI3tB,OAAOmY,KAAX,EAAmB;eAAWnY,OAAOmY,KAAhB;;QAChBnY,OAAOoY,GAAZ,EAAkB;eAAWpY,OAAOoY,GAAhB;;;QAEhB6N,WAAW,KAAf;QACKvsB,YAAY,IAAjB,EAAwB;iBAAa,IAAX,CAAiBA,UAAU,EAAV;;QACvCk5B,UAAU,EAAd;WACO9f,IAAP,CAAYpZ,OAAZ,EAAqBwb,OAArB,CAA6B,UAAS1a,GAAT,EAAc;UACpCd,QAAQc,GAAR,KAAgB,KAAKd,OAAL,CAAac,GAAb,CAArB,EAAyC;mBAC5B,IAAX;gBACQA,GAAR,IAAe,IAAf;;;KAHyB,CAM3BxD,IAN2B,CAMtB,IANsB,CAA7B;;QAQK,CAAEivB,QAAP,EAAkB;;;;;QAKbrvB,OAAOkc,IAAP,CAAY8f,OAAZ,EAAqBl8B,MAArB,IAA+B,CAA/B,IAAoCk8B,QAAQvkB,KAAjD,EAAyD;aAChD3U,OAAP,CAAe2U,KAAf,GAAuB3U,QAAQ2U,KAA/B;WACKwkB,YAAL;;;;QAIGn5B,QAAQ4tB,YAAR,IAAwB5tB,QAAQ4tB,YAAR,IAAwB,KAAK5tB,OAAL,CAAa4tB,YAAlE,EAAiF;;qBAEhElR,OAAf,CAAuB,cAAvB,EAAuC1c,QAAQ4tB,YAA/C;eACSwL,MAAT;;;;UAIF,CAAY,KAAKp5B,OAAjB,EAA0BA,OAA1B;;SAEKs2B,IAAL,CAAUhwB,MAAV,EAAkB,YAAW;WACtBoxB,eAAL;WACKyB,YAAL;WACKpd,YAAL;WACKsd,YAAL,CAAkB,IAAlB;KAJgB,CAKhB/7B,IALgB,CAKX,IALW,CAAlB;GArZ0B;;mBA6ZX,2BAAW;QACrB,KAAKu5B,UAAL,IAAmB,KAAKA,UAAL,CAAgBC,OAAxC,EAAkD;WAC3CwC,gBAAL,GAAwB,KAAKzC,UAAL,CAAgB5C,eAAhB,EAAxB;;WAEK,KAAKqF,gBAAZ;GAja0B;;eAoaf,uBAAW;QAClB3e,OAAO,IAAX;;;QAGI4e,qBAAqB,KAAzB;QACK,KAAKzD,KAAL,CAAWM,OAAX,CAAmBhb,QAAnB,CAA4BoQ,MAA5B,IAAsC,eAA3C,EAA6D;;KAA7D,MAEO,IAAK,KAAKxrB,OAAL,CAAayc,IAAb,IAAqB,MAArB,IAA+B,KAAKzc,OAAL,CAAayc,IAAb,IAAqB,WAAzD,EAAuE;2BACvD,IAArB;;;QAGE+c,0BAA0B,EAA9B;;;QAGK,KAAKpe,QAAL,CAAcoQ,MAAd,IAAwB,eAA7B,EAA+C;WACxCqL,UAAL,CAAgBI,KAAhB,CAAsBzF,OAAtB,CAA8BsG,QAA9B,CAAuC,UAASxN,QAAT,EAAmB;iBAC/CmP,kBAAT,CAA4B;iBAClB;yBACO,CAAC,KAAKC,OAAL,CAAaC,WAAb,GAA2B,KAAKD,OAAL,CAAaC,WAAb,GAA2B,IAAtD,GAA6D,MAA9D,IAAwE,YAD/E;0BAEQ,CAAC,KAAKD,OAAL,CAAa7X,MAAb,GAAuB,KAAK6X,OAAL,CAAa7X,MAAb,GAAsB,GAAvB,GAA8B,IAApD,GAA2D,KAA5D,IAAqE,YAF7E;0BAGQ,SAHR;iCAIe;WALG;iBAOlB;yBACO,CAAC,KAAK6X,OAAL,CAAaC,WAAb,GAA2B,KAAKD,OAAL,CAAaC,WAAb,GAA2B,IAAtD,GAA6D,MAA9D,IAAwE,YAD/E;0BAEQ,CAAC,KAAKD,OAAL,CAAa7X,MAAb,GAAuB,KAAK6X,OAAL,CAAa7X,MAAb,GAAsB,GAAvB,GAA8B,IAApD,GAA2D,KAA5D,IAAqE,YAF7E;iCAGe;;SAVzB;OADqC,CAcrCvkB,IAdqC,CAchC,KAAKu5B,UAd2B,CAAvC;KADF,MAgBO;WACAA,UAAL,CAAgBI,KAAhB,CAAsBzF,OAAtB,CAA8BsG,QAA9B,CAAuC,UAASxN,QAAT,EAAmB;iBAC/CmP,kBAAT,CAA4B;iBAClB;;0BAEQ;WAHU;oBAKhB;0BACM,uBADN;sBAEE;;SAPd;OADqC,CAWrCn8B,IAXqC,CAWhC,KAAKu5B,UAX2B,CAAvC;;;SAcGa,eAAL;;QAEK8B,wBAAwBx8B,MAA7B,EAAsC;WAC/B65B,UAAL,CAAgBI,KAAhB,CAAsBzF,OAAtB,CAA8BsG,QAA9B,CAAuC,UAAS8B,IAAT,EAAe;aAC/CH,kBAAL,CAAwBD,uBAAxB;OADF;;;SAKG3C,UAAL,CAAgBlwB,EAAhB,CAAmB,SAAnB,EAA8B,UAASkzB,GAAT,EAAc;WACrCjzB,IAAL,CAAU,SAAV,EAAqBizB,GAArB;KADF;;SAIKhD,UAAL,CAAgBlwB,EAAhB,CAAmB,WAAnB,EAAgC,UAAS6X,QAAT,EAAmB;WAC5C5X,IAAL,CAAU,WAAV,EAAuB4X,QAAvB;KADF;;SAIKqY,UAAL,CAAgBlwB,EAAhB,CAAmB,cAAnB,EAAmC,UAAS0K,GAAT,EAAc;cACvC9N,GAAR,CAAY,8BAAZ,EAA4C8N,GAA5C;KADF;;SAIKwlB,UAAL,CAAgBlwB,EAAhB,CAAmB,iBAAnB,EAAsC,UAAS6X,QAAT,EAAmB;UACnDob,OAAO,KAAK9C,OAAL,CAAa3C,OAAb,EAAX;UACIsE,UAAUmB,KAAKnB,OAAnB;UACItE,UAAU,KAAK2F,IAAL,CAAU5D,UAAV,CAAqB5jB,GAArB,CAAyBmmB,QAAQ/c,IAAjC,CAAd;;WAEK9U,IAAL,CAAU,eAAV,EAA2ButB,OAA3B;WACKvtB,IAAL,CAAU,gBAAV,EAA4B4X,QAA5B;;KANF;;SAUKqY,UAAL,CAAgBlwB,EAAhB,CAAmB,UAAnB,EAA+B,UAAS8xB,OAAT,EAAkBmB,IAAlB,EAAwB;;UAEhDA,KAAKtP,QAAV,EAAqB;;;;;;;;;;;;;;;;;;;;;;MAsBlB,AAAH,KAcK3jB,EAAL,CAAQ,SAAR,EAAmB,UAAS9F,IAAT,EAAe;YAC3BA,KAAK4e,OAAL,IAAgB,KAAhB,IAAyB5e,KAAKk3B,KAAnC,EAA2C;cACrCloB,YAAY8K,KAAKkc,UAAL,CAAgBC,OAAhB,CAAwBjnB,SAAxC;cACIkqB,GAAJ;cACI5rB,KAAJ;cACI1P,CAAJ,CAAO,IAAIu7B,GAAJ;qBACI,YAAW;gBAChB5Z,aAAavQ,UAAUuQ,UAA3B;kBACMA,aAAaiD,SAAS1I,KAAKkc,UAAL,CAAgBC,OAAhB,CAAwBtL,MAAxB,CAA+Brd,KAAxC,EAA+C,EAA/C,CAAnB;gBACK4rB,MAAM,CAAN,IAAaA,MAAMpf,KAAKkc,UAAL,CAAgBC,OAAhB,CAAwBtL,MAAxB,CAA+Brd,KAAvC,GAAiD,IAAjE,EAAwE;;;kBAGlE/O,KAAKoM,KAAL,CAAWqE,UAAUuQ,UAAV,GAAuBiD,SAAS1I,KAAKkc,UAAL,CAAgBC,OAAhB,CAAwBtL,MAAxB,CAA+Brd,KAAxC,EAA+C,EAA/C,CAAlC,CAAJ;kBACKtN,KAAKkf,QAAV,EAAqB;qBAAO,CAAL;eAAvB,MACK;qBAAO,CAAL;;kBACHjV,IAAI+E,UAAUuQ,UAAlB;sBACU3hB,IAAIkc,KAAKkc,UAAL,CAAgBC,OAAhB,CAAwBtL,MAAxB,CAA+Brd,KAArC,GAA+CrD,CAAvD;oBACQrM,IAAIkc,KAAKkc,UAAL,CAAgBC,OAAhB,CAAwBtL,MAAxB,CAA+Brd,KAA3C;;kBAEK,QAAQ,CAAEtN,KAAKkf,QAApB,EAA+B;qBACxB8W,UAAL,CAAgBC,OAAhB,CAAwBuB,QAAxB,CAAiClqB,KAAjC;;;oBAGI5K,GAAR,CAAY,0BAAZ,EAAwC1C,KAAKkf,QAA7C,EAAuDK,UAAvD,EAAmE2Z,GAAnE,EAAwEt7B,CAAxE,EAA2Eu7B,GAA3E,EAAgF7rB,KAAhF;WAjBF,EAkBG,CAlBH;;OANJ;KAtCF;GA/e0B;;2BAqjBH,mCAAW;QAC9BwM,OAAO,IAAX;QACIY,SAAS,KAAKvb,OAAL,CAAaub,MAA1B;QACKA,MAAL,EAAc;aACLC,OAAP,CAAe,UAASC,KAAT,EAAgB;aACxBob,UAAL,CAAgBtb,MAAhB,CAAuBuc,QAAvB,CAAgCrc,MAAM,OAAN,CAAhC,EAAgDA,MAAMC,IAAN,GAAaD,MAAMC,IAAnB,GAA0BD,MAAMG,KAAhF;OADF;;;;SAMGib,UAAL,CAAgBtb,MAAhB,CAAuB0e,QAAvB,CAAgC,YAAhC,EAA8C,4DAA9C;GA/jB0B;;gBAkkBd,sBAASC,OAAT,EAAkB;QAC1Bze,QAAQ,KAAKzb,OAAL,CAAayb,KAAb,IAAsB,SAAlC;SACKob,UAAL,CAAgBtb,MAAhB,CAAuB4e,MAAvB,CAA8B1e,KAA9B;QACK,KAAKye,OAAV,EAAoB;UACdxb,MAAM,KAAKuV,eAAL,GAAuBmG,GAAvB,CAA2B1b,GAArC;WACKmY,UAAL,CAAgBC,OAAhB,CAAwBI,KAAxB;cACQ3zB,GAAR,CAAY,MAAZ,EAAoBmb,GAApB;WACKmY,UAAL,CAAgBpU,OAAhB,CAAwB/D,GAAxB;;GAzkBwB;;mBA6kBX,2BAAW;QACtBwD,YAAY,KAAKliB,OAAL,CAAakiB,SAAb,IAA0B,MAA1B,GAAmC,GAAnC,GAAyC,KAAKliB,OAAL,CAAakiB,SAAtE;SACK2U,UAAL,CAAgBtb,MAAhB,CAAuBgS,QAAvB,CAAmCrL,SAAnC;;;;;;;;GA/kB0B;;gBAylBd,wBAAW;QACnBvN,QAAQ,KAAK3U,OAAL,CAAa2U,KAAzB;QACKA,KAAL,EAAa;cACH0O,SAAS1O,KAAT,EAAgB,EAAhB,IAAsB,KAA9B;WACKkiB,UAAL,CAAgBliB,KAAhB,CAAsBA,KAAtB;;GA7lBwB;;OAimBvB;;CAjmBS,CAAhB;;AAqmBAzX,OAAO6Z,cAAP,CAAsB2D,OAAOua,MAAP,CAAc53B,SAApC,EAA+C,UAA/C,EAA2D;OACpD,kBAAW;;WAEP,KAAKg9B,SAAZ;GAHuD;;OAMpD,aAASx5B,IAAT,EAAe;SACbw5B,SAAL,GAAiB51B,MAAA,CAAY,EAAZ,EAAgB5D,IAAhB,EAAsB,KAAKb,OAAL,CAAaob,QAAnC,CAAjB;;CAPJ;;AAWAle,OAAO6Z,cAAP,CAAsB2D,OAAOua,MAAP,CAAc53B,SAApC,EAA+C,aAA/C,EAA8D;OACvD,kBAAW;;QAETyO,EAAL,EAAkB;aACT;eACE,iBAAW,YADb;mBAEM,mBAASimB,QAAT,EAAmB;OAFhC;;QAKG,CAAE,KAAK8E,UAAL,CAAgBpF,WAAhB,CAA4BC,KAAnC,EAA2C;WACpCmF,UAAL,CAAgBpF,WAAhB,CAA4BC,KAA5B,GAAoC,YAAU;aACxC,IAAIsG,IAAR,IAAgB,KAAKsC,YAArB,EAAmC;cAC3BvI,WAAWwI,UAAUvC,IAAV,CAAf;eACKllB,MAAL,CAAYif,QAAZ;;aAECyI,0BAAL,GAAkC,EAAlC;OALkC,CAMlCl9B,IANkC,CAM7B,KAAKu5B,UAAL,CAAgBpF,WANa,CAApC;;WAQK,KAAKoF,UAAL,CAAgBpF,WAAvB;;CAlBJ;;AAsBAv0B,OAAO6Z,cAAP,CAAsB2D,OAAOua,MAAP,CAAc53B,SAApC,EAA+C,WAA/C,EAA4D;OACrD,kBAAW;;WAEP,KAAKy4B,KAAL,CAAWzC,SAAlB;;CAHJ;;AAOA5xB,OAAOiZ,MAAP,GAAgBA,MAAhB;;AAEA,AAAO,SAAS+f,cAAT,CAAsBt4B,EAAtB,EAA0BnC,OAA1B,EAAmC;SACjC,IAAI0a,OAAOua,MAAX,CAAkB9yB,EAAlB,EAAsBnC,OAAtB,CAAP;;;ACppBF0a,OAAOggB,IAAP,GAAchgB,OAAOje,MAAP,CAAc;;cAEd,oBAAS0F,EAAT,EAAanC,OAAb,EAAsB;WACzB3C,SAAP,CAAiBgH,UAAjB,CAA4B1G,KAA5B,CAAkC,IAAlC,EAAwCZ,SAAxC;GAHwB;;QAMpB,cAASuJ,MAAT,EAAiB8T,QAAjB,EAA2B;QAC3BO,OAAO,IAAX;SACKmb,KAAL,GAAa;gBACD;eACD,eADC;iBAEC,WAFD;mBAGG,kBAHH;kBAIE,eAJF;iBAKC;OANA;gBAQD;aACH,CACH,EAAC3zB,IAAI,CAAL,EAAQuZ,MAAM,uCAAd,EAAuD6J,OAAO,OAA9D,EAAuExhB,QAAQ,IAA/E,EADG,EAEH,EAAC5B,IAAI,CAAL,EAAQuZ,MAAM,uCAAd,EAAuD6J,OAAO,WAA9D,EAA2ExhB,QAAQ,IAAnF,EAFG,EAGH,EAAC5B,IAAI,CAAL,EAAQuZ,MAAM,uCAAd,EAAuD6J,OAAO,WAA9D,EAA2ExhB,QAAQ,IAAnF,EAHG,EAIH,EAAC5B,IAAI,CAAL,EAAQuZ,MAAM,uCAAd,EAAuD6J,OAAO,WAA9D,EAA2ExhB,QAAQ,IAAnF,EAJG,EAKH,EAAC5B,IAAI,CAAL,EAAQuZ,MAAM,uCAAd,EAAuD6J,OAAO,WAA9D,EAA2ExhB,QAAQ,IAAnF,EALG,EAMH,EAAC5B,IAAI,CAAL,EAAQuZ,MAAM,uCAAd,EAAuD6J,OAAO,WAA9D,EAA2ExhB,QAAQ,IAAnF,EANG,EAOH,EAAC5B,IAAI,CAAL,EAAQuZ,MAAM,uCAAd,EAAuD6J,OAAO,WAA9D,EAA2ExhB,QAAQ,IAAnF,EAPG,EAQH,EAAC5B,IAAI,CAAL,EAAQuZ,MAAM,uCAAd,EAAuD6J,OAAO,WAA9D,EAA2ExhB,QAAQ,IAAnF,EARG,EASH,EAAC5B,IAAI,CAAL,EAAQuZ,MAAM,mCAAd,EAAmD6J,OAAO,OAA1D,EAAmExhB,QAAQ,IAA3E,EATG;;KATT;;SAuBK2yB,UAAL,GAAkB,CAChB,gCADgB,EAEhB,gCAFgB,EAGhB,gCAHgB,EAIhB,gCAJgB,EAKhB,gCALgB,EAMhB,gCANgB,EAOhB,gCAPgB,EAQhB,gCARgB,EAShB,gCATgB,EAUhB,4BAVgB,CAAlB;;SAaKiE,cAAL,GAAsB,CAAtB;;SAEKvf,QAAL,GAAgB,KAAK0a,KAAL,CAAW1a,QAA3B;SACKxU,IAAL,CAAU,gBAAV,EAA4B,KAAKkvB,KAAL,CAAWxL,QAAvC;SACK1jB,IAAL,CAAU,aAAV,EAAyB,KAAKyzB,SAA9B;SACKzzB,IAAL,CAAU,iBAAV,EAA6B,KAAK8vB,UAAlC;SACKJ,IAAL,CAAUhwB,MAAV,EAAkB8T,QAAlB;GAlDwB;;QAqDpB,cAAS9T,MAAT,EAAiB8T,QAAjB,EAA2B;QAC3BO,OAAO,IAAX;SACKyc,QAAL,GAAgB,EAAE3a,MAAM,KAAKzc,OAAL,CAAayc,IAArB,EAAhB;SACK2a,QAAL,CAAcvV,MAAd,GAAuB,MAAvB;SACKuV,QAAL,CAActV,KAAd,GAAsB,KAAtB;;QAEK,KAAK9hB,OAAL,CAAayc,IAAb,IAAqB,MAA1B,EAAmC;WAC5BmB,MAAL,CAAY,MAAZ,EAAoBxW,KAApB,CAA0BkwB,QAA1B,GAAqC,QAArC;KADF,MAEO;WACA1Z,MAAL,CAAY,MAAZ,EAAoBxW,KAApB,CAA0BkwB,QAA1B,GAAqC,MAArC;;QAEG,OAAOhxB,MAAP,IAAkB,UAAlB,IAAgCvD,OAAO/B,SAA5C,EAAwD;iBAC3CsF,MAAX;eACStF,SAAT;;;SAGG4F,IAAL,CAAU,OAAV;GArEwB;;QAwEpB,gBAAW;;GAxES;;QA4EpB,gBAAW;;GA5ES;;SAgFnB,iBAAW;;GAhFQ;;QAoFpB,gBAAW,EApFS;;YAuFhB,kBAASN,MAAT,EAAiB;QACpB,OAAOA,MAAP,IAAkB,QAAvB,EAAkC;WAC3Bq0B,cAAL,GAAsB,KAAKjE,UAAL,CAAgBj2B,OAAhB,CAAwB6F,MAAxB,CAAtB;KADF,MAEO;WACAq0B,cAAL,GAAsBr0B,MAAtB;;SAEGM,IAAL,CAAU,WAAV,EAAuB,KAAKqtB,eAAL,EAAvB;GA7FwB;;WAgGjB,mBAAW;;;;;GAhGM;;mBAuGT,2BAAW;QACtBvV,MAAM,KAAKgY,UAAL,CAAgB,KAAKiE,cAArB,CAAV;WACO;aACE,EAAEjc,KAAKA,GAAP,EAAYhD,MAAMgD,GAAlB,EADF;WAEA,EAAEA,KAAKA,GAAP,EAAYhD,MAAMgD,GAAlB;KAFP;GAzGwB;;eA+Gb,uBAAW;QAClB/D,OAAO,IAAX;GAhHwB;;gBAoHZ,wBAAW,EApHC;;OAwHrB;;CAxHO,CAAd;;AA4HAzd,OAAO6Z,cAAP,CAAsB2D,OAAOggB,IAAP,CAAYr9B,SAAlC,EAA6C,UAA7C,EAAyD;OAClD,kBAAW;;WAEP,KAAKg9B,SAAZ;GAHqD;;OAMlD,aAASx5B,IAAT,EAAe;SACbw5B,SAAL,GAAiB51B,MAAA,CAAY,EAAZ,EAAgB5D,IAAhB,EAAsB,KAAKb,OAAL,CAAaob,QAAnC,CAAjB;;CAPJ;;AAWAle,OAAO6Z,cAAP,CAAsB2D,OAAOggB,IAAP,CAAYr9B,SAAlC,EAA6C,WAA7C,EAA0D;OACnD,kBAAW;;QAEVsd,OAAO,IAAX;WACO;aACEA,KAAK+b,UAAL,CAAgB15B,MADlB;uBAEY,yBAAS0hB,GAAT,EAAc;eACtB/D,KAAK+b,UAAL,CAAgBj2B,OAAhB,CAAwBie,GAAxB,CAAP;OAHG;yBAKc,2BAASA,GAAT,EAAc;YAC3B5B,QAAQnC,KAAK0Y,SAAL,CAAeiB,eAAf,CAA+B5V,GAA/B,CAAZ;eACS5B,QAAQnC,KAAK0Y,SAAL,CAAeqB,KAAhC;OAPG;yBASc,2BAAStV,UAAT,EAAqB;YAClCtC,QAAQ1d,KAAKsM,IAAL,CAAU0T,aAAa,EAAvB,CAAZ;eACOzE,KAAK+b,UAAL,CAAgB5Z,KAAhB,CAAP;;KAXJ;;CAJJ;;AAqBA5f,OAAO6Z,cAAP,CAAsB2D,OAAOggB,IAAP,CAAYr9B,SAAlC,EAA6C,aAA7C,EAA4D;OACrD,kBAAW;WACP;aACE,iBAAW,EADb;iBAEM,qBAAW;KAFxB;;CAFJ;;AASA,AAAO,SAASo9B,cAAT,CAAsBt4B,EAAtB,EAA0BnC,OAA1B,EAAmC;SACjC,IAAI0a,OAAOggB,IAAX,CAAgBv4B,EAAhB,EAAoBnC,OAApB,CAAP;;;ACtKF,IAAI46B,UAAU;UACJ3F,cADI;QAENyF;CAFR;;AAKA,AAAO,IAAIzc,WAAS,SAATA,MAAS,CAAS9b,EAAT,EAAanC,OAAb,EAAsB;YAC9BA,WAAW,EAArB;MACIwd,SAASxd,QAAQwd,MAAR,IAAkB/b,OAAOo5B,gBAAzB,IAA6C,QAA1D;MACIze,cAAcpc,QAAQoc,WAAR,IAAuB3a,OAAOq5B,qBAAhD;MACIC,QAAQ,IAAZ;MACIC,aAAaj+B,SAAjB;;UAEQygB,MAAR,GAAiBA,MAAjB;UACQpB,WAAR,GAAsBA,WAAtB;;SAEOwe,QAAQpd,MAAR,EAAgB7f,KAAhB,CAAsBo9B,KAAtB,EAA6B,CAAC54B,EAAD,EAAKnC,OAAL,CAA7B,CAAP;CAVK;;;;;;;;;;;;;;;;;;;;;;;;;;"}
>>>>>>> af5bd27... track new epub.js for prepaginated scaling
=======
{"version":3,"file":"cozy-sun-bear.js","sources":["../node_modules/url-polyfill/url-polyfill.js","../node_modules/classlist-polyfill/src/index.js","../src/core/Util.js","../src/core/Class.js","../src/core/Events.js","../src/core/Browser.js","../src/geometry/Point.js","../src/dom/DomEvent.Pointer.js","../src/dom/DomEvent.DoubleTap.js","../src/dom/DomEvent.js","../src/dom/DomUtil.js","../node_modules/lodash/isObject.js","../node_modules/lodash/_freeGlobal.js","../node_modules/lodash/_root.js","../node_modules/lodash/_Symbol.js","../node_modules/lodash/_getRawTag.js","../node_modules/lodash/_objectToString.js","../node_modules/lodash/_baseGetTag.js","../node_modules/lodash/isObjectLike.js","../node_modules/lodash/isFunction.js","../node_modules/lodash/_coreJsData.js","../node_modules/lodash/_isMasked.js","../node_modules/lodash/_toSource.js","../node_modules/lodash/_baseIsNative.js","../node_modules/lodash/_getValue.js","../node_modules/lodash/_getNative.js","../node_modules/lodash/_defineProperty.js","../node_modules/lodash/_baseAssignValue.js","../node_modules/lodash/eq.js","../node_modules/lodash/_assignValue.js","../node_modules/lodash/_copyObject.js","../node_modules/lodash/identity.js","../node_modules/lodash/_apply.js","../node_modules/lodash/_overRest.js","../node_modules/lodash/constant.js","../node_modules/lodash/_baseSetToString.js","../node_modules/lodash/_shortOut.js","../node_modules/lodash/_setToString.js","../node_modules/lodash/_baseRest.js","../node_modules/lodash/isLength.js","../node_modules/lodash/isArrayLike.js","../node_modules/lodash/_isIndex.js","../node_modules/lodash/_isIterateeCall.js","../node_modules/lodash/_createAssigner.js","../node_modules/lodash/_isPrototype.js","../node_modules/lodash/_baseTimes.js","../node_modules/lodash/_baseIsArguments.js","../node_modules/lodash/isArguments.js","../node_modules/lodash/isArray.js","../node_modules/lodash/stubFalse.js","../node_modules/lodash/isBuffer.js","../node_modules/lodash/_baseIsTypedArray.js","../node_modules/lodash/_baseUnary.js","../node_modules/lodash/_nodeUtil.js","../node_modules/lodash/isTypedArray.js","../node_modules/lodash/_arrayLikeKeys.js","../node_modules/lodash/_overArg.js","../node_modules/lodash/_nativeKeys.js","../node_modules/lodash/_baseKeys.js","../node_modules/lodash/keys.js","../node_modules/lodash/assign.js","../src/screenfull.js","../src/reader/Reader.js","../src/control/Control.js","../src/control/Control.Paging.js","../src/control/Modal.js","../src/control/Control.Contents.js","../src/control/Control.Title.js","../src/control/Control.PublicationMetadata.js","../src/control/Control.Preferences.js","../src/control/Control.Widget.js","../src/control/Control.Citation.js","../src/control/Control.Search.js","../src/control/Control.BibliographicInformation.js","../src/control/Control.Download.js","../src/control/Control.Navigator.js","../src/control/index.js","../src/core/Bus.js","../src/core/index.js","../src/epubjs.js","../node_modules/path-webpack/path.js","../src/reader/Reader.EpubJS.js","../src/reader/Reader.Mock.js","../src/reader/index.js"],"sourcesContent":["(function(global) {\r\n  /**\r\n   * Polyfill URLSearchParams\r\n   *\r\n   * Inspired from : https://github.com/WebReflection/url-search-params/blob/master/src/url-search-params.js\r\n   */\r\n\r\n  var checkIfIteratorIsSupported = function() {\r\n    try {\r\n      return !!Symbol.iterator;\r\n    } catch(error) {\r\n      return false;\r\n    }\r\n  };\r\n\r\n\r\n  var iteratorSupported = checkIfIteratorIsSupported();\r\n\r\n  var createIterator = function(items) {\r\n    var iterator = {\r\n      next: function() {\r\n        var value = items.shift();\r\n        return { done: value === void 0, value: value };\r\n      }\r\n    };\r\n\r\n    if(iteratorSupported) {\r\n      iterator[Symbol.iterator] = function() {\r\n        return iterator;\r\n      };\r\n    }\r\n\r\n    return iterator;\r\n  };\r\n\r\n  /**\r\n   * Search param name and values should be encoded according to https://url.spec.whatwg.org/#urlencoded-serializing\r\n   * encodeURIComponent() produces the same result except encoding spaces as `%20` instead of `+`.\r\n   */\r\n  var serializeParam = function(value) {\r\n    return encodeURIComponent(value).replace(/%20/g, '+');\r\n  };\r\n\r\n  var deserializeParam = function(value) {\r\n    return decodeURIComponent(value).replace(/\\+/g, ' ');\r\n  };\r\n\r\n  var polyfillURLSearchParams= function() {\r\n\r\n    var URLSearchParams = function(searchString) {\r\n      Object.defineProperty(this, '_entries', { value: {} });\r\n\r\n      if(typeof searchString === 'string') {\r\n        if(searchString !== '') {\r\n          searchString = searchString.replace(/^\\?/, '');\r\n          var attributes = searchString.split('&');\r\n          var attribute;\r\n          for(var i = 0; i < attributes.length; i++) {\r\n            attribute = attributes[i].split('=');\r\n            this.append(\r\n              deserializeParam(attribute[0]),\r\n              (attribute.length > 1) ? deserializeParam(attribute[1]) : ''\r\n            );\r\n          }\r\n        }\r\n      } else if(searchString instanceof URLSearchParams) {\r\n        var _this = this;\r\n        searchString.forEach(function(value, name) {\r\n          _this.append(value, name);\r\n        });\r\n      }\r\n    };\r\n\r\n    var proto = URLSearchParams.prototype;\r\n\r\n    proto.append = function(name, value) {\r\n      if(name in this._entries) {\r\n        this._entries[name].push(value.toString());\r\n      } else {\r\n        this._entries[name] = [value.toString()];\r\n      }\r\n    };\r\n\r\n    proto.delete = function(name) {\r\n      delete this._entries[name];\r\n    };\r\n\r\n    proto.get = function(name) {\r\n      return (name in this._entries) ? this._entries[name][0] : null;\r\n    };\r\n\r\n    proto.getAll = function(name) {\r\n      return (name in this._entries) ? this._entries[name].slice(0) : [];\r\n    };\r\n\r\n    proto.has = function(name) {\r\n      return (name in this._entries);\r\n    };\r\n\r\n    proto.set = function(name, value) {\r\n      this._entries[name] = [value.toString()];\r\n    };\r\n\r\n    proto.forEach = function(callback, thisArg) {\r\n      var entries;\r\n      for(var name in this._entries) {\r\n        if(this._entries.hasOwnProperty(name)) {\r\n          entries = this._entries[name];\r\n          for(var i = 0; i < entries.length; i++) {\r\n            callback.call(thisArg, entries[i], name, this);\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    proto.keys = function() {\r\n      var items = [];\r\n      this.forEach(function(value, name) { items.push(name); });\r\n      return createIterator(items);\r\n    };\r\n\r\n    proto.values = function() {\r\n      var items = [];\r\n      this.forEach(function(value) { items.push(value); });\r\n      return createIterator(items);\r\n    };\r\n\r\n    proto.entries = function() {\r\n      var items = [];\r\n      this.forEach(function(value, name) { items.push([name, value]); });\r\n      return createIterator(items);\r\n    };\r\n\r\n    if(iteratorSupported) {\r\n      proto[Symbol.iterator] = proto.entries;\r\n    }\r\n\r\n    proto.toString = function() {\r\n      var searchString = '';\r\n      this.forEach(function(value, name) {\r\n        if(searchString.length > 0) searchString+= '&';\r\n        searchString += serializeParam(name) + '=' + serializeParam(value);\r\n      });\r\n      return searchString;\r\n    };\r\n\r\n    global.URLSearchParams = URLSearchParams;\r\n  };\r\n\r\n  if(!('URLSearchParams' in global) || (new URLSearchParams('?a=1').toString() !== 'a=1')) {\r\n    polyfillURLSearchParams();\r\n  }\r\n\r\n  // HTMLAnchorElement\r\n\r\n})(\r\n  (typeof global !== 'undefined') ? global\r\n    : ((typeof window !== 'undefined') ? window\r\n    : ((typeof self !== 'undefined') ? self : this))\r\n);\r\n\r\n(function(global) {\r\n  /**\r\n   * Polyfill URL\r\n   *\r\n   * Inspired from : https://github.com/arv/DOM-URL-Polyfill/blob/master/src/url.js\r\n   */\r\n\r\n  var checkIfURLIsSupported = function() {\r\n    try {\r\n      var u = new URL('b', 'http://a');\r\n      u.pathname = 'c%20d';\r\n      return (u.href === 'http://a/c%20d') && u.searchParams;\r\n    } catch(e) {\r\n      return false;\r\n    }\r\n  };\r\n\r\n\r\n  var polyfillURL = function() {\r\n    var _URL = global.URL;\r\n\r\n    var URL = function(url, base) {\r\n      if(typeof url !== 'string') url = String(url);\r\n\r\n      var doc = document.implementation.createHTMLDocument('');\r\n      window.doc = doc;\r\n      if(base) {\r\n        var baseElement = doc.createElement('base');\r\n        baseElement.href = base;\r\n        doc.head.appendChild(baseElement);\r\n      }\r\n\r\n      var anchorElement = doc.createElement('a');\r\n      anchorElement.href = url;\r\n      doc.body.appendChild(anchorElement);\r\n      anchorElement.href = anchorElement.href; // force href to refresh\r\n\r\n      if(anchorElement.protocol === ':' || !/:/.test(anchorElement.href)) {\r\n        throw new TypeError('Invalid URL');\r\n      }\r\n\r\n      Object.defineProperty(this, '_anchorElement', {\r\n        value: anchorElement\r\n      });\r\n    };\r\n\r\n    var proto = URL.prototype;\r\n\r\n    var linkURLWithAnchorAttribute = function(attributeName) {\r\n      Object.defineProperty(proto, attributeName, {\r\n        get: function() {\r\n          return this._anchorElement[attributeName];\r\n        },\r\n        set: function(value) {\r\n          this._anchorElement[attributeName] = value;\r\n        },\r\n        enumerable: true\r\n      });\r\n    };\r\n\r\n    ['hash', 'host', 'hostname', 'port', 'protocol', 'search']\r\n    .forEach(function(attributeName) {\r\n      linkURLWithAnchorAttribute(attributeName);\r\n    });\r\n\r\n    Object.defineProperties(proto, {\r\n\r\n      'toString': {\r\n        get: function() {\r\n          var _this = this;\r\n          return function() {\r\n            return _this.href;\r\n          };\r\n        }\r\n      },\r\n\r\n      'href' : {\r\n        get: function() {\r\n          return this._anchorElement.href.replace(/\\?$/,'');\r\n        },\r\n        set: function(value) {\r\n          this._anchorElement.href = value;\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'pathname' : {\r\n        get: function() {\r\n          return this._anchorElement.pathname.replace(/(^\\/?)/,'/');\r\n        },\r\n        set: function(value) {\r\n          this._anchorElement.pathname = value;\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'origin': {\r\n        get: function() {\r\n          // get expected port from protocol\r\n          var expectedPort = {'http:': 80, 'https:': 443, 'ftp:': 21}[this._anchorElement.protocol];\r\n          // add port to origin if, expected port is different than actual port\r\n          // and it is not empty f.e http://foo:8080\r\n          // 8080 != 80 && 8080 != ''\r\n          var addPortToOrigin = this._anchorElement.port != expectedPort &&\r\n            this._anchorElement.port !== ''\r\n\r\n          return this._anchorElement.protocol +\r\n            '//' +\r\n            this._anchorElement.hostname +\r\n            (addPortToOrigin ? (':' + this._anchorElement.port) : '');\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'password': { // TODO\r\n        get: function() {\r\n          return '';\r\n        },\r\n        set: function(value) {\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'username': { // TODO\r\n        get: function() {\r\n          return '';\r\n        },\r\n        set: function(value) {\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'searchParams': {\r\n        get: function() {\r\n          var searchParams = new URLSearchParams(this.search);\r\n          var _this = this;\r\n          ['append', 'delete', 'set'].forEach(function(methodName) {\r\n            var method = searchParams[methodName];\r\n            searchParams[methodName] = function() {\r\n              method.apply(searchParams, arguments);\r\n              _this.search = searchParams.toString();\r\n            };\r\n          });\r\n          return searchParams;\r\n        },\r\n        enumerable: true\r\n      }\r\n    });\r\n\r\n    URL.createObjectURL = function(blob) {\r\n      return _URL.createObjectURL.apply(_URL, arguments);\r\n    };\r\n\r\n    URL.revokeObjectURL = function(url) {\r\n      return _URL.revokeObjectURL.apply(_URL, arguments);\r\n    };\r\n\r\n    global.URL = URL;\r\n\r\n  };\r\n\r\n  if(!checkIfURLIsSupported()) {\r\n    polyfillURL();\r\n  }\r\n\r\n  if((global.location !== void 0) && !('origin' in global.location)) {\r\n    var getOrigin = function() {\r\n      return global.location.protocol + '//' + global.location.hostname + (global.location.port ? (':' + global.location.port) : '');\r\n    };\r\n\r\n    try {\r\n      Object.defineProperty(global.location, 'origin', {\r\n        get: getOrigin,\r\n        enumerable: true\r\n      });\r\n    } catch(e) {\r\n      setInterval(function() {\r\n        global.location.origin = getOrigin();\r\n      }, 100);\r\n    }\r\n  }\r\n\r\n})(\r\n  (typeof global !== 'undefined') ? global\r\n    : ((typeof window !== 'undefined') ? window\r\n    : ((typeof self !== 'undefined') ? self : this))\r\n);\r\n","/*\n * classList.js: Cross-browser full element.classList implementation.\n * 1.1.20170427\n *\n * By Eli Grey, http://eligrey.com\n * License: Dedicated to the public domain.\n *   See https://github.com/eligrey/classList.js/blob/master/LICENSE.md\n */\n\n/*global self, document, DOMException */\n\n/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js */\n\nif (\"document\" in window.self) {\n\n// Full polyfill for browsers with no classList support\n// Including IE < Edge missing SVGElement.classList\nif (!(\"classList\" in document.createElement(\"_\")) \n\t|| document.createElementNS && !(\"classList\" in document.createElementNS(\"http://www.w3.org/2000/svg\",\"g\"))) {\n\n(function (view) {\n\n\"use strict\";\n\nif (!('Element' in view)) return;\n\nvar\n\t  classListProp = \"classList\"\n\t, protoProp = \"prototype\"\n\t, elemCtrProto = view.Element[protoProp]\n\t, objCtr = Object\n\t, strTrim = String[protoProp].trim || function () {\n\t\treturn this.replace(/^\\s+|\\s+$/g, \"\");\n\t}\n\t, arrIndexOf = Array[protoProp].indexOf || function (item) {\n\t\tvar\n\t\t\t  i = 0\n\t\t\t, len = this.length\n\t\t;\n\t\tfor (; i < len; i++) {\n\t\t\tif (i in this && this[i] === item) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t}\n\t// Vendors: please allow content code to instantiate DOMExceptions\n\t, DOMEx = function (type, message) {\n\t\tthis.name = type;\n\t\tthis.code = DOMException[type];\n\t\tthis.message = message;\n\t}\n\t, checkTokenAndGetIndex = function (classList, token) {\n\t\tif (token === \"\") {\n\t\t\tthrow new DOMEx(\n\t\t\t\t  \"SYNTAX_ERR\"\n\t\t\t\t, \"An invalid or illegal string was specified\"\n\t\t\t);\n\t\t}\n\t\tif (/\\s/.test(token)) {\n\t\t\tthrow new DOMEx(\n\t\t\t\t  \"INVALID_CHARACTER_ERR\"\n\t\t\t\t, \"String contains an invalid character\"\n\t\t\t);\n\t\t}\n\t\treturn arrIndexOf.call(classList, token);\n\t}\n\t, ClassList = function (elem) {\n\t\tvar\n\t\t\t  trimmedClasses = strTrim.call(elem.getAttribute(\"class\") || \"\")\n\t\t\t, classes = trimmedClasses ? trimmedClasses.split(/\\s+/) : []\n\t\t\t, i = 0\n\t\t\t, len = classes.length\n\t\t;\n\t\tfor (; i < len; i++) {\n\t\t\tthis.push(classes[i]);\n\t\t}\n\t\tthis._updateClassName = function () {\n\t\t\telem.setAttribute(\"class\", this.toString());\n\t\t};\n\t}\n\t, classListProto = ClassList[protoProp] = []\n\t, classListGetter = function () {\n\t\treturn new ClassList(this);\n\t}\n;\n// Most DOMException implementations don't allow calling DOMException's toString()\n// on non-DOMExceptions. Error's toString() is sufficient here.\nDOMEx[protoProp] = Error[protoProp];\nclassListProto.item = function (i) {\n\treturn this[i] || null;\n};\nclassListProto.contains = function (token) {\n\ttoken += \"\";\n\treturn checkTokenAndGetIndex(this, token) !== -1;\n};\nclassListProto.add = function () {\n\tvar\n\t\t  tokens = arguments\n\t\t, i = 0\n\t\t, l = tokens.length\n\t\t, token\n\t\t, updated = false\n\t;\n\tdo {\n\t\ttoken = tokens[i] + \"\";\n\t\tif (checkTokenAndGetIndex(this, token) === -1) {\n\t\t\tthis.push(token);\n\t\t\tupdated = true;\n\t\t}\n\t}\n\twhile (++i < l);\n\n\tif (updated) {\n\t\tthis._updateClassName();\n\t}\n};\nclassListProto.remove = function () {\n\tvar\n\t\t  tokens = arguments\n\t\t, i = 0\n\t\t, l = tokens.length\n\t\t, token\n\t\t, updated = false\n\t\t, index\n\t;\n\tdo {\n\t\ttoken = tokens[i] + \"\";\n\t\tindex = checkTokenAndGetIndex(this, token);\n\t\twhile (index !== -1) {\n\t\t\tthis.splice(index, 1);\n\t\t\tupdated = true;\n\t\t\tindex = checkTokenAndGetIndex(this, token);\n\t\t}\n\t}\n\twhile (++i < l);\n\n\tif (updated) {\n\t\tthis._updateClassName();\n\t}\n};\nclassListProto.toggle = function (token, force) {\n\ttoken += \"\";\n\n\tvar\n\t\t  result = this.contains(token)\n\t\t, method = result ?\n\t\t\tforce !== true && \"remove\"\n\t\t:\n\t\t\tforce !== false && \"add\"\n\t;\n\n\tif (method) {\n\t\tthis[method](token);\n\t}\n\n\tif (force === true || force === false) {\n\t\treturn force;\n\t} else {\n\t\treturn !result;\n\t}\n};\nclassListProto.toString = function () {\n\treturn this.join(\" \");\n};\n\nif (objCtr.defineProperty) {\n\tvar classListPropDesc = {\n\t\t  get: classListGetter\n\t\t, enumerable: true\n\t\t, configurable: true\n\t};\n\ttry {\n\t\tobjCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\n\t} catch (ex) { // IE 8 doesn't support enumerable:true\n\t\t// adding undefined to fight this issue https://github.com/eligrey/classList.js/issues/36\n\t\t// modernie IE8-MSW7 machine has IE8 8.0.6001.18702 and is affected\n\t\tif (ex.number === undefined || ex.number === -0x7FF5EC54) {\n\t\t\tclassListPropDesc.enumerable = false;\n\t\t\tobjCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\n\t\t}\n\t}\n} else if (objCtr[protoProp].__defineGetter__) {\n\telemCtrProto.__defineGetter__(classListProp, classListGetter);\n}\n\n}(window.self));\n\n}\n\n// There is full or partial native classList support, so just check if we need\n// to normalize the add/remove and toggle APIs.\n\n(function () {\n\t\"use strict\";\n\n\tvar testElement = document.createElement(\"_\");\n\n\ttestElement.classList.add(\"c1\", \"c2\");\n\n\t// Polyfill for IE 10/11 and Firefox <26, where classList.add and\n\t// classList.remove exist but support only one argument at a time.\n\tif (!testElement.classList.contains(\"c2\")) {\n\t\tvar createMethod = function(method) {\n\t\t\tvar original = DOMTokenList.prototype[method];\n\n\t\t\tDOMTokenList.prototype[method] = function(token) {\n\t\t\t\tvar i, len = arguments.length;\n\n\t\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t\ttoken = arguments[i];\n\t\t\t\t\toriginal.call(this, token);\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t\tcreateMethod('add');\n\t\tcreateMethod('remove');\n\t}\n\n\ttestElement.classList.toggle(\"c3\", false);\n\n\t// Polyfill for IE 10 and Firefox <24, where classList.toggle does not\n\t// support the second argument.\n\tif (testElement.classList.contains(\"c3\")) {\n\t\tvar _toggle = DOMTokenList.prototype.toggle;\n\n\t\tDOMTokenList.prototype.toggle = function(token, force) {\n\t\t\tif (1 in arguments && !this.contains(token) === !force) {\n\t\t\t\treturn force;\n\t\t\t} else {\n\t\t\t\treturn _toggle.call(this, token);\n\t\t\t}\n\t\t};\n\n\t}\n\n\ttestElement = null;\n}());\n\n}\n","/*\n * @namespace Util\n *\n * Various utility functions, used by Leaflet internally.\n */\n\n// @function extend(dest: Object, src?: Object): Object\n// Merges the properties of the `src` object (or multiple objects) into `dest` object and returns the latter. Has an `L.extend` shortcut.\nexport function extend(dest) {\n    var i, j, len, src;\n\n    for (j = 1, len = arguments.length; j < len; j++) {\n        src = arguments[j];\n        for (i in src) {\n            dest[i] = src[i];\n        }\n    }\n    return dest;\n}\n\n// @function create(proto: Object, properties?: Object): Object\n// Compatibility polyfill for [Object.create](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/create)\nexport var create = Object.create || (function () {\n    function F() {}\n    return function (proto) {\n        F.prototype = proto;\n        return new F();\n    };\n})();\n\n// @function bind(fn: Function, …): Function\n// Returns a new function bound to the arguments passed, like [Function.prototype.bind](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Function/bind).\n// Has a `L.bind()` shortcut.\nexport function bind(fn, obj) {\n    var slice = Array.prototype.slice;\n\n    if (fn.bind) {\n        return fn.bind.apply(fn, slice.call(arguments, 1));\n    }\n\n    var args = slice.call(arguments, 2);\n\n    return function () {\n        return fn.apply(obj, args.length ? args.concat(slice.call(arguments)) : arguments);\n    };\n}\n\n// @property lastId: Number\n// Last unique ID used by [`stamp()`](#util-stamp)\nexport var lastId = 0;\n\n// @function stamp(obj: Object): Number\n// Returns the unique ID of an object, assiging it one if it doesn't have it.\nexport function stamp(obj) {\n    /*eslint-disable */\n    obj._cozy_id = obj._cozy_id || ++lastId;\n    return obj._cozy_id; /* not leaflet */\n    /*eslint-enable */\n}\n\n// @function throttle(fn: Function, time: Number, context: Object): Function\n// Returns a function which executes function `fn` with the given scope `context`\n// (so that the `this` keyword refers to `context` inside `fn`'s code). The function\n// `fn` will be called no more than one time per given amount of `time`. The arguments\n// received by the bound function will be any arguments passed when binding the\n// function, followed by any arguments passed when invoking the bound function.\n// Has an `L.throttle` shortcut.\nexport function throttle(fn, time, context) {\n    var lock, args, wrapperFn, later;\n\n    later = function () {\n        // reset lock and call if queued\n        lock = false;\n        if (args) {\n            wrapperFn.apply(context, args);\n            args = false;\n        }\n    };\n\n    wrapperFn = function () {\n        if (lock) {\n            // called too soon, queue to call later\n            args = arguments;\n\n        } else {\n            // call and lock until later\n            fn.apply(context, arguments);\n            setTimeout(later, time);\n            lock = true;\n        }\n    };\n\n    return wrapperFn;\n}\n\n// @function wrapNum(num: Number, range: Number[], includeMax?: Boolean): Number\n// Returns the number `num` modulo `range` in such a way so it lies within\n// `range[0]` and `range[1]`. The returned value will be always smaller than\n// `range[1]` unless `includeMax` is set to `true`.\nexport function wrapNum(x, range, includeMax) {\n    var max = range[1],\n        min = range[0],\n        d = max - min;\n    return x === max && includeMax ? x : ((x - min) % d + d) % d + min;\n}\n\n// @function falseFn(): Function\n// Returns a function which always returns `false`.\nexport function falseFn() { return false; }\n\n// @function formatNum(num: Number, digits?: Number): Number\n// Returns the number `num` rounded to `digits` decimals, or to 5 decimals by default.\nexport function formatNum(num, digits) {\n    var pow = Math.pow(10, digits || 5);\n    return Math.round(num * pow) / pow;\n}\n\n// @function isNumeric(num: Number): Boolean\n// Returns whether num is actually numeric\nexport function isNumeric(num) {\n  return !isNaN(parseFloat(num)) && isFinite(num);\n}\n\n// @function trim(str: String): String\n// Compatibility polyfill for [String.prototype.trim](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String/Trim)\nexport function trim(str) {\n    return str.trim ? str.trim() : str.replace(/^\\s+|\\s+$/g, '');\n}\n\n// @function splitWords(str: String): String[]\n// Trims and splits the string on whitespace and returns the array of parts.\nexport function splitWords(str) {\n    return trim(str).split(/\\s+/);\n}\n\n// @function setOptions(obj: Object, options: Object): Object\n// Merges the given properties to the `options` of the `obj` object, returning the resulting options. See `Class options`. Has an `L.setOptions` shortcut.\nexport function setOptions(obj, options) {\n    if (!obj.hasOwnProperty('options')) {\n        obj.options = obj.options ? create(obj.options) : {};\n    }\n    for (var i in options) {\n        obj.options[i] = options[i];\n    }\n    return obj.options;\n}\n\n// @function getParamString(obj: Object, existingUrl?: String, uppercase?: Boolean): String\n// Converts an object into a parameter URL string, e.g. `{a: \"foo\", b: \"bar\"}`\n// translates to `'?a=foo&b=bar'`. If `existingUrl` is set, the parameters will\n// be appended at the end. If `uppercase` is `true`, the parameter names will\n// be uppercased (e.g. `'?A=foo&B=bar'`)\nexport function getParamString(obj, existingUrl, uppercase) {\n    var params = [];\n    for (var i in obj) {\n        params.push(encodeURIComponent(uppercase ? i.toUpperCase() : i) + '=' + encodeURIComponent(obj[i]));\n    }\n    return ((!existingUrl || existingUrl.indexOf('?') === -1) ? '?' : '&') + params.join('&');\n}\n\nvar templateRe = /\\{ *([\\w_\\-]+) *\\}/g;\n\n// @function template(str: String, data: Object): String\n// Simple templating facility, accepts a template string of the form `'Hello {a}, {b}'`\n// and a data object like `{a: 'foo', b: 'bar'}`, returns evaluated string\n// `('Hello foo, bar')`. You can also specify functions instead of strings for\n// data values — they will be evaluated passing `data` as an argument.\nexport function template(str, data) {\n    return str.replace(templateRe, function (str, key) {\n        var value = data[key];\n\n        if (value === undefined) {\n            throw new Error('No value provided for variable ' + str);\n\n        } else if (typeof value === 'function') {\n            value = value(data);\n        }\n        return value;\n    });\n}\n\n// @function isArray(obj): Boolean\n// Compatibility polyfill for [Array.isArray](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array/isArray)\nexport var isArray = Array.isArray || function (obj) {\n    return (Object.prototype.toString.call(obj) === '[object Array]');\n};\n\n// @function indexOf(array: Array, el: Object): Number\n// Compatibility polyfill for [Array.prototype.indexOf](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf)\nexport function indexOf(array, el) {\n    for (var i = 0; i < array.length; i++) {\n        if (array[i] === el) { return i; }\n    }\n    return -1;\n}\n\n// @property emptyImageUrl: String\n// Data URI string containing a base64-encoded empty GIF image.\n// Used as a hack to free memory from unused images on WebKit-powered\n// mobile devices (by setting image `src` to this string).\nexport var emptyImageUrl = 'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=';\n\n// inspired by http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n\nfunction getPrefixed(name) {\n    return window['webkit' + name] || window['moz' + name] || window['ms' + name];\n}\n\nvar lastTime = 0;\n\n// fallback for IE 7-8\nfunction timeoutDefer(fn) {\n    var time = +new Date(),\n        timeToCall = Math.max(0, 16 - (time - lastTime));\n\n    lastTime = time + timeToCall;\n    return window.setTimeout(fn, timeToCall);\n}\n\nexport var requestFn = window.requestAnimationFrame || getPrefixed('RequestAnimationFrame') || timeoutDefer;\nexport var cancelFn = window.cancelAnimationFrame || getPrefixed('CancelAnimationFrame') ||\n        getPrefixed('CancelRequestAnimationFrame') || function (id) { window.clearTimeout(id); };\n\n// @function requestAnimFrame(fn: Function, context?: Object, immediate?: Boolean): Number\n// Schedules `fn` to be executed when the browser repaints. `fn` is bound to\n// `context` if given. When `immediate` is set, `fn` is called immediately if\n// the browser doesn't have native support for\n// [`window.requestAnimationFrame`](https://developer.mozilla.org/docs/Web/API/window/requestAnimationFrame),\n// otherwise it's delayed. Returns a request ID that can be used to cancel the request.\nexport function requestAnimFrame(fn, context, immediate) {\n    if (immediate && requestFn === timeoutDefer) {\n        fn.call(context);\n    } else {\n        return requestFn.call(window, bind(fn, context));\n    }\n}\n\n// @function cancelAnimFrame(id: Number): undefined\n// Cancels a previous `requestAnimFrame`. See also [window.cancelAnimationFrame](https://developer.mozilla.org/docs/Web/API/window/cancelAnimationFrame).\nexport function cancelAnimFrame(id) {\n    if (id) {\n        cancelFn.call(window, id);\n    }\n}\n\nexport var loader = {\n    js: function(url) {\n        var handler = { _resolved: false };\n        handler.callbacks = [];\n        handler.error = [];\n        handler.then = function(cb) {\n            handler.callbacks.push(cb);\n            if ( handler._resolved ) { return handler.resolve(); }\n            return handler;\n        }\n        handler.catch = function(cb) {\n            handler.error.push(cb);\n            if ( handler._resolved ) { return handler.reject(); }\n            return handler;\n        }\n        handler.resolve = function(_argv) {\n            // var _argv;\n            handler._resolved = true;\n            while ( handler.callbacks.length ) {\n                var cb = handler.callbacks.shift();\n                var retval;\n                try {\n                    _argv = cb(_argv);\n                } catch(e) {\n                    console.log(e);\n                    handler.reject(e);\n                    break;\n                }\n            }\n            return handler;\n        }\n\n        handler.reject = function(e) {\n            while ( handler.error.length ) {\n                var cb = handler.error.shift();\n                cb(e);\n            }\n            console.log(e);\n            console.trace();\n            return handler;\n        }\n\n        if ( url == undefined ) {\n            handler._resolved = true;\n            return handler;\n        }\n\n        var element = document.createElement('script');\n\n        element.onload = function() {\n          handler.resolve(url);\n        };\n        element.onerror = function() {\n          handler.catch.apply(arguments);\n        };\n\n        element.async = true;\n        var parent = 'body';\n        var attr = 'src';\n        element[attr] = url;\n        document[parent].appendChild(element);\n\n        console.log(\"AHOY APPENDED\", url);\n\n        return handler;\n    }\n}","import * as Util from './Util';\r\n\r\n// @class Class\r\n// @aka L.Class\r\n\r\n// @section\r\n// @uninheritable\r\n\r\n// Thanks to John Resig and Dean Edwards for inspiration!\r\n\r\nexport function Class() {}\r\n\r\nClass.extend = function (props) {\r\n\r\n\t// @function extend(props: Object): Function\r\n\t// [Extends the current class](#class-inheritance) given the properties to be included.\r\n\t// Returns a Javascript function that is a class constructor (to be called with `new`).\r\n\tvar NewClass = function () {\r\n\r\n\t\t// call the constructor\r\n\t\tif (this.initialize) {\r\n\t\t\tthis.initialize.apply(this, arguments);\r\n\t\t}\r\n\r\n\t\t// call all constructor hooks\r\n\t\tthis.callInitHooks();\r\n\t};\r\n\r\n\tvar parentProto = NewClass.__super__ = this.prototype;\r\n\r\n\tvar proto = Util.create(parentProto);\r\n\tproto.constructor = NewClass;\r\n\r\n\tNewClass.prototype = proto;\r\n\r\n\t// inherit parent's statics\r\n\tfor (var i in this) {\r\n\t\tif (this.hasOwnProperty(i) && i !== 'prototype') {\r\n\t\t\tNewClass[i] = this[i];\r\n\t\t}\r\n\t}\r\n\r\n\t// mix static properties into the class\r\n\tif (props.statics) {\r\n\t\tUtil.extend(NewClass, props.statics);\r\n\t\tdelete props.statics;\r\n\t}\r\n\r\n\t// mix includes into the prototype\r\n\tif (props.includes) {\r\n\t\tcheckDeprecatedMixinEvents(props.includes);\r\n\t\tUtil.extend.apply(null, [proto].concat(props.includes));\r\n\t\tdelete props.includes;\r\n\t}\r\n\r\n\t// merge options\r\n\tif (proto.options) {\r\n\t\tprops.options = Util.extend(Util.create(proto.options), props.options);\r\n\t}\r\n\r\n\t// mix given properties into the prototype\r\n\tUtil.extend(proto, props);\r\n\t\r\n\tproto._initHooks = [];\r\n\r\n\t// add method for calling all hooks\r\n\tproto.callInitHooks = function () {\r\n\r\n\t\tif (this._initHooksCalled) { return; }\r\n\r\n\t\tif (parentProto.callInitHooks) {\r\n\t\t\tparentProto.callInitHooks.call(this);\r\n\t\t}\r\n\r\n\t\tthis._initHooksCalled = true;\r\n\r\n\t\tfor (var i = 0, len = proto._initHooks.length; i < len; i++) {\r\n\t\t\tproto._initHooks[i].call(this);\r\n\t\t}\r\n\t};\r\n\r\n\treturn NewClass;\r\n};\r\n\r\n\r\n// @function include(properties: Object): this\r\n// [Includes a mixin](#class-includes) into the current class.\r\nClass.include = function (props) {\r\n\tUtil.extend(this.prototype, props);\r\n\treturn this;\r\n};\r\n\r\n// @function mergeOptions(options: Object): this\r\n// [Merges `options`](#class-options) into the defaults of the class.\r\nClass.mergeOptions = function (options) {\r\n\tUtil.extend(this.prototype.options, options);\r\n\treturn this;\r\n};\r\n\r\n// @function addInitHook(fn: Function): this\r\n// Adds a [constructor hook](#class-constructor-hooks) to the class.\r\nClass.addInitHook = function (fn) { // (Function) || (String, args...)\r\n\tvar args = Array.prototype.slice.call(arguments, 1);\r\n\r\n\tvar init = typeof fn === 'function' ? fn : function () {\r\n\t\tthis[fn].apply(this, args);\r\n\t};\r\n\r\n\tthis.prototype._initHooks = this.prototype._initHooks || [];\r\n\tthis.prototype._initHooks.push(init);\r\n\treturn this;\r\n};\r\n\r\nfunction checkDeprecatedMixinEvents(includes) {\r\n\tif (!cozy || !cozy.Mixin) { return; }\r\n\r\n\tincludes = cozy.Util.isArray(includes) ? includes : [includes];\r\n\r\n\t// for (var i = 0; i < includes.length; i++) {\r\n\t// \tif (includes[i] === cozy.Mixin.Events) {\r\n\t// \t\tconsole.warn('Deprecated include of cozy.Mixin.Events: ' +\r\n\t// \t\t\t'this property will be removed in future releases, ' +\r\n\t// \t\t\t'please inherit from cozy.Evented instead.', new Error().stack);\r\n\t// \t}\r\n\t// }\r\n}\r\n","import {Class} from './Class';\r\nimport * as Util from './Util';\r\n\r\n/*\r\n * @class Evented\r\n * @aka L.Evented\r\n * @inherits Class\r\n *\r\n * A set of methods shared between event-powered classes (like `Map` and `Marker`). Generally, events allow you to execute some function when something happens with an object (e.g. the user clicks on the map, causing the map to fire `'click'` event).\r\n *\r\n * @example\r\n *\r\n * ```js\r\n * map.on('click', function(e) {\r\n * \talert(e.latlng);\r\n * } );\r\n * ```\r\n *\r\n * Leaflet deals with event listeners by reference, so if you want to add a listener and then remove it, define it as a function:\r\n *\r\n * ```js\r\n * function onClick(e) { ... }\r\n *\r\n * map.on('click', onClick);\r\n * map.off('click', onClick);\r\n * ```\r\n */\r\n\r\nexport var Evented = Class.extend({\r\n\r\n\t/* @method on(type: String, fn: Function, context?: Object): this\r\n\t * Adds a listener function (`fn`) to a particular event type of the object. You can optionally specify the context of the listener (object the this keyword will point to). You can also pass several space-separated types (e.g. `'click dblclick'`).\r\n\t *\r\n\t * @alternative\r\n\t * @method on(eventMap: Object): this\r\n\t * Adds a set of type/listener pairs, e.g. `{click: onClick, mousemove: onMouseMove}`\r\n\t */\r\n\ton: function (types, fn, context) {\r\n\r\n\t\t// types can be a map of types/handlers\r\n\t\tif (typeof types === 'object') {\r\n\t\t\tfor (var type in types) {\r\n\t\t\t\t// we don't process space-separated events here for performance;\r\n\t\t\t\t// it's a hot path since Layer uses the on(obj) syntax\r\n\t\t\t\tthis._on(type, types[type], fn);\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\t// types can be a string of space-separated words\r\n\t\t\ttypes = Util.splitWords(types);\r\n\r\n\t\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\t\tthis._on(types[i], fn, context);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t/* @method off(type: String, fn?: Function, context?: Object): this\r\n\t * Removes a previously added listener function. If no function is specified, it will remove all the listeners of that particular event from the object. Note that if you passed a custom context to `on`, you must pass the same context to `off` in order to remove the listener.\r\n\t *\r\n\t * @alternative\r\n\t * @method off(eventMap: Object): this\r\n\t * Removes a set of type/listener pairs.\r\n\t *\r\n\t * @alternative\r\n\t * @method off: this\r\n\t * Removes all listeners to all events on the object.\r\n\t */\r\n\toff: function (types, fn, context) {\r\n\r\n\t\tif (!types) {\r\n\t\t\t// clear all listeners if called without arguments\r\n\t\t\tdelete this._events;\r\n\r\n\t\t} else if (typeof types === 'object') {\r\n\t\t\tfor (var type in types) {\r\n\t\t\t\tthis._off(type, types[type], fn);\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\ttypes = Util.splitWords(types);\r\n\r\n\t\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\t\tthis._off(types[i], fn, context);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// attach listener (without syntactic sugar now)\r\n\t_on: function (type, fn, context) {\r\n\t\tthis._events = this._events || {};\r\n\r\n\t\t/* get/init listeners for type */\r\n\t\tvar typeListeners = this._events[type];\r\n\t\tif (!typeListeners) {\r\n\t\t\ttypeListeners = [];\r\n\t\t\tthis._events[type] = typeListeners;\r\n\t\t}\r\n\r\n\t\tif (context === this) {\r\n\t\t\t// Less memory footprint.\r\n\t\t\tcontext = undefined;\r\n\t\t}\r\n\t\tvar newListener = {fn: fn, ctx: context},\r\n\t\t    listeners = typeListeners;\r\n\r\n\t\t// check if fn already there\r\n\t\tfor (var i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\tif (listeners[i].fn === fn && listeners[i].ctx === context) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlisteners.push(newListener);\r\n\t},\r\n\r\n\t_off: function (type, fn, context) {\r\n\t\tvar listeners,\r\n\t\t    i,\r\n\t\t    len;\r\n\r\n\t\tif (!this._events) { return; }\r\n\r\n\t\tlisteners = this._events[type];\r\n\r\n\t\tif (!listeners) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!fn) {\r\n\t\t\t// Set all removed listeners to noop so they are not called if remove happens in fire\r\n\t\t\tfor (i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\t\tlisteners[i].fn = Util.falseFn;\r\n\t\t\t}\r\n\t\t\t// clear all listeners for a type if function isn't specified\r\n\t\t\tdelete this._events[type];\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (context === this) {\r\n\t\t\tcontext = undefined;\r\n\t\t}\r\n\r\n\t\tif (listeners) {\r\n\r\n\t\t\t// find fn and remove it\r\n\t\t\tfor (i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\t\tvar l = listeners[i];\r\n\t\t\t\tif (l.ctx !== context) { continue; }\r\n\t\t\t\tif (l.fn === fn) {\r\n\r\n\t\t\t\t\t// set the removed listener to noop so that's not called if remove happens in fire\r\n\t\t\t\t\tl.fn = Util.falseFn;\r\n\r\n\t\t\t\t\tif (this._firingCount) {\r\n\t\t\t\t\t\t/* copy array in case events are being fired */\r\n\t\t\t\t\t\tthis._events[type] = listeners = listeners.slice();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlisteners.splice(i, 1);\r\n\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t// @method fire(type: String, data?: Object, propagate?: Boolean): this\r\n\t// Fires an event of the specified type. You can optionally provide an data\r\n\t// object — the first argument of the listener function will contain its\r\n\t// properties. The event can optionally be propagated to event parents.\r\n\tfire: function (type, data, propagate) {\r\n\t\tif (!this.listens(type, propagate)) { return this; }\r\n\r\n\t\tvar event = Util.extend({}, data, {type: type, target: this});\r\n\r\n\t\tif (this._events) {\r\n\t\t\tvar listeners = this._events[type];\r\n\r\n\t\t\tif (listeners) {\r\n\t\t\t\tthis._firingCount = (this._firingCount + 1) || 1;\r\n\t\t\t\tfor (var i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\t\t\tvar l = listeners[i];\r\n\t\t\t\t\tl.fn.call(l.ctx || this, event);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._firingCount--;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (propagate) {\r\n\t\t\t// propagate the event to parents (set with addEventParent)\r\n\t\t\tthis._propagateEvent(event);\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method listens(type: String): Boolean\r\n\t// Returns `true` if a particular event type has any listeners attached to it.\r\n\tlistens: function (type, propagate) {\r\n\t\tvar listeners = this._events && this._events[type];\r\n\t\tif (listeners && listeners.length) { return true; }\r\n\r\n\t\tif (propagate) {\r\n\t\t\t// also check parents for listeners if event propagates\r\n\t\t\tfor (var id in this._eventParents) {\r\n\t\t\t\tif (this._eventParents[id].listens(type, propagate)) { return true; }\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\r\n\t// @method once(…): this\r\n\t// Behaves as [`on(…)`](#evented-on), except the listener will only get fired once and then removed.\r\n\tonce: function (types, fn, context) {\r\n\r\n\t\tif (typeof types === 'object') {\r\n\t\t\tfor (var type in types) {\r\n\t\t\t\tthis.once(type, types[type], fn);\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tvar handler = Util.bind(function () {\r\n\t\t\tthis\r\n\t\t\t    .off(types, fn, context)\r\n\t\t\t    .off(types, handler, context);\r\n\t\t}, this);\r\n\r\n\t\t// add a listener that's executed once and removed after that\r\n\t\treturn this\r\n\t\t    .on(types, fn, context)\r\n\t\t    .on(types, handler, context);\r\n\t},\r\n\r\n\t// @method addEventParent(obj: Evented): this\r\n\t// Adds an event parent - an `Evented` that will receive propagated events\r\n\taddEventParent: function (obj) {\r\n\t\tthis._eventParents = this._eventParents || {};\r\n\t\tthis._eventParents[Util.stamp(obj)] = obj;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method removeEventParent(obj: Evented): this\r\n\t// Removes an event parent, so it will stop receiving propagated events\r\n\tremoveEventParent: function (obj) {\r\n\t\tif (this._eventParents) {\r\n\t\t\tdelete this._eventParents[Util.stamp(obj)];\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\t_propagateEvent: function (e) {\r\n\t\tfor (var id in this._eventParents) {\r\n\t\t\tthis._eventParents[id].fire(e.type, Util.extend({layer: e.target}, e), true);\r\n\t\t}\r\n\t}\r\n});\r\n\r\nvar proto = Evented.prototype;\r\n\r\n// aliases; we should ditch those eventually\r\n\r\n// @method addEventListener(…): this\r\n// Alias to [`on(…)`](#evented-on)\r\nproto.addEventListener = proto.on;\r\n\r\n// @method removeEventListener(…): this\r\n// Alias to [`off(…)`](#evented-off)\r\n\r\n// @method clearAllEventListeners(…): this\r\n// Alias to [`off()`](#evented-off)\r\nproto.removeEventListener = proto.clearAllEventListeners = proto.off;\r\n\r\n// @method addOneTimeEventListener(…): this\r\n// Alias to [`once(…)`](#evented-once)\r\nproto.addOneTimeEventListener = proto.once;\r\n\r\n// @method fireEvent(…): this\r\n// Alias to [`fire(…)`](#evented-fire)\r\nproto.fireEvent = proto.fire;\r\n\r\n// @method hasEventListeners(…): Boolean\r\n// Alias to [`listens(…)`](#evented-listens)\r\nproto.hasEventListeners = proto.listens;\r\n","\n/*\n * @namespace Browser\n * @aka L.Browser\n *\n * A namespace with static properties for browser/feature detection used by Leaflet internally.\n *\n * @example\n *\n * ```js\n * if (L.Browser.ielt9) {\n *   alert('Upgrade your browser, dude!');\n * }\n * ```\n */\n\nvar style = document.documentElement.style;\n\n// @property ie: Boolean; `true` for all Internet Explorer versions (not Edge).\nexport var ie = 'ActiveXObject' in window;\n\n// @property ielt9: Boolean; `true` for Internet Explorer versions less than 9.\nexport var ielt9 = ie && !document.addEventListener;\n\n// @property edge: Boolean; `true` for the Edge web browser.\nexport var edge = 'msLaunchUri' in navigator && !('documentMode' in document);\n\n// @property webkit: Boolean;\n// `true` for webkit-based browsers like Chrome and Safari (including mobile versions).\nexport var webkit = userAgentContains('webkit');\n\n// @property android: Boolean\n// `true` for any browser running on an Android platform.\nexport var android = userAgentContains('android');\n\n// @property android23: Boolean; `true` for browsers running on Android 2 or Android 3.\nexport var android23 = userAgentContains('android 2') || userAgentContains('android 3');\n\n// @property opera: Boolean; `true` for the Opera browser\nexport var opera = !!window.opera;\n\n// @property chrome: Boolean; `true` for the Chrome browser.\nexport var chrome = userAgentContains('chrome');\n\n// @property gecko: Boolean; `true` for gecko-based browsers like Firefox.\nexport var gecko = userAgentContains('gecko') && !webkit && !opera && !ie;\n\n// @property safari: Boolean; `true` for the Safari browser.\nexport var safari = !chrome && userAgentContains('safari');\n\nexport var phantom = userAgentContains('phantom');\n\n// @property opera12: Boolean\n// `true` for the Opera browser supporting CSS transforms (version 12 or later).\nexport var opera12 = 'OTransition' in style;\n\n// @property win: Boolean; `true` when the browser is running in a Windows platform\nexport var win = navigator.platform.indexOf('Win') === 0;\n\n// @property ie3d: Boolean; `true` for all Internet Explorer versions supporting CSS transforms.\nexport var ie3d = ie && ('transition' in style);\n\n// @property webkit3d: Boolean; `true` for webkit-based browsers supporting CSS transforms.\nexport var webkit3d = ('WebKitCSSMatrix' in window) && ('m11' in new window.WebKitCSSMatrix()) && !android23;\n\n// @property gecko3d: Boolean; `true` for gecko-based browsers supporting CSS transforms.\nexport var gecko3d = 'MozPerspective' in style;\n\n// @property any3d: Boolean\n// `true` for all browsers supporting CSS transforms.\nexport var any3d = !window.L_DISABLE_3D && (ie3d || webkit3d || gecko3d) && !opera12 && !phantom;\n\n// @property mobile: Boolean; `true` for all browsers running in a mobile device.\nexport var mobile = typeof orientation !== 'undefined' || userAgentContains('mobile');\n\n// @property mobileWebkit: Boolean; `true` for all webkit-based browsers in a mobile device.\nexport var mobileWebkit = mobile && webkit;\n\n// @property mobileWebkit3d: Boolean\n// `true` for all webkit-based browsers in a mobile device supporting CSS transforms.\nexport var mobileWebkit3d = mobile && webkit3d;\n\n// @property msPointer: Boolean\n// `true` for browsers implementing the Microsoft touch events model (notably IE10).\nexport var msPointer = !window.PointerEvent && window.MSPointerEvent;\n\n// @property pointer: Boolean\n// `true` for all browsers supporting [pointer events](https://msdn.microsoft.com/en-us/library/dn433244%28v=vs.85%29.aspx).\nexport var pointer = !!(window.PointerEvent || msPointer);\n\n// @property touch: Boolean\n// `true` for all browsers supporting [touch events](https://developer.mozilla.org/docs/Web/API/Touch_events).\n// This does not necessarily mean that the browser is running in a computer with\n// a touchscreen, it only means that the browser is capable of understanding\n// touch events.\nexport var touch = !window.L_NO_TOUCH && (pointer || 'ontouchstart' in window ||\n        (window.DocumentTouch && document instanceof window.DocumentTouch));\n\n// @property mobileOpera: Boolean; `true` for the Opera browser in a mobile device.\nexport var mobileOpera = mobile && opera;\n\n// @property mobileGecko: Boolean\n// `true` for gecko-based browsers running in a mobile device.\nexport var mobileGecko = mobile && gecko;\n\n// @property retina: Boolean\n// `true` for browsers on a high-resolution \"retina\" screen.\nexport var retina = (window.devicePixelRatio || (window.screen.deviceXDPI / window.screen.logicalXDPI)) > 1;\n\n\n// @property canvas: Boolean\n// `true` when the browser supports [`<canvas>`](https://developer.mozilla.org/docs/Web/API/Canvas_API).\nexport var canvas = (function () {\n    return !!document.createElement('canvas').getContext;\n}());\n\n// @property svg: Boolean\n// `true` when the browser supports [SVG](https://developer.mozilla.org/docs/Web/SVG).\n// export var svg = !!(document.createElementNS && svgCreate('svg').createSVGRect);\nexport var svg = true;\n\n// @property vml: Boolean\n// `true` if the browser supports [VML](https://en.wikipedia.org/wiki/Vector_Markup_Language).\nexport var vml = !svg && (function () {\n    try {\n        var div = document.createElement('div');\n        div.innerHTML = '<v:shape adj=\"1\"/>';\n\n        var shape = div.firstChild;\n        shape.style.behavior = 'url(#default#VML)';\n\n        return shape && (typeof shape.adj === 'object');\n\n    } catch (e) {\n        return false;\n    }\n}());\n\nexport var columnCount = ( 'columnCount' in style );\nexport var classList = ( document.documentElement.classList !== undefined );\n\nfunction userAgentContains(str) {\n    return navigator.userAgent.toLowerCase().indexOf(str) >= 0;\n}\n","import {isArray, formatNum} from '../core/Util';\r\n\r\n/*\r\n * @class Point\r\n * @aka L.Point\r\n *\r\n * Represents a point with `x` and `y` coordinates in pixels.\r\n *\r\n * @example\r\n *\r\n * ```js\r\n * var point = L.point(200, 300);\r\n * ```\r\n *\r\n * All Leaflet methods and options that accept `Point` objects also accept them in a simple Array form (unless noted otherwise), so these lines are equivalent:\r\n *\r\n * ```js\r\n * map.panBy([200, 300]);\r\n * map.panBy(L.point(200, 300));\r\n * ```\r\n */\r\n\r\nexport function Point(x, y, round) {\r\n\t// @property x: Number; The `x` coordinate of the point\r\n\tthis.x = (round ? Math.round(x) : x);\r\n\t// @property y: Number; The `y` coordinate of the point\r\n\tthis.y = (round ? Math.round(y) : y);\r\n}\r\n\r\nPoint.prototype = {\r\n\r\n\t// @method clone(): Point\r\n\t// Returns a copy of the current point.\r\n\tclone: function () {\r\n\t\treturn new Point(this.x, this.y);\r\n\t},\r\n\r\n\t// @method add(otherPoint: Point): Point\r\n\t// Returns the result of addition of the current and the given points.\r\n\tadd: function (point) {\r\n\t\t// non-destructive, returns a new point\r\n\t\treturn this.clone()._add(toPoint(point));\r\n\t},\r\n\r\n\t_add: function (point) {\r\n\t\t// destructive, used directly for performance in situations where it's safe to modify existing point\r\n\t\tthis.x += point.x;\r\n\t\tthis.y += point.y;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method subtract(otherPoint: Point): Point\r\n\t// Returns the result of subtraction of the given point from the current.\r\n\tsubtract: function (point) {\r\n\t\treturn this.clone()._subtract(toPoint(point));\r\n\t},\r\n\r\n\t_subtract: function (point) {\r\n\t\tthis.x -= point.x;\r\n\t\tthis.y -= point.y;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method divideBy(num: Number): Point\r\n\t// Returns the result of division of the current point by the given number.\r\n\tdivideBy: function (num) {\r\n\t\treturn this.clone()._divideBy(num);\r\n\t},\r\n\r\n\t_divideBy: function (num) {\r\n\t\tthis.x /= num;\r\n\t\tthis.y /= num;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method multiplyBy(num: Number): Point\r\n\t// Returns the result of multiplication of the current point by the given number.\r\n\tmultiplyBy: function (num) {\r\n\t\treturn this.clone()._multiplyBy(num);\r\n\t},\r\n\r\n\t_multiplyBy: function (num) {\r\n\t\tthis.x *= num;\r\n\t\tthis.y *= num;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method scaleBy(scale: Point): Point\r\n\t// Multiply each coordinate of the current point by each coordinate of\r\n\t// `scale`. In linear algebra terms, multiply the point by the\r\n\t// [scaling matrix](https://en.wikipedia.org/wiki/Scaling_%28geometry%29#Matrix_representation)\r\n\t// defined by `scale`.\r\n\tscaleBy: function (point) {\r\n\t\treturn new Point(this.x * point.x, this.y * point.y);\r\n\t},\r\n\r\n\t// @method unscaleBy(scale: Point): Point\r\n\t// Inverse of `scaleBy`. Divide each coordinate of the current point by\r\n\t// each coordinate of `scale`.\r\n\tunscaleBy: function (point) {\r\n\t\treturn new Point(this.x / point.x, this.y / point.y);\r\n\t},\r\n\r\n\t// @method round(): Point\r\n\t// Returns a copy of the current point with rounded coordinates.\r\n\tround: function () {\r\n\t\treturn this.clone()._round();\r\n\t},\r\n\r\n\t_round: function () {\r\n\t\tthis.x = Math.round(this.x);\r\n\t\tthis.y = Math.round(this.y);\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method floor(): Point\r\n\t// Returns a copy of the current point with floored coordinates (rounded down).\r\n\tfloor: function () {\r\n\t\treturn this.clone()._floor();\r\n\t},\r\n\r\n\t_floor: function () {\r\n\t\tthis.x = Math.floor(this.x);\r\n\t\tthis.y = Math.floor(this.y);\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method ceil(): Point\r\n\t// Returns a copy of the current point with ceiled coordinates (rounded up).\r\n\tceil: function () {\r\n\t\treturn this.clone()._ceil();\r\n\t},\r\n\r\n\t_ceil: function () {\r\n\t\tthis.x = Math.ceil(this.x);\r\n\t\tthis.y = Math.ceil(this.y);\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method distanceTo(otherPoint: Point): Number\r\n\t// Returns the cartesian distance between the current and the given points.\r\n\tdistanceTo: function (point) {\r\n\t\tpoint = toPoint(point);\r\n\r\n\t\tvar x = point.x - this.x,\r\n\t\t    y = point.y - this.y;\r\n\r\n\t\treturn Math.sqrt(x * x + y * y);\r\n\t},\r\n\r\n\t// @method equals(otherPoint: Point): Boolean\r\n\t// Returns `true` if the given point has the same coordinates.\r\n\tequals: function (point) {\r\n\t\tpoint = toPoint(point);\r\n\r\n\t\treturn point.x === this.x &&\r\n\t\t       point.y === this.y;\r\n\t},\r\n\r\n\t// @method contains(otherPoint: Point): Boolean\r\n\t// Returns `true` if both coordinates of the given point are less than the corresponding current point coordinates (in absolute values).\r\n\tcontains: function (point) {\r\n\t\tpoint = toPoint(point);\r\n\r\n\t\treturn Math.abs(point.x) <= Math.abs(this.x) &&\r\n\t\t       Math.abs(point.y) <= Math.abs(this.y);\r\n\t},\r\n\r\n\t// @method toString(): String\r\n\t// Returns a string representation of the point for debugging purposes.\r\n\ttoString: function () {\r\n\t\treturn 'Point(' +\r\n\t\t        formatNum(this.x) + ', ' +\r\n\t\t        formatNum(this.y) + ')';\r\n\t}\r\n};\r\n\r\n// @factory L.point(x: Number, y: Number, round?: Boolean)\r\n// Creates a Point object with the given `x` and `y` coordinates. If optional `round` is set to true, rounds the `x` and `y` values.\r\n\r\n// @alternative\r\n// @factory L.point(coords: Number[])\r\n// Expects an array of the form `[x, y]` instead.\r\n\r\n// @alternative\r\n// @factory L.point(coords: Object)\r\n// Expects a plain object of the form `{x: Number, y: Number}` instead.\r\nexport function toPoint(x, y, round) {\r\n\tif (x instanceof Point) {\r\n\t\treturn x;\r\n\t}\r\n\tif (isArray(x)) {\r\n\t\treturn new Point(x[0], x[1]);\r\n\t}\r\n\tif (x === undefined || x === null) {\r\n\t\treturn x;\r\n\t}\r\n\tif (typeof x === 'object' && 'x' in x && 'y' in x) {\r\n\t\treturn new Point(x.x, x.y);\r\n\t}\r\n\treturn new Point(x, y, round);\r\n}\r\n","import * as DomEvent from './DomEvent';\nimport * as Util from '../core/Util';\nimport * as Browser from '../core/Browser';\n\n/*\n * Extends L.DomEvent to provide touch support for Internet Explorer and Windows-based devices.\n */\n\n\nvar POINTER_DOWN =   Browser.msPointer ? 'MSPointerDown'   : 'pointerdown',\n    POINTER_MOVE =   Browser.msPointer ? 'MSPointerMove'   : 'pointermove',\n    POINTER_UP =     Browser.msPointer ? 'MSPointerUp'     : 'pointerup',\n    POINTER_CANCEL = Browser.msPointer ? 'MSPointerCancel' : 'pointercancel',\n    TAG_WHITE_LIST = ['INPUT', 'SELECT', 'OPTION'],\n\n    _pointers = {},\n    _pointerDocListener = false;\n\n// DomEvent.DoubleTap needs to know about this\nexport var _pointersCount = 0;\n\n// Provides a touch events wrapper for (ms)pointer events.\n// ref http://www.w3.org/TR/pointerevents/ https://www.w3.org/Bugs/Public/show_bug.cgi?id=22890\n\nexport function addPointerListener(obj, type, handler, id) {\n\tif (type === 'touchstart') {\n\t\t_addPointerStart(obj, handler, id);\n\n\t} else if (type === 'touchmove') {\n\t\t_addPointerMove(obj, handler, id);\n\n\t} else if (type === 'touchend') {\n\t\t_addPointerEnd(obj, handler, id);\n\t}\n\n\treturn this;\n}\n\nexport function removePointerListener(obj, type, id) {\n\tvar handler = obj['_leaflet_' + type + id];\n\n\tif (type === 'touchstart') {\n\t\tobj.removeEventListener(POINTER_DOWN, handler, false);\n\n\t} else if (type === 'touchmove') {\n\t\tobj.removeEventListener(POINTER_MOVE, handler, false);\n\n\t} else if (type === 'touchend') {\n\t\tobj.removeEventListener(POINTER_UP, handler, false);\n\t\tobj.removeEventListener(POINTER_CANCEL, handler, false);\n\t}\n\n\treturn this;\n}\n\nfunction _addPointerStart(obj, handler, id) {\n\tvar onDown = Util.bind(function (e) {\n\t\tif (e.pointerType !== 'mouse' && e.pointerType !== e.MSPOINTER_TYPE_MOUSE && e.pointerType !== e.MSPOINTER_TYPE_MOUSE) {\n\t\t\t// In IE11, some touch events needs to fire for form controls, or\n\t\t\t// the controls will stop working. We keep a whitelist of tag names that\n\t\t\t// need these events. For other target tags, we prevent default on the event.\n\t\t\tif (TAG_WHITE_LIST.indexOf(e.target.tagName) < 0) {\n\t\t\t\tDomEvent.preventDefault(e);\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t_handlePointer(e, handler);\n\t});\n\n\tobj['_leaflet_touchstart' + id] = onDown;\n\tobj.addEventListener(POINTER_DOWN, onDown, false);\n\n\t// need to keep track of what pointers and how many are active to provide e.touches emulation\n\tif (!_pointerDocListener) {\n\t\t// we listen documentElement as any drags that end by moving the touch off the screen get fired there\n\t\tdocument.documentElement.addEventListener(POINTER_DOWN, _globalPointerDown, true);\n\t\tdocument.documentElement.addEventListener(POINTER_MOVE, _globalPointerMove, true);\n\t\tdocument.documentElement.addEventListener(POINTER_UP, _globalPointerUp, true);\n\t\tdocument.documentElement.addEventListener(POINTER_CANCEL, _globalPointerUp, true);\n\n\t\t_pointerDocListener = true;\n\t}\n}\n\nfunction _globalPointerDown(e) {\n\t_pointers[e.pointerId] = e;\n\t_pointersCount++;\n}\n\nfunction _globalPointerMove(e) {\n\tif (_pointers[e.pointerId]) {\n\t\t_pointers[e.pointerId] = e;\n\t}\n}\n\nfunction _globalPointerUp(e) {\n\tdelete _pointers[e.pointerId];\n\t_pointersCount--;\n}\n\nfunction _handlePointer(e, handler) {\n\te.touches = [];\n\tfor (var i in _pointers) {\n\t\te.touches.push(_pointers[i]);\n\t}\n\te.changedTouches = [e];\n\n\thandler(e);\n}\n\nfunction _addPointerMove(obj, handler, id) {\n\tvar onMove = function (e) {\n\t\t// don't fire touch moves when mouse isn't down\n\t\tif ((e.pointerType === e.MSPOINTER_TYPE_MOUSE || e.pointerType === 'mouse') && e.buttons === 0) { return; }\n\n\t\t_handlePointer(e, handler);\n\t};\n\n\tobj['_leaflet_touchmove' + id] = onMove;\n\tobj.addEventListener(POINTER_MOVE, onMove, false);\n}\n\nfunction _addPointerEnd(obj, handler, id) {\n\tvar onUp = function (e) {\n\t\t_handlePointer(e, handler);\n\t};\n\n\tobj['_leaflet_touchend' + id] = onUp;\n\tobj.addEventListener(POINTER_UP, onUp, false);\n\tobj.addEventListener(POINTER_CANCEL, onUp, false);\n}\n\n","import * as Browser from '../core/Browser';\r\nimport {_pointersCount} from './DomEvent.Pointer';\r\n\r\n/*\r\n * Extends the event handling code with double tap support for mobile browsers.\r\n */\r\n\r\nvar _touchstart = Browser.msPointer ? 'MSPointerDown' : Browser.pointer ? 'pointerdown' : 'touchstart',\r\n    _touchend = Browser.msPointer ? 'MSPointerUp' : Browser.pointer ? 'pointerup' : 'touchend',\r\n    _pre = '_leaflet_';\r\n\r\n// inspired by Zepto touch code by Thomas Fuchs\r\nexport function addDoubleTapListener(obj, handler, id) {\r\n\tvar last, touch,\r\n\t    doubleTap = false,\r\n\t    delay = 250;\r\n\r\n\tfunction onTouchStart(e) {\r\n\t\tvar count;\r\n\r\n\t\tif (Browser.pointer) {\r\n\t\t\tif ((!Browser.edge) || e.pointerType === 'mouse') { return; }\r\n\t\t\tcount = _pointersCount;\r\n\t\t} else {\r\n\t\t\tcount = e.touches.length;\r\n\t\t}\r\n\r\n\t\tif (count > 1) { return; }\r\n\r\n\t\tvar now = Date.now(),\r\n\t\t    delta = now - (last || now);\r\n\r\n\t\ttouch = e.touches ? e.touches[0] : e;\r\n\t\tdoubleTap = (delta > 0 && delta <= delay);\r\n\t\tlast = now;\r\n\t}\r\n\r\n\tfunction onTouchEnd(e) {\r\n\t\tif (doubleTap && !touch.cancelBubble) {\r\n\t\t\tif (Browser.pointer) {\r\n\t\t\t\tif ((!Browser.edge) || e.pointerType === 'mouse') { return; }\r\n\t\t\t\t// work around .type being readonly with MSPointer* events\r\n\t\t\t\tvar newTouch = {},\r\n\t\t\t\t    prop, i;\r\n\r\n\t\t\t\tfor (i in touch) {\r\n\t\t\t\t\tprop = touch[i];\r\n\t\t\t\t\tnewTouch[i] = prop && prop.bind ? prop.bind(touch) : prop;\r\n\t\t\t\t}\r\n\t\t\t\ttouch = newTouch;\r\n\t\t\t}\r\n\t\t\ttouch.type = 'dblclick';\r\n\t\t\thandler(touch);\r\n\t\t\tlast = null;\r\n\t\t}\r\n\t}\r\n\r\n\tobj[_pre + _touchstart + id] = onTouchStart;\r\n\tobj[_pre + _touchend + id] = onTouchEnd;\r\n\tobj[_pre + 'dblclick' + id] = handler;\r\n\r\n\tobj.addEventListener(_touchstart, onTouchStart, false);\r\n\tobj.addEventListener(_touchend, onTouchEnd, false);\r\n\r\n\t// On some platforms (notably, chrome<55 on win10 + touchscreen + mouse),\r\n\t// the browser doesn't fire touchend/pointerup events but does fire\r\n\t// native dblclicks. See #4127.\r\n\t// Edge 14 also fires native dblclicks, but only for pointerType mouse, see #5180.\r\n\tobj.addEventListener('dblclick', handler, false);\r\n\r\n\treturn this;\r\n}\r\n\r\nexport function removeDoubleTapListener(obj, id) {\r\n\tvar touchstart = obj[_pre + _touchstart + id],\r\n\t    touchend = obj[_pre + _touchend + id],\r\n\t    dblclick = obj[_pre + 'dblclick' + id];\r\n\r\n\tobj.removeEventListener(_touchstart, touchstart, false);\r\n\tobj.removeEventListener(_touchend, touchend, false);\r\n\tif (!Browser.edge) {\r\n\t\tobj.removeEventListener('dblclick', dblclick, false);\r\n\t}\r\n\r\n\treturn this;\r\n}\r\n","import {Point} from '../geometry/Point';\r\nimport * as Util from '../core/Util';\r\nimport * as Browser from '../core/Browser';\r\nimport {addPointerListener, removePointerListener} from './DomEvent.Pointer';\r\nimport {addDoubleTapListener, removeDoubleTapListener} from './DomEvent.DoubleTap';\r\n\r\n/*\r\n * @namespace DomEvent\r\n * Utility functions to work with the [DOM events](https://developer.mozilla.org/docs/Web/API/Event), used by Leaflet internally.\r\n */\r\n\r\n// Inspired by John Resig, Dean Edwards and YUI addEvent implementations.\r\n\r\n// @function on(el: HTMLElement, types: String, fn: Function, context?: Object): this\r\n// Adds a listener function (`fn`) to a particular DOM event type of the\r\n// element `el`. You can optionally specify the context of the listener\r\n// (object the `this` keyword will point to). You can also pass several\r\n// space-separated types (e.g. `'click dblclick'`).\r\n\r\n// @alternative\r\n// @function on(el: HTMLElement, eventMap: Object, context?: Object): this\r\n// Adds a set of type/listener pairs, e.g. `{click: onClick, mousemove: onMouseMove}`\r\nexport function on(obj, types, fn, context) {\r\n\r\n\tif (typeof types === 'object') {\r\n\t\tfor (var type in types) {\r\n\t\t\taddOne(obj, type, types[type], fn);\r\n\t\t}\r\n\t} else {\r\n\t\ttypes = Util.splitWords(types);\r\n\r\n\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\taddOne(obj, types[i], fn, context);\r\n\t\t}\r\n\t}\r\n\r\n\treturn this;\r\n}\r\n\r\nvar eventsKey = '_leaflet_events';\r\n\r\n// @function off(el: HTMLElement, types: String, fn: Function, context?: Object): this\r\n// Removes a previously added listener function. If no function is specified,\r\n// it will remove all the listeners of that particular DOM event from the element.\r\n// Note that if you passed a custom context to on, you must pass the same\r\n// context to `off` in order to remove the listener.\r\n\r\n// @alternative\r\n// @function off(el: HTMLElement, eventMap: Object, context?: Object): this\r\n// Removes a set of type/listener pairs, e.g. `{click: onClick, mousemove: onMouseMove}`\r\n\r\n// @alternative\r\n// @function off(el: HTMLElement): this\r\n// Removes all known event listeners\r\nexport function off(obj, types, fn, context) {\r\n\r\n\tif (typeof types === 'object') {\r\n\t\tfor (var type in types) {\r\n\t\t\tremoveOne(obj, type, types[type], fn);\r\n\t\t}\r\n\t} else if (types) {\r\n\t\ttypes = Util.splitWords(types);\r\n\r\n\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\tremoveOne(obj, types[i], fn, context);\r\n\t\t}\r\n\t} else {\r\n\t\tfor (var j in obj[eventsKey]) {\r\n\t\t\tremoveOne(obj, j, obj[eventsKey][j]);\r\n\t\t}\r\n\t\tdelete obj[eventsKey];\r\n\t}\r\n}\r\n\r\nfunction addOne(obj, type, fn, context) {\r\n\tvar id = type + Util.stamp(fn) + (context ? '_' + Util.stamp(context) : '');\r\n\r\n\tif (obj[eventsKey] && obj[eventsKey][id]) { return this; }\r\n\r\n\tvar handler = function (e) {\r\n\t\treturn fn.call(context || obj, e || window.event);\r\n\t};\r\n\r\n\tvar originalHandler = handler;\r\n\r\n\tif (Browser.pointer && type.indexOf('touch') === 0) {\r\n\t\t// Needs DomEvent.Pointer.js\r\n\t\taddPointerListener(obj, type, handler, id);\r\n\r\n\t} else if (Browser.touch && (type === 'dblclick') && addDoubleTapListener &&\r\n\t           !(Browser.pointer && Browser.chrome)) {\r\n\t\t// Chrome >55 does not need the synthetic dblclicks from addDoubleTapListener\r\n\t\t// See #5180\r\n\t\taddDoubleTapListener(obj, handler, id);\r\n\r\n\t} else if ('addEventListener' in obj) {\r\n\r\n\t\tif (type === 'mousewheel') {\r\n\t\t\tobj.addEventListener('onwheel' in obj ? 'wheel' : 'mousewheel', handler, false);\r\n\r\n\t\t} else if ((type === 'mouseenter') || (type === 'mouseleave')) {\r\n\t\t\thandler = function (e) {\r\n\t\t\t\te = e || window.event;\r\n\t\t\t\tif (isExternalTarget(obj, e)) {\r\n\t\t\t\t\toriginalHandler(e);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tobj.addEventListener(type === 'mouseenter' ? 'mouseover' : 'mouseout', handler, false);\r\n\r\n\t\t} else {\r\n\t\t\tif (type === 'click' && Browser.android) {\r\n\t\t\t\thandler = function (e) {\r\n\t\t\t\t\tfilterClick(e, originalHandler);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tobj.addEventListener(type, handler, false);\r\n\t\t}\r\n\r\n\t} else if ('attachEvent' in obj) {\r\n\t\tobj.attachEvent('on' + type, handler);\r\n\t}\r\n\r\n\tobj[eventsKey] = obj[eventsKey] || {};\r\n\tobj[eventsKey][id] = handler;\r\n}\r\n\r\nfunction removeOne(obj, type, fn, context) {\r\n\r\n\tvar id = type + Util.stamp(fn) + (context ? '_' + Util.stamp(context) : ''),\r\n\t    handler = obj[eventsKey] && obj[eventsKey][id];\r\n\r\n\tif (!handler) { return this; }\r\n\r\n\tif (Browser.pointer && type.indexOf('touch') === 0) {\r\n\t\tremovePointerListener(obj, type, id);\r\n\r\n\t} else if (Browser.touch && (type === 'dblclick') && removeDoubleTapListener) {\r\n\t\tremoveDoubleTapListener(obj, id);\r\n\r\n\t} else if ('removeEventListener' in obj) {\r\n\r\n\t\tif (type === 'mousewheel') {\r\n\t\t\tobj.removeEventListener('onwheel' in obj ? 'wheel' : 'mousewheel', handler, false);\r\n\r\n\t\t} else {\r\n\t\t\tobj.removeEventListener(\r\n\t\t\t\ttype === 'mouseenter' ? 'mouseover' :\r\n\t\t\t\ttype === 'mouseleave' ? 'mouseout' : type, handler, false);\r\n\t\t}\r\n\r\n\t} else if ('detachEvent' in obj) {\r\n\t\tobj.detachEvent('on' + type, handler);\r\n\t}\r\n\r\n\tobj[eventsKey][id] = null;\r\n}\r\n\r\n// @function stopPropagation(ev: DOMEvent): this\r\n// Stop the given event from propagation to parent elements. Used inside the listener functions:\r\n// ```js\r\n// L.DomEvent.on(div, 'click', function (ev) {\r\n// \tL.DomEvent.stopPropagation(ev);\r\n// });\r\n// ```\r\nexport function stopPropagation(e) {\r\n\r\n\tif (e.stopPropagation) {\r\n\t\te.stopPropagation();\r\n\t} else if (e.originalEvent) {  // In case of Leaflet event.\r\n\t\te.originalEvent._stopped = true;\r\n\t} else {\r\n\t\te.cancelBubble = true;\r\n\t}\r\n\tskipped(e);\r\n\r\n\treturn this;\r\n}\r\n\r\n// @function disableScrollPropagation(el: HTMLElement): this\r\n// Adds `stopPropagation` to the element's `'mousewheel'` events (plus browser variants).\r\nexport function disableScrollPropagation(el) {\r\n\treturn addOne(el, 'mousewheel', stopPropagation);\r\n}\r\n\r\n// @function disableClickPropagation(el: HTMLElement): this\r\n// Adds `stopPropagation` to the element's `'click'`, `'doubleclick'`,\r\n// `'mousedown'` and `'touchstart'` events (plus browser variants).\r\nexport function disableClickPropagation(el) {\r\n\ton(el, 'mousedown touchstart dblclick', stopPropagation);\r\n\taddOne(el, 'click', fakeStop);\r\n\treturn this;\r\n}\r\n\r\n// @function preventDefault(ev: DOMEvent): this\r\n// Prevents the default action of the DOM Event `ev` from happening (such as\r\n// following a link in the href of the a element, or doing a POST request\r\n// with page reload when a `<form>` is submitted).\r\n// Use it inside listener functions.\r\nexport function preventDefault(e) {\r\n\tif (e.preventDefault) {\r\n\t\te.preventDefault();\r\n\t} else {\r\n\t\te.returnValue = false;\r\n\t}\r\n\treturn this;\r\n}\r\n\r\n// @function stop(ev): this\r\n// Does `stopPropagation` and `preventDefault` at the same time.\r\nexport function stop(e) {\r\n\tpreventDefault(e);\r\n\tstopPropagation(e);\r\n\treturn this;\r\n}\r\n\r\n// @function getMousePosition(ev: DOMEvent, container?: HTMLElement): Point\r\n// Gets normalized mouse position from a DOM event relative to the\r\n// `container` or to the whole page if not specified.\r\nexport function getMousePosition(e, container) {\r\n\tif (!container) {\r\n\t\treturn new Point(e.clientX, e.clientY);\r\n\t}\r\n\r\n\tvar rect = container.getBoundingClientRect();\r\n\r\n\treturn new Point(\r\n\t\te.clientX - rect.left - container.clientLeft,\r\n\t\te.clientY - rect.top - container.clientTop);\r\n}\r\n\r\n// Chrome on Win scrolls double the pixels as in other platforms (see #4538),\r\n// and Firefox scrolls device pixels, not CSS pixels\r\nvar wheelPxFactor =\r\n\t(Browser.win && Browser.chrome) ? 2 :\r\n\tBrowser.gecko ? window.devicePixelRatio : 1;\r\n\r\n// @function getWheelDelta(ev: DOMEvent): Number\r\n// Gets normalized wheel delta from a mousewheel DOM event, in vertical\r\n// pixels scrolled (negative if scrolling down).\r\n// Events from pointing devices without precise scrolling are mapped to\r\n// a best guess of 60 pixels.\r\nexport function getWheelDelta(e) {\r\n\treturn (Browser.edge) ? e.wheelDeltaY / 2 : // Don't trust window-geometry-based delta\r\n\t       (e.deltaY && e.deltaMode === 0) ? -e.deltaY / wheelPxFactor : // Pixels\r\n\t       (e.deltaY && e.deltaMode === 1) ? -e.deltaY * 20 : // Lines\r\n\t       (e.deltaY && e.deltaMode === 2) ? -e.deltaY * 60 : // Pages\r\n\t       (e.deltaX || e.deltaZ) ? 0 :\t// Skip horizontal/depth wheel events\r\n\t       e.wheelDelta ? (e.wheelDeltaY || e.wheelDelta) / 2 : // Legacy IE pixels\r\n\t       (e.detail && Math.abs(e.detail) < 32765) ? -e.detail * 20 : // Legacy Moz lines\r\n\t       e.detail ? e.detail / -32765 * 60 : // Legacy Moz pages\r\n\t       0;\r\n}\r\n\r\nvar skipEvents = {};\r\n\r\nexport function fakeStop(e) {\r\n\t// fakes stopPropagation by setting a special event flag, checked/reset with skipped(e)\r\n\tskipEvents[e.type] = true;\r\n}\r\n\r\nexport function skipped(e) {\r\n\tvar events = skipEvents[e.type];\r\n\t// reset when checking, as it's only used in map container and propagates outside of the map\r\n\tskipEvents[e.type] = false;\r\n\treturn events;\r\n}\r\n\r\n// check if element really left/entered the event target (for mouseenter/mouseleave)\r\nexport function isExternalTarget(el, e) {\r\n\r\n\tvar related = e.relatedTarget;\r\n\r\n\tif (!related) { return true; }\r\n\r\n\ttry {\r\n\t\twhile (related && (related !== el)) {\r\n\t\t\trelated = related.parentNode;\r\n\t\t}\r\n\t} catch (err) {\r\n\t\treturn false;\r\n\t}\r\n\treturn (related !== el);\r\n}\r\n\r\nvar lastClick;\r\n\r\n// this is a horrible workaround for a bug in Android where a single touch triggers two click events\r\nfunction filterClick(e, handler) {\r\n\tvar timeStamp = (e.timeStamp || (e.originalEvent && e.originalEvent.timeStamp)),\r\n\t    elapsed = lastClick && (timeStamp - lastClick);\r\n\r\n\t// are they closer together than 500ms yet more than 100ms?\r\n\t// Android typically triggers them ~300ms apart while multiple listeners\r\n\t// on the same event should be triggered far faster;\r\n\t// or check if click is simulated on the element, and if it is, reject any non-simulated events\r\n\r\n\tif ((elapsed && elapsed > 100 && elapsed < 500) || (e.target._simulatedClick && !e._simulated)) {\r\n\t\tstop(e);\r\n\t\treturn;\r\n\t}\r\n\tlastClick = timeStamp;\r\n\r\n\thandler(e);\r\n}\r\n\r\n// @function addListener(…): this\r\n// Alias to [`L.DomEvent.on`](#domevent-on)\r\nexport {on as addListener};\r\n\r\n// @function removeListener(…): this\r\n// Alias to [`L.DomEvent.off`](#domevent-off)\r\nexport {off as removeListener};\r\n","import * as DomEvent from './DomEvent';\nimport * as Util from '../core/Util';\nimport {Point} from '../geometry/Point';\nimport * as Browser from '../core/Browser';\n\n/*\n * @namespace DomUtil\n *\n * Utility functions to work with the [DOM](https://developer.mozilla.org/docs/Web/API/Document_Object_Model)\n * tree, used by Leaflet internally.\n *\n * Most functions expecting or returning a `HTMLElement` also work for\n * SVG elements. The only difference is that classes refer to CSS classes\n * in HTML and SVG classes in SVG.\n */\n\n if (!Element.prototype.matches) {\n    var ep = Element.prototype;\n \n    if (ep.webkitMatchesSelector) // Chrome <34, SF<7.1, iOS<8\n      ep.matches = ep.webkitMatchesSelector;\n \n    if (ep.msMatchesSelector) // IE9/10/11 & Edge\n      ep.matches = ep.msMatchesSelector;\n \n    if (ep.mozMatchesSelector) // FF<34\n      ep.matches = ep.mozMatchesSelector;\n }\n\n// @property TRANSFORM: String\n// Vendor-prefixed fransform style name (e.g. `'webkitTransform'` for WebKit).\nexport var TRANSFORM = testProp(\n    ['transform', 'WebkitTransform', 'OTransform', 'MozTransform', 'msTransform']);\n\n// webkitTransition comes first because some browser versions that drop vendor prefix don't do\n// the same for the transitionend event, in particular the Android 4.1 stock browser\n\n// @property TRANSITION: String\n// Vendor-prefixed transform style name.\nexport var TRANSITION = testProp(\n    ['webkitTransition', 'transition', 'OTransition', 'MozTransition', 'msTransition']);\n\nexport var TRANSITION_END =\n    TRANSITION === 'webkitTransition' || TRANSITION === 'OTransition' ? TRANSITION + 'End' : 'transitionend';\n\n\n// @function get(id: String|HTMLElement): HTMLElement\n// Returns an element given its DOM id, or returns the element itself\n// if it was passed directly.\nexport function get(id) {\n    return typeof id === 'string' ? document.getElementById(id) : id;\n}\n\n// @function getStyle(el: HTMLElement, styleAttrib: String): String\n// Returns the value for a certain style attribute on an element,\n// including computed values or values set through CSS.\nexport function getStyle(el, style) {\n    var value = el.style[style] || (el.currentStyle && el.currentStyle[style]);\n\n    if ((!value || value === 'auto') && document.defaultView) {\n        var css = document.defaultView.getComputedStyle(el, null);\n        value = css ? css[style] : null;\n    }\n    return value === 'auto' ? null : value;\n}\n\n// @function create(tagName: String, className?: String, container?: HTMLElement): HTMLElement\n// Creates an HTML element with `tagName`, sets its class to `className`, and optionally appends it to `container` element.\nexport function create(tagName, className, container) {\n    var el = document.createElement(tagName);\n    el.className = className || '';\n\n    if (container) {\n        container.appendChild(el);\n    }\n    return el;\n}\n\n// @function remove(el: HTMLElement)\n// Removes `el` from its parent element\nexport function remove(el) {\n    var parent = el.parentNode;\n    if (parent) {\n        parent.removeChild(el);\n    }\n}\n\n// @function empty(el: HTMLElement)\n// Removes all of `el`'s children elements from `el`\nexport function empty(el) {\n    while (el.firstChild) {\n        el.removeChild(el.firstChild);\n    }\n}\n\n// @function toFront(el: HTMLElement)\n// Makes `el` the last child of its parent, so it renders in front of the other children.\nexport function toFront(el) {\n    el.parentNode.appendChild(el);\n}\n\n// @function toBack(el: HTMLElement)\n// Makes `el` the first child of its parent, so it renders behind the other children.\nexport function toBack(el) {\n    var parent = el.parentNode;\n    parent.insertBefore(el, parent.firstChild);\n}\n\n// @function hasClass(el: HTMLElement, name: String): Boolean\n// Returns `true` if the element's class attribute contains `name`.\nexport function hasClass(el, name) {\n    if (el.classList !== undefined) {\n        return el.classList.contains(name);\n    }\n    var className = getClass(el);\n    return className.length > 0 && new RegExp('(^|\\\\s)' + name + '(\\\\s|$)').test(className);\n}\n\n// @function addClass(el: HTMLElement, name: String)\n// Adds `name` to the element's class attribute.\nexport function addClass(el, name) {\n    if (el.classList !== undefined) {\n        var classes = Util.splitWords(name);\n        for (var i = 0, len = classes.length; i < len; i++) {\n            el.classList.add(classes[i]);\n        }\n    } else if (!hasClass(el, name)) {\n        var className = getClass(el);\n        setClass(el, (className ? className + ' ' : '') + name);\n    }\n}\n\n// @function removeClass(el: HTMLElement, name: String)\n// Removes `name` from the element's class attribute.\nexport function removeClass(el, name) {\n    if (el.classList !== undefined) {\n        el.classList.remove(name);\n    } else {\n        setClass(el, Util.trim((' ' + getClass(el) + ' ').replace(' ' + name + ' ', ' ')));\n    }\n}\n\n// @function setClass(el: HTMLElement, name: String)\n// Sets the element's class.\nexport function setClass(el, name) {\n    if (el.className.baseVal === undefined) {\n        el.className = name;\n    } else {\n        // in case of SVG element\n        el.className.baseVal = name;\n    }\n}\n\n// @function getClass(el: HTMLElement): String\n// Returns the element's class.\nexport function getClass(el) {\n    return el.className.baseVal === undefined ? el.className : el.className.baseVal;\n}\n\n// @function setOpacity(el: HTMLElement, opacity: Number)\n// Set the opacity of an element (including old IE support).\n// `opacity` must be a number from `0` to `1`.\nexport function setOpacity(el, value) {\n    if ('opacity' in el.style) {\n        el.style.opacity = value;\n    } else if ('filter' in el.style) {\n        _setOpacityIE(el, value);\n    }\n}\n\nfunction _setOpacityIE(el, value) {\n    var filter = false,\n        filterName = 'DXImageTransform.Microsoft.Alpha';\n\n    // filters collection throws an error if we try to retrieve a filter that doesn't exist\n    try {\n        filter = el.filters.item(filterName);\n    } catch (e) {\n        // don't set opacity to 1 if we haven't already set an opacity,\n        // it isn't needed and breaks transparent pngs.\n        if (value === 1) { return; }\n    }\n\n    value = Math.round(value * 100);\n\n    if (filter) {\n        filter.Enabled = (value !== 100);\n        filter.Opacity = value;\n    } else {\n        el.style.filter += ' progid:' + filterName + '(opacity=' + value + ')';\n    }\n}\n\n// @function testProp(props: String[]): String|false\n// Goes through the array of style names and returns the first name\n// that is a valid style name for an element. If no such name is found,\n// it returns false. Useful for vendor-prefixed styles like `transform`.\nexport function testProp(props) {\n    var style = document.documentElement.style;\n\n    for (var i = 0; i < props.length; i++) {\n        if (props[i] in style) {\n            return props[i];\n        }\n    }\n    return false;\n}\n\nexport function isPropertySupported(prop) {\n    var style = document.documentElement.style;\n    return prop in style;\n}\n\n// @function setTransform(el: HTMLElement, offset: Point, scale?: Number)\n// Resets the 3D CSS transform of `el` so it is translated by `offset` pixels\n// and optionally scaled by `scale`. Does not have an effect if the\n// browser doesn't support 3D CSS transforms.\nexport function setTransform(el, offset, scale) {\n    var pos = offset || new Point(0, 0);\n\n    el.style[TRANSFORM] =\n        (Browser.ie3d ?\n            'translate(' + pos.x + 'px,' + pos.y + 'px)' :\n            'translate3d(' + pos.x + 'px,' + pos.y + 'px,0)') +\n        (scale ? ' scale(' + scale + ')' : '');\n}\n\n// @function setPosition(el: HTMLElement, position: Point)\n// Sets the position of `el` to coordinates specified by `position`,\n// using CSS translate or top/left positioning depending on the browser\n// (used by Leaflet internally to position its layers).\nexport function setPosition(el, point) {\n\n    /*eslint-disable */\n    el._leaflet_pos = point;\n    /*eslint-enable */\n\n    if (Browser.any3d) {\n        setTransform(el, point);\n    } else {\n        el.style.left = point.x + 'px';\n        el.style.top = point.y + 'px';\n    }\n}\n\n// @function getPosition(el: HTMLElement): Point\n// Returns the coordinates of an element previously positioned with setPosition.\nexport function getPosition(el) {\n    // this method is only used for elements previously positioned using setPosition,\n    // so it's safe to cache the position for performance\n\n    return el._leaflet_pos || new Point(0, 0);\n}\n\n// @function disableTextSelection()\n// Prevents the user from generating `selectstart` DOM events, usually generated\n// when the user drags the mouse through a page with text. Used internally\n// by Leaflet to override the behaviour of any click-and-drag interaction on\n// the map. Affects drag interactions on the whole document.\n\n// @function enableTextSelection()\n// Cancels the effects of a previous [`L.DomUtil.disableTextSelection`](#domutil-disabletextselection).\nexport var disableTextSelection;\nexport var enableTextSelection;\nvar _userSelect;\nif ('onselectstart' in document) {\n    disableTextSelection = function () {\n        DomEvent.on(window, 'selectstart', DomEvent.preventDefault);\n    };\n    enableTextSelection = function () {\n        DomEvent.off(window, 'selectstart', DomEvent.preventDefault);\n    };\n} else {\n    var userSelectProperty = testProp(\n        ['userSelect', 'WebkitUserSelect', 'OUserSelect', 'MozUserSelect', 'msUserSelect']);\n\n    disableTextSelection = function () {\n        if (userSelectProperty) {\n            var style = document.documentElement.style;\n            _userSelect = style[userSelectProperty];\n            style[userSelectProperty] = 'none';\n        }\n    };\n    enableTextSelection = function () {\n        if (userSelectProperty) {\n            document.documentElement.style[userSelectProperty] = _userSelect;\n            _userSelect = undefined;\n        }\n    };\n}\n\n// @function disableImageDrag()\n// As [`L.DomUtil.disableTextSelection`](#domutil-disabletextselection), but\n// for `dragstart` DOM events, usually generated when the user drags an image.\nexport function disableImageDrag() {\n    DomEvent.on(window, 'dragstart', DomEvent.preventDefault);\n}\n\n// @function enableImageDrag()\n// Cancels the effects of a previous [`L.DomUtil.disableImageDrag`](#domutil-disabletextselection).\nexport function enableImageDrag() {\n    DomEvent.off(window, 'dragstart', DomEvent.preventDefault);\n}\n\nvar _outlineElement, _outlineStyle;\n// @function preventOutline(el: HTMLElement)\n// Makes the [outline](https://developer.mozilla.org/docs/Web/CSS/outline)\n// of the element `el` invisible. Used internally by Leaflet to prevent\n// focusable elements from displaying an outline when the user performs a\n// drag interaction on them.\nexport function preventOutline(element) {\n    while (element.tabIndex === -1) {\n        element = element.parentNode;\n    }\n    if (!element || !element.style) { return; }\n    restoreOutline();\n    _outlineElement = element;\n    _outlineStyle = element.style.outline;\n    element.style.outline = 'none';\n    DomEvent.on(window, 'keydown', restoreOutline);\n}\n\n// @function restoreOutline()\n// Cancels the effects of a previous [`L.DomUtil.preventOutline`]().\nexport function restoreOutline() {\n    if (!_outlineElement) { return; }\n    _outlineElement.style.outline = _outlineStyle;\n    _outlineElement = undefined;\n    _outlineStyle = undefined;\n    DomEvent.off(window, 'keydown', restoreOutline);\n}\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var baseGetTag = require('./_baseGetTag'),\n    isObject = require('./isObject');\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nmodule.exports = isFunction;\n","var root = require('./_root');\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nmodule.exports = coreJsData;\n","var coreJsData = require('./_coreJsData');\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nmodule.exports = isMasked;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nmodule.exports = toSource;\n","var isFunction = require('./isFunction'),\n    isMasked = require('./_isMasked'),\n    isObject = require('./isObject'),\n    toSource = require('./_toSource');\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nmodule.exports = baseIsNative;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nmodule.exports = getValue;\n","var baseIsNative = require('./_baseIsNative'),\n    getValue = require('./_getValue');\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nmodule.exports = getNative;\n","var getNative = require('./_getNative');\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nmodule.exports = defineProperty;\n","var defineProperty = require('./_defineProperty');\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\nmodule.exports = baseAssignValue;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nmodule.exports = eq;\n","var baseAssignValue = require('./_baseAssignValue'),\n    eq = require('./eq');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nmodule.exports = assignValue;\n","var assignValue = require('./_assignValue'),\n    baseAssignValue = require('./_baseAssignValue');\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property identifiers to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @param {Function} [customizer] The function to customize copied values.\n * @returns {Object} Returns `object`.\n */\nfunction copyObject(source, props, object, customizer) {\n  var isNew = !object;\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n\n    var newValue = customizer\n      ? customizer(object[key], source[key], key, object, source)\n      : undefined;\n\n    if (newValue === undefined) {\n      newValue = source[key];\n    }\n    if (isNew) {\n      baseAssignValue(object, key, newValue);\n    } else {\n      assignValue(object, key, newValue);\n    }\n  }\n  return object;\n}\n\nmodule.exports = copyObject;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nmodule.exports = identity;\n","/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\nmodule.exports = apply;\n","var apply = require('./_apply');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * A specialized version of `baseRest` which transforms the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @param {Function} transform The rest array transform.\n * @returns {Function} Returns the new function.\n */\nfunction overRest(func, start, transform) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = transform(array);\n    return apply(func, this, otherArgs);\n  };\n}\n\nmodule.exports = overRest;\n","/**\n * Creates a function that returns `value`.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {*} value The value to return from the new function.\n * @returns {Function} Returns the new constant function.\n * @example\n *\n * var objects = _.times(2, _.constant({ 'a': 1 }));\n *\n * console.log(objects);\n * // => [{ 'a': 1 }, { 'a': 1 }]\n *\n * console.log(objects[0] === objects[1]);\n * // => true\n */\nfunction constant(value) {\n  return function() {\n    return value;\n  };\n}\n\nmodule.exports = constant;\n","var constant = require('./constant'),\n    defineProperty = require('./_defineProperty'),\n    identity = require('./identity');\n\n/**\n * The base implementation of `setToString` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar baseSetToString = !defineProperty ? identity : function(func, string) {\n  return defineProperty(func, 'toString', {\n    'configurable': true,\n    'enumerable': false,\n    'value': constant(string),\n    'writable': true\n  });\n};\n\nmodule.exports = baseSetToString;\n","/** Used to detect hot functions by number of calls within a span of milliseconds. */\nvar HOT_COUNT = 800,\n    HOT_SPAN = 16;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeNow = Date.now;\n\n/**\n * Creates a function that'll short out and invoke `identity` instead\n * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n * milliseconds.\n *\n * @private\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new shortable function.\n */\nfunction shortOut(func) {\n  var count = 0,\n      lastCalled = 0;\n\n  return function() {\n    var stamp = nativeNow(),\n        remaining = HOT_SPAN - (stamp - lastCalled);\n\n    lastCalled = stamp;\n    if (remaining > 0) {\n      if (++count >= HOT_COUNT) {\n        return arguments[0];\n      }\n    } else {\n      count = 0;\n    }\n    return func.apply(undefined, arguments);\n  };\n}\n\nmodule.exports = shortOut;\n","var baseSetToString = require('./_baseSetToString'),\n    shortOut = require('./_shortOut');\n\n/**\n * Sets the `toString` method of `func` to return `string`.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar setToString = shortOut(baseSetToString);\n\nmodule.exports = setToString;\n","var identity = require('./identity'),\n    overRest = require('./_overRest'),\n    setToString = require('./_setToString');\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  return setToString(overRest(func, start, identity), func + '');\n}\n\nmodule.exports = baseRest;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nmodule.exports = isLength;\n","var isFunction = require('./isFunction'),\n    isLength = require('./isLength');\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nmodule.exports = isArrayLike;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  length = length == null ? MAX_SAFE_INTEGER : length;\n  return !!length &&\n    (typeof value == 'number' || reIsUint.test(value)) &&\n    (value > -1 && value % 1 == 0 && value < length);\n}\n\nmodule.exports = isIndex;\n","var eq = require('./eq'),\n    isArrayLike = require('./isArrayLike'),\n    isIndex = require('./_isIndex'),\n    isObject = require('./isObject');\n\n/**\n * Checks if the given arguments are from an iteratee call.\n *\n * @private\n * @param {*} value The potential iteratee value argument.\n * @param {*} index The potential iteratee index or key argument.\n * @param {*} object The potential iteratee object argument.\n * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n *  else `false`.\n */\nfunction isIterateeCall(value, index, object) {\n  if (!isObject(object)) {\n    return false;\n  }\n  var type = typeof index;\n  if (type == 'number'\n        ? (isArrayLike(object) && isIndex(index, object.length))\n        : (type == 'string' && index in object)\n      ) {\n    return eq(object[index], value);\n  }\n  return false;\n}\n\nmodule.exports = isIterateeCall;\n","var baseRest = require('./_baseRest'),\n    isIterateeCall = require('./_isIterateeCall');\n\n/**\n * Creates a function like `_.assign`.\n *\n * @private\n * @param {Function} assigner The function to assign values.\n * @returns {Function} Returns the new assigner function.\n */\nfunction createAssigner(assigner) {\n  return baseRest(function(object, sources) {\n    var index = -1,\n        length = sources.length,\n        customizer = length > 1 ? sources[length - 1] : undefined,\n        guard = length > 2 ? sources[2] : undefined;\n\n    customizer = (assigner.length > 3 && typeof customizer == 'function')\n      ? (length--, customizer)\n      : undefined;\n\n    if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n      customizer = length < 3 ? undefined : customizer;\n      length = 1;\n    }\n    object = Object(object);\n    while (++index < length) {\n      var source = sources[index];\n      if (source) {\n        assigner(object, source, index, customizer);\n      }\n    }\n    return object;\n  });\n}\n\nmodule.exports = createAssigner;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nmodule.exports = isPrototype;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nmodule.exports = baseTimes;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nmodule.exports = baseIsArguments;\n","var baseIsArguments = require('./_baseIsArguments'),\n    isObjectLike = require('./isObjectLike');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nmodule.exports = isArguments;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nmodule.exports = isArray;\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = stubFalse;\n","var root = require('./_root'),\n    stubFalse = require('./stubFalse');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nmodule.exports = isBuffer;\n","var baseGetTag = require('./_baseGetTag'),\n    isLength = require('./isLength'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nmodule.exports = baseIsTypedArray;\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nmodule.exports = baseUnary;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nmodule.exports = nodeUtil;\n","var baseIsTypedArray = require('./_baseIsTypedArray'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nmodule.exports = isTypedArray;\n","var baseTimes = require('./_baseTimes'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isIndex = require('./_isIndex'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayLikeKeys;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nmodule.exports = overArg;\n","var overArg = require('./_overArg');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nmodule.exports = nativeKeys;\n","var isPrototype = require('./_isPrototype'),\n    nativeKeys = require('./_nativeKeys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseKeys;\n","var arrayLikeKeys = require('./_arrayLikeKeys'),\n    baseKeys = require('./_baseKeys'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nmodule.exports = keys;\n","var assignValue = require('./_assignValue'),\n    copyObject = require('./_copyObject'),\n    createAssigner = require('./_createAssigner'),\n    isArrayLike = require('./isArrayLike'),\n    isPrototype = require('./_isPrototype'),\n    keys = require('./keys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns own enumerable string keyed properties of source objects to the\n * destination object. Source objects are applied from left to right.\n * Subsequent sources overwrite property assignments of previous sources.\n *\n * **Note:** This method mutates `object` and is loosely based on\n * [`Object.assign`](https://mdn.io/Object/assign).\n *\n * @static\n * @memberOf _\n * @since 0.10.0\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} [sources] The source objects.\n * @returns {Object} Returns `object`.\n * @see _.assignIn\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * function Bar() {\n *   this.c = 3;\n * }\n *\n * Foo.prototype.b = 2;\n * Bar.prototype.d = 4;\n *\n * _.assign({ 'a': 0 }, new Foo, new Bar);\n * // => { 'a': 1, 'c': 3 }\n */\nvar assign = createAssigner(function(object, source) {\n  if (isPrototype(source) || isArrayLike(source)) {\n    copyObject(source, keys(source), object);\n    return;\n  }\n  for (var key in source) {\n    if (hasOwnProperty.call(source, key)) {\n      assignValue(object, key, source[key]);\n    }\n  }\n});\n\nmodule.exports = assign;\n","var document = typeof window !== 'undefined' && typeof window.document !== 'undefined' ? window.document : {};\nvar keyboardAllowed = typeof Element !== 'undefined' && 'ALLOW_KEYBOARD_INPUT' in Element;\n\nvar fn = (function () {\n  var val;\n\n  var fnMap = [\n    [\n      'requestFullscreen',\n      'exitFullscreen',\n      'fullscreenElement',\n      'fullscreenEnabled',\n      'fullscreenchange',\n      'fullscreenerror'\n    ],\n    // New WebKit\n    [\n      'webkitRequestFullscreen',\n      'webkitExitFullscreen',\n      'webkitFullscreenElement',\n      'webkitFullscreenEnabled',\n      'webkitfullscreenchange',\n      'webkitfullscreenerror'\n\n    ],\n    // Old WebKit (Safari 5.1)\n    [\n      'webkitRequestFullScreen',\n      'webkitCancelFullScreen',\n      'webkitCurrentFullScreenElement',\n      'webkitCancelFullScreen',\n      'webkitfullscreenchange',\n      'webkitfullscreenerror'\n\n    ],\n    [\n      'mozRequestFullScreen',\n      'mozCancelFullScreen',\n      'mozFullScreenElement',\n      'mozFullScreenEnabled',\n      'mozfullscreenchange',\n      'mozfullscreenerror'\n    ],\n    [\n      'msRequestFullscreen',\n      'msExitFullscreen',\n      'msFullscreenElement',\n      'msFullscreenEnabled',\n      'MSFullscreenChange',\n      'MSFullscreenError'\n    ]\n  ];\n\n  var i = 0;\n  var l = fnMap.length;\n  var ret = {};\n\n  for (; i < l; i++) {\n    val = fnMap[i];\n    if (val && val[1] in document) {\n      for (i = 0; i < val.length; i++) {\n        ret[fnMap[0][i]] = val[i];\n      }\n      return ret;\n    }\n  }\n\n  return false;\n})();\n\nvar eventNameMap = {\n  change: fn.fullscreenchange,\n  error: fn.fullscreenerror\n};\n\nvar screenfull = {\n  request: function (elem) {\n    var request = fn.requestFullscreen;\n\n    elem = elem || document.documentElement;\n\n    // Work around Safari 5.1 bug: reports support for\n    // keyboard in fullscreen even though it doesn't.\n    // Browser sniffing, since the alternative with\n    // setTimeout is even worse.\n    if (/5\\.1[.\\d]* Safari/.test(navigator.userAgent)) {\n      elem[request]();\n    } else {\n      elem[request](keyboardAllowed && Element.ALLOW_KEYBOARD_INPUT);\n    }\n  },\n  exit: function () {\n    document[fn.exitFullscreen]();\n  },\n  toggle: function (elem) {\n    if (this.isFullscreen) {\n      this.exit();\n    } else {\n      this.request(elem);\n    }\n  },\n  onchange: function (callback) {\n    this.on('change', callback);\n  },\n  onerror: function (callback) {\n    this.on('error', callback);\n  },\n  on: function (event, callback) {\n    var eventName = eventNameMap[event];\n    if (eventName) {\n      document.addEventListener(eventName, callback, false);\n    }\n  },\n  off: function (event, callback) {\n    var eventName = eventNameMap[event];\n    if (eventName) {\n      document.removeEventListener(eventName, callback, false);\n    }\n  },\n  raw: fn\n};\n\nObject.defineProperties(screenfull, {\n  isFullscreen: {\n    get: function () {\n      return Boolean(document[fn.fullscreenElement]);\n    }\n  },\n  element: {\n    enumerable: true,\n    get: function () {\n      return document[fn.fullscreenElement];\n    }\n  },\n  enabled: {\n    enumerable: true,\n    get: function () {\n      // Coerce to boolean in case of old WebKit\n      return Boolean(document[fn.fullscreenEnabled]);\n    }\n  }\n});\n\nexport {screenfull};","import * as Util from '../core/Util';\nimport {Evented} from '../core/Events';\n// import {Class} from '../core/Class';\nimport * as Browser from '../core/Browser';\nimport * as DomEvent from '../dom/DomEvent';\nimport * as DomUtil from '../dom/DomUtil';\n\nimport debounce from 'lodash/debounce';\nimport assign from 'lodash/assign';\n\nimport {screenfull} from '../screenfull';\n\n/*\n * @class Reader\n * @aka cozy.Map\n * @inherits Evented\n *\n * The central class of the API — it is used to create a book on a page and manipulate it.\n *\n * @example\n *\n * ```js\n * // initialize the map on the \"map\" div with a given center and zoom\n * var map = L.map('map', {\n *  center: [51.505, -0.09],\n *  zoom: 13\n * });\n * ```\n *\n */\n\nvar _padding = 1.0;\nexport var Reader = Evented.extend({\n  options: {\n    regions: [\n      'header',\n      'toolbar.top',\n      'toolbar.left',\n      'main',\n      'toolbar.right',\n      'toolbar.bottom',\n      'footer'\n    ],\n    metadata: {},\n    flow: 'auto',\n    engine: 'epubjs',\n    fontSizeLarge: '140%',\n    fontSizeSmall: '90%',\n    fontSizeDefault: '100%',\n    trackResize: true,\n    text_size: 100,\n    mobileMediaQuery: '(min-device-width : 300px) and (max-device-width : 600px)',\n    forceScrolledDocHeight: 1200,\n    theme: 'default',\n    rootfilePath: '',\n    themes: []\n  },\n\n  initialize: function(id, options) {\n    var self = this\n\n    self._original_document_title = document.title;\n\n    if ( localStorage.getItem('cozy.options') ) {\n      options = assign(options, JSON.parse(localStorage.getItem('cozy.options')));\n    }\n    options = Util.setOptions(this, options);\n\n    this._checkFeatureCompatibility();\n\n    this.metadata = this.options.metadata; // initial seed\n\n    this._initContainer(id);\n    this._initLayout();\n\n    if ( this.options.themes && this.options.themes.length > 0 ) {\n        this.options.themes.forEach(function(theme) {\n            if ( theme.href ) { return; }\n            var klass = theme.klass;\n            var rules = {};\n            for(var rule in theme.rules) {\n                var new_rule = '.' + klass;\n                if ( rule == 'body' ) { new_rule = 'body' + new_rule; }\n                else { new_rule += ' ' + rule ; }\n                rules[new_rule] = theme.rules[rule];\n            }\n            theme.rules = rules;\n        });\n    }\n\n    this._updateTheme();\n\n    // hack for https://github.com/Leaflet/Leaflet/issues/1980\n    // this._onResize = Util.bind(this._onResize, this);\n\n    this._initEvents();\n\n    this.callInitHooks();\n\n    this._mode = this.options.mode;\n  },\n\n  start: function(target, cb) {\n    var self = this;\n\n    if ( typeof(target) == 'function' && cb === undefined ) {\n      cb = target;\n      target = undefined;\n    }\n\n    Util.loader.js(this.options.engine_href).then(function() {\n      self._start(target, cb);\n      self._loaded = true;\n    })\n  },\n\n  _start: function(target, cb) {\n    var self = this;\n    target = target || 0;\n\n    // self.open(function() {\n    //   self.draw(target, cb);\n    // });\n\n    self.open(target, cb);\n  },\n\n  reopen: function(options, target) {\n    /* NOP */\n  },\n\n  saveOptions: function(options) {\n    var saved_options = {};\n    assign(saved_options, options);\n    if ( saved_options.flow == 'auto' ) {\n      // do not save\n      delete saved_options.flow;\n    }\n    localStorage.setItem('cozy.options', JSON.stringify(saved_options));\n  },\n\n  _updateTheme: function() {\n    DomUtil.removeClass(this._container, 'cozy-theme-' + ( this._container.dataset.theme || 'default' ));\n    DomUtil.addClass(this._container, 'cozy-theme-' + this.options.theme);\n    this._container.dataset.theme = this.options.theme;\n  },\n\n  draw: function(target) {\n    // NOOP\n  },\n\n  next: function() {\n    // NOOP\n  },\n\n  prev: function() {\n    // NOOP\n  },\n\n  display: function(index) {\n    // NOOP\n  },\n\n  gotoPage: function(target) {\n    // NOOP\n  },\n\n  goBack: function() {\n    history.back();\n  },\n\n  goForward: function() {\n    history.forward();\n  },\n\n  requestFullscreen: function() {\n    if ( screenfull.enabled ) {\n      // this._preResize();\n      screenfull.toggle(this._container);\n    }\n  },\n\n  _preResize: function() {\n\n  },\n\n  _initContainer: function (id) {\n    var container = this._container = DomUtil.get(id);\n\n    if (!container) {\n      throw new Error('Reader container not found.');\n    } else if (container._cozy_id) {\n      throw new Error('Reader container is already initialized.');\n    }\n\n    DomEvent.on(container, 'scroll', this._onScroll, this);\n    this._containerId = Util.stamp(container);\n  },\n\n  _initLayout: function () {\n    var container = this._container;\n\n    this._fadeAnimated = this.options.fadeAnimation && Browser.any3d;\n\n    DomUtil.addClass(container, 'cozy-container' +\n      (Browser.touch ? ' cozy-touch' : '') +\n      (Browser.retina ? ' cozy-retina' : '') +\n      (Browser.ielt9 ? ' cozy-oldie' : '') +\n      (Browser.safari ? ' cozy-safari' : '') +\n      (this._fadeAnimated ? ' cozy-fade-anim' : '') +\n      ' cozy-engine-' + this.options.engine +\n      ' cozy-theme-' + this.options.theme);\n\n    var position = DomUtil.getStyle(container, 'position');\n\n    this._initPanes();\n\n    if ( ! Browser.columnCount ) {\n      this.options.flow = 'scrolled-doc';\n    }\n  },\n\n  _initPanes: function () {\n    var self = this;\n\n    var panes = this._panes = {};\n\n    var l = 'cozy-';\n    var container = this._container;\n\n    var prefix = 'cozy-module-';\n\n    DomUtil.addClass(container, 'cozy-container');\n    panes['top'] = DomUtil.create('div', prefix + 'top', container);\n    panes['main'] = DomUtil.create('div', prefix + 'main', container);\n    panes['bottom'] = DomUtil.create('div', prefix + 'bottom', container);\n\n    panes['left'] = DomUtil.create('div', prefix + 'left', panes['main']);\n    panes['book-cover'] = DomUtil.create('div', prefix + 'book-cover', panes['main']);\n    panes['right'] = DomUtil.create('div', prefix + 'right', panes['main']);\n    panes['book'] = DomUtil.create('div', prefix + 'book', panes['book-cover']);\n    panes['loader'] = DomUtil.create('div', prefix + 'book-loading', panes['book']);\n    panes['epub'] = DomUtil.create('div', prefix + 'book-epub', panes['book']);\n    this._initBookLoader();\n  },\n\n  _checkIfLoaded: function () {\n    if (!this._loaded) {\n      throw new Error('Set map center and zoom first.');\n    }\n  },\n\n  // DOM event handling\n\n  // @section Interaction events\n  _initEvents: function (remove) {\n    this._targets = {};\n    this._targets[Util.stamp(this._container)] = this;\n\n    this.tracking = function(reader) {\n      var _action = [];\n      var _last_location_start;\n      var _reader = reader;\n      return {\n        action: function(v) {\n          if ( v ) {\n            _action = [v];\n            this.event(v);\n            // _reader.fire('trackAction', { action: v })\n          } else {\n            return _action.pop();\n          }\n        },\n\n        event: function(action, data) {\n          if ( data == null ) { data = {}; }\n          data.action = action;\n          _reader.fire(\"trackAction\", data);\n        },\n\n        pageview: function(location) {\n          if ( location.start != _last_location_start ) {\n            _last_location_start = location.start;\n            // console.log(\"AHOY RELOCATED\", location, location.start, location.href, location.location, this.action());\n            _reader.fire('trackPageview', { cfi: location.start, href: location.href, action: this.action()})\n            return true;\n          }\n          return false;\n        }\n      }\n    }(this);\n\n    var onOff = remove ? DomEvent.off : DomEvent.on;\n\n    // @event click: MouseEvent\n    // Fired when the user clicks (or taps) the map.\n    // @event dblclick: MouseEvent\n    // Fired when the user double-clicks (or double-taps) the map.\n    // @event mousedown: MouseEvent\n    // Fired when the user pushes the mouse button on the map.\n    // @event mouseup: MouseEvent\n    // Fired when the user releases the mouse button on the map.\n    // @event mouseover: MouseEvent\n    // Fired when the mouse enters the map.\n    // @event mouseout: MouseEvent\n    // Fired when the mouse leaves the map.\n    // @event mousemove: MouseEvent\n    // Fired while the mouse moves over the map.\n    // @event contextmenu: MouseEvent\n    // Fired when the user pushes the right mouse button on the map, prevents\n    // default browser context menu from showing if there are listeners on\n    // this event. Also fired on mobile when the user holds a single touch\n    // for a second (also called long press).\n    // @event keypress: KeyboardEvent\n    // Fired when the user presses a key from the keyboard while the map is focused.\n    // onOff(this._container, 'click dblclick mousedown mouseup ' +\n    //   'mouseover mouseout mousemove contextmenu keypress', this._handleDOMEvent, this);\n\n    // if (this.options.trackResize) {\n    //   var self = this;\n    //   var fn = debounce(function(){ self.invalidateSize({}); }, 150);\n    //   onOff(window, 'resize', fn, this);\n    // }\n\n    if (Browser.any3d && this.options.transform3DLimit) {\n      (remove ? this.off : this.on).call(this, 'moveend', this._onMoveEnd);\n    }\n\n    var self = this;\n    if (screenfull.enabled) {\n      screenfull.on('change', function() {\n        // setTimeout(function() {\n        //   self.invalidateSize({});\n        // }, 100);\n        console.log('AHOY: Am I fullscreen?', screenfull.isFullscreen ? 'YES' : 'NO');\n      });\n    }\n\n    self.on(\"updateLocation\", function(location) {\n      var location_href = location.start;\n\n      if ( self._ignoreHistory ) {\n        self._ignoreHistory = false;\n        return;\n      }\n\n      if ( self.tracking.pageview(location) ) {\n        var tmp_href = window.location.href.split(\"#\");\n        tmp_href[1] = location.start.substr(8, location.start.length - 8 - 1);\n        history.pushState({ cfi: location.start }, '', tmp_href.join('#'));\n\n        if ( location.percentage ) {\n          var p = Math.ceil(location.percentage * 100);\n          document.title = `${self._original_document_title} - ${p}%`;\n        }        \n      }\n    })\n\n    window.addEventListener('popstate', function(event) {\n      if ( event.isTrusted && event.state !== null ) {\n        self._ignoreHistory = true;\n        self.gotoPage(event.state.cfi);\n      }\n    })\n\n    document.addEventListener('keydown', function(event) {\n      var keyName = event.key;\n      var target = event.target;\n\n      // check if the activeElement is \".special-panel\"\n      var check = document.activeElement;\n      while ( check.localName != 'body' ) {\n        if ( check.classList.contains('special-panel') ) {\n          return;\n        }\n        check = check.parentElement;\n      }\n\n      var IGNORE_TARGETS = [ 'input', 'target' ];\n      if ( IGNORE_TARGETS.indexOf(target.localName) >= 0 ) {\n        return;\n      }\n\n      self.fire('keyDown', { keyName: keyName, shiftKey: event.shiftKey });\n    });\n\n    self.on('keyDown', function(data) {\n      switch(data.keyName) {\n        case 'ArrowRight':\n        case 'PageDown':\n          self.next();\n          break;\n        case 'ArrowLeft':\n        case 'PageUp':\n          self.prev();\n          break;\n        case 'Home':\n          self._scroll('HOME');\n          break;\n        case 'End':\n          self._scroll('END')\n          break;\n      }\n    });\n  },\n\n  // _onResize: function() {\n  //   if ( ! this._resizeRequest ) {\n  //     this._resizeRequest = Util.requestAnimFrame(function() {\n  //       this.invalidateSize({})\n  //     }, this);\n  //   }\n  // },\n\n  _onScroll: function () {\n    this._container.scrollTop  = 0;\n    this._container.scrollLeft = 0;\n  },\n\n  _handleDOMEvent: function (e) {\n    if (!this._loaded || DomEvent.skipped(e)) { return; }\n\n    var type = e.type === 'keypress' && e.keyCode === 13 ? 'click' : e.type;\n\n    if (type === 'mousedown') {\n      // prevents outline when clicking on keyboard-focusable element\n      DomUtil.preventOutline(e.target || e.srcElement);\n    }\n\n    this._fireDOMEvent(e, type);\n  },\n\n  _fireDOMEvent: function (e, type, targets) {\n\n    if (e.type === 'click') {\n      // Fire a synthetic 'preclick' event which propagates up (mainly for closing popups).\n      // @event preclick: MouseEvent\n      // Fired before mouse click on the map (sometimes useful when you\n      // want something to happen on click before any existing click\n      // handlers start running).\n      var synth = Util.extend({}, e);\n      synth.type = 'preclick';\n      this._fireDOMEvent(synth, synth.type, targets);\n    }\n\n    if (e._stopped) { return; }\n\n    // Find the layer the event is propagating from and its parents.\n    targets = (targets || []).concat(this._findEventTargets(e, type));\n\n    if (!targets.length) { return; }\n\n    var target = targets[0];\n    if (type === 'contextmenu' && target.listens(type, true)) {\n      DomEvent.preventDefault(e);\n    }\n\n    var data = {\n      originalEvent: e\n    };\n\n    if (e.type !== 'keypress') {\n      var isMarker = (target.options && 'icon' in target.options);\n      data.containerPoint = isMarker ?\n          this.latLngToContainerPoint(target.getLatLng()) : this.mouseEventToContainerPoint(e);\n      data.layerPoint = this.containerPointToLayerPoint(data.containerPoint);\n      data.latlng = isMarker ? target.getLatLng() : this.layerPointToLatLng(data.layerPoint);\n    }\n\n    for (var i = 0; i < targets.length; i++) {\n      targets[i].fire(type, data, true);\n      if (data.originalEvent._stopped ||\n        (targets[i].options.nonBubblingEvents && Util.indexOf(targets[i].options.nonBubblingEvents, type) !== -1)) { return; }\n    }\n  },\n\n  getFixedBookPanelSize: function() {\n    // have to make the book\n    var style = window.getComputedStyle(this._panes['book']);\n    var h = this._panes['book'].clientHeight - parseFloat(style.paddingTop) - parseFloat(style.paddingBottom);\n    var w = this._panes['book'].clientWidth - parseFloat(style.paddingRight) - parseFloat(style.paddingLeft);\n    return { height: Math.floor(h * 1.00), width: Math.floor(w * 1.00) };\n  },\n\n  invalidateSize: function(options) {\n    // TODO: IS THIS EVER USED?\n    var self = this;\n\n    if ( ! self._drawn ) { return; }\n\n    Util.cancelAnimFrame(this._resizeRequest);\n\n    if (! this._loaded) { return this; }\n\n    this.fire('resized');\n  },\n\n  _resizeBookPane: function() {\n\n  },\n\n  _setupHooks: function() {\n\n  },\n\n  _checkFeatureCompatibility: function() {\n    if ( ! DomUtil.isPropertySupported('columnCount') || this._checkMobileDevice() ) {\n      // force\n      this.options.flow = 'scrolled-doc';\n    }\n    if ( this._checkMobileDevice() ) {\n      // this.options.fontSizeLarge = '160%';\n      // this.options.fontSizeSmall ='100%';\n      // this.options.fontSizeDefault = '120%';\n      this.options.text_size = 120;\n    }\n  },\n\n  _checkMobileDevice: function() {\n    if ( this._isMobile === undefined ) {\n      this._isMobile = false;\n      if ( this.options.mobileMediaQuery ) {\n        this._isMobile = window.matchMedia(this.options.mobileMediaQuery).matches;\n      }\n    }\n    return this._isMobile;\n  },\n\n  _enableBookLoader: function(delay=0) {\n    var self = this;\n    self._clearBookLoaderTimeout();\n    if ( delay < 0 ) {\n      delay = 0;\n      self._force_progress = true;\n    }\n    self._loader_timeout = setTimeout(function() {\n      self._panes['loader'].style.display = 'block';\n    }, delay);\n  },\n\n  _disableBookLoader: function(force=false) {\n    var self = this;\n    self._clearBookLoaderTimeout();\n    if ( ! self._force_progress || force ) {\n      self._panes['loader'].style.display = 'none';\n      self._force_progress = false;\n      self._panes['loader-status'].innerHTML = '';\n    }\n  },\n\n  _clearBookLoaderTimeout: function() {\n    var self = this;\n    if ( self._loader_timeout ) {\n      clearTimeout(self._loader_timeout);\n      self._loader_timeout = null;\n    }\n  },\n\n  _initBookLoader: function() {\n    // is this not awesome?\n    var template = this.options.loader_template || this.loaderTemplate();\n\n    var body = new DOMParser().parseFromString(template, \"text/html\").body;\n    while ( body.children.length ) {\n      this._panes['loader'].appendChild(body.children[0]);\n    }\n    this._panes['loader-status'] = DomUtil.create('div', 'cozy-module-book-loading-status', this._panes['loader']);\n  },\n\n  loaderTemplate: function() {\n    return `<div class=\"cozy-loader-spinner\">\n    <div class=\"spinner-backdrop spinner-backdrop--1\"></div>\n    <div class=\"spinner-backdrop spinner-backdrop--2\"></div>\n    <div class=\"spinner-backdrop spinner-backdrop--3\"></div>\n    <div class=\"spinner-backdrop spinner-backdrop--4\"></div>\n    <div class=\"spinner-quarter spinner-quarter--1\"></div>\n    <div class=\"spinner-quarter spinner-quarter--2\"></div>\n    <div class=\"spinner-quarter spinner-quarter--3\"></div>\n    <div class=\"spinner-quarter spinner-quarter--4\"></div>\n  </div>`;\n  },\n\n  EOT: true\n});\n\nexport function createReader(id, options) {\n  return new Reader(id, options);\n}\n","import {Class} from '../core/Class';\nimport {Reader} from '../reader/Reader';\nimport * as Util from '../core/Util';\nimport * as DomUtil from '../dom/DomUtil';\n\n/*\n * @class Control\n * @aka L.Control\n * @inherits Class\n *\n * L.Control is a base class for implementing reader controls. Handles regioning.\n * All other controls extend from this class.\n */\n\nexport var Control = Class.extend({\n    // @section\n    // @aka Control options\n    options: {\n        // @option region: String = 'topright'\n        // The region of the control (one of the reader corners). Possible values are `'topleft'`,\n        // `'topright'`, `'bottomleft'` or `'bottomright'`\n    },\n\n    initialize: function (options) {\n        Util.setOptions(this, options);\n        if ( options.container ) {\n            this._container = options.container;\n            this._locked = true;\n        }\n        this._id = (new Date()).getTime() + '-' + parseInt(Math.random((new Date()).getTime()) * 1000, 10);\n    },\n\n    /* @section\n     * Classes extending L.Control will inherit the following methods:\n     *\n     * @method getRegion: string\n     * Returns the region of the control.\n     */\n    getRegion: function () {\n        return this.options.region;\n    },\n\n    // @method setRegion(region: string): this\n    // Sets the region of the control.\n    setRegion: function (region) {\n        var reader = this._reader;\n\n        if (reader) {\n            reader.removeControl(this);\n        }\n\n        this.options.region = region;\n\n        if (reader) {\n            reader.addControl(this);\n        }\n\n        return this;\n    },\n\n    // @method getContainer: HTMLElement\n    // Returns the HTMLElement that contains the control.\n    getContainer: function () {\n        return this._container;\n    },\n\n    // @method addTo(reader: Map): this\n    // Adds the control to the given reader.\n    addTo: function (reader) {\n        this.remove();\n        this._reader = reader;\n\n        var container = this._container = this.onAdd(reader);\n\n        DomUtil.addClass(container, 'cozy-control');\n\n        if ( ! this._locked ) {\n            var region = this.getRegion();\n            var area = reader.getControlRegion(region);\n            area.appendChild(container);\n        }\n\n        return this;\n    },\n\n    // @method remove: this\n    // Removes the control from the reader it is currently active on.\n    remove: function () {\n        if (!this._reader) {\n            return this;\n        }\n\n        if (! this._container) {\n            return this;\n        }\n\n        if ( ! this._locked ) {\n            DomUtil.remove(this._container);\n        }\n\n        if (this.onRemove) {\n            this.onRemove(this._reader);\n        }\n\n        this._reader = null;\n\n        return this;\n    },\n\n    _refocusOnMap: function (e) {\n        // if reader exists and event is not a keyboard event\n        if (this._reader && e && e.screenX > 0 && e.screenY > 0) {\n            this._reader.getContainer().focus();\n        }\n    },\n\n    _className: function(widget) {\n        var className = [ 'cozy-control' ];\n        if ( this.options.direction ) {\n            className.push('cozy-control-' + this.options.direction);\n        }\n        if ( widget ) {\n            className.push('cozy-control-' + widget);\n        }\n        return className.join(' ');\n    }\n});\n\nexport var control = function (options) {\n    return new Control(options);\n};\n\n/* @section Extension methods\n * @uninheritable\n *\n * Every control should extend from `L.Control` and (re-)implement the following methods.\n *\n * @method onAdd(reader: Map): HTMLElement\n * Should return the container DOM element for the control and add listeners on relevant reader events. Called on [`control.addTo(reader)`](#control-addTo).\n *\n * @method onRemove(reader: Map)\n * Optional method. Should contain all clean up code that removes the listeners previously added in [`onAdd`](#control-onadd). Called on [`control.remove()`](#control-remove).\n */\n\n/* @namespace Map\n * @section Methods for Layers and Controls\n */\nReader.include({\n    // @method addControl(control: Control): this\n    // Adds the given control to the reader\n    addControl: function (control) {\n        control.addTo(this);\n        return this;\n    },\n\n    // @method removeControl(control: Control): this\n    // Removes the given control from the reader\n    removeControl: function (control) {\n        control.remove();\n        return this;\n    },\n\n    getControlContainer: function() {\n        var l = 'cozy-';\n        if ( ! this._controlContainer ) {\n            this._controlContainer =\n                DomUtil.create('div', l + 'control-container', this._container);\n        }\n        return this._controlContainer;\n    },\n\n    getControlRegion: function (target) {\n\n        if ( ! this._panes[target] ) {\n            // target is dot-delimited string\n            // first dot is the panel\n            var parts = target.split('.');\n            var tmp = [];\n            var parent = this._container;\n            var x = 0;\n            while ( parts.length ) {\n                var slug = parts.shift();\n                tmp.push(slug);\n                var panel = tmp.join(\".\");\n                var className = 'cozy-panel-' + slug;\n                if ( ! this._panes[panel] ) {\n                    this._panes[panel] = DomUtil.create('div', className, parent);\n                }\n                parent = this._panes[panel];\n                x += 1;\n                if ( x > 100 ) { break; }\n            }\n        }\n        return this._panes[target];\n    },\n\n    getControlRegion_1: function (target) {\n\n        var tmp = target.split('.');\n        var region = tmp.shift();\n        var slot = tmp.pop() || '-slot';\n\n        var container = this._panes[region];\n        if ( ! this._panes[target] ) {\n            var className = 'cozy-' + region + '--item cozy-slot-' + slot\n            if ( ! this._panes[region + '.' + slot] ) {\n                var div = DomUtil.create('div', className);\n                if ( slot == 'left' || slot == 'bottom' ) {\n                    var childElement = this._panes[region].firstChild;\n                    this._panes[region].insertBefore(div, childElement);\n                } else {\n                    this._panes[region].appendChild(div);\n                }\n                this._panes[region + '.' + slot] = div;\n            }\n            className = this._classify(tmp);\n            this._panes[target] = DomUtil.create('div', className, this._panes[region + '.' + slot]);\n        }\n\n        return this._panes[target];\n    },\n\n    _classify: function(tmp) {\n        var l = 'cozy-';\n        var className = [];\n        for(var i in tmp) {\n            className.push(l + tmp[i]);\n        }\n        className = className.join(' ');\n        return className;\n    },\n\n    _clearControlRegion: function () {\n        for (var i in this._controlRegions) {\n            DomUtil.remove(this._controlRegions[i]);\n        }\n        DomUtil.remove(this._controlContainer);\n        delete this._controlRegions;\n        delete this._controlContainer;\n    }\n});\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nvar PageControl = Control.extend({\n  onAdd: function(reader) {\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n      container = DomUtil.create('div', className),\n\n      this._control  = this._createButton(this._fill(options.html || options.label), this._fill(options.label),\n              className, container);\n    }\n    this._bindEvents();\n\n    return container;\n  },\n\n  _createButton: function (html, title, className, container) {\n    var link = DomUtil.create('a', className, container);\n    link.innerHTML = html;\n    link.href = '#';\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    return link;\n  },\n\n  _bindEvents: function() {\n    var self = this;\n    DomEvent.disableClickPropagation(this._control);\n    DomEvent.on(this._control, 'click', DomEvent.stop);\n    DomEvent.on(this._control, 'click', this._action, this);\n\n    this._reader.on('reopen', function(data) {\n      // update the button text / titles\n      var html = self.options.html || self.options.label;\n      self._control.innerHTML = self._fill(html);\n      self._control.setAttribute('title', self._fill(self.options.label));\n      self._control.setAttribute('aria-label', self._fill(self.options.label));\n    });\n\n  },\n\n  _unit: function() {\n    return ( this._reader.options.flow == 'scrolled-doc' ) ? 'Section' : 'Page';\n  },\n\n  _fill: function(s) {\n    var unit = this._unit();\n    return s.replace(/\\$\\{unit\\}/g, unit);\n  },\n\n  _label: function() {\n    return this.options.label + \" \" + ( this._reader.options.flow == 'scrolled-doc' ) ? 'Section' : 'Page';\n  },\n\n  EOT: true\n});\n\nexport var PagePrevious = PageControl.extend({\n  options: {\n    region: 'edge.left',\n    direction: 'previous',\n    label: 'Previous ${unit}',\n    html: '<i class=\"icon-chevron-left oi\" data-glyph=\"chevron-left\" title=\"Previous ${unit}\" aria-hidden=\"true\"></i>'\n  },\n\n  _action: function(e) {\n    this._reader.prev();\n  }\n});\n\nexport var PageNext = PageControl.extend({\n  options: {\n    region: 'edge.right',\n    direction: 'next',\n    label: 'Next ${unit}',\n    html: '<i class=\"icon-chevron-right oi\" data-glyph=\"chevron-right\" title=\"Next ${unit}\" aria-hidden=\"true\"></i>'\n  },\n\n  _action: function(e) {\n    this._reader.next();\n  }\n});\n\nexport var PageFirst = PageControl.extend({\n  options: {\n    direction: 'first',\n    label: 'First ${unit}'\n  },\n  _action: function(e) {\n      this._reader.first();\n  }\n});\n\nexport var PageLast = PageControl.extend({\n  options: {\n    direction: 'last',\n    label: 'Last ${unit}'\n  },\n  _action: function(e) {\n      this._reader.last();\n  }\n});\n\nexport var pageNext = function(options) {\n  return new PageNext(options);\n}\n\nexport var pagePrevious = function(options) {\n  return new PagePrevious(options);\n}\n\nexport var pageFirst = function(options) {\n  return new PageFirst(options);\n}\n\nexport var pageLast = function(options) {\n  return new PageLast(options);\n}\n","import {Class} from '../core/Class';\nimport {Reader} from '../reader/Reader';\nimport * as Util from '../core/Util';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nimport assign from 'lodash/assign';\n\nvar activeModal;\nvar dismissModalListener = false;\n\n// from https://github.com/ghosh/micromodal/blob/master/src/index.js\nconst FOCUSABLE_ELEMENTS = [\n    'a[href]',\n    'area[href]',\n    'input:not([disabled]):not([type=\"hidden\"])',\n    'select:not([disabled])',\n    'textarea:not([disabled])',\n    'button:not([disabled])',\n    'iframe',\n    'object',\n    'embed',\n    '[contenteditable]',\n    '[tabindex]:not([tabindex^=\"-\"])'\n  ];\n\nconst ACTIONABLE_ELEMENTS = [\n    'a[href]',\n    'area[href]',\n    'input[type=\"submit\"]:not([disabled])',\n    'button:not([disabled])'\n  ];\n\nexport var Modal = Class.extend({\n  options: {\n    // @option region: String = 'topright'\n    // The region of the control (one of the reader edges). Possible values are `'left' ad 'right'`\n    region: 'left',\n    fraction: 0,\n    width: null,\n    className: {},\n    actions: null,\n    callbacks: { onShow: function() {}, onClose: function() {} },\n    handlers: {}\n  },\n\n  initialize: function (options) {\n    options = Util.setOptions(this, options);\n    this._id = (new Date()).getTime() + '-' + parseInt(Math.random((new Date()).getTime()) * 1000, 10);\n    this._initializedEvents = false;\n    this.callbacks = assign({}, this.options.callbacks);\n    this.actions = this.options.actions ? assign({}, this.options.actions) : null;\n    this.handlers = assign({}, this.options.handlers);\n    if ( typeof(this.options.className) == 'string' ) {\n      this.options.className = { container: this.options.className };\n    }\n  },\n\n  addTo: function(reader) {\n    var self = this;\n    this._reader = reader;\n    var template = this.options.template;\n\n    var panelHTML = `<div class=\"cozy-modal modal-slide ${this.options.region || 'left'}\" id=\"modal-${this._id}\" aria-labelledby=\"modal-${this._id}-title\" role=\"dialog\" aria-describedby=\"modal-${this._id}-content\" aria-hidden=\"true\">\n      <div class=\"modal__overlay\" tabindex=\"-1\" data-modal-close>\n        <div class=\"modal__container ${this.options.className.container ? this.options.className.container : ''}\" role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"modal-${this._id}-title\" aria-describedby=\"modal-${this._id}-content\" id=\"modal-${this._id}-container\">\n          <div role=\"document\">\n            <header class=\"modal__header\">\n              <h3 class=\"modal__title\" id=\"modal-${this._id}-title\">${this.options.title}</h3>\n              <button class=\"modal__close\" aria-label=\"Close modal\" aria-controls=\"modal-${this._id}-container\" data-modal-close></button>\n            </header>\n            <main class=\"modal__content ${this.options.className.main ? this.options.className.main : ''}\" id=\"modal-${this._id}-content\">\n              ${template}\n            </main>`;\n\n    if ( this.options.actions ) {\n      panelHTML += '<footer class=\"modal__footer\">'\n      for(var i in this.options.actions) {\n        var action = this.options.actions[i];\n        var button_cls = action.className || 'button--default';\n        panelHTML += `<button id=\"action-${this._id}-${i}\" class=\"button button--lg ${button_cls}\">${action.label}</button>`;\n      }\n      panelHTML += '</footer>';\n    }\n\n    panelHTML += '</div></div></div></div>';\n\n    var body = new DOMParser().parseFromString(panelHTML, \"text/html\").body;\n\n    this.modal = reader._container.appendChild(body.children[0]);\n    this._container = this.modal; // compatibility\n\n    this.container = this.modal.querySelector('.modal__container');\n    this._bindEvents();\n    return this;\n  },\n\n  _bindEvents: function() {\n    var self = this;\n    this.onClick = this.onClick.bind(this);\n    this.onKeydown = this.onKeydown.bind(this);\n    this.onModalTransition = this.onModalTransition.bind(this);\n\n    this.modal.addEventListener('transitionend', function() {\n    }.bind(this));\n\n    // bind any actions\n    if ( this.actions ) {\n      for(var i in this.actions) {\n        let action = this.actions[i];\n        let button_id = '#action-' + this._id + '-' + i;\n        let button = this.modal.querySelector(button_id);\n        if ( button ) {\n          DomEvent.on(button, 'click', function(event) {\n            event.preventDefault();\n            action.callback(event);\n            if ( action.close ) {\n              self.closeModal();\n            }\n          })\n        }\n      }\n    }\n  },\n\n  deactivate: function() {\n    this.closeModal();\n  },\n\n  closeModal: function() {\n    var self = this;\n    this.modal.setAttribute('aria-hidden', 'true');\n    this.removeEventListeners();\n    if ( this.activeElement ) {\n      this.activeElement.focus();\n    }\n    this.callbacks.onClose(this.modal);\n  },\n\n  showModal: function() {\n    this.activeElement = document.activeElement\n    this._resize();\n    this.modal.setAttribute('aria-hidden', 'false')\n    this.setFocusToFirstNode()\n    this.addEventListeners()\n    this.callbacks.onShow(this.modal)\n  },\n\n  activate: function() {\n    return this.showModal();\n    var self = this;\n    activeModal = this;\n    DomUtil.addClass(self._reader._container, 'st-modal-activating');\n    this._resize();\n    DomUtil.addClass(this._reader._container, 'st-modal-open');\n    setTimeout(function() {\n      DomUtil.addClass(self._container, 'active');\n      DomUtil.removeClass(self._reader._container, 'st-modal-activating');\n      self._container.setAttribute('aria-hidden', 'false');\n      self.setFocusToFirstNode();\n    }, 25);\n  },\n\n  addEventListeners: function () {\n    // --- do we need touch listeners?\n    // this.modal.addEventListener('touchstart', this.onClick)\n    // this.modal.addEventListener('touchend', this.onClick)\n    this.modal.addEventListener('click', this.onClick)\n    document.addEventListener('keydown', this.onKeydown)\n    'webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend'.split(' ').forEach(function(event) {\n      this.modal.addEventListener(event, this.onModalTransition);\n    }.bind(this))\n  },\n\n  removeEventListeners: function () {\n    this.modal.removeEventListener('touchstart', this.onClick)\n    this.modal.removeEventListener('click', this.onClick)\n    'webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend'.split(' ').forEach(function(event) {\n      this.modal.removeEventListener(event, this.onModalTransition);\n    }.bind(this))\n    document.removeEventListener('keydown', this.onKeydown)\n  },\n\n  _resize: function() {\n    var container = this._reader._container;\n    this.container.style.height = container.offsetHeight + 'px';\n    console.log(\"AHOY MODAL\", this.container.style.height);\n    if ( ! this.options.className.container  ) {\n      this.container.style.width = this.options.width || parseInt(container.offsetWidth * this.options.fraction) + 'px';\n    }\n\n    var header = this.container.querySelector('header');\n    var footer = this.container.querySelector('footer');\n    var main = this.container.querySelector('main');\n    var height = this.container.clientHeight - header.clientHeight;\n    if ( footer ) {\n      height -= footer.clientHeight;\n    }\n    main.style.height = height + 'px';\n  },\n\n  getFocusableNodes: function() {\n    const nodes = this.modal.querySelectorAll(FOCUSABLE_ELEMENTS);\n    return Object.keys(nodes).map((key) => nodes[key]);\n  },\n\n  setFocusToFirstNode: function() {\n    var focusableNodes = this.getFocusableNodes();\n    if ( focusableNodes.length ) {\n      focusableNodes[0].focus();\n    } else {\n      activeModal._container.focus();\n    }\n  },\n\n  getActionableNodes: function() {\n    const nodes = this.modal.querySelectorAll(ACTIONABLE_ELEMENTS);\n    return Object.keys(nodes).map((key) => nodes[key]);\n  },\n\n  onKeydown: function(event) {\n    if ( event.keyCode == 27 ) { this.closeModal(); }\n    if ( event.keyCode == 9 ) {\n      this.maintainFocus(event);\n    }\n  },\n\n  onClick: function(event) {\n\n    var closeAfterAction = false;\n    var target = event.target;\n\n    // As far as I can tell, the code below isn't catching direct clicks on\n    // items with class='data-modal-close' as they're not ACTIONABLE_ELEMENTS.\n    // Adding them to ACTIONABLE_ELEMENTS causes undesirable behavior where\n    // their child items also close the modal thanks to the loop below.\n    // Children of .modal__overlay include the modal header, border area and\n    // padding. We don't want clicks on these closing the modal.\n    // Just close the modal now for direct clicks on a '.data-modal-close'.\n    if (target.hasAttribute('data-modal-close')) {\n      this.fire('closed');\n      this.closeModal();\n      return;\n    }\n\n    // if the target isn't an actionable type, walk the DOM until\n    // one is found\n    var actionableNodes = this.getActionableNodes();\n    while ( actionableNodes.indexOf(target) < 0 && target != this.modal ) {\n      target = target.parentElement;\n    }\n\n    // no target found, punt\n    if ( actionableNodes.indexOf(target) < 0 ) {\n      return;\n    }\n\n    if (this.handlers.click) {\n      var did_match = false;\n      for(var selector in this.handlers.click) {\n        if ( target.matches(selector) ) {\n          closeAfterAction = this.handlers.click[selector](this, target);\n          break;\n        }\n      }\n    }\n\n    if (closeAfterAction || target.hasAttribute('data-modal-close')) this.closeModal();\n\n    event.preventDefault();\n  },\n\n  onModalTransition: function(event) {\n    if ( this.modal.getAttribute('aria-hidden') == 'true' ) {\n      this._reader.fire('modal-closed');\n    } else {\n      this._reader.fire('modal-opened');\n    }\n  },\n\n  on: function(event, selector, handler) {\n    if (! this.handlers[event] ) {\n      this.handlers[event] = {};\n    }\n    if (typeof(selector) == 'function') {\n      handler = selector;\n      selector = '*';\n    }\n    this.handlers[event][selector] = handler;\n  },\n\n  fire: function(event) {\n    if ( this.handlers[event] && this.handlers[event]['*'] ) {\n      this.handlers[event]['*'](this);\n    }\n  },\n\n  maintainFocus: function(event) {\n    var focusableNodes = this.getFocusableNodes();\n    var focusedItemIndex = focusableNodes.indexOf(document.activeElement);\n    if (event.shiftKey && focusedItemIndex === 0) {\n      focusableNodes[focusableNodes.length - 1].focus()\n      event.preventDefault()\n    }\n\n    if (!event.shiftKey && focusedItemIndex === focusableNodes.length - 1) {\n      focusableNodes[0].focus()\n      event.preventDefault()\n    }\n  },\n\n  EOT: true\n});\n\nReader.include({\n  modal: function (options) {\n    var modal = new Modal(options);\n    return modal.addTo(this);\n    // return this;\n  },\n\n  EOT: true\n});\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport {Modal} from './Modal';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Contents = Control.extend({\n\n  defaultTemplate: `<button class=\"button--sm\" data-toggle=\"open\" aria-label=\"Table of Contents\"><i class=\"icon-menu oi\" data-glyph=\"menu\" title=\"Table of Contents\" aria-hidden=\"true\"></i></button>`,\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    this._control.setAttribute('id', 'action-' + this._id);\n    container.style.position = 'relative';\n\n    this._reader.on('updateContents', function(data) {\n\n      DomEvent.on(this._control, 'click', function(event) {\n        event.preventDefault();\n        self._reader.tracking.action('contents/open');\n        self._modal.activate();\n      }, this)\n\n      this._modal = this._reader.modal({\n        template: '<ul></ul>',\n        title: 'Contents',\n        region: 'left',\n        className: 'cozy-modal-contents'\n      });\n\n      this._modal.on('click', 'a[href]', function(modal, target) {\n        target = target.getAttribute('data-href');\n        this._reader.tracking.action('contents/go');\n        this._reader.gotoPage(target);\n        return true;\n      }.bind(this))\n\n      this._modal.on('closed', function() {\n        self._reader.tracking.action('contents/close');\n      })\n\n      this._setupSkipLink();\n\n      var parent = self._modal._container.querySelector('ul');\n      // var s = data.toc.filter(function(value) { return value.parent == null }).map(function(value) { return [ value, 0, parent ] });\n      // while ( s.length ) {\n      //   var tuple = s.shift();\n      //   var chapter = tuple[0];\n      //   var tabindex = tuple[1];\n      //   var parent = tuple[2];\n\n      //   var option = self._createOption(chapter, tabindex, parent);\n      //   data.toc.filter(function(value) { return value.parent == chapter.id }).reverse().forEach(function(chapter_) {\n      //     s.unshift([chapter_, tabindex + 1, option]);\n      //   });\n      // }\n      var _process = function(items, tabindex, parent) {\n        items.forEach(function(item) {\n          var option = self._createOption(item, tabindex, parent);\n          if ( item.subitems.length ) {\n            _process(item.subitems, tabindex + 1, option);\n          }\n        })\n      }\n      _process(data.toc, 0, parent);\n    }.bind(this))\n\n    return container;\n  },\n\n  _createOption(chapter, tabindex, parent) {\n\n    function pad(value, length) {\n        return (value.toString().length < length) ? pad(\"-\"+value, length):value;\n    }\n    var option = DomUtil.create('li');\n    if ( chapter.href ) {\n      var anchor = DomUtil.create('a', null, option);\n      anchor.textContent = chapter.label;\n      // var tab = pad('', tabindex); tab = tab.length ? tab + ' ' : '';\n      // option.textContent = tab + chapter.label;\n      anchor.setAttribute('href', chapter.href);\n      anchor.setAttribute('data-href', chapter.href);\n    } else {\n      var span = DomUtil.create('span', null, option);\n      span.textContent = chapter.label;\n    }\n\n    if ( parent.tagName == 'LI' ) {\n      // need to nest\n      var tmp = parent.querySelector('ul');\n      if ( ! tmp ) {\n        tmp = DomUtil.create('ul', null, parent);\n      }\n      parent = tmp;\n    }\n\n    parent.appendChild(option);\n    return option;\n  },\n\n  _setupSkipLink: function() {\n    if ( ! this.options.skipLink ) { return; }\n      \n    var target = document.querySelector(this.options.skipLink);\n    if ( ! target ) { return; }\n\n    var link = document.createElement('a');\n    link.textContent = 'Skip to contents';\n    link.setAttribute('href', '#action-' + this._id);\n\n    var ul = target.querySelector('ul');\n    if ( ul ) {\n      // add to list\n      target = document.createElement('li');\n      ul.appendChild(target);\n    }\n    target.appendChild(link);\n    link.addEventListener('click', function(event) {\n      event.preventDefault();\n      event.stopPropagation();\n      this._control.click();\n    }.bind(this))\n\n  },\n\n  EOT: true\n});\n\nexport var contents = function(options) {\n  return new Contents(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\n// Title + Chapter\n\nexport var Title = Control.extend({\n  onAdd: function(reader) {\n    var self = this;\n    var className = this._className(),\n        container = DomUtil.create('div', className),\n        options = this.options;\n\n    // var template = '<h1><span class=\"cozy-title\">Contents: </span><select size=\"1\" name=\"contents\"></select></label>';\n    // var control = new DOMParser().parseFromString(template, \"text/html\").body.firstChild;\n\n    var h1 = DomUtil.create('h1', 'cozy-h1', container);\n    DomUtil.setOpacity(h1, 0);\n    this._title = DomUtil.create('span', 'cozy-title', h1);\n    this._divider = DomUtil.create('span', 'cozy-divider', h1);\n    this._divider.textContent = \" · \";\n    this._section = DomUtil.create('span', 'cozy-section', h1);\n\n    // --- TODO: disable until we can work out how to \n    // --- more reliably match the current section to the contents\n    // this._reader.on('updateSection', function(data) {\n    //   if ( data && data.label ) {\n    //     self._section.textContent = data.label;\n    //     DomUtil.setOpacity(self._section, 1.0);\n    //     DomUtil.setOpacity(self._divider, 1.0);\n    //   } else {\n    //     DomUtil.setOpacity(self._section, 0);\n    //     DomUtil.setOpacity(self._divider, 0);\n    //   }\n    // })\n\n    this._reader.on('updateTitle', function(data) {\n      if ( data ) {\n        self._title.textContent = data.title || data.bookTitle;\n        DomUtil.setOpacity(self._section, 0);\n        DomUtil.setOpacity(self._divider, 0);\n        DomUtil.setOpacity(h1, 1);\n      }\n    })\n\n    return container;\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('a', className, container);\n    link.innerHTML = html;\n    link.href = '#';\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n    // DomEvent.on(link, 'click', this._refocusOnMap, this);\n\n    return link;\n  },\n\n  EOT: true\n});\n\nexport var title = function(options) {\n  return new Title(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\n// Title + Chapter\n\nexport var PublicationMetadata = Control.extend({\n  onAdd: function(reader) {\n    var self = this;\n    var className = this._className(),\n        container = DomUtil.create('div', className),\n        options = this.options;\n\n    // var template = '<h1><span class=\"cozy-title\">Contents: </span><select size=\"1\" name=\"contents\"></select></label>';\n    // var control = new DOMParser().parseFromString(template, \"text/html\").body.firstChild;\n\n    this._publisher = DomUtil.create('div', 'cozy-publisher', container);\n    this._rights = DomUtil.create('div', 'cozy-rights', container);\n\n    this._reader.on('updateTitle', function(data) {\n      if ( data ) {\n        self._publisher.textContent = data.publisher;\n        self._rights.textContent = data.rights;\n      }\n    })\n\n    return container;\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('a', className, container);\n    link.innerHTML = html;\n    link.href = '#';\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n    // DomEvent.on(link, 'click', this._refocusOnMap, this);\n\n    return link;\n  },\n\n  EOT: true\n});\n\nexport var publicationMetadata = function(options) {\n  return new PublicationMetadata(options);\n}\n","import {Class} from '../core/Class';\nimport {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\nimport * as Util from '../core/Util';\n\nimport assign from 'lodash/assign';\nimport keys from 'lodash/keys';\n\nexport var Preferences = Control.extend({\n  options: {\n    label: 'Preferences',\n    hasThemes: false,\n    html: '<i class=\"icon-cog oi\" data-glyph=\"cog\" title=\"Preferences and Settings\" aria-hidden=\"true\"></i>'\n  },\n\n  onAdd: function(reader) {\n    var self = this;\n    var className = this._className('preferences'),\n        container = DomUtil.create('div', className),\n        options = this.options;\n\n    this._activated = false;\n    this._control = this._createButton(options.html || options.label, options.label,\n            className, container, this._action)\n\n    // self.initializeForm();\n    this._modal = this._reader.modal({\n      // template: '<form></form>',\n      title: 'Preferences',\n      className: 'cozy-modal-preferences',\n      actions: [\n        {\n          label: 'Save Changes',\n          callback: function(event) {\n            self.updatePreferences(event);\n          }\n        }\n      ],\n      region: 'right'\n    });\n\n\n    return container;\n  },\n\n  _action: function() {\n    var self = this;\n    self.initializeForm();\n    self._modal.activate();\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('button', className, container);\n    link.innerHTML = html;\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n\n    return link;\n  },\n\n  _createPanel: function() {\n    var self = this;\n    if ( this._modal._container.querySelector('form') ) { return; }\n\n    var template = '';\n\n    var possible_fieldsets = [];\n    if ( this._reader.metadata.layout == 'pre-paginated' ) {\n      // different panel\n      possible_fieldsets.push('Scale');\n    } else {\n      possible_fieldsets.push('TextSize');\n    }\n    possible_fieldsets.push('Display');\n\n    if ( this._reader.rootfiles && this._reader.rootfiles.length > 1 ) {\n      // this.options.hasPackagePaths = true;\n      possible_fieldsets.push('Rendition');\n    }\n\n    if ( this._reader.options.themes && this._reader.options.themes.length > 0 ) {\n      this.options.hasThemes = true;\n      possible_fieldsets.push('Theme');\n    }\n\n    this._fieldsets = [];\n    possible_fieldsets.forEach(function(cls) {\n      var fieldset = new Preferences.fieldset[cls](this);\n      template += fieldset.template();\n      this._fieldsets.push(fieldset);\n    }.bind(this))\n\n    if ( this.options.fields ) {\n      this.options.hasFields = true;\n      for(var i in this.options.fields) {\n        var field = this.options.fields[i];\n        var id = \"preferences-custom-\" + i;\n        template += `<fieldset class=\"custom-field\">\n          <legend>${field.label}</legend>\n        `;\n        for(var j in field.inputs) {\n          var input = field.inputs[j];\n          var checked = input.value == field.value ? ' checked=\"checked\"' : '';\n          template += `<label><input id=\"preferences-custom-${i}-${j}\" type=\"radio\" name=\"x${field.name}\" value=\"${input.value}\" ${checked}/>${input.label}</label>`;\n        }\n        if ( field.hint ) {\n          template += `<p class=\"hint\" style=\"font-size: 90%\">${field.hint}</p>`;\n        }\n      }\n    }\n\n    template = '<form>' + template + '</form>';\n\n    // this._modal = this._reader.modal({\n    //   template: template,\n    //   title: 'Preferences',\n    //   className: 'cozy-modal-preferences',\n    //   actions: [\n    //     {\n    //       label: 'Save Changes',\n    //       callback: function(event) {\n    //         self.updatePreferences(event);\n    //       }\n    //     }\n    //   ],\n    //   region: 'right'\n    // });\n\n    this._modal._container.querySelector('main').innerHTML = template;\n    this._form = this._modal._container.querySelector('form');\n  },\n\n  initializeForm: function() {\n    this._createPanel();\n    this._fieldsets.forEach(function(fieldset) {\n      fieldset.initializeForm(this._form);\n    }.bind(this));\n  },\n\n  updatePreferences: function(event) {\n    event.preventDefault();\n\n    var doUpdate = false;\n    var new_options = {};\n    var saveable_options = {};\n    this._fieldsets.forEach(function(fieldset) {\n      // doUpdate = doUpdate || fieldset.updateForm(this._form, new_options);\n      // assign(new_options, fieldset.updateForm(this._form));\n      fieldset.updateForm(this._form, new_options, saveable_options);\n    }.bind(this));\n\n    if ( this.options.hasFields ) {\n      for(var i in this.options.fields) {\n        var field = this.options.fields[i];\n        var id = \"preferences-custom-\" + i;\n        var input = this._form.querySelector(`input[name=\"x${field.name}\"]:checked`);\n        if ( input.value != field.value ) {\n          field.value = input.value;\n          field.callback(field.value);\n        }\n      }\n    }\n\n    this._modal.deactivate();\n\n    setTimeout(function() {\n      this._reader.saveOptions(saveable_options);\n      this._reader.reopen(new_options);\n    }.bind(this), 100);\n  },\n\n  EOT: true\n});\n\nPreferences.fieldset = {};\n\nvar Fieldset = Class.extend({\n\n  options: {},\n\n  initialize: function (control, options) {\n      Util.setOptions(this, options);\n      this._control = control;\n      this._current = {};\n      this._id = (new Date()).getTime() + '-' + parseInt(Math.random((new Date()).getTime()) * 1000, 10);\n  },\n\n  template: function() {\n\n  },\n\n  EOT: true\n\n\n});\n\nPreferences.fieldset.TextSize = Fieldset.extend({\n\n  initializeForm: function(form) {\n    if ( ! this._input ) {\n      this._input = form.querySelector(`#x${this._id}-input`);\n      this._output = form.querySelector(`#x${this._id}-output`);\n      this._preview = form.querySelector(`#x${this._id}-preview`);\n      this._actionReset = form.querySelector(`#x${this._id}-reset`);\n\n      this._input.addEventListener('input', this._updatePreview.bind(this));\n      this._input.addEventListener('change', this._updatePreview.bind(this));\n\n      this._actionReset.addEventListener('click', function(event) {\n        event.preventDefault();\n        this._input.value = 100;\n        this._updatePreview();\n      }.bind(this));\n    }\n\n    var text_size = this._control._reader.options.text_size || 100;\n    if ( text_size == 'auto' ) { text_size = 100; }\n    this._current.text_size = text_size;\n    this._input.value = text_size;\n    this._updatePreview();\n  },\n\n  updateForm: function(form, options, saveable) {\n    // return { text_size: this._input.value };\n    options.text_size = saveable.text_size = this._input.value;\n    // options.text_size = this._input.value;\n    // return ( this._input.value != this._current.text_size );\n  },\n\n  template: function() {\n    return `<fieldset class=\"cozy-fieldset-text_size\">\n        <legend>Text Size</legend>\n        <div class=\"preview--text_size\" id=\"x${this._id}-preview\">\n          ‘Yes, that’s it,’ said the Hatter with a sigh: ‘it’s always tea-time, and we’ve no time to wash the things between whiles.’\n        </div>\n        <p style=\"white-space: no-wrap\">\n          <span>T-</span>\n          <input name=\"text_size\" type=\"range\" id=\"x${this._id}-input\" value=\"100\" min=\"50\" max=\"400\" step=\"10\" style=\"width: 75%; display: inline-block\" />\n          <span>T+</span>\n        </p>\n        <p>\n          <span>Text Size: </span>\n          <output for=\"preferences-input-text_size\" id=\"x${this._id}-output\">100</output>\n          <button id=\"x${this._id}-reset\" class=\"reset button--inline\" style=\"margin-left: 8px\">Reset</button> \n        </p>\n      </fieldset>`;\n  },\n\n  _updatePreview: function() {\n    this._preview.style.fontSize = `${( parseInt(this._input.value, 10) / 100 )}em`;\n    this._output.value = `${this._input.value}%`;\n  },\n\n  EOT: true\n\n});\n\nPreferences.fieldset.Display = Fieldset.extend({\n\n  initializeForm: function(form) {\n    var flow = this._control._reader.options.flow || this._control._reader.metadata.flow || 'auto';\n    // if ( flow == 'auto' ) { flow = 'paginated'; }\n\n    var input = form.querySelector(`#x${this._id}-input-${flow}`);\n    input.checked = true;\n    this._current.flow = flow;\n\n  },\n\n  updateForm: function(form, options, saveable) {\n    var input = form.querySelector(`input[name=\"x${this._id}-flow\"]:checked`);\n    options.flow = input.value;\n    if ( options.flow != 'auto' ) {\n      saveable.flow = options.flow;\n    }\n    // if ( input.value == 'auto' ) {\n    //   // we do NOT want to save flow as a preference\n    //   return {};\n    // }\n    // return { flow: input.value };\n  },\n\n  template: function() {\n    var scrolled_help = '';\n    if ( this._control._reader.metadata.layout != 'pre-paginated' ) {\n      scrolled_help = \"<br /><small>This is an experimental feature that may cause display and loading issues for the book when enabled.</small>\";\n    }\n    return `<fieldset>\n            <legend>Display</legend>\n            <label><input name=\"x${this._id}-flow\" type=\"radio\" id=\"x${this._id}-input-auto\" value=\"auto\" /> Auto<br /><small>Let the reader determine display mode based on your browser dimensions and the type of content you're reading</small></label>\n            <label><input name=\"x${this._id}-flow\" type=\"radio\" id=\"x${this._id}-input-paginated\" value=\"paginated\" /> Page-by-Page</label>\n            <label><input name=\"x${this._id}-flow\" type=\"radio\" id=\"x${this._id}-input-scrolled-doc\" value=\"scrolled-doc\" /> Scroll${scrolled_help}</label>\n          </fieldset>`;\n  },\n\n  EOT: true\n\n});\n\nPreferences.fieldset.Theme = Fieldset.extend({\n\n  initializeForm: function(form) {\n    var theme = this._control._reader.options.theme || 'default';\n\n    var input = form.querySelector(`#x${this._id}-input-theme-${theme}`);\n    input.checked = true;\n    this._current.theme = theme;\n  },\n\n  updateForm: function(form, options, saveable) {\n    var input = form.querySelector(`input[name=\"x${this._id}-theme\"]:checked`);\n    options.theme = saveable.theme = input.value;\n    // return { theme: input.value };\n  },\n\n  template: function() {\n    var template = `<fieldset>\n            <legend>Theme</legend>\n            <label><input name=\"x${this._id}-theme\" type=\"radio\" id=\"x${this._id}-input-theme-default\" value=\"default\" />Default</label>`;\n\n    this._control._reader.options.themes.forEach(function(theme) {\n      template += `<label><input name=\"x${this._id}-theme\" type=\"radio\" id=\"x${this._id}-input-theme-${theme.klass}\" value=\"${theme.klass}\" />${theme.name}</label>`\n    }.bind(this));\n\n    template += '</fieldset>';\n\n    return template;\n\n  },\n\n  EOT: true\n\n});\n\nPreferences.fieldset.Rendition = Fieldset.extend({\n\n  initializeForm: function(form) {\n    var rootfiles = this._control._reader.rootfiles;\n    var rootfilePath = this._control._reader.options.rootfilePath;\n    var expr = rootfilePath ? `[value=\"${rootfilePath}\"]` : \":first-child\";\n    var input = form.querySelector(`input[name=\"x${this._id}-rootfilePath\"]${expr}`);\n    input.checked = true;\n    this._current.rootfilePath = rootfilePath || rootfiles[0].rootfilePath;\n  },\n\n  updateForm: function(form, options, saveable) {\n    var input = form.querySelector(`input[name=\"x${this._id}-rootfilePath\"]:checked`);\n    if ( input.value != this._current.rootfilePath ) {\n      options.rootfilePath = input.value;\n      this._current.rootfilePath = input.value;\n    }\n  },\n\n  template: function() {\n    var template = `<fieldset>\n            <legend>Rendition</legend>\n    `;\n\n    this._control._reader.rootfiles.forEach(function(rootfile, i) {\n      template += `<label><input name=\"x${this._id}-rootfilePath\" type=\"radio\" id=\"x${this._id}-input-rootfilePath-${i}\" value=\"${rootfile.rootfilePath}\" />${rootfile.label || rootfile.accessMode || rootfile.rootfilePath}</label>`;\n    }.bind(this))\n\n    template += '</fieldset>';\n\n    return template;\n\n  },\n\n  EOT: true\n\n});\n\nPreferences.fieldset.Scale = Fieldset.extend({\n\n  initializeForm: function(form) {\n    if ( ! this._input ) {\n      this._input = form.querySelector(`#x${this._id}-input`);\n      this._output = form.querySelector(`#x${this._id}-output`);\n      this._preview = form.querySelector(`#x${this._id}-preview > div`);\n      this._actionReset = form.querySelector(`#x${this._id}-reset`);\n\n      this._input.addEventListener('input', this._updatePreview.bind(this));\n      this._input.addEventListener('change', this._updatePreview.bind(this));\n\n      this._actionReset.addEventListener('click', function(event) {\n        event.preventDefault();\n        this._input.value = 100;\n        this._updatePreview();\n      }.bind(this));\n    }\n\n    var scale = this._control._reader.options.scale || 100;\n    if ( ! scale ) { scale = 100; }\n    this._current.scale = scale;\n    this._input.value = scale;\n    this._updatePreview();\n  },\n\n  updateForm: function(form, options, saveable) {\n    // return { text_size: this._input.value };\n    options.scale = saveable.scale = this._input.value;\n    // options.text_size = this._input.value;\n    // return ( this._input.value != this._current.text_size );\n  },\n\n  template: function() {\n    return `<fieldset class=\"cozy-fieldset-text_size\">\n        <legend>Zoom In/Out</legend>\n        <div class=\"preview--scale\" id=\"x${this._id}-preview\" style=\"overflow: hidden; height: 5rem\">\n          <div>\n            ‘Yes, that’s it,’ said the Hatter with a sigh: ‘it’s always tea-time, and we’ve no time to wash the things between whiles.’\n          </div>\n        </div>\n        <p style=\"white-space: no-wrap\">\n          <span style=\"font-size: 150%\">⊖<span class=\"u-screenreader\"> Zoom Out</span></span>\n          <input name=\"scale\" type=\"range\" id=\"x${this._id}-input\" value=\"100\" min=\"50\" max=\"400\" step=\"10\" style=\"width: 75%; display: inline-block\" />\n          <span style=\"font-size: 150%\">⊕<span class=\"u-screenreader\">Zoom In </span></span>\n        </p>\n        <p>\n          <span>Scale: </span>\n          <output for=\"preferences-input-text_size\" id=\"x${this._id}-output\">100</output>\n          <button id=\"x${this._id}-reset\" class=\"reset button--inline\" style=\"margin-left: 8px\">Reset</button> \n        </p>\n      </fieldset>`;\n  },\n\n  _updatePreview: function() {\n    this._preview.style.transform = `scale(${( parseInt(this._input.value, 10) / 100 )}) translate(0,0)`;\n    this._output.value = `${this._input.value}%`;\n  },\n\n  EOT: true\n\n});\n\nexport var preferences = function(options) {\n  return new Preferences(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Widget = Control.extend({\n\n\n  options: {\n      // @option region: String = 'topright'\n      // The region of the control (one of the reader corners). Possible values are `'topleft'`,\n      // `'topright'`, `'bottomleft'` or `'bottomright'`\n  },\n\n  onAdd: function(reader) {\n    var container = this._container;\n    if ( container ) {\n      // NOOP\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n\n    }\n\n    this._onAddExtra(container);\n    this._updateTemplate(container);\n    this._updateClass(container);\n    this._bindEvents(container);\n\n    return container;\n  },\n\n  _updateTemplate: function(container) {\n    var data = this.data();\n    for(var slot in data) {\n      if ( data.hasOwnProperty(slot) ) {\n        var value = data[slot];\n        if ( typeof(value) == \"function\" ) { value = value(); }\n        var node = container.querySelector(`[data-slot=${slot}]`);\n        if ( node ) {\n          if ( node.hasAttribute('value') ) {\n            node.setAttribute('value', value);\n          } else {\n            node.innerHTML = value;\n          }\n        }\n      }\n    }\n  },\n\n  _updateClass: function(container) {\n    if ( this.options.className ) {\n      DomUtil.addClass(container, this.options.className);\n    }\n  },\n\n  _onAddExtra: function() { },\n\n  _bindEvents: function(container) {\n    var control = container.querySelector(\"[data-toggle=button]\");\n    if ( ! control ) { return ; }\n    DomEvent.disableClickPropagation(control);\n    DomEvent.on(control, 'click', DomEvent.stop);\n    DomEvent.on(control, 'click', this._action, this);\n  },\n\n  _action: function() {\n  },\n\n  data: function() {\n    return this.options.data || {};\n  },\n\n  EOT: true\n});\n\nWidget.Button = Widget.extend({\n  defaultTemplate: `<button data-toggle=\"button\" data-slot=\"label\"></button>`,\n\n  _action: function() {\n    this.options.onClick(this, this._reader);\n  },\n\n  EOT: true\n});\n\nWidget.Panel = Widget.extend({\n  defaultTemplate: `<div><span data-slot=\"text\"></span></div>`,\n\n\n  EOT: true\n});\n\nWidget.Toggle = Widget.extend({\n  defaultTemplate: `<button data-toggle=\"button\" data-slot=\"label\"></button>`,\n\n  _onAddExtra: function(container) {\n    this.state(this.options.states[0].stateName, container);\n\n    return container;\n  },\n\n  state: function(stateName, container) {\n    container = container || this._container;\n    this._resetState(container);\n    this._state = this.options.states.filter(function(s) { return s.stateName == stateName })[0];\n    this._updateClass(container);\n    this._updateTemplate(container);\n  },\n\n  _resetState: function(container) {\n    if ( ! this._state ) { return; }\n    if ( this._state.className ) {\n      DomUtil.removeClass(container, this._state.className);\n    }\n  },\n\n  _updateClass: function(container) {\n    if ( this._state.className ) {\n      DomUtil.addClass(container, this._state.className);\n    }\n  },\n\n  _action: function() {\n    this._state.onClick(this, this._reader);\n  },\n\n  data: function() {\n    return this._state.data || {};\n  },\n\n  EOT: true\n});\n\n// export var widget = function(options) {\n//   return new Widget(options);\n// }\n\nexport var widget = {\n  button: function(options) { return new Widget.Button(options); },\n  panel: function(options) { return new Widget.Panel(options); },\n  toggle: function(options) { return new Widget.Toggle(options); }\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Citation = Control.extend({\n  options: {\n    label: 'Citation',\n    html: '<span>Get Citation</span>'\n  },\n\n  defaultTemplate: `<button class=\"button--sm cozy-citation\" data-toggle=\"open\">Get Citation</button>`,\n\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._reader.on('updateContents', function(data) {\n      self._createPanel();\n    });\n\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n      self._modal.activate();\n    }, this)\n\n    return container;\n  },\n\n  _action: function() {\n    var self = this;\n    self._modal.activate();\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('button', className, container);\n    link.innerHTML = html;\n    link.title = title;\n\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n\n    return link;\n  },\n\n  _createPanel: function() {\n    var self = this;\n\n    var template = `<form>\n      <fieldset>\n        <legend>Select Citation Format</legend>\n      </fieldset>\n    </form>\n    <blockquote id=\"formatted\" style=\"padding: 8px; border-left: 4px solid black; background-color: #fff\"></blockquote>\n    <div class=\"alert alert-info\" id=\"message\" style=\"display: none\"></div>`;\n\n    this._modal = this._reader.modal({\n      template: template,\n      title: 'Copy Citation to Clipboard',\n      className: 'cozy-modal-citatation',\n      actions: [\n        {\n          label: 'Copy Citation',\n          callback: function(event) {\n            document.designMode = \"on\";\n            var formatted = self._modal._container.querySelector(\"#formatted\");\n\n            var range = document.createRange();\n            range.selectNode(formatted);\n            var sel = window.getSelection();\n            sel.removeAllRanges();\n            sel.addRange(range);\n\n            // formatted.select();\n\n            try {\n              var flag = document.execCommand('copy');\n            } catch(err) {\n              console.log(\"AHOY COPY FAILED\", err);\n            }\n\n            self._message.innerHTML = 'Success! Citation copied to your clipboard.';\n            self._message.style.display = 'block';\n            sel.removeAllRanges();\n            range.detach();\n            document.designMode = \"off\";\n          }\n        }\n      ],\n      region: 'left',\n      fraction: 1.0\n    });\n\n    this._form = this._modal._container.querySelector('form');\n    var fieldset = this._form.querySelector('fieldset');\n\n    var citations = this.options.citations || this._reader.metadata.citations;\n\n    citations.forEach(function(citation, index) {\n      var label = DomUtil.create('label', null, fieldset);\n      var input = DomUtil.create('input', null, label);\n      input.setAttribute('name', 'format');\n      input.setAttribute('value', citation.format);\n      input.setAttribute('type', 'radio');\n      if ( index == 0 ) {\n        input.setAttribute('checked', 'checked');\n      }\n      var text = document.createTextNode(\" \" + citation.format);\n      label.appendChild(text);\n      input.setAttribute('data-text', citation.text);\n    });\n\n    this._formatted = this._modal._container.querySelector(\"#formatted\");\n    this._message = this._modal._container.querySelector(\"#message\");\n    DomEvent.on(this._form, 'change', function(event) {\n      var target = event.target;\n      if ( target.tagName == 'INPUT' ) {\n        this._initializeForm();\n      }\n    }, this);\n\n    this._initializeForm();\n  },\n\n  _initializeForm: function() {\n    var formatted = this._formatCitation();\n    this._formatted.innerHTML = formatted;\n    this._message.style.display = 'none';\n    this._message.innerHTML = '';\n  },\n\n  _formatCitation: function(format) {\n    if ( format == null ) {\n      var selected = this._form.querySelector(\"input:checked\");\n      format = selected.value;\n    }\n    var selected = this._form.querySelector(\"input[value=\" + format + \"]\");\n    return selected.getAttribute('data-text');\n    // return selected.dataset.text;\n  },\n\n  EOT: true\n});\n\nexport var citation = function(options) {\n  return new Citation(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Search = Control.extend({\n  options: {\n    label: 'Search',\n    html: '<span>Search</span>'\n  },\n\n  defaultTemplate: `<form class=\"search\">\n    <label class=\"u-screenreader\" for=\"cozy-search-string\">Search in this text</label>\n    <input id=\"cozy-search-string\" name=\"search\" type=\"text\" placeholder=\"Search in this text...\"/>\n    <button class=\"button--sm\" data-toggle=\"open\" aria-label=\"Search\"><i class=\"icon-magnifying-glass oi\" data-glyph=\"magnifying-glass\" title=\"Search\" aria-hidden=\"true\"></i></button>\n  </form>`,\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    container.style.position = 'relative';\n\n    this._data = null;\n    this._canceled = false;\n    this._processing = false;\n\n    this._reader.on('ready', function() {\n\n      this._modal = this._reader.modal({\n        template: '<article></article>',\n        title: 'Search Results',\n        className: { container: 'cozy-modal-search' },\n        region: 'left',\n      });\n\n      this._modal.callbacks.onClose = function() {\n        if ( self._processing ) {\n          self._canceled = true;\n        }\n      };\n\n      this._article = this._modal._container.querySelector('article');\n\n      this._modal.on('click', 'a[href]', function(modal, target) {\n        target = target.getAttribute('href');\n        this._reader.tracking.action('search/go');\n        this._reader.gotoPage(target);\n        return true;\n      }.bind(this));\n\n      this._modal.on('closed', function() {\n        this._reader.tracking.action('contents/close');\n      }.bind(this))\n\n    }.bind(this));\n\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n\n      var searchString = this._container.querySelector(\"#cozy-search-string\").value;\n      searchString = searchString.replace(/^\\s*/, '').replace(/\\s*$/, '');\n\n      if ( ! searchString ) {\n        // just punt\n        return;\n      }\n\n      if ( searchString == this.searchString ) {\n        // cached results\n        self.openModalResults();\n      } else {\n        this.searchString = searchString;\n        self.openModalWaiting();\n        self.submitQuery();\n      }\n    }, this);\n\n    return container;\n  },\n\n  openModalWaiting: function() {\n    this._processing = true;\n    this._emptyArticle();\n    var value = this.searchString;\n    this._article.innerHTML = '<p>Submitting query for <em>' + value + '</em>...</p>' + this._reader.loaderTemplate();\n    this._modal.activate();\n  },\n\n  openModalResults: function() {\n    if ( this._canceled ) {\n      this._canceled = false;\n      return;\n    }\n    this._buildResults();\n    this._modal.activate();\n    this._reader.tracking.action(\"search/open\");\n  },\n\n  submitQuery: function() {\n    var self = this;\n\n    var url = this.options.searchUrl + this.searchString;\n\n    var request = new XMLHttpRequest();\n    request.open('GET', url, true);\n\n    request.onload = function() {\n      if (this.status >= 200 && this.status < 400) {\n        // Success!\n        var data = JSON.parse(this.response);\n        console.log(\"SEARCH DATA\", data);\n\n        self._data = data;\n\n      } else {\n        // We reached our target server, but it returned an error\n\n        self._data = null;\n        console.log(this.response);\n      }\n\n      self._reader.tracking.action(\"search/submitQuery\");\n      self.openModalResults();\n\n    };\n\n    request.onerror = function() {\n      // There was a connection error of some sort\n      self._data = null;\n      self.openModalResults();\n    };\n\n    request.send();\n\n  },\n\n  _emptyArticle: function() {\n    while (this._article && this._article.hasChildNodes()) {\n      this._article.removeChild(this._article.lastChild);\n    }\n  },\n\n  _buildResults: function() {\n    var self = this;\n    var content;\n\n    this._processing = false;\n\n    self._emptyArticle();\n\n    var reader = this._reader;\n    reader.annotations.reset();\n\n    if ( this._data ) {\n      var highlight = true\n      if (this._data.highlight_off == \"yes\") {\n        highlight = false;\n      }\n      if ( this._data.search_results.length ) {\n        content = DomUtil.create('ul');\n\n        this._data.search_results.forEach(function(result) {\n          var option = DomUtil.create('li');\n          var anchor = DomUtil.create('a', null, option);\n          var cfiRange = \"epubcfi(\" + result.cfi + \")\";\n\n          if (result.snippet) {\n            if (result.title) {\n              var chapterTitle = DomUtil.create('i');\n              chapterTitle.textContent = result.title + \": \";\n              anchor.appendChild(chapterTitle);\n            }\n            anchor.appendChild(document.createTextNode(result.snippet));\n\n            anchor.setAttribute(\"href\", cfiRange);\n            content.appendChild(option);\n          }\n          if (highlight) {\n            reader.annotations.highlight(cfiRange);\n          }\n        });\n      } else {\n        content = DomUtil.create(\"p\")\n        content.textContent = 'No results found for \"' + self.searchString + '\"';\n      }\n    } else {\n      content = DomUtil.create(\"p\")\n      content.textContent = 'There was a problem processing this query.';\n    }\n\n    self._article.appendChild(content);\n  },\n\n  EOT: true\n});\n\nexport var search = function(options) {\n  return new Search(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\n// Title + Chapter\n\nexport var BibliographicInformation = Control.extend({\n  options: {\n    label: 'Info',\n    direction: 'left',\n    html: '<span class=\"oi\" data-glyph=\"info\">Info</span>'\n  },\n\n  defaultTemplate: `<button class=\"button--sm cozy-bib-info oi\" data-glyph=\"info\" data-toggle=\"open\" aria-label=\"Bibliographic Information\"> Info</button>`,\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._reader.on('updateContents', function(data) {\n      self._createPanel();\n    });\n\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n      self._modal.activate();\n    }, this)\n\n    return container;\n  },\n\n  _createPanel: function() {\n    var self = this;\n\n    var template = `<dl>\n    </dl>`;\n\n    this._modal = this._reader.modal({\n      template: template,\n      title: 'Info',\n      region: 'left',\n      fraction: 1.0\n    });\n\n    var dl = this._modal._container.querySelector('dl');\n\n    var metadata_fields = [\n      [ 'title', 'Title' ],\n      [ 'creator', 'Author' ],\n      [ 'pubdate', 'Publication Date' ],\n      [ 'modified_date', 'Modified Date' ],\n      [ 'publisher', 'Publisher' ],\n      [ 'rights', 'Rights' ],\n      [ 'doi', 'DOI' ],\n      [ 'description', 'Description' ],\n    ];\n\n    var metadata_fields_seen = {};\n\n    var metadata = this._reader.metadata;\n\n    for(var idx in metadata_fields) {\n      var key = metadata_fields[idx][0];\n      var label = metadata_fields[idx][1];\n      if ( metadata[key] ) {\n        var value = metadata[key];\n        if ( key == 'pubdate' || key == 'modified_date' ) {\n          value = this._formatDate(value);\n          if ( ! value ) { continue; }\n          // value = d.toISOString().slice(0,10); // for YYYY-MM-DD\n        }\n        metadata_fields_seen[key] = true;\n        var dt = DomUtil.create('dt', 'cozy-bib-info-label', dl);\n        dt.innerHTML = label;\n        var dd = DomUtil.create('dd', 'cozy-bib-info-value cozy-bib-info-value-' + key, dl);\n        dd.innerHTML = value;\n      }\n    }\n\n  },\n\n  _formatDate: function(value) {\n    var match = value.match(/\\d{4}/);\n    if ( match ) {\n      return match[0];\n    }\n    return null;\n  },\n\n  EOT: true\n});\n\nexport var bibliographicInformation = function(options) {\n  return new BibliographicInformation(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Download = Control.extend({\n  options: {\n    label: 'Download Book',\n    html: '<span>Download Book</span>'\n  },\n\n  defaultTemplate: `<button class=\"button--sm cozy-download oi\" data-toggle=\"open\" data-glyph=\"data-transfer-download\"> Download Book</button>`,\n\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._reader.on('updateContents', function(data) {\n      self._createPanel();\n    });\n\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n      self._modal.activate();\n    }, this)\n\n    return container;\n  },\n\n  _createPanel: function() {\n    var self = this;\n\n    var template = `<form>\n      <fieldset>\n        <legend>Choose File Format</legend>\n      </fieldset>\n    </form>`;\n\n    this._modal = this._reader.modal({\n      template: template,\n      title: 'Download Book',\n      className: 'cozy-modal-download',\n      actions: [\n        {\n          label: 'Download',\n          callback: function(event) {\n            var selected = self._form.querySelector(\"input:checked\");\n            var href = selected.getAttribute('data-href');\n            self._configureDownloadForm(href);\n            self._form.submit();\n          }\n        }\n      ],\n      region: 'left',\n      fraction: 1.0\n    });\n\n    this._form = this._modal._container.querySelector('form');    \n    var fieldset = this._form.querySelector('fieldset');\n    this._reader.options.download_links.forEach(function(link, index) {\n      var label = DomUtil.create('label', null, fieldset);\n      var input = DomUtil.create('input', null, label);\n      input.setAttribute('name', 'format');\n      input.setAttribute('value', link.format);\n      input.setAttribute('data-href', link.href);\n      input.setAttribute('type', 'radio');\n      if ( index == 0 ) {\n        input.setAttribute('checked', 'checked');\n      }\n      var text = link.format;\n      if ( link.size ) {\n        text += \" (\" + link.size + \")\";\n      }\n      var text = document.createTextNode(\" \" + text);\n      label.appendChild(text);\n    });\n\n  },\n\n  _configureDownloadForm: function(href) {\n    var self = this;\n    self._form.setAttribute('method', 'GET');\n    self._form.setAttribute('action', href);\n    self._form.setAttribute('target', '_blank');\n  },\n\n\n  EOT: true\n});\n\nexport var download = function(options) {\n  return new Download(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Navigator = Control.extend({\n  onAdd: function(reader) {\n    var container = this._container;\n    if ( container ) {\n    } else {\n\n      var className = this._className('navigator'),\n          options = this.options;\n      \n      container = DomUtil.create('div', className);\n    }\n    this._setup(container);\n\n    this._reader.on('updateLocations', function(locations) {      \n      // if ( ! this._reader.currentLocation() || ! this._reader.currentLocation().start ) {\n      //   console.log(\"AHOY updateLocations NO START\", this._reader.currentLocation().then);\n      //   setTimeout(function() {\n      //     this._initializeNavigator(locations);\n      //   }.bind(this), 100);\n      //   return;\n      // }\n      this._initializeNavigator(locations);\n    }.bind(this));\n\n    return container;\n  },\n\n  _setup: function(container) {\n    this._control = container.querySelector(\"input[type=range]\");\n    if ( ! this._control ) {\n      this._createControl(container);\n    }\n    this._background = container.querySelector(\".cozy-navigator-range__background\");\n    this._status = container.querySelector(\".cozy-navigator-range__status\");\n    this._spanCurrentPercentage = container.querySelector(\".currentPercentage\");\n    this._spanCurrentLocation = container.querySelector(\".currentLocation\");\n    this._spanTotalLocations = container.querySelector(\".totalLocations\");\n\n    this._bindEvents();\n  },\n\n  _createControl: function (container) {\n    var template = `<div class=\"cozy-navigator-range\">\n        <label class=\"u-screenreader\" for=\"cozy-navigator-range-input\">Location: </label>\n        <input class=\"cozy-navigator-range__input\" id=\"cozy-navigator-range-input\" type=\"range\" name=\"locations-range-value\" min=\"0\" max=\"100\" aria-valuemin=\"0\" aria-valuemax=\"100\" aria-valuenow=\"0\" aria-valuetext=\"0% • Location 0 of ?\" value=\"0\" data-background-position=\"0\" />\n        <div class=\"cozy-navigator-range__background\"></div>\n      </div>\n      <div class=\"cozy-navigator-range__status\"><span class=\"currentPercentage\">0%</span> • Location <span class=\"currentLocation\">0</span> of <span class=\"totalLocations\">?</span></div>\n    `;\n\n    var body = new DOMParser().parseFromString(template, \"text/html\").body;\n    while ( body.children.length ) {\n      container.appendChild(body.children[0]);\n    }\n\n    this._control = container.querySelector(\"input[type=range]\");\n  },\n\n  _bindEvents: function() {\n    var self = this;\n\n    this._control.addEventListener(\"input\", function() {\n      self._update();\n    }, false);\n    this._control.addEventListener(\"change\", function() { self._action(); }, false);\n    this._control.addEventListener(\"mousedown\", function(){\n        self._mouseDown = true;\n    }, false);\n    this._control.addEventListener(\"mouseup\", function(){\n        self._mouseDown = false;\n    }, false);\n    this._control.addEventListener(\"keydown\", function(){\n      self._mouseDown = true;\n    }, false);\n    this._control.addEventListener(\"keyup\", function(){\n      self._mouseDown = false;\n    }, false);\n\n    this._reader.on('relocated', function(location) {\n      if ( ! self._initiated ) { return; }\n      if ( ! self._mouseDown ) {\n        self._control.value = Math.ceil(self._reader.locations.percentageFromCfi(self._reader.currentLocation().start.cfi) * 100);\n        self._update();\n      }\n    })\n\n  },\n\n  _action: function() {\n    var value = this._control.value;\n    var locations = this._reader.locations;\n    var cfi = locations.cfiFromPercentage(value / 100);\n    this._reader.tracking.action(\"navigator/go\");\n    this._reader.gotoPage(cfi);\n  },\n\n  _update: function() {\n    var self = this;\n\n    var current = this._reader.currentLocation();\n    if ( ! current || ! current.start ) {\n      setTimeout(function() {\n        this._update();\n      }.bind(this), 100);\n    }\n\n    var rangeBg = this._background;\n    var range = self._control;\n\n    var value = parseInt(range.value, 10);\n    var percentage = value;\n\n    rangeBg.setAttribute('style', 'background-position: ' + (-percentage) + '% 0%, left top;');\n    self._control.setAttribute('data-background-position', Math.ceil(percentage));\n\n    this._spanCurrentPercentage.innerHTML = percentage + '%';\n    if ( current && current.start ) {\n      var current_location = this._reader.locations.locationFromCfi(current.start.cfi);\n      this._spanCurrentLocation.innerHTML = ( current_location );\n    }\n    self._last_delta = self._last_value > value; self._last_value = value;\n  },\n\n  _initializeNavigator: function(locations) {\n    console.log(\"AHOY updateLocations PROCESSING LOCATION\");\n    this._initiated = true;\n    this._total = this._reader.locations.total;\n    if ( this._reader.currentLocation().start ) {\n      this._control.value = Math.ceil(this._reader.locations.percentageFromCfi(this._reader.currentLocation().start.cfi) * 100);\n      this._last_value = this._control.value;\n    } else {\n      this._last_value = this._control.value;\n    }\n\n    this._spanTotalLocations.innerHTML = this._total;\n\n    this._update();\n    setTimeout(function() {\n      DomUtil.addClass(this._container, 'initialized');\n    }.bind(this), 0);\n  },\n\n  EOT: true\n});\n\nexport var navigator = function(options) {\n  return new Navigator(options);\n}\n","import {Control, control} from './Control';\nimport {PageNext, PagePrevious, pageNext, pagePrevious, PageFirst, pageFirst, PageLast, pageLast} from './Control.Paging';\nimport {Contents, contents} from './Control.Contents';\nimport {Title, title} from './Control.Title';\nimport {PublicationMetadata, publicationMetadata} from './Control.PublicationMetadata';\nimport {Preferences, preferences} from './Control.Preferences';\nimport {Widget, widget} from './Control.Widget';\nimport {Citation, citation} from './Control.Citation';\nimport {Search, search} from './Control.Search';\nimport {BibliographicInformation, bibliographicInformation} from './Control.BibliographicInformation';\nimport {Download, download} from './Control.Download';\nimport {Navigator, navigator} from './Control.Navigator';\n\n// import {Zoom, zoom} from './Control.Zoom';\n// import {Attribution, attribution} from './Control.Attribution';\n\nControl.PageNext = PageNext;\nControl.PagePrevious = PagePrevious;\nControl.PageFirst = PageFirst;\nControl.PageLast = PageLast;\ncontrol.pagePrevious = pagePrevious;\ncontrol.pageNext = pageNext;\ncontrol.pageFirst = pageFirst;\ncontrol.pageLast = pageLast;\n\nControl.Contents = Contents;\ncontrol.contents = contents;\n\nControl.Title = Title;\ncontrol.title = title;\n\nControl.PublicationMetadata = PublicationMetadata;\ncontrol.publicationMetadata = publicationMetadata;\n\nControl.Preferences = Preferences;\ncontrol.preferences = preferences;\n\nControl.Widget = Widget;\ncontrol.widget = widget;\n\nControl.Citation = Citation;\ncontrol.citation = citation;\n\nControl.Search = Search;\ncontrol.search = search;\n\nControl.BibliographicInformation = BibliographicInformation;\ncontrol.bibliographicInformation = bibliographicInformation;\n\nControl.Download = Download;\ncontrol.download = download;\n\nControl.Navigator = Navigator;\ncontrol.navigator = navigator;\n\nexport {Control, control};\n","import {Evented} from './Events';\n\nvar Bus = Evented.extend({\n});\n\nvar instance;\nexport var bus = function() {\n  return instance || ( instance = new Bus() );\n}\n","import * as Browser from './Browser';\nexport {Browser};\n\nexport {Class} from './Class';\n\nimport {Evented} from './Events';\nexport {Evented};\nexport var Mixin = {Events: Evented.prototype};\n\nimport * as Util from './Util';\nexport {Util};\nexport {extend, bind, stamp, setOptions} from './Util';\nexport {bus} from './Bus';\n","\n// var ePub = window.ePub;\n// export {ePub};\n\nexport function ePub(href, options) {\n\tif ( window.require !== undefined ) {\n\t\twindow.ePub = require(\"ePub\");\n\t}\n  return window.ePub(href, options);\n}\n","'use strict';\n\nif (!process) {\n  var process = {\n    \"cwd\" : function () { return '/' }\n  };\n}\n\nfunction assertPath(path) {\n  if (typeof path !== 'string') {\n    throw new TypeError('Path must be a string. Received ' + path);\n  }\n}\n\n// Resolves . and .. elements in a path with directory names\nfunction normalizeStringPosix(path, allowAboveRoot) {\n  var res = '';\n  var lastSlash = -1;\n  var dots = 0;\n  var code;\n  for (var i = 0; i <= path.length; ++i) {\n    if (i < path.length)\n      code = path.charCodeAt(i);\n    else if (code === 47/*/*/)\n      break;\n    else\n      code = 47/*/*/;\n    if (code === 47/*/*/) {\n      if (lastSlash === i - 1 || dots === 1) {\n        // NOOP\n      } else if (lastSlash !== i - 1 && dots === 2) {\n        if (res.length < 2 ||\n            res.charCodeAt(res.length - 1) !== 46/*.*/ ||\n            res.charCodeAt(res.length - 2) !== 46/*.*/) {\n          if (res.length > 2) {\n            var start = res.length - 1;\n            var j = start;\n            for (; j >= 0; --j) {\n              if (res.charCodeAt(j) === 47/*/*/)\n                break;\n            }\n            if (j !== start) {\n              if (j === -1)\n                res = '';\n              else\n                res = res.slice(0, j);\n              lastSlash = i;\n              dots = 0;\n              continue;\n            }\n          } else if (res.length === 2 || res.length === 1) {\n            res = '';\n            lastSlash = i;\n            dots = 0;\n            continue;\n          }\n        }\n        if (allowAboveRoot) {\n          if (res.length > 0)\n            res += '/..';\n          else\n            res = '..';\n        }\n      } else {\n        if (res.length > 0)\n          res += '/' + path.slice(lastSlash + 1, i);\n        else\n          res = path.slice(lastSlash + 1, i);\n      }\n      lastSlash = i;\n      dots = 0;\n    } else if (code === 46/*.*/ && dots !== -1) {\n      ++dots;\n    } else {\n      dots = -1;\n    }\n  }\n  return res;\n}\n\nfunction _format(sep, pathObject) {\n  var dir = pathObject.dir || pathObject.root;\n  var base = pathObject.base ||\n    ((pathObject.name || '') + (pathObject.ext || ''));\n  if (!dir) {\n    return base;\n  }\n  if (dir === pathObject.root) {\n    return dir + base;\n  }\n  return dir + sep + base;\n}\n\nvar posix = {\n  // path.resolve([from ...], to)\n  resolve: function resolve() {\n    var resolvedPath = '';\n    var resolvedAbsolute = false;\n    var cwd;\n\n    for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n      var path;\n      if (i >= 0)\n        path = arguments[i];\n      else {\n        if (cwd === undefined)\n          cwd = process.cwd();\n        path = cwd;\n      }\n\n      assertPath(path);\n\n      // Skip empty entries\n      if (path.length === 0) {\n        continue;\n      }\n\n      resolvedPath = path + '/' + resolvedPath;\n      resolvedAbsolute = path.charCodeAt(0) === 47/*/*/;\n    }\n\n    // At this point the path should be resolved to a full absolute path, but\n    // handle relative paths to be safe (might happen when process.cwd() fails)\n\n    // Normalize the path\n    resolvedPath = normalizeStringPosix(resolvedPath, !resolvedAbsolute);\n\n    if (resolvedAbsolute) {\n      if (resolvedPath.length > 0)\n        return '/' + resolvedPath;\n      else\n        return '/';\n    } else if (resolvedPath.length > 0) {\n      return resolvedPath;\n    } else {\n      return '.';\n    }\n  },\n\n\n  normalize: function normalize(path) {\n    assertPath(path);\n\n    if (path.length === 0)\n      return '.';\n\n    var isAbsolute = path.charCodeAt(0) === 47/*/*/;\n    var trailingSeparator = path.charCodeAt(path.length - 1) === 47/*/*/;\n\n    // Normalize the path\n    path = normalizeStringPosix(path, !isAbsolute);\n\n    if (path.length === 0 && !isAbsolute)\n      path = '.';\n    if (path.length > 0 && trailingSeparator)\n      path += '/';\n\n    if (isAbsolute)\n      return '/' + path;\n    return path;\n  },\n\n\n  isAbsolute: function isAbsolute(path) {\n    assertPath(path);\n    return path.length > 0 && path.charCodeAt(0) === 47/*/*/;\n  },\n\n\n  join: function join() {\n    if (arguments.length === 0)\n      return '.';\n    var joined;\n    for (var i = 0; i < arguments.length; ++i) {\n      var arg = arguments[i];\n      assertPath(arg);\n      if (arg.length > 0) {\n        if (joined === undefined)\n          joined = arg;\n        else\n          joined += '/' + arg;\n      }\n    }\n    if (joined === undefined)\n      return '.';\n    return posix.normalize(joined);\n  },\n\n\n  relative: function relative(from, to) {\n    assertPath(from);\n    assertPath(to);\n\n    if (from === to)\n      return '';\n\n    from = posix.resolve(from);\n    to = posix.resolve(to);\n\n    if (from === to)\n      return '';\n\n    // Trim any leading backslashes\n    var fromStart = 1;\n    for (; fromStart < from.length; ++fromStart) {\n      if (from.charCodeAt(fromStart) !== 47/*/*/)\n        break;\n    }\n    var fromEnd = from.length;\n    var fromLen = (fromEnd - fromStart);\n\n    // Trim any leading backslashes\n    var toStart = 1;\n    for (; toStart < to.length; ++toStart) {\n      if (to.charCodeAt(toStart) !== 47/*/*/)\n        break;\n    }\n    var toEnd = to.length;\n    var toLen = (toEnd - toStart);\n\n    // Compare paths to find the longest common path from root\n    var length = (fromLen < toLen ? fromLen : toLen);\n    var lastCommonSep = -1;\n    var i = 0;\n    for (; i <= length; ++i) {\n      if (i === length) {\n        if (toLen > length) {\n          if (to.charCodeAt(toStart + i) === 47/*/*/) {\n            // We get here if `from` is the exact base path for `to`.\n            // For example: from='/foo/bar'; to='/foo/bar/baz'\n            return to.slice(toStart + i + 1);\n          } else if (i === 0) {\n            // We get here if `from` is the root\n            // For example: from='/'; to='/foo'\n            return to.slice(toStart + i);\n          }\n        } else if (fromLen > length) {\n          if (from.charCodeAt(fromStart + i) === 47/*/*/) {\n            // We get here if `to` is the exact base path for `from`.\n            // For example: from='/foo/bar/baz'; to='/foo/bar'\n            lastCommonSep = i;\n          } else if (i === 0) {\n            // We get here if `to` is the root.\n            // For example: from='/foo'; to='/'\n            lastCommonSep = 0;\n          }\n        }\n        break;\n      }\n      var fromCode = from.charCodeAt(fromStart + i);\n      var toCode = to.charCodeAt(toStart + i);\n      if (fromCode !== toCode)\n        break;\n      else if (fromCode === 47/*/*/)\n        lastCommonSep = i;\n    }\n\n    var out = '';\n    // Generate the relative path based on the path difference between `to`\n    // and `from`\n    for (i = fromStart + lastCommonSep + 1; i <= fromEnd; ++i) {\n      if (i === fromEnd || from.charCodeAt(i) === 47/*/*/) {\n        if (out.length === 0)\n          out += '..';\n        else\n          out += '/..';\n      }\n    }\n\n    // Lastly, append the rest of the destination (`to`) path that comes after\n    // the common path parts\n    if (out.length > 0)\n      return out + to.slice(toStart + lastCommonSep);\n    else {\n      toStart += lastCommonSep;\n      if (to.charCodeAt(toStart) === 47/*/*/)\n        ++toStart;\n      return to.slice(toStart);\n    }\n  },\n\n\n  _makeLong: function _makeLong(path) {\n    return path;\n  },\n\n\n  dirname: function dirname(path) {\n    assertPath(path);\n    if (path.length === 0)\n      return '.';\n    var code = path.charCodeAt(0);\n    var hasRoot = (code === 47/*/*/);\n    var end = -1;\n    var matchedSlash = true;\n    for (var i = path.length - 1; i >= 1; --i) {\n      code = path.charCodeAt(i);\n      if (code === 47/*/*/) {\n        if (!matchedSlash) {\n          end = i;\n          break;\n        }\n      } else {\n        // We saw the first non-path separator\n        matchedSlash = false;\n      }\n    }\n\n    if (end === -1)\n      return hasRoot ? '/' : '.';\n    if (hasRoot && end === 1)\n      return '//';\n    return path.slice(0, end);\n  },\n\n\n  basename: function basename(path, ext) {\n    if (ext !== undefined && typeof ext !== 'string')\n      throw new TypeError('\"ext\" argument must be a string');\n    assertPath(path);\n\n    var start = 0;\n    var end = -1;\n    var matchedSlash = true;\n    var i;\n\n    if (ext !== undefined && ext.length > 0 && ext.length <= path.length) {\n      if (ext.length === path.length && ext === path)\n        return '';\n      var extIdx = ext.length - 1;\n      var firstNonSlashEnd = -1;\n      for (i = path.length - 1; i >= 0; --i) {\n        var code = path.charCodeAt(i);\n        if (code === 47/*/*/) {\n          // If we reached a path separator that was not part of a set of path\n          // separators at the end of the string, stop now\n          if (!matchedSlash) {\n            start = i + 1;\n            break;\n          }\n        } else {\n          if (firstNonSlashEnd === -1) {\n            // We saw the first non-path separator, remember this index in case\n            // we need it if the extension ends up not matching\n            matchedSlash = false;\n            firstNonSlashEnd = i + 1;\n          }\n          if (extIdx >= 0) {\n            // Try to match the explicit extension\n            if (code === ext.charCodeAt(extIdx)) {\n              if (--extIdx === -1) {\n                // We matched the extension, so mark this as the end of our path\n                // component\n                end = i;\n              }\n            } else {\n              // Extension does not match, so our result is the entire path\n              // component\n              extIdx = -1;\n              end = firstNonSlashEnd;\n            }\n          }\n        }\n      }\n\n      if (start === end)\n        end = firstNonSlashEnd;\n      else if (end === -1)\n        end = path.length;\n      return path.slice(start, end);\n    } else {\n      for (i = path.length - 1; i >= 0; --i) {\n        if (path.charCodeAt(i) === 47/*/*/) {\n          // If we reached a path separator that was not part of a set of path\n          // separators at the end of the string, stop now\n          if (!matchedSlash) {\n            start = i + 1;\n            break;\n          }\n        } else if (end === -1) {\n          // We saw the first non-path separator, mark this as the end of our\n          // path component\n          matchedSlash = false;\n          end = i + 1;\n        }\n      }\n\n      if (end === -1)\n        return '';\n      return path.slice(start, end);\n    }\n  },\n\n\n  extname: function extname(path) {\n    assertPath(path);\n    var startDot = -1;\n    var startPart = 0;\n    var end = -1;\n    var matchedSlash = true;\n    // Track the state of characters (if any) we see before our first dot and\n    // after any path separator we find\n    var preDotState = 0;\n    for (var i = path.length - 1; i >= 0; --i) {\n      var code = path.charCodeAt(i);\n      if (code === 47/*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          startPart = i + 1;\n          break;\n        }\n        continue;\n      }\n      if (end === -1) {\n        // We saw the first non-path separator, mark this as the end of our\n        // extension\n        matchedSlash = false;\n        end = i + 1;\n      }\n      if (code === 46/*.*/) {\n        // If this is our first dot, mark it as the start of our extension\n        if (startDot === -1)\n          startDot = i;\n        else if (preDotState !== 1)\n          preDotState = 1;\n      } else if (startDot !== -1) {\n        // We saw a non-dot and non-path separator before our dot, so we should\n        // have a good chance at having a non-empty extension\n        preDotState = -1;\n      }\n    }\n\n    if (startDot === -1 ||\n        end === -1 ||\n        // We saw a non-dot character immediately before the dot\n        preDotState === 0 ||\n        // The (right-most) trimmed path component is exactly '..'\n        (preDotState === 1 &&\n         startDot === end - 1 &&\n         startDot === startPart + 1)) {\n      return '';\n    }\n    return path.slice(startDot, end);\n  },\n\n\n  format: function format(pathObject) {\n    if (pathObject === null || typeof pathObject !== 'object') {\n      throw new TypeError(\n        'Parameter \"pathObject\" must be an object, not ' + typeof(pathObject)\n      );\n    }\n    return _format('/', pathObject);\n  },\n\n\n  parse: function parse(path) {\n    assertPath(path);\n\n    var ret = { root: '', dir: '', base: '', ext: '', name: '' };\n    if (path.length === 0)\n      return ret;\n    var code = path.charCodeAt(0);\n    var isAbsolute = (code === 47/*/*/);\n    var start;\n    if (isAbsolute) {\n      ret.root = '/';\n      start = 1;\n    } else {\n      start = 0;\n    }\n    var startDot = -1;\n    var startPart = 0;\n    var end = -1;\n    var matchedSlash = true;\n    var i = path.length - 1;\n\n    // Track the state of characters (if any) we see before our first dot and\n    // after any path separator we find\n    var preDotState = 0;\n\n    // Get non-dir info\n    for (; i >= start; --i) {\n      code = path.charCodeAt(i);\n      if (code === 47/*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          startPart = i + 1;\n          break;\n        }\n        continue;\n      }\n      if (end === -1) {\n        // We saw the first non-path separator, mark this as the end of our\n        // extension\n        matchedSlash = false;\n        end = i + 1;\n      }\n      if (code === 46/*.*/) {\n        // If this is our first dot, mark it as the start of our extension\n        if (startDot === -1)\n          startDot = i;\n        else if (preDotState !== 1)\n          preDotState = 1;\n      } else if (startDot !== -1) {\n        // We saw a non-dot and non-path separator before our dot, so we should\n        // have a good chance at having a non-empty extension\n        preDotState = -1;\n      }\n    }\n\n    if (startDot === -1 ||\n        end === -1 ||\n        // We saw a non-dot character immediately before the dot\n        preDotState === 0 ||\n        // The (right-most) trimmed path component is exactly '..'\n        (preDotState === 1 &&\n         startDot === end - 1 &&\n         startDot === startPart + 1)) {\n      if (end !== -1) {\n        if (startPart === 0 && isAbsolute)\n          ret.base = ret.name = path.slice(1, end);\n        else\n          ret.base = ret.name = path.slice(startPart, end);\n      }\n    } else {\n      if (startPart === 0 && isAbsolute) {\n        ret.name = path.slice(1, startDot);\n        ret.base = path.slice(1, end);\n      } else {\n        ret.name = path.slice(startPart, startDot);\n        ret.base = path.slice(startPart, end);\n      }\n      ret.ext = path.slice(startDot, end);\n    }\n\n    if (startPart > 0)\n      ret.dir = path.slice(0, startPart - 1);\n    else if (isAbsolute)\n      ret.dir = '/';\n\n    return ret;\n  },\n\n\n  sep: '/',\n  delimiter: ':',\n  posix: null\n};\n\n\nmodule.exports = posix;\n","import * as Util from '../core/Util';\nimport {Reader} from './Reader';\nimport * as epubjs from '../epubjs';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as Browser from '../core/Browser';\n\nimport path from \"path-webpack\";\n\nReader.EpubJS = Reader.extend({\n\n  initialize: function(id, options) {\n    Reader.prototype.initialize.apply(this, arguments);\n    this._epubjs_ready = false;\n    window.xpath = path;\n  },\n\n  open: function(target, callback) {\n    var self = this;\n    if ( typeof(target) == 'function' ) {\n      callback = target;\n      target = undefined;\n    }\n    if ( callback == null ) {\n      callback = function() { };\n    }\n\n    // okay, we need to do some hacking to fetch the dang files\n    // but this isn't going to be done async\n    self.rootfiles = [];\n    var request = new XMLHttpRequest();\n    request.open('GET', this.options.href + \"/META-INF/container.xml\");\n    request.responseType = 'document';\n    request.onload = function() {\n      var containerDoc = request.responseXML;\n      var rootfiles = containerDoc.querySelectorAll(\"rootfile\");\n      if ( rootfiles.length > 1 ) {\n        console.log(\"AHOY ROOTFILES MULTIPLE RENDITIONS\", rootfiles.length);\n        for(var i = 0; i < rootfiles.length; i++) {\n          var rootfile = rootfiles[i];\n          var rootfilePath = rootfile.getAttribute('full-path');\n          var label = rootfile.getAttribute('rendition:label');\n          var layout = rootfile.getAttribute('rendition:layout');\n          self.rootfiles.push({\n            rootfilePath: rootfilePath,\n            label: label,\n            layout: layout\n          })\n        }\n      }\n    }\n    request.send();\n\n    this.options.rootfilePath = this.options.rootfilePath || sessionStorage.getItem('rootfilePath');\n\n    var book_href = this.options.href;\n    var book_options = { packagePath: this.options.rootfilePath };\n    if ( this.options.useArchive ) {\n      book_href = book_href.replace(/\\/(\\w+)\\/$/, '/$1/$1.sm.epub');\n      book_options.openAs = 'epub';\n    }\n    this._book = epubjs.ePub(book_href, book_options);\n    sessionStorage.removeItem('rootfilePath');\n    // this._book = epubjs.ePub(this.options.href);\n    this._book.loaded.navigation.then(function(toc) {\n      self._contents = toc;\n      self.metadata = self._book.package.metadata;\n      self.fire('updateContents', toc);\n      self.fire('updateTitle', self._book.package.metadata);\n    })\n    this._book.ready.then(function() {\n      self.draw(target, callback);\n      if ( self.metadata.layout == 'pre-paginated' ) {\n        // fake it with the spine\n        var locations = [];\n        self._book.spine.each(function(item) {\n          locations.push(`epubcfi(${item.cfiBase}!/4/2)`);\n          self.locations._locations.push(`epubcfi(${item.cfiBase}!/4/2)`);\n        });\n        self.locations.total = locations.length;\n        var t;\n        var f = function() {\n          if ( self._rendition && self._rendition.manager && self._rendition.manager.stage ) {\n            var location = self._rendition.currentLocation();\n            if ( location && location.start) {\n              self.fire('updateLocations', locations);\n              clearTimeout(t);\n              return;\n            }\n          }\n          t = setTimeout(f, 100);\n        }\n\n        t = setTimeout(f, 100);\n      } else {\n        self._book.locations.generate(1600).then(function(locations) {\n          // console.log(\"AHOY WUT\", locations);\n          self.fire('updateLocations', locations);\n        })\n      }\n    })\n    // .then(callback);\n  },\n\n  draw: function(target, callback) {\n    var self = this;\n\n    if ( self._rendition ) {\n      // self._unbindEvents();\n      var container = self._rendition.manager.container;\n      Object.keys(self._rendition.hooks).forEach(function(key) {\n        console.log(\"AHOY draw clearing\", key);\n        self._rendition.hooks[key].clear();\n      })\n      self._rendition.destroy();\n      self._rendition = null;\n    }\n\n    this.settings = { flow: this.options.flow };\n    this.settings.manager = this.options.manager || 'default';\n\n    if ( this.settings.flow == 'auto' && this.metadata.layout == 'pre-paginated' ) {\n      // dumb check to see if the window is _tall_ enough to put\n      // two pages side by side\n      if ( this._container.offsetHeight <= this.options.forceScrolledDocHeight ) {\n        this.settings.flow = 'scrolled-doc';\n        this.settings.manager = 'prepaginated';\n      }\n    }\n\n    if ( this.settings.flow == 'auto' || this.settings.flow == 'paginated' ) {\n      this._panes['epub'].style.overflow = this.metadata.layout == 'pre-paginated' ? 'auto' : 'hidden';\n      this.settings.manager = 'default';\n    } else {\n      this._panes['epub'].style.overflow = 'auto';\n      if ( this.settings.manager == 'default' ) {\n        this.settings.manager = 'continuous';\n      }\n    }\n\n    if ( ! callback ) {\n      callback = function() { };\n    }\n\n    if ( this.metadata.layout == 'pre-paginated' && this.settings.manager == 'continuous' ) {\n        this.settings.manager = 'prepaginated';\n    }\n\n    if ( this.settings.manager == 'prepaginated' ) {\n      this.settings.spread = 'none';\n    }\n\n    // would pre-paginated work better if we scaled the default view from the start? maybe?\n    if ( false && this.metadata.layout == 'pre-paginated' && this.settings.manager == 'default' ) {\n      this.settings.spread = 'none';\n      this._panes['epub'].style.overflow = 'auto';\n    }\n\n    self.settings.height = '100%';\n    self.settings.width = '100%';\n    self.settings['ignoreClass'] = 'annotator-hl';\n\n    if ( self.options.scale != '100' ) {\n      self.settings.scale = parseInt(self.options.scale, 10) / 100;\n    }\n\n    self._panes['book'].dataset.manager = this.settings.manager + ( this.settings.spread ? `-${this.settings.spread}` : '');\n\n    self._drawRendition(target, callback);\n  },\n\n  _drawRendition: function(target, callback) {\n    var self = this;\n\n    self._rendition = self._book.renderTo(self._panes['epub'], self.settings);\n    self._updateFontSize();\n    self._bindEvents();\n    self._drawn = true;\n\n    // if ( this.metadata.layout == 'pre-paginated' && this.settings.manager == 'prepaginated' ) {\n    //   this._panes['epub'].style.overflowX = 'hidden';\n    // }\n\n    var status_index = 0;\n    self._rendition.on('started', function() {\n\n      //var t;\n      //t = setInterval(function() {\n      //  if ( self._rendition.manager.stage && self.metadata.layout == 'pre-paginated' && self.settings.manager == 'default' ) {\n      //    self._rendition.manager.scale(1.75);\n      //    clearInterval(t)\n      // }\n      //}, 100);\n\n      self._rendition.manager.on(\"building\", function(status) {\n        if ( status ) {\n          status_index += 1;\n          self._panes['loader-status'].innerHTML = `<span>${Math.round((status_index / status.total) * 100.0)}%</span>`;\n        } else {\n          self._enableBookLoader(-1);\n        }\n      })\n      self._rendition.manager.on(\"built\", function() {\n        console.log(\"AHOY manager built\");\n        self._disableBookLoader(true);\n      })\n    })\n    // self._rendition.on('attached', attached_callback)\n\n    self._rendition.hooks.content.register(function(contents) {\n      self.fire('ready:contents', contents);\n      self.fire('readyContents', contents);\n      contents.document.addEventListener('keydown', (event) => {\n        const keyName = event.key;\n        self.fire('keyDown', { keyName: keyName, shiftKey: event.shiftKey, inner: true });\n        console.log('inner keydown event: ', keyName);\n      });\n    })\n\n    if ( target && target.start ) { target = target.start; }\n    if ( ! target && window.location.hash ) {\n      if ( window.location.hash.substr(1, 3) == '/6/' ) {\n        target = \"epubcfi(\" + window.location.hash.substr(1) + \")\";\n      } else {\n        target = window.location.hash.substr(2);\n        target = self._book.url.path().resolve(target);\n      }\n    }\n\n    self.gotoPage(target, function() {\n      window._loaded = true;\n      self._initializeReaderStyles();\n\n      if ( callback ) { callback(); }\n\n      self._epubjs_ready = true;\n\n      setTimeout(function() {\n        self.fire('opened');\n        self.fire('ready');\n        clearTimeout(self._queueTimeout);\n        self.tracking.event(\"openBook\", {\n          rootFilePath: self.options.rootFilePath,\n          flow: self.settings.flow,\n          manager: self.settings.manager\n        });\n      }, 100);\n\n    })\n  },\n\n  _scroll: function(delta) {\n    var self = this;\n    if ( self.options.flow == 'XXscrolled-doc' ) {\n      var container = self._rendition.manager.container;\n      var rect = container.getBoundingClientRect();\n      var scrollTop = container.scrollTop;\n      var newScrollTop = scrollTop;\n      var scrollBy = ( rect.height * 0.98 );\n      switch(delta) {\n        case 'PREV':\n          newScrollTop = -( scrollTop + scrollBy );\n          break;\n        case 'NEXT':\n          newScrollTop = ( scrollTop + scrollBy );\n          break;\n        case 'HOME':\n          newScrollTop = 0;\n          break;\n        case 'END':\n          newScrollTop = container.scrollHeight - scrollBy;\n          break;\n      }\n      container.scrollTop = newScrollTop;\n      return ( Math.floor(container.scrollTop) != Math.floor(scrollTop) );\n    }\n    return false;\n  },\n\n  _navigate: function(promise, callback) {\n    var self = this;\n    self._enableBookLoader(100);\n    promise.then(function() {\n      console.log(\"AHOY NAVIGATE FIN\");\n      self._disableBookLoader();\n      if ( callback ) { callback(); }\n    }).catch(function(e) {\n      self._disableBookLoader();\n      if ( callback ) { callback(); }\n      console.log(\"AHOY NAVIGATE ERROR\", e);\n      throw(e);\n    })\n  },\n\n  next: function() {\n    var self = this;\n    this.tracking.action('reader/go/next');\n    self._scroll('NEXT') || self._navigate(this._rendition.next());\n  },\n\n  prev: function() {\n    this.tracking.action('reader/go/previous');\n    this._scroll('PREV') || this._navigate(this._rendition.prev());\n  },\n\n  first: function() {\n    this.tracking.action('reader/go/first');\n    this._navigate(this._rendition.display(0), undefined);\n  },\n\n  last: function() {\n    var self = this;\n    this.tracking.action('reader/go/last');\n    var target = this._book.spine.length - 1;\n    this._navigate(this._rendition.display(target), undefined);\n  },\n\n  gotoPage: function(target, callback) {\n    if ( target != null ) {\n      var section = this._book.spine.get(target);\n      if ( ! section) {\n        // maybe it needs to be resolved\n        var guessed = target;\n        if ( guessed.indexOf(\"://\") < 0 ) {\n          var path1 = path.resolve(this._book.path.directory, this._book.package.navPath);\n          var path2 = path.resolve(path.dirname(path1), target);\n          guessed = this._book.canonical(path2);\n        }\n        if ( guessed.indexOf(\"#\") !== 0 ) {\n          guessed = guessed.split('#')[0];\n        }\n\n        this._book.spine.each(function(item) {\n          if ( item.canonical == guessed ) {\n            section = item;\n            target = section.href;\n            return;\n          }\n        })\n\n        console.log(\"AHOY GUESSED\", target);\n      } else if ( target.toString().match(/^\\d+$/) ) {\n        console.log(\"AHOY USING\", section.href);\n        target = section.href;\n      }\n\n      if ( ! section ) {\n        if ( ! this._epubjs_ready ) {\n          target = 0;\n        } else {\n          return;\n        }\n      }\n    }\n\n    console.log(\"AHOY gotoPage\", target);\n\n    var navigating = this._rendition.display(target).then(function() {\n      this._rendition.display(target);\n    }.bind(this));\n    this._navigate(navigating, callback);\n  },\n\n  percentageFromCfi: function(cfi) {\n    return this._book.percentageFromCfi(cfi);\n  },\n\n  destroy: function() {\n    if ( this._rendition ) {\n      try {\n        this._rendition.destroy();\n      } catch(e) {}\n    }\n    this._rendition = null;\n    this._drawn = false;\n  },\n\n  reopen: function(options, target) {\n    // different per reader?\n    var target = target || this.currentLocation();\n    if( target.start ) { target = target.start ; }\n    if ( target.cfi ) { target = target.cfi ; }\n\n    var doUpdate = false;\n    if ( options === true ) { doUpdate = true; options = {}; }\n    var changed = {};\n    Object.keys(options).forEach(function(key) {\n      if ( options[key] != this.options[key] ) {\n        doUpdate = true;\n        changed[key] = true;\n      }\n      // doUpdate = doUpdate || ( options[key] != this.options[key] );\n    }.bind(this));\n\n    if ( ! doUpdate ) {\n      return;\n    }\n\n    // performance hack\n    if ( Object.keys(changed).length == 1 && changed.scale ) {\n      reader.options.scale = options.scale;\n      this._updateScale();\n      return;\n    }\n\n    if ( options.rootfilePath && options.rootfilePath != this.options.rootfilePath ) {\n      // we need to REOPEN THE DANG BOOK\n      sessionStorage.setItem('rootfilePath', options.rootfilePath);\n      location.reload();\n      return;\n    }\n\n    Util.extend(this.options, options);\n\n    this.draw(target, function() {\n      this._updateFontSize();\n      this._updateScale();\n      this._updateTheme();\n      this._selectTheme(true);\n    }.bind(this))\n  },\n\n  currentLocation: function() {\n    if ( this._rendition && this._rendition.manager ) {\n      this._cached_location = this._rendition.currentLocation();\n    }\n    return this._cached_location;\n  },\n\n  _bindEvents: function() {\n    var self = this;\n\n    // add a stylesheet to stop images from breaking their columns\n    var add_max_img_styles = false;\n    if ( this._book.package.metadata.layout == 'pre-paginated' ) {\n      // NOOP\n    } else if ( this.options.flow == 'auto' || this.options.flow == 'paginated' ) {\n      add_max_img_styles = true;\n    }\n\n    var custom_stylesheet_rules = [];\n\n    // force 90% height instead of default 60%\n    if ( this.metadata.layout != 'pre-paginated' ) {\n      this._rendition.hooks.content.register(function(contents) {\n        contents.addStylesheetRules({\n          \"img\" : {\n            \"max-width\": (this._layout.columnWidth ? this._layout.columnWidth + \"px\" : \"100%\") + \"!important\",\n            \"max-height\": (this._layout.height ? (this._layout.height * 0.9) + \"px\" : \"90%\") + \"!important\",\n            \"object-fit\": \"contain\",\n            \"page-break-inside\": \"avoid\"\n          },\n          \"svg\" : {\n            \"max-width\": (this._layout.columnWidth ? this._layout.columnWidth + \"px\" : \"100%\") + \"!important\",\n            \"max-height\": (this._layout.height ? (this._layout.height * 0.9) + \"px\" : \"90%\") + \"!important\",\n            \"page-break-inside\": \"avoid\"\n          }\n        });\n      }.bind(this._rendition))\n    } else {\n      this._rendition.hooks.content.register(function(contents) {\n        contents.addStylesheetRules({\n          \"img\" : {\n            // \"border\": \"64px solid black !important\",\n            \"box-sizing\": \"border-box !important\"\n          },\n          \"figure\": {\n            \"box-sizing\": \"border-box !important\",\n            \"margin\": \"0 !important\"\n          }\n        });\n      }.bind(this._rendition));\n    }\n\n    this._updateFontSize();\n\n    if ( custom_stylesheet_rules.length ) {\n      this._rendition.hooks.content.register(function(view) {\n        view.addStylesheetRules(custom_stylesheet_rules);\n      })\n    }\n\n    this._rendition.on('resized', function(box) {\n      self.fire('resized', box);\n    })\n\n    this._rendition.on('relocated', function(location) {\n      self.fire('relocated', location);\n    })\n\n    this._rendition.on('displayerror', function(err) {\n      console.log(\"AHOY RENDITION DISPLAY ERROR\", err);\n    })\n\n    this._rendition.on(\"locationChanged\", function(location) {\n      var view = this.manager.current();\n      var section = view.section;\n      var current = this.book.navigation.get(section.href);\n\n      self.fire(\"updateSection\", current);\n      self.fire(\"updateLocation\", location);\n      // self.fire(\"relocated\", location);\n    });\n\n    this._rendition.on(\"rendered\", function(section, view) {\n\n      if ( view.contents ) {\n        // view.contents.on(\"xxlinkClicked\", function(href) {\n        //   console.log(\"AHOY CLICKED\", href);\n        //   var tmp = href.split(\"#\");\n        //   href = tmp[0];\n        //   var hash = tmp[1]\n        //   // var current = self.currentLocation().start.href;\n        //   // var section = self._book.spine.get(current.href);\n        //   console.log(\"AHOY CLICKED CHECK\", section.canonical, href);\n        //   if ( section.canonical.indexOf(href) < 0 ) {\n        //     self.gotoPage(href);\n        //     // self._rendition.display(href);\n\n        //   } else if ( hash ) {\n        //     // we're already on this page, so we need to scroll to this location\n        //     var node = view.contents.content.querySelector('#' + hash);\n        //     console.log(\"AHOY INTERNAL\", hash, view.contents, node);\n        //   }\n        //   // self._rendition.display(href);\n        // })\n      }\n\n      if(false) {\n        if ( ! self._rendition.manager.container.dataset.__scroll ) {\n          var ticking;\n          self._rendition.manager.container.addEventListener(\"scroll\", function(event) {\n            if ( self._rendition && self._rendition.manager ) {\n              var container = self._rendition.manager.container;\n              var mod = container.scrollLeft % parseInt(self._rendition.manager.layout.delta, 10);\n              console.log(\"AHOY DETECTED SCROLL\", mod, mod / self._rendition.manager.layout.delta);\n            }\n          });\n          self._rendition.manager.container.dataset.__scroll = true;\n        }\n      }\n\n      self.on('keyDown', function(data) {\n        if ( data.keyName == 'Tab' && data.inner ) {\n          var container = self._rendition.manager.container;\n          var mod;\n          var delta;\n          var x; var xyz;\n          setTimeout(function() {\n            var scrollLeft = container.scrollLeft;\n            mod = scrollLeft % parseInt(self._rendition.manager.layout.delta, 10);\n            if ( mod > 0 && ( mod / self._rendition.manager.layout.delta ) < 0.99 ) {\n              // var x = Math.floor(event.target.scrollLeft / parseInt(self._rendition.manager.layout.delta, 10)) + 1;\n              // var delta = ( x * self._rendition.manager.layout.delta) - event.target.scrollLeft;\n              x = Math.floor(container.scrollLeft / parseInt(self._rendition.manager.layout.delta, 10));\n              if ( data.shiftKey ) { x -= 0 ; }\n              else { x += 1; }\n              var y = container.scrollLeft;\n              delta = ( x * self._rendition.manager.layout.delta ) - y;\n              xyz = ( x * self._rendition.manager.layout.delta );\n              // if ( data.shiftKey ) { delta *= -1 ; }\n              if ( true || ! data.shiftKey ) {\n                self._rendition.manager.scrollBy(delta);\n              }\n            }\n            console.log(\"AHOY DOING THE SCROLLING\", data.shiftKey, scrollLeft, mod, x, xyz, delta);\n          }, 0);\n        }\n      })\n\n\n    })\n  },\n\n  _initializeReaderStyles: function() {\n    var self = this;\n    var themes = this.options.themes;\n    if ( themes ) {\n      themes.forEach(function(theme) {\n        self._rendition.themes.register(theme['klass'], theme.href ? theme.href : theme.rules);\n      })\n    }\n\n    // base for highlights\n    this._rendition.themes.override('.epubjs-hl', \"fill: yellow; fill-opacity: 0.3; mix-blend-mode: multiply;\");\n  },\n\n  _selectTheme: function(refresh) {\n    var theme = this.options.theme || 'default';\n    this._rendition.themes.select(theme);\n    if ( 0 && refresh ) {\n      var cfi = this.currentLocation().end.cfi;\n      this._rendition.manager.clear();\n      console.log(\"AHOY\", cfi);\n      this._rendition.display(cfi);\n    }\n  },\n\n  _updateFontSize: function() {\n    if ( this.metadata.layout == 'pre-paginated') {\n      // we're not doing font changes for pre-paginted\n      return;\n    }\n\n    var text_size = this.options.text_size == 'auto' ? 100 : this.options.text_size;\n    this._rendition.themes.fontSize(`${text_size}%`);\n  },\n\n  _updateScale: function() {\n    if ( this.metadata.layout != 'pre-paginated') {\n      // we're not scaling for reflowable\n      return;\n    }\n    var scale = this.options.scale;\n    if ( scale ) {\n      scale = parseInt(scale, 10) / 100.0;\n      this._rendition.scale(scale);\n    }\n  },\n\n  EOT: true\n\n})\n\nObject.defineProperty(Reader.EpubJS.prototype, 'metadata', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    return this._metadata;\n  },\n\n  set: function(data) {\n    this._metadata = Util.extend({}, data, this.options.metadata);\n  }\n});\n\nObject.defineProperty(Reader.EpubJS.prototype, 'annotations', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    if ( Browser.ie ) {\n      return {\n        reset: function() { /* NOOP */ },\n        highlight: function(cfiRange) { /* NOOP */ }\n      }\n    }\n    if ( ! this._rendition.annotations.reset ) {\n      this._rendition.annotations.reset = function(){\n        for(var hash in this._annotations) {\n            var cfiRange = decodeURI(hash);\n            this.remove(cfiRange);\n        }\n        this._annotationsBySectionIndex = {};\n      }.bind(this._rendition.annotations);\n    }\n    return this._rendition.annotations;\n  }\n});\n\nObject.defineProperty(Reader.EpubJS.prototype, 'locations', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    return this._book.locations;\n  }\n});\n\nwindow.Reader = Reader;\n\nexport function createReader(id, options) {\n  return new Reader.EpubJS(id, options);\n}\n","import * as Util from '../core/Util';\nimport {Reader} from './Reader';\nimport * as DomUtil from '../dom/DomUtil';\n\nReader.Mock = Reader.extend({\n\n  initialize: function(id, options) {\n    Reader.prototype.initialize.apply(this, arguments);\n  },\n\n  open: function(target, callback) {\n    var self = this;\n    this._book = {\n      metadata: {\n        title: 'The Mock Life',\n        creator: 'Alex Mock',\n        publisher: 'University Press',\n        location: 'Ann Arbor, MI',\n        pubdate: '2017-05-23'\n      },\n      contents: {\n        toc: [\n          {id: 1, href: \"/epubs/mock/ops/xhtml/TitlePage.xhtml\", label: \"Title\", parent: null},\n          {id: 2, href: \"/epubs/mock/ops/xhtml/Chapter01.xhtml\", label: \"Chapter 1\", parent: null},\n          {id: 3, href: \"/epubs/mock/ops/xhtml/Chapter02.xhtml\", label: \"Chapter 2\", parent: null},\n          {id: 4, href: \"/epubs/mock/ops/xhtml/Chapter03.xhtml\", label: \"Chapter 3\", parent: null},\n          {id: 5, href: \"/epubs/mock/ops/xhtml/Chapter04.xhtml\", label: \"Chapter 4\", parent: null},\n          {id: 6, href: \"/epubs/mock/ops/xhtml/Chapter05.xhtml\", label: \"Chapter 5\", parent: null},\n          {id: 7, href: \"/epubs/mock/ops/xhtml/Chapter06.xhtml\", label: \"Chapter 6\", parent: null},\n          {id: 8, href: \"/epubs/mock/ops/xhtml/Chapter07.xhtml\", label: \"Chapter 7\", parent: null},\n          {id: 9, href: \"/epubs/mock/ops/xhtml/Index.xhtml\", label: \"Index\", parent: null},\n        ]\n      }\n    };\n\n    this._locations = [\n      'epubcfi(/6/4[TitlePage.xhtml])',\n      'epubcfi(/6/4[Chapter01.xhtml])',\n      'epubcfi(/6/4[Chapter02.xhtml])',\n      'epubcfi(/6/4[Chapter03.xhtml])',\n      'epubcfi(/6/4[Chapter04.xhtml])',\n      'epubcfi(/6/4[Chapter05.xhtml])',\n      'epubcfi(/6/4[Chapter06.xhtml])',\n      'epubcfi(/6/4[Chapter07.xhtml])',\n      'epubcfi(/6/4[Chapter08.xhtml])',\n      'epubcfi(/6/4[Index.xhtml])',\n    ];\n\n    this.__currentIndex = 0;\n\n    this.metadata = this._book.metadata;\n    this.fire('updateContents', this._book.contents);\n    this.fire('updateTitle', this._metadata);\n    this.fire('updateLocations', this._locations);\n    this.draw(target, callback);\n  },\n\n  draw: function(target, callback) {\n    var self = this;\n    this.settings = { flow: this.options.flow };\n    this.settings.height = '100%';\n    this.settings.width = '99%';\n    // this.settings.width = '100%';\n    if ( this.options.flow == 'auto' ) {\n      this._panes['book'].style.overflow = 'hidden';\n    } else {\n      this._panes['book'].style.overflow = 'auto';\n    }\n    if ( typeof(target) == 'function' && cb === undefined ) {\n      callback = target;\n      target = undefined;\n    }\n    callback();\n    self.fire('ready');\n  },\n\n  next: function() {\n    // this._rendition.next();\n  },\n\n  prev: function() {\n    // this._rendition.prev();\n  },\n\n  first: function() {\n    // this._rendition.display(0);\n  },\n\n  last: function() {\n  },\n\n  gotoPage: function(target) {\n    if ( typeof(target) == \"string\" ) {\n      this.__currentIndex = this._locations.indexOf(target);\n    } else {\n      this.__currentIndex = target;\n    }\n    this.fire(\"relocated\", this.currentLocation());\n  },\n\n  destroy: function() {\n    // if ( this._rendition ) {\n    //   this._rendition.destroy();\n    // }\n    // this._rendition = null;\n  },\n\n  currentLocation: function() {\n    var cfi = this._locations[this.__currentIndex];\n    return {\n      start: { cfi: cfi, href: cfi },\n      end: { cfi: cfi, href: cfi }\n    }\n  },\n\n  _bindEvents: function() {\n    var self = this;\n\n  },\n\n  _updateTheme: function() {\n\n  },\n\n  EOT: true\n\n})\n\nObject.defineProperty(Reader.Mock.prototype, 'metadata', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    return this._metadata;\n  },\n\n  set: function(data) {\n    this._metadata = Util.extend({}, data, this.options.metadata);\n  }\n});\n\nObject.defineProperty(Reader.Mock.prototype, 'locations', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    var self = this;\n    return {\n      total: self._locations.length,\n      locationFromCfi: function(cfi) {\n        return self._locations.indexOf(cfi);\n      },\n      percentageFromCfi: function(cfi) {\n        var index = self.locations.locationFromCfi(cfi);\n        return ( index / self.locations.total );\n      },\n      cfiFromPercentage: function(percentage) {\n        var index = Math.ceil(percentage * 10);\n        return self._locations[index];\n      }\n    }\n  }\n});\n\nObject.defineProperty(Reader.Mock.prototype, 'annotations', {\n  get: function() {\n    return {\n      reset: function() {},\n      highlight: function() {}\n    }\n  }\n})\n\nexport function createReader(id, options) {\n  return new Reader.Mock(id, options);\n}\n","import {Reader} from './Reader';\nimport * as EpubJS from './Reader.EpubJS';\nimport * as Mock from './Reader.Mock';\n\nvar engines = {\n  epubjs: EpubJS.createReader,\n  mock: Mock.createReader\n}\n\nexport var reader = function(id, options) {\n  options = options || {};\n  var engine = options.engine || window.COZY_EPUB_ENGINE || 'epubjs';\n  var engine_href = options.engine_href || window.COZY_EPUB_ENGINE_HREF;\n  var _this = this;\n  var _arguments = arguments;\n\n  options.engine = engine;\n  options.engine_href = engine_href;\n\n  return engines[engine].apply(_this, [id, options]);\n}"],"names":["global","this","extend","dest","i","j","len","src","arguments","length","create","Object","F","proto","prototype","bind","fn","obj","slice","Array","apply","call","args","concat","lastId","stamp","_cozy_id","throttle","time","context","lock","wrapperFn","later","wrapNum","x","range","includeMax","max","min","d","falseFn","formatNum","num","digits","pow","Math","round","isNumeric","isNaN","parseFloat","isFinite","trim","str","replace","splitWords","split","setOptions","options","hasOwnProperty","getParamString","existingUrl","uppercase","params","push","encodeURIComponent","toUpperCase","indexOf","join","templateRe","template","data","key","value","undefined","Error","isArray","toString","array","el","emptyImageUrl","getPrefixed","name","window","lastTime","timeoutDefer","Date","timeToCall","setTimeout","requestFn","requestAnimationFrame","cancelFn","cancelAnimationFrame","id","clearTimeout","requestAnimFrame","immediate","cancelAnimFrame","loader","url","handler","_resolved","callbacks","error","then","cb","resolve","catch","reject","_argv","shift","retval","e","log","trace","element","document","createElement","onload","onerror","async","parent","attr","appendChild","Class","props","NewClass","initialize","callInitHooks","parentProto","__super__","Util","constructor","statics","includes","_initHooks","_initHooksCalled","include","mergeOptions","addInitHook","init","checkDeprecatedMixinEvents","cozy","Mixin","Evented","types","type","_on","_events","_off","typeListeners","newListener","ctx","listeners","l","_firingCount","splice","propagate","listens","event","target","_propagateEvent","_eventParents","once","off","on","fire","layer","addEventListener","removeEventListener","clearAllEventListeners","addOneTimeEventListener","fireEvent","hasEventListeners","style","documentElement","ie","ielt9","edge","navigator","webkit","userAgentContains","android","android23","opera","chrome","gecko","safari","phantom","opera12","win","platform","ie3d","webkit3d","WebKitCSSMatrix","gecko3d","any3d","L_DISABLE_3D","mobile","orientation","mobileWebkit","mobileWebkit3d","msPointer","PointerEvent","MSPointerEvent","pointer","touch","L_NO_TOUCH","DocumentTouch","mobileOpera","mobileGecko","retina","devicePixelRatio","screen","deviceXDPI","logicalXDPI","canvas","getContext","svg","vml","div","innerHTML","shape","firstChild","behavior","babelHelpers.typeof","adj","columnCount","classList","userAgent","toLowerCase","Point","y","point","clone","_add","toPoint","_subtract","_divideBy","_multiplyBy","_round","_floor","floor","_ceil","ceil","sqrt","abs","POINTER_DOWN","Browser","POINTER_MOVE","POINTER_UP","POINTER_CANCEL","TAG_WHITE_LIST","_pointers","_pointerDocListener","_pointersCount","addPointerListener","removePointerListener","_addPointerStart","onDown","pointerType","MSPOINTER_TYPE_MOUSE","tagName","_globalPointerDown","_globalPointerMove","_globalPointerUp","pointerId","_handlePointer","touches","changedTouches","_addPointerMove","onMove","buttons","_addPointerEnd","onUp","_touchstart","_touchend","_pre","addDoubleTapListener","last","doubleTap","delay","onTouchStart","count","now","delta","onTouchEnd","cancelBubble","newTouch","prop","removeDoubleTapListener","touchstart","touchend","dblclick","eventsKey","addOne","originalHandler","isExternalTarget","attachEvent","removeOne","detachEvent","stopPropagation","originalEvent","_stopped","disableScrollPropagation","disableClickPropagation","fakeStop","preventDefault","returnValue","stop","getMousePosition","container","clientX","clientY","rect","getBoundingClientRect","left","clientLeft","top","clientTop","wheelPxFactor","getWheelDelta","wheelDeltaY","deltaY","deltaMode","deltaX","deltaZ","wheelDelta","detail","skipEvents","skipped","events","related","relatedTarget","parentNode","err","lastClick","filterClick","timeStamp","elapsed","_simulatedClick","_simulated","Element","matches","ep","webkitMatchesSelector","msMatchesSelector","mozMatchesSelector","TRANSFORM","testProp","TRANSITION","TRANSITION_END","get","getElementById","getStyle","currentStyle","defaultView","css","getComputedStyle","className","remove","removeChild","empty","toFront","toBack","insertBefore","hasClass","contains","getClass","RegExp","test","addClass","classes","add","removeClass","setClass","baseVal","setOpacity","opacity","_setOpacityIE","filter","filterName","filters","item","Enabled","Opacity","isPropertySupported","setTransform","offset","scale","pos","setPosition","_leaflet_pos","getPosition","disableTextSelection","enableTextSelection","_userSelect","DomEvent","userSelectProperty","disableImageDrag","enableImageDrag","_outlineElement","_outlineStyle","preventOutline","tabIndex","outline","restoreOutline","freeGlobal","Symbol","root","symToStringTag","objectProto","nativeObjectToString","getRawTag","objectToString","isObject","baseGetTag","coreJsData","funcProto","funcToString","isMasked","isFunction","toSource","getValue","baseIsNative","defineProperty","getNative","eq","baseAssignValue","assignValue","nativeMax","identity","constant","shortOut","baseSetToString","setToString","overRest","isLength","MAX_SAFE_INTEGER","isArrayLike","isIndex","baseRest","isIterateeCall","isObjectLike","baseIsArguments","stubFalse","argsTag","funcTag","nodeUtil","baseUnary","baseIsTypedArray","isArguments","isBuffer","isTypedArray","baseTimes","overArg","isPrototype","nativeKeys","arrayLikeKeys","baseKeys","createAssigner","copyObject","keys","keyboardAllowed","val","fnMap","ret","eventNameMap","fullscreenchange","fullscreenerror","screenfull","elem","request","requestFullscreen","ALLOW_KEYBOARD_INPUT","exitFullscreen","isFullscreen","exit","callback","eventName","defineProperties","Boolean","fullscreenElement","fullscreenEnabled","Reader","self","_original_document_title","title","localStorage","getItem","assign","JSON","parse","_checkFeatureCompatibility","metadata","_initContainer","_initLayout","themes","forEach","theme","href","klass","rules","rule","new_rule","_updateTheme","_initEvents","_mode","mode","js","engine_href","_start","_loaded","open","saved_options","flow","setItem","stringify","_container","dataset","index","back","forward","enabled","toggle","DomUtil","_onScroll","_containerId","_fadeAnimated","fadeAnimation","engine","position","_initPanes","panes","_panes","prefix","_initBookLoader","_targets","tracking","reader","_action","_last_location_start","_reader","v","pop","action","location","start","cfi","onOff","transform3DLimit","_onMoveEnd","location_href","_ignoreHistory","pageview","tmp_href","substr","pushState","percentage","p","isTrusted","state","gotoPage","keyName","check","activeElement","localName","parentElement","IGNORE_TARGETS","shiftKey","next","prev","_scroll","scrollTop","scrollLeft","keyCode","srcElement","_fireDOMEvent","targets","synth","_findEventTargets","isMarker","containerPoint","latLngToContainerPoint","getLatLng","mouseEventToContainerPoint","layerPoint","containerPointToLayerPoint","latlng","layerPointToLatLng","nonBubblingEvents","h","clientHeight","paddingTop","paddingBottom","w","clientWidth","paddingRight","paddingLeft","height","width","_drawn","_resizeRequest","_checkMobileDevice","text_size","_isMobile","mobileMediaQuery","matchMedia","_clearBookLoaderTimeout","_force_progress","_loader_timeout","display","force","loader_template","loaderTemplate","body","DOMParser","parseFromString","children","Control","_locked","_id","getTime","parseInt","random","region","removeControl","addControl","onAdd","getRegion","area","getControlRegion","onRemove","screenX","screenY","getContainer","focus","widget","direction","control","addTo","_controlContainer","parts","tmp","slug","panel","slot","childElement","_classify","_controlRegions","PageControl","_control","querySelector","_className","_createButton","_fill","html","label","_bindEvents","link","setAttribute","s","unit","_unit","PagePrevious","PageNext","PageFirst","first","PageLast","pageNext","pagePrevious","pageFirst","pageLast","activeModal","FOCUSABLE_ELEMENTS","ACTIONABLE_ELEMENTS","Modal","onShow","onClose","_initializedEvents","actions","handlers","panelHTML","main","button_cls","modal","onClick","onKeydown","onModalTransition","button_id","button","close","closeModal","removeEventListeners","_resize","setFocusToFirstNode","addEventListeners","showModal","offsetHeight","offsetWidth","fraction","header","footer","nodes","querySelectorAll","map","focusableNodes","getFocusableNodes","maintainFocus","closeAfterAction","hasAttribute","actionableNodes","getActionableNodes","click","did_match","selector","getAttribute","focusedItemIndex","Contents","defaultTemplate","_modal","activate","_setupSkipLink","_process","items","tabindex","option","_createOption","subitems","toc","chapter","anchor","textContent","span","skipLink","ul","contents","Title","h1","_title","_divider","_section","bookTitle","PublicationMetadata","_publisher","_rights","publisher","rights","publicationMetadata","Preferences","_activated","updatePreferences","initializeForm","possible_fieldsets","layout","rootfiles","hasThemes","_fieldsets","cls","fieldset","fields","hasFields","field","inputs","input","checked","hint","_form","_createPanel","doUpdate","new_options","saveable_options","updateForm","deactivate","saveOptions","reopen","Fieldset","_current","TextSize","form","_input","_output","_preview","_actionReset","_updatePreview","saveable","fontSize","Display","scrolled_help","Theme","Rendition","rootfilePath","expr","rootfile","accessMode","Scale","transform","preferences","Widget","_onAddExtra","_updateTemplate","_updateClass","node","Button","Panel","Toggle","states","stateName","_resetState","_state","Citation","designMode","formatted","createRange","selectNode","sel","getSelection","removeAllRanges","addRange","flag","execCommand","_message","detach","citations","citation","format","text","createTextNode","_formatted","_initializeForm","_formatCitation","selected","Search","_data","_canceled","_processing","_article","searchString","openModalResults","openModalWaiting","submitQuery","_emptyArticle","_buildResults","searchUrl","XMLHttpRequest","status","response","send","hasChildNodes","lastChild","content","annotations","reset","highlight","highlight_off","search_results","result","cfiRange","snippet","chapterTitle","search","BibliographicInformation","dl","metadata_fields","metadata_fields_seen","idx","_formatDate","dt","dd","match","bibliographicInformation","Download","_configureDownloadForm","submit","download_links","size","download","Navigator","_setup","locations","_initializeNavigator","_createControl","_background","_status","_spanCurrentPercentage","_spanCurrentLocation","_spanTotalLocations","_update","_mouseDown","_initiated","percentageFromCfi","currentLocation","cfiFromPercentage","current","rangeBg","current_location","locationFromCfi","_last_delta","_last_value","_total","total","Bus","instance","bus","Events","ePub","require","EpubJS","_epubjs_ready","xpath","path","responseType","containerDoc","responseXML","sessionStorage","book_href","book_options","packagePath","useArchive","openAs","_book","epubjs","removeItem","loaded","navigation","_contents","package","ready","draw","spine","each","cfiBase","_locations","t","f","_rendition","manager","stage","generate","hooks","clear","destroy","settings","forceScrolledDocHeight","overflow","spread","_drawRendition","renderTo","_updateFontSize","status_index","_enableBookLoader","_disableBookLoader","register","inner","hash","_initializeReaderStyles","_queueTimeout","rootFilePath","newScrollTop","scrollBy","scrollHeight","promise","_navigate","section","guessed","path1","directory","navPath","path2","dirname","canonical","navigating","changed","_updateScale","reload","_selectTheme","_cached_location","add_max_img_styles","custom_stylesheet_rules","addStylesheetRules","_layout","columnWidth","view","box","book","mod","xyz","override","refresh","select","end","_metadata","_annotations","decodeURI","_annotationsBySectionIndex","createReader","Mock","__currentIndex","engines","COZY_EPUB_ENGINE","COZY_EPUB_ENGINE_HREF","_this","_arguments"],"mappings":"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"}
>>>>>>> e2283b9... fix overflow when scaling pre-paginated + default manager
=======
{"version":3,"file":"cozy-sun-bear.js","sources":["../node_modules/url-polyfill/url-polyfill.js","../node_modules/classlist-polyfill/src/index.js","../src/core/Util.js","../src/core/Class.js","../src/core/Events.js","../src/core/Browser.js","../src/geometry/Point.js","../src/dom/DomEvent.Pointer.js","../src/dom/DomEvent.DoubleTap.js","../src/dom/DomEvent.js","../src/dom/DomUtil.js","../node_modules/lodash/isObject.js","../node_modules/lodash/_freeGlobal.js","../node_modules/lodash/_root.js","../node_modules/lodash/_Symbol.js","../node_modules/lodash/_getRawTag.js","../node_modules/lodash/_objectToString.js","../node_modules/lodash/_baseGetTag.js","../node_modules/lodash/isObjectLike.js","../node_modules/lodash/isFunction.js","../node_modules/lodash/_coreJsData.js","../node_modules/lodash/_isMasked.js","../node_modules/lodash/_toSource.js","../node_modules/lodash/_baseIsNative.js","../node_modules/lodash/_getValue.js","../node_modules/lodash/_getNative.js","../node_modules/lodash/_defineProperty.js","../node_modules/lodash/_baseAssignValue.js","../node_modules/lodash/eq.js","../node_modules/lodash/_assignValue.js","../node_modules/lodash/_copyObject.js","../node_modules/lodash/identity.js","../node_modules/lodash/_apply.js","../node_modules/lodash/_overRest.js","../node_modules/lodash/constant.js","../node_modules/lodash/_baseSetToString.js","../node_modules/lodash/_shortOut.js","../node_modules/lodash/_setToString.js","../node_modules/lodash/_baseRest.js","../node_modules/lodash/isLength.js","../node_modules/lodash/isArrayLike.js","../node_modules/lodash/_isIndex.js","../node_modules/lodash/_isIterateeCall.js","../node_modules/lodash/_createAssigner.js","../node_modules/lodash/_isPrototype.js","../node_modules/lodash/_baseTimes.js","../node_modules/lodash/_baseIsArguments.js","../node_modules/lodash/isArguments.js","../node_modules/lodash/isArray.js","../node_modules/lodash/stubFalse.js","../node_modules/lodash/isBuffer.js","../node_modules/lodash/_baseIsTypedArray.js","../node_modules/lodash/_baseUnary.js","../node_modules/lodash/_nodeUtil.js","../node_modules/lodash/isTypedArray.js","../node_modules/lodash/_arrayLikeKeys.js","../node_modules/lodash/_overArg.js","../node_modules/lodash/_nativeKeys.js","../node_modules/lodash/_baseKeys.js","../node_modules/lodash/keys.js","../node_modules/lodash/assign.js","../src/screenfull.js","../src/reader/Reader.js","../src/control/Control.js","../src/control/Control.Paging.js","../src/control/Modal.js","../src/control/Control.Contents.js","../src/control/Control.Title.js","../src/control/Control.PublicationMetadata.js","../src/control/Control.Preferences.js","../src/control/Control.Widget.js","../src/control/Control.Citation.js","../src/control/Control.Search.js","../src/control/Control.BibliographicInformation.js","../src/control/Control.Download.js","../src/control/Control.Navigator.js","../src/control/index.js","../src/core/Bus.js","../src/core/index.js","../src/epubjs.js","../node_modules/path-webpack/path.js","../src/reader/Reader.EpubJS.js","../src/reader/Reader.Mock.js","../src/reader/index.js"],"sourcesContent":["(function(global) {\r\n  /**\r\n   * Polyfill URLSearchParams\r\n   *\r\n   * Inspired from : https://github.com/WebReflection/url-search-params/blob/master/src/url-search-params.js\r\n   */\r\n\r\n  var checkIfIteratorIsSupported = function() {\r\n    try {\r\n      return !!Symbol.iterator;\r\n    } catch(error) {\r\n      return false;\r\n    }\r\n  };\r\n\r\n\r\n  var iteratorSupported = checkIfIteratorIsSupported();\r\n\r\n  var createIterator = function(items) {\r\n    var iterator = {\r\n      next: function() {\r\n        var value = items.shift();\r\n        return { done: value === void 0, value: value };\r\n      }\r\n    };\r\n\r\n    if(iteratorSupported) {\r\n      iterator[Symbol.iterator] = function() {\r\n        return iterator;\r\n      };\r\n    }\r\n\r\n    return iterator;\r\n  };\r\n\r\n  /**\r\n   * Search param name and values should be encoded according to https://url.spec.whatwg.org/#urlencoded-serializing\r\n   * encodeURIComponent() produces the same result except encoding spaces as `%20` instead of `+`.\r\n   */\r\n  var serializeParam = function(value) {\r\n    return encodeURIComponent(value).replace(/%20/g, '+');\r\n  };\r\n\r\n  var deserializeParam = function(value) {\r\n    return decodeURIComponent(value).replace(/\\+/g, ' ');\r\n  };\r\n\r\n  var polyfillURLSearchParams= function() {\r\n\r\n    var URLSearchParams = function(searchString) {\r\n      Object.defineProperty(this, '_entries', { value: {} });\r\n\r\n      if(typeof searchString === 'string') {\r\n        if(searchString !== '') {\r\n          searchString = searchString.replace(/^\\?/, '');\r\n          var attributes = searchString.split('&');\r\n          var attribute;\r\n          for(var i = 0; i < attributes.length; i++) {\r\n            attribute = attributes[i].split('=');\r\n            this.append(\r\n              deserializeParam(attribute[0]),\r\n              (attribute.length > 1) ? deserializeParam(attribute[1]) : ''\r\n            );\r\n          }\r\n        }\r\n      } else if(searchString instanceof URLSearchParams) {\r\n        var _this = this;\r\n        searchString.forEach(function(value, name) {\r\n          _this.append(value, name);\r\n        });\r\n      }\r\n    };\r\n\r\n    var proto = URLSearchParams.prototype;\r\n\r\n    proto.append = function(name, value) {\r\n      if(name in this._entries) {\r\n        this._entries[name].push(value.toString());\r\n      } else {\r\n        this._entries[name] = [value.toString()];\r\n      }\r\n    };\r\n\r\n    proto.delete = function(name) {\r\n      delete this._entries[name];\r\n    };\r\n\r\n    proto.get = function(name) {\r\n      return (name in this._entries) ? this._entries[name][0] : null;\r\n    };\r\n\r\n    proto.getAll = function(name) {\r\n      return (name in this._entries) ? this._entries[name].slice(0) : [];\r\n    };\r\n\r\n    proto.has = function(name) {\r\n      return (name in this._entries);\r\n    };\r\n\r\n    proto.set = function(name, value) {\r\n      this._entries[name] = [value.toString()];\r\n    };\r\n\r\n    proto.forEach = function(callback, thisArg) {\r\n      var entries;\r\n      for(var name in this._entries) {\r\n        if(this._entries.hasOwnProperty(name)) {\r\n          entries = this._entries[name];\r\n          for(var i = 0; i < entries.length; i++) {\r\n            callback.call(thisArg, entries[i], name, this);\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    proto.keys = function() {\r\n      var items = [];\r\n      this.forEach(function(value, name) { items.push(name); });\r\n      return createIterator(items);\r\n    };\r\n\r\n    proto.values = function() {\r\n      var items = [];\r\n      this.forEach(function(value) { items.push(value); });\r\n      return createIterator(items);\r\n    };\r\n\r\n    proto.entries = function() {\r\n      var items = [];\r\n      this.forEach(function(value, name) { items.push([name, value]); });\r\n      return createIterator(items);\r\n    };\r\n\r\n    if(iteratorSupported) {\r\n      proto[Symbol.iterator] = proto.entries;\r\n    }\r\n\r\n    proto.toString = function() {\r\n      var searchString = '';\r\n      this.forEach(function(value, name) {\r\n        if(searchString.length > 0) searchString+= '&';\r\n        searchString += serializeParam(name) + '=' + serializeParam(value);\r\n      });\r\n      return searchString;\r\n    };\r\n\r\n    global.URLSearchParams = URLSearchParams;\r\n  };\r\n\r\n  if(!('URLSearchParams' in global) || (new URLSearchParams('?a=1').toString() !== 'a=1')) {\r\n    polyfillURLSearchParams();\r\n  }\r\n\r\n  // HTMLAnchorElement\r\n\r\n})(\r\n  (typeof global !== 'undefined') ? global\r\n    : ((typeof window !== 'undefined') ? window\r\n    : ((typeof self !== 'undefined') ? self : this))\r\n);\r\n\r\n(function(global) {\r\n  /**\r\n   * Polyfill URL\r\n   *\r\n   * Inspired from : https://github.com/arv/DOM-URL-Polyfill/blob/master/src/url.js\r\n   */\r\n\r\n  var checkIfURLIsSupported = function() {\r\n    try {\r\n      var u = new URL('b', 'http://a');\r\n      u.pathname = 'c%20d';\r\n      return (u.href === 'http://a/c%20d') && u.searchParams;\r\n    } catch(e) {\r\n      return false;\r\n    }\r\n  };\r\n\r\n\r\n  var polyfillURL = function() {\r\n    var _URL = global.URL;\r\n\r\n    var URL = function(url, base) {\r\n      if(typeof url !== 'string') url = String(url);\r\n\r\n      var doc = document.implementation.createHTMLDocument('');\r\n      window.doc = doc;\r\n      if(base) {\r\n        var baseElement = doc.createElement('base');\r\n        baseElement.href = base;\r\n        doc.head.appendChild(baseElement);\r\n      }\r\n\r\n      var anchorElement = doc.createElement('a');\r\n      anchorElement.href = url;\r\n      doc.body.appendChild(anchorElement);\r\n      anchorElement.href = anchorElement.href; // force href to refresh\r\n\r\n      if(anchorElement.protocol === ':' || !/:/.test(anchorElement.href)) {\r\n        throw new TypeError('Invalid URL');\r\n      }\r\n\r\n      Object.defineProperty(this, '_anchorElement', {\r\n        value: anchorElement\r\n      });\r\n    };\r\n\r\n    var proto = URL.prototype;\r\n\r\n    var linkURLWithAnchorAttribute = function(attributeName) {\r\n      Object.defineProperty(proto, attributeName, {\r\n        get: function() {\r\n          return this._anchorElement[attributeName];\r\n        },\r\n        set: function(value) {\r\n          this._anchorElement[attributeName] = value;\r\n        },\r\n        enumerable: true\r\n      });\r\n    };\r\n\r\n    ['hash', 'host', 'hostname', 'port', 'protocol', 'search']\r\n    .forEach(function(attributeName) {\r\n      linkURLWithAnchorAttribute(attributeName);\r\n    });\r\n\r\n    Object.defineProperties(proto, {\r\n\r\n      'toString': {\r\n        get: function() {\r\n          var _this = this;\r\n          return function() {\r\n            return _this.href;\r\n          };\r\n        }\r\n      },\r\n\r\n      'href' : {\r\n        get: function() {\r\n          return this._anchorElement.href.replace(/\\?$/,'');\r\n        },\r\n        set: function(value) {\r\n          this._anchorElement.href = value;\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'pathname' : {\r\n        get: function() {\r\n          return this._anchorElement.pathname.replace(/(^\\/?)/,'/');\r\n        },\r\n        set: function(value) {\r\n          this._anchorElement.pathname = value;\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'origin': {\r\n        get: function() {\r\n          // get expected port from protocol\r\n          var expectedPort = {'http:': 80, 'https:': 443, 'ftp:': 21}[this._anchorElement.protocol];\r\n          // add port to origin if, expected port is different than actual port\r\n          // and it is not empty f.e http://foo:8080\r\n          // 8080 != 80 && 8080 != ''\r\n          var addPortToOrigin = this._anchorElement.port != expectedPort &&\r\n            this._anchorElement.port !== ''\r\n\r\n          return this._anchorElement.protocol +\r\n            '//' +\r\n            this._anchorElement.hostname +\r\n            (addPortToOrigin ? (':' + this._anchorElement.port) : '');\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'password': { // TODO\r\n        get: function() {\r\n          return '';\r\n        },\r\n        set: function(value) {\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'username': { // TODO\r\n        get: function() {\r\n          return '';\r\n        },\r\n        set: function(value) {\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'searchParams': {\r\n        get: function() {\r\n          var searchParams = new URLSearchParams(this.search);\r\n          var _this = this;\r\n          ['append', 'delete', 'set'].forEach(function(methodName) {\r\n            var method = searchParams[methodName];\r\n            searchParams[methodName] = function() {\r\n              method.apply(searchParams, arguments);\r\n              _this.search = searchParams.toString();\r\n            };\r\n          });\r\n          return searchParams;\r\n        },\r\n        enumerable: true\r\n      }\r\n    });\r\n\r\n    URL.createObjectURL = function(blob) {\r\n      return _URL.createObjectURL.apply(_URL, arguments);\r\n    };\r\n\r\n    URL.revokeObjectURL = function(url) {\r\n      return _URL.revokeObjectURL.apply(_URL, arguments);\r\n    };\r\n\r\n    global.URL = URL;\r\n\r\n  };\r\n\r\n  if(!checkIfURLIsSupported()) {\r\n    polyfillURL();\r\n  }\r\n\r\n  if((global.location !== void 0) && !('origin' in global.location)) {\r\n    var getOrigin = function() {\r\n      return global.location.protocol + '//' + global.location.hostname + (global.location.port ? (':' + global.location.port) : '');\r\n    };\r\n\r\n    try {\r\n      Object.defineProperty(global.location, 'origin', {\r\n        get: getOrigin,\r\n        enumerable: true\r\n      });\r\n    } catch(e) {\r\n      setInterval(function() {\r\n        global.location.origin = getOrigin();\r\n      }, 100);\r\n    }\r\n  }\r\n\r\n})(\r\n  (typeof global !== 'undefined') ? global\r\n    : ((typeof window !== 'undefined') ? window\r\n    : ((typeof self !== 'undefined') ? self : this))\r\n);\r\n","/*\n * classList.js: Cross-browser full element.classList implementation.\n * 1.1.20170427\n *\n * By Eli Grey, http://eligrey.com\n * License: Dedicated to the public domain.\n *   See https://github.com/eligrey/classList.js/blob/master/LICENSE.md\n */\n\n/*global self, document, DOMException */\n\n/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js */\n\nif (\"document\" in window.self) {\n\n// Full polyfill for browsers with no classList support\n// Including IE < Edge missing SVGElement.classList\nif (!(\"classList\" in document.createElement(\"_\")) \n\t|| document.createElementNS && !(\"classList\" in document.createElementNS(\"http://www.w3.org/2000/svg\",\"g\"))) {\n\n(function (view) {\n\n\"use strict\";\n\nif (!('Element' in view)) return;\n\nvar\n\t  classListProp = \"classList\"\n\t, protoProp = \"prototype\"\n\t, elemCtrProto = view.Element[protoProp]\n\t, objCtr = Object\n\t, strTrim = String[protoProp].trim || function () {\n\t\treturn this.replace(/^\\s+|\\s+$/g, \"\");\n\t}\n\t, arrIndexOf = Array[protoProp].indexOf || function (item) {\n\t\tvar\n\t\t\t  i = 0\n\t\t\t, len = this.length\n\t\t;\n\t\tfor (; i < len; i++) {\n\t\t\tif (i in this && this[i] === item) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t}\n\t// Vendors: please allow content code to instantiate DOMExceptions\n\t, DOMEx = function (type, message) {\n\t\tthis.name = type;\n\t\tthis.code = DOMException[type];\n\t\tthis.message = message;\n\t}\n\t, checkTokenAndGetIndex = function (classList, token) {\n\t\tif (token === \"\") {\n\t\t\tthrow new DOMEx(\n\t\t\t\t  \"SYNTAX_ERR\"\n\t\t\t\t, \"An invalid or illegal string was specified\"\n\t\t\t);\n\t\t}\n\t\tif (/\\s/.test(token)) {\n\t\t\tthrow new DOMEx(\n\t\t\t\t  \"INVALID_CHARACTER_ERR\"\n\t\t\t\t, \"String contains an invalid character\"\n\t\t\t);\n\t\t}\n\t\treturn arrIndexOf.call(classList, token);\n\t}\n\t, ClassList = function (elem) {\n\t\tvar\n\t\t\t  trimmedClasses = strTrim.call(elem.getAttribute(\"class\") || \"\")\n\t\t\t, classes = trimmedClasses ? trimmedClasses.split(/\\s+/) : []\n\t\t\t, i = 0\n\t\t\t, len = classes.length\n\t\t;\n\t\tfor (; i < len; i++) {\n\t\t\tthis.push(classes[i]);\n\t\t}\n\t\tthis._updateClassName = function () {\n\t\t\telem.setAttribute(\"class\", this.toString());\n\t\t};\n\t}\n\t, classListProto = ClassList[protoProp] = []\n\t, classListGetter = function () {\n\t\treturn new ClassList(this);\n\t}\n;\n// Most DOMException implementations don't allow calling DOMException's toString()\n// on non-DOMExceptions. Error's toString() is sufficient here.\nDOMEx[protoProp] = Error[protoProp];\nclassListProto.item = function (i) {\n\treturn this[i] || null;\n};\nclassListProto.contains = function (token) {\n\ttoken += \"\";\n\treturn checkTokenAndGetIndex(this, token) !== -1;\n};\nclassListProto.add = function () {\n\tvar\n\t\t  tokens = arguments\n\t\t, i = 0\n\t\t, l = tokens.length\n\t\t, token\n\t\t, updated = false\n\t;\n\tdo {\n\t\ttoken = tokens[i] + \"\";\n\t\tif (checkTokenAndGetIndex(this, token) === -1) {\n\t\t\tthis.push(token);\n\t\t\tupdated = true;\n\t\t}\n\t}\n\twhile (++i < l);\n\n\tif (updated) {\n\t\tthis._updateClassName();\n\t}\n};\nclassListProto.remove = function () {\n\tvar\n\t\t  tokens = arguments\n\t\t, i = 0\n\t\t, l = tokens.length\n\t\t, token\n\t\t, updated = false\n\t\t, index\n\t;\n\tdo {\n\t\ttoken = tokens[i] + \"\";\n\t\tindex = checkTokenAndGetIndex(this, token);\n\t\twhile (index !== -1) {\n\t\t\tthis.splice(index, 1);\n\t\t\tupdated = true;\n\t\t\tindex = checkTokenAndGetIndex(this, token);\n\t\t}\n\t}\n\twhile (++i < l);\n\n\tif (updated) {\n\t\tthis._updateClassName();\n\t}\n};\nclassListProto.toggle = function (token, force) {\n\ttoken += \"\";\n\n\tvar\n\t\t  result = this.contains(token)\n\t\t, method = result ?\n\t\t\tforce !== true && \"remove\"\n\t\t:\n\t\t\tforce !== false && \"add\"\n\t;\n\n\tif (method) {\n\t\tthis[method](token);\n\t}\n\n\tif (force === true || force === false) {\n\t\treturn force;\n\t} else {\n\t\treturn !result;\n\t}\n};\nclassListProto.toString = function () {\n\treturn this.join(\" \");\n};\n\nif (objCtr.defineProperty) {\n\tvar classListPropDesc = {\n\t\t  get: classListGetter\n\t\t, enumerable: true\n\t\t, configurable: true\n\t};\n\ttry {\n\t\tobjCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\n\t} catch (ex) { // IE 8 doesn't support enumerable:true\n\t\t// adding undefined to fight this issue https://github.com/eligrey/classList.js/issues/36\n\t\t// modernie IE8-MSW7 machine has IE8 8.0.6001.18702 and is affected\n\t\tif (ex.number === undefined || ex.number === -0x7FF5EC54) {\n\t\t\tclassListPropDesc.enumerable = false;\n\t\t\tobjCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\n\t\t}\n\t}\n} else if (objCtr[protoProp].__defineGetter__) {\n\telemCtrProto.__defineGetter__(classListProp, classListGetter);\n}\n\n}(window.self));\n\n}\n\n// There is full or partial native classList support, so just check if we need\n// to normalize the add/remove and toggle APIs.\n\n(function () {\n\t\"use strict\";\n\n\tvar testElement = document.createElement(\"_\");\n\n\ttestElement.classList.add(\"c1\", \"c2\");\n\n\t// Polyfill for IE 10/11 and Firefox <26, where classList.add and\n\t// classList.remove exist but support only one argument at a time.\n\tif (!testElement.classList.contains(\"c2\")) {\n\t\tvar createMethod = function(method) {\n\t\t\tvar original = DOMTokenList.prototype[method];\n\n\t\t\tDOMTokenList.prototype[method] = function(token) {\n\t\t\t\tvar i, len = arguments.length;\n\n\t\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t\ttoken = arguments[i];\n\t\t\t\t\toriginal.call(this, token);\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t\tcreateMethod('add');\n\t\tcreateMethod('remove');\n\t}\n\n\ttestElement.classList.toggle(\"c3\", false);\n\n\t// Polyfill for IE 10 and Firefox <24, where classList.toggle does not\n\t// support the second argument.\n\tif (testElement.classList.contains(\"c3\")) {\n\t\tvar _toggle = DOMTokenList.prototype.toggle;\n\n\t\tDOMTokenList.prototype.toggle = function(token, force) {\n\t\t\tif (1 in arguments && !this.contains(token) === !force) {\n\t\t\t\treturn force;\n\t\t\t} else {\n\t\t\t\treturn _toggle.call(this, token);\n\t\t\t}\n\t\t};\n\n\t}\n\n\ttestElement = null;\n}());\n\n}\n","/*\n * @namespace Util\n *\n * Various utility functions, used by Leaflet internally.\n */\n\n// @function extend(dest: Object, src?: Object): Object\n// Merges the properties of the `src` object (or multiple objects) into `dest` object and returns the latter. Has an `L.extend` shortcut.\nexport function extend(dest) {\n    var i, j, len, src;\n\n    for (j = 1, len = arguments.length; j < len; j++) {\n        src = arguments[j];\n        for (i in src) {\n            dest[i] = src[i];\n        }\n    }\n    return dest;\n}\n\n// @function create(proto: Object, properties?: Object): Object\n// Compatibility polyfill for [Object.create](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/create)\nexport var create = Object.create || (function () {\n    function F() {}\n    return function (proto) {\n        F.prototype = proto;\n        return new F();\n    };\n})();\n\n// @function bind(fn: Function, …): Function\n// Returns a new function bound to the arguments passed, like [Function.prototype.bind](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Function/bind).\n// Has a `L.bind()` shortcut.\nexport function bind(fn, obj) {\n    var slice = Array.prototype.slice;\n\n    if (fn.bind) {\n        return fn.bind.apply(fn, slice.call(arguments, 1));\n    }\n\n    var args = slice.call(arguments, 2);\n\n    return function () {\n        return fn.apply(obj, args.length ? args.concat(slice.call(arguments)) : arguments);\n    };\n}\n\n// @property lastId: Number\n// Last unique ID used by [`stamp()`](#util-stamp)\nexport var lastId = 0;\n\n// @function stamp(obj: Object): Number\n// Returns the unique ID of an object, assiging it one if it doesn't have it.\nexport function stamp(obj) {\n    /*eslint-disable */\n    obj._cozy_id = obj._cozy_id || ++lastId;\n    return obj._cozy_id; /* not leaflet */\n    /*eslint-enable */\n}\n\n// @function throttle(fn: Function, time: Number, context: Object): Function\n// Returns a function which executes function `fn` with the given scope `context`\n// (so that the `this` keyword refers to `context` inside `fn`'s code). The function\n// `fn` will be called no more than one time per given amount of `time`. The arguments\n// received by the bound function will be any arguments passed when binding the\n// function, followed by any arguments passed when invoking the bound function.\n// Has an `L.throttle` shortcut.\nexport function throttle(fn, time, context) {\n    var lock, args, wrapperFn, later;\n\n    later = function () {\n        // reset lock and call if queued\n        lock = false;\n        if (args) {\n            wrapperFn.apply(context, args);\n            args = false;\n        }\n    };\n\n    wrapperFn = function () {\n        if (lock) {\n            // called too soon, queue to call later\n            args = arguments;\n\n        } else {\n            // call and lock until later\n            fn.apply(context, arguments);\n            setTimeout(later, time);\n            lock = true;\n        }\n    };\n\n    return wrapperFn;\n}\n\n// @function wrapNum(num: Number, range: Number[], includeMax?: Boolean): Number\n// Returns the number `num` modulo `range` in such a way so it lies within\n// `range[0]` and `range[1]`. The returned value will be always smaller than\n// `range[1]` unless `includeMax` is set to `true`.\nexport function wrapNum(x, range, includeMax) {\n    var max = range[1],\n        min = range[0],\n        d = max - min;\n    return x === max && includeMax ? x : ((x - min) % d + d) % d + min;\n}\n\n// @function falseFn(): Function\n// Returns a function which always returns `false`.\nexport function falseFn() { return false; }\n\n// @function formatNum(num: Number, digits?: Number): Number\n// Returns the number `num` rounded to `digits` decimals, or to 5 decimals by default.\nexport function formatNum(num, digits) {\n    var pow = Math.pow(10, digits || 5);\n    return Math.round(num * pow) / pow;\n}\n\n// @function isNumeric(num: Number): Boolean\n// Returns whether num is actually numeric\nexport function isNumeric(num) {\n  return !isNaN(parseFloat(num)) && isFinite(num);\n}\n\n// @function trim(str: String): String\n// Compatibility polyfill for [String.prototype.trim](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String/Trim)\nexport function trim(str) {\n    return str.trim ? str.trim() : str.replace(/^\\s+|\\s+$/g, '');\n}\n\n// @function splitWords(str: String): String[]\n// Trims and splits the string on whitespace and returns the array of parts.\nexport function splitWords(str) {\n    return trim(str).split(/\\s+/);\n}\n\n// @function setOptions(obj: Object, options: Object): Object\n// Merges the given properties to the `options` of the `obj` object, returning the resulting options. See `Class options`. Has an `L.setOptions` shortcut.\nexport function setOptions(obj, options) {\n    if (!obj.hasOwnProperty('options')) {\n        obj.options = obj.options ? create(obj.options) : {};\n    }\n    for (var i in options) {\n        obj.options[i] = options[i];\n    }\n    return obj.options;\n}\n\n// @function getParamString(obj: Object, existingUrl?: String, uppercase?: Boolean): String\n// Converts an object into a parameter URL string, e.g. `{a: \"foo\", b: \"bar\"}`\n// translates to `'?a=foo&b=bar'`. If `existingUrl` is set, the parameters will\n// be appended at the end. If `uppercase` is `true`, the parameter names will\n// be uppercased (e.g. `'?A=foo&B=bar'`)\nexport function getParamString(obj, existingUrl, uppercase) {\n    var params = [];\n    for (var i in obj) {\n        params.push(encodeURIComponent(uppercase ? i.toUpperCase() : i) + '=' + encodeURIComponent(obj[i]));\n    }\n    return ((!existingUrl || existingUrl.indexOf('?') === -1) ? '?' : '&') + params.join('&');\n}\n\nvar templateRe = /\\{ *([\\w_\\-]+) *\\}/g;\n\n// @function template(str: String, data: Object): String\n// Simple templating facility, accepts a template string of the form `'Hello {a}, {b}'`\n// and a data object like `{a: 'foo', b: 'bar'}`, returns evaluated string\n// `('Hello foo, bar')`. You can also specify functions instead of strings for\n// data values — they will be evaluated passing `data` as an argument.\nexport function template(str, data) {\n    return str.replace(templateRe, function (str, key) {\n        var value = data[key];\n\n        if (value === undefined) {\n            throw new Error('No value provided for variable ' + str);\n\n        } else if (typeof value === 'function') {\n            value = value(data);\n        }\n        return value;\n    });\n}\n\n// @function isArray(obj): Boolean\n// Compatibility polyfill for [Array.isArray](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array/isArray)\nexport var isArray = Array.isArray || function (obj) {\n    return (Object.prototype.toString.call(obj) === '[object Array]');\n};\n\n// @function indexOf(array: Array, el: Object): Number\n// Compatibility polyfill for [Array.prototype.indexOf](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf)\nexport function indexOf(array, el) {\n    for (var i = 0; i < array.length; i++) {\n        if (array[i] === el) { return i; }\n    }\n    return -1;\n}\n\n// @property emptyImageUrl: String\n// Data URI string containing a base64-encoded empty GIF image.\n// Used as a hack to free memory from unused images on WebKit-powered\n// mobile devices (by setting image `src` to this string).\nexport var emptyImageUrl = 'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=';\n\n// inspired by http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n\nfunction getPrefixed(name) {\n    return window['webkit' + name] || window['moz' + name] || window['ms' + name];\n}\n\nvar lastTime = 0;\n\n// fallback for IE 7-8\nfunction timeoutDefer(fn) {\n    var time = +new Date(),\n        timeToCall = Math.max(0, 16 - (time - lastTime));\n\n    lastTime = time + timeToCall;\n    return window.setTimeout(fn, timeToCall);\n}\n\nexport var requestFn = window.requestAnimationFrame || getPrefixed('RequestAnimationFrame') || timeoutDefer;\nexport var cancelFn = window.cancelAnimationFrame || getPrefixed('CancelAnimationFrame') ||\n        getPrefixed('CancelRequestAnimationFrame') || function (id) { window.clearTimeout(id); };\n\n// @function requestAnimFrame(fn: Function, context?: Object, immediate?: Boolean): Number\n// Schedules `fn` to be executed when the browser repaints. `fn` is bound to\n// `context` if given. When `immediate` is set, `fn` is called immediately if\n// the browser doesn't have native support for\n// [`window.requestAnimationFrame`](https://developer.mozilla.org/docs/Web/API/window/requestAnimationFrame),\n// otherwise it's delayed. Returns a request ID that can be used to cancel the request.\nexport function requestAnimFrame(fn, context, immediate) {\n    if (immediate && requestFn === timeoutDefer) {\n        fn.call(context);\n    } else {\n        return requestFn.call(window, bind(fn, context));\n    }\n}\n\n// @function cancelAnimFrame(id: Number): undefined\n// Cancels a previous `requestAnimFrame`. See also [window.cancelAnimationFrame](https://developer.mozilla.org/docs/Web/API/window/cancelAnimationFrame).\nexport function cancelAnimFrame(id) {\n    if (id) {\n        cancelFn.call(window, id);\n    }\n}\n\nexport var loader = {\n    js: function(url) {\n        var handler = { _resolved: false };\n        handler.callbacks = [];\n        handler.error = [];\n        handler.then = function(cb) {\n            handler.callbacks.push(cb);\n            if ( handler._resolved ) { return handler.resolve(); }\n            return handler;\n        }\n        handler.catch = function(cb) {\n            handler.error.push(cb);\n            if ( handler._resolved ) { return handler.reject(); }\n            return handler;\n        }\n        handler.resolve = function(_argv) {\n            // var _argv;\n            handler._resolved = true;\n            while ( handler.callbacks.length ) {\n                var cb = handler.callbacks.shift();\n                var retval;\n                try {\n                    _argv = cb(_argv);\n                } catch(e) {\n                    console.log(e);\n                    handler.reject(e);\n                    break;\n                }\n            }\n            return handler;\n        }\n\n        handler.reject = function(e) {\n            while ( handler.error.length ) {\n                var cb = handler.error.shift();\n                cb(e);\n            }\n            console.log(e);\n            console.trace();\n            return handler;\n        }\n\n        if ( url == undefined ) {\n            handler._resolved = true;\n            return handler;\n        }\n\n        var element = document.createElement('script');\n\n        element.onload = function() {\n          handler.resolve(url);\n        };\n        element.onerror = function() {\n          handler.catch.apply(arguments);\n        };\n\n        element.async = true;\n        var parent = 'body';\n        var attr = 'src';\n        element[attr] = url;\n        document[parent].appendChild(element);\n\n        console.log(\"AHOY APPENDED\", url);\n\n        return handler;\n    }\n}","import * as Util from './Util';\r\n\r\n// @class Class\r\n// @aka L.Class\r\n\r\n// @section\r\n// @uninheritable\r\n\r\n// Thanks to John Resig and Dean Edwards for inspiration!\r\n\r\nexport function Class() {}\r\n\r\nClass.extend = function (props) {\r\n\r\n\t// @function extend(props: Object): Function\r\n\t// [Extends the current class](#class-inheritance) given the properties to be included.\r\n\t// Returns a Javascript function that is a class constructor (to be called with `new`).\r\n\tvar NewClass = function () {\r\n\r\n\t\t// call the constructor\r\n\t\tif (this.initialize) {\r\n\t\t\tthis.initialize.apply(this, arguments);\r\n\t\t}\r\n\r\n\t\t// call all constructor hooks\r\n\t\tthis.callInitHooks();\r\n\t};\r\n\r\n\tvar parentProto = NewClass.__super__ = this.prototype;\r\n\r\n\tvar proto = Util.create(parentProto);\r\n\tproto.constructor = NewClass;\r\n\r\n\tNewClass.prototype = proto;\r\n\r\n\t// inherit parent's statics\r\n\tfor (var i in this) {\r\n\t\tif (this.hasOwnProperty(i) && i !== 'prototype') {\r\n\t\t\tNewClass[i] = this[i];\r\n\t\t}\r\n\t}\r\n\r\n\t// mix static properties into the class\r\n\tif (props.statics) {\r\n\t\tUtil.extend(NewClass, props.statics);\r\n\t\tdelete props.statics;\r\n\t}\r\n\r\n\t// mix includes into the prototype\r\n\tif (props.includes) {\r\n\t\tcheckDeprecatedMixinEvents(props.includes);\r\n\t\tUtil.extend.apply(null, [proto].concat(props.includes));\r\n\t\tdelete props.includes;\r\n\t}\r\n\r\n\t// merge options\r\n\tif (proto.options) {\r\n\t\tprops.options = Util.extend(Util.create(proto.options), props.options);\r\n\t}\r\n\r\n\t// mix given properties into the prototype\r\n\tUtil.extend(proto, props);\r\n\t\r\n\tproto._initHooks = [];\r\n\r\n\t// add method for calling all hooks\r\n\tproto.callInitHooks = function () {\r\n\r\n\t\tif (this._initHooksCalled) { return; }\r\n\r\n\t\tif (parentProto.callInitHooks) {\r\n\t\t\tparentProto.callInitHooks.call(this);\r\n\t\t}\r\n\r\n\t\tthis._initHooksCalled = true;\r\n\r\n\t\tfor (var i = 0, len = proto._initHooks.length; i < len; i++) {\r\n\t\t\tproto._initHooks[i].call(this);\r\n\t\t}\r\n\t};\r\n\r\n\treturn NewClass;\r\n};\r\n\r\n\r\n// @function include(properties: Object): this\r\n// [Includes a mixin](#class-includes) into the current class.\r\nClass.include = function (props) {\r\n\tUtil.extend(this.prototype, props);\r\n\treturn this;\r\n};\r\n\r\n// @function mergeOptions(options: Object): this\r\n// [Merges `options`](#class-options) into the defaults of the class.\r\nClass.mergeOptions = function (options) {\r\n\tUtil.extend(this.prototype.options, options);\r\n\treturn this;\r\n};\r\n\r\n// @function addInitHook(fn: Function): this\r\n// Adds a [constructor hook](#class-constructor-hooks) to the class.\r\nClass.addInitHook = function (fn) { // (Function) || (String, args...)\r\n\tvar args = Array.prototype.slice.call(arguments, 1);\r\n\r\n\tvar init = typeof fn === 'function' ? fn : function () {\r\n\t\tthis[fn].apply(this, args);\r\n\t};\r\n\r\n\tthis.prototype._initHooks = this.prototype._initHooks || [];\r\n\tthis.prototype._initHooks.push(init);\r\n\treturn this;\r\n};\r\n\r\nfunction checkDeprecatedMixinEvents(includes) {\r\n\tif (!cozy || !cozy.Mixin) { return; }\r\n\r\n\tincludes = cozy.Util.isArray(includes) ? includes : [includes];\r\n\r\n\t// for (var i = 0; i < includes.length; i++) {\r\n\t// \tif (includes[i] === cozy.Mixin.Events) {\r\n\t// \t\tconsole.warn('Deprecated include of cozy.Mixin.Events: ' +\r\n\t// \t\t\t'this property will be removed in future releases, ' +\r\n\t// \t\t\t'please inherit from cozy.Evented instead.', new Error().stack);\r\n\t// \t}\r\n\t// }\r\n}\r\n","import {Class} from './Class';\r\nimport * as Util from './Util';\r\n\r\n/*\r\n * @class Evented\r\n * @aka L.Evented\r\n * @inherits Class\r\n *\r\n * A set of methods shared between event-powered classes (like `Map` and `Marker`). Generally, events allow you to execute some function when something happens with an object (e.g. the user clicks on the map, causing the map to fire `'click'` event).\r\n *\r\n * @example\r\n *\r\n * ```js\r\n * map.on('click', function(e) {\r\n * \talert(e.latlng);\r\n * } );\r\n * ```\r\n *\r\n * Leaflet deals with event listeners by reference, so if you want to add a listener and then remove it, define it as a function:\r\n *\r\n * ```js\r\n * function onClick(e) { ... }\r\n *\r\n * map.on('click', onClick);\r\n * map.off('click', onClick);\r\n * ```\r\n */\r\n\r\nexport var Evented = Class.extend({\r\n\r\n\t/* @method on(type: String, fn: Function, context?: Object): this\r\n\t * Adds a listener function (`fn`) to a particular event type of the object. You can optionally specify the context of the listener (object the this keyword will point to). You can also pass several space-separated types (e.g. `'click dblclick'`).\r\n\t *\r\n\t * @alternative\r\n\t * @method on(eventMap: Object): this\r\n\t * Adds a set of type/listener pairs, e.g. `{click: onClick, mousemove: onMouseMove}`\r\n\t */\r\n\ton: function (types, fn, context) {\r\n\r\n\t\t// types can be a map of types/handlers\r\n\t\tif (typeof types === 'object') {\r\n\t\t\tfor (var type in types) {\r\n\t\t\t\t// we don't process space-separated events here for performance;\r\n\t\t\t\t// it's a hot path since Layer uses the on(obj) syntax\r\n\t\t\t\tthis._on(type, types[type], fn);\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\t// types can be a string of space-separated words\r\n\t\t\ttypes = Util.splitWords(types);\r\n\r\n\t\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\t\tthis._on(types[i], fn, context);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t/* @method off(type: String, fn?: Function, context?: Object): this\r\n\t * Removes a previously added listener function. If no function is specified, it will remove all the listeners of that particular event from the object. Note that if you passed a custom context to `on`, you must pass the same context to `off` in order to remove the listener.\r\n\t *\r\n\t * @alternative\r\n\t * @method off(eventMap: Object): this\r\n\t * Removes a set of type/listener pairs.\r\n\t *\r\n\t * @alternative\r\n\t * @method off: this\r\n\t * Removes all listeners to all events on the object.\r\n\t */\r\n\toff: function (types, fn, context) {\r\n\r\n\t\tif (!types) {\r\n\t\t\t// clear all listeners if called without arguments\r\n\t\t\tdelete this._events;\r\n\r\n\t\t} else if (typeof types === 'object') {\r\n\t\t\tfor (var type in types) {\r\n\t\t\t\tthis._off(type, types[type], fn);\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\ttypes = Util.splitWords(types);\r\n\r\n\t\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\t\tthis._off(types[i], fn, context);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// attach listener (without syntactic sugar now)\r\n\t_on: function (type, fn, context) {\r\n\t\tthis._events = this._events || {};\r\n\r\n\t\t/* get/init listeners for type */\r\n\t\tvar typeListeners = this._events[type];\r\n\t\tif (!typeListeners) {\r\n\t\t\ttypeListeners = [];\r\n\t\t\tthis._events[type] = typeListeners;\r\n\t\t}\r\n\r\n\t\tif (context === this) {\r\n\t\t\t// Less memory footprint.\r\n\t\t\tcontext = undefined;\r\n\t\t}\r\n\t\tvar newListener = {fn: fn, ctx: context},\r\n\t\t    listeners = typeListeners;\r\n\r\n\t\t// check if fn already there\r\n\t\tfor (var i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\tif (listeners[i].fn === fn && listeners[i].ctx === context) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlisteners.push(newListener);\r\n\t},\r\n\r\n\t_off: function (type, fn, context) {\r\n\t\tvar listeners,\r\n\t\t    i,\r\n\t\t    len;\r\n\r\n\t\tif (!this._events) { return; }\r\n\r\n\t\tlisteners = this._events[type];\r\n\r\n\t\tif (!listeners) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!fn) {\r\n\t\t\t// Set all removed listeners to noop so they are not called if remove happens in fire\r\n\t\t\tfor (i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\t\tlisteners[i].fn = Util.falseFn;\r\n\t\t\t}\r\n\t\t\t// clear all listeners for a type if function isn't specified\r\n\t\t\tdelete this._events[type];\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (context === this) {\r\n\t\t\tcontext = undefined;\r\n\t\t}\r\n\r\n\t\tif (listeners) {\r\n\r\n\t\t\t// find fn and remove it\r\n\t\t\tfor (i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\t\tvar l = listeners[i];\r\n\t\t\t\tif (l.ctx !== context) { continue; }\r\n\t\t\t\tif (l.fn === fn) {\r\n\r\n\t\t\t\t\t// set the removed listener to noop so that's not called if remove happens in fire\r\n\t\t\t\t\tl.fn = Util.falseFn;\r\n\r\n\t\t\t\t\tif (this._firingCount) {\r\n\t\t\t\t\t\t/* copy array in case events are being fired */\r\n\t\t\t\t\t\tthis._events[type] = listeners = listeners.slice();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlisteners.splice(i, 1);\r\n\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t// @method fire(type: String, data?: Object, propagate?: Boolean): this\r\n\t// Fires an event of the specified type. You can optionally provide an data\r\n\t// object — the first argument of the listener function will contain its\r\n\t// properties. The event can optionally be propagated to event parents.\r\n\tfire: function (type, data, propagate) {\r\n\t\tif (!this.listens(type, propagate)) { return this; }\r\n\r\n\t\tvar event = Util.extend({}, data, {type: type, target: this});\r\n\r\n\t\tif (this._events) {\r\n\t\t\tvar listeners = this._events[type];\r\n\r\n\t\t\tif (listeners) {\r\n\t\t\t\tthis._firingCount = (this._firingCount + 1) || 1;\r\n\t\t\t\tfor (var i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\t\t\tvar l = listeners[i];\r\n\t\t\t\t\tl.fn.call(l.ctx || this, event);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._firingCount--;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (propagate) {\r\n\t\t\t// propagate the event to parents (set with addEventParent)\r\n\t\t\tthis._propagateEvent(event);\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method listens(type: String): Boolean\r\n\t// Returns `true` if a particular event type has any listeners attached to it.\r\n\tlistens: function (type, propagate) {\r\n\t\tvar listeners = this._events && this._events[type];\r\n\t\tif (listeners && listeners.length) { return true; }\r\n\r\n\t\tif (propagate) {\r\n\t\t\t// also check parents for listeners if event propagates\r\n\t\t\tfor (var id in this._eventParents) {\r\n\t\t\t\tif (this._eventParents[id].listens(type, propagate)) { return true; }\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\r\n\t// @method once(…): this\r\n\t// Behaves as [`on(…)`](#evented-on), except the listener will only get fired once and then removed.\r\n\tonce: function (types, fn, context) {\r\n\r\n\t\tif (typeof types === 'object') {\r\n\t\t\tfor (var type in types) {\r\n\t\t\t\tthis.once(type, types[type], fn);\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tvar handler = Util.bind(function () {\r\n\t\t\tthis\r\n\t\t\t    .off(types, fn, context)\r\n\t\t\t    .off(types, handler, context);\r\n\t\t}, this);\r\n\r\n\t\t// add a listener that's executed once and removed after that\r\n\t\treturn this\r\n\t\t    .on(types, fn, context)\r\n\t\t    .on(types, handler, context);\r\n\t},\r\n\r\n\t// @method addEventParent(obj: Evented): this\r\n\t// Adds an event parent - an `Evented` that will receive propagated events\r\n\taddEventParent: function (obj) {\r\n\t\tthis._eventParents = this._eventParents || {};\r\n\t\tthis._eventParents[Util.stamp(obj)] = obj;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method removeEventParent(obj: Evented): this\r\n\t// Removes an event parent, so it will stop receiving propagated events\r\n\tremoveEventParent: function (obj) {\r\n\t\tif (this._eventParents) {\r\n\t\t\tdelete this._eventParents[Util.stamp(obj)];\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\t_propagateEvent: function (e) {\r\n\t\tfor (var id in this._eventParents) {\r\n\t\t\tthis._eventParents[id].fire(e.type, Util.extend({layer: e.target}, e), true);\r\n\t\t}\r\n\t}\r\n});\r\n\r\nvar proto = Evented.prototype;\r\n\r\n// aliases; we should ditch those eventually\r\n\r\n// @method addEventListener(…): this\r\n// Alias to [`on(…)`](#evented-on)\r\nproto.addEventListener = proto.on;\r\n\r\n// @method removeEventListener(…): this\r\n// Alias to [`off(…)`](#evented-off)\r\n\r\n// @method clearAllEventListeners(…): this\r\n// Alias to [`off()`](#evented-off)\r\nproto.removeEventListener = proto.clearAllEventListeners = proto.off;\r\n\r\n// @method addOneTimeEventListener(…): this\r\n// Alias to [`once(…)`](#evented-once)\r\nproto.addOneTimeEventListener = proto.once;\r\n\r\n// @method fireEvent(…): this\r\n// Alias to [`fire(…)`](#evented-fire)\r\nproto.fireEvent = proto.fire;\r\n\r\n// @method hasEventListeners(…): Boolean\r\n// Alias to [`listens(…)`](#evented-listens)\r\nproto.hasEventListeners = proto.listens;\r\n","\n/*\n * @namespace Browser\n * @aka L.Browser\n *\n * A namespace with static properties for browser/feature detection used by Leaflet internally.\n *\n * @example\n *\n * ```js\n * if (L.Browser.ielt9) {\n *   alert('Upgrade your browser, dude!');\n * }\n * ```\n */\n\nvar style = document.documentElement.style;\n\n// @property ie: Boolean; `true` for all Internet Explorer versions (not Edge).\nexport var ie = 'ActiveXObject' in window;\n\n// @property ielt9: Boolean; `true` for Internet Explorer versions less than 9.\nexport var ielt9 = ie && !document.addEventListener;\n\n// @property edge: Boolean; `true` for the Edge web browser.\nexport var edge = 'msLaunchUri' in navigator && !('documentMode' in document);\n\n// @property webkit: Boolean;\n// `true` for webkit-based browsers like Chrome and Safari (including mobile versions).\nexport var webkit = userAgentContains('webkit');\n\n// @property android: Boolean\n// `true` for any browser running on an Android platform.\nexport var android = userAgentContains('android');\n\n// @property android23: Boolean; `true` for browsers running on Android 2 or Android 3.\nexport var android23 = userAgentContains('android 2') || userAgentContains('android 3');\n\n// @property opera: Boolean; `true` for the Opera browser\nexport var opera = !!window.opera;\n\n// @property chrome: Boolean; `true` for the Chrome browser.\nexport var chrome = userAgentContains('chrome');\n\n// @property gecko: Boolean; `true` for gecko-based browsers like Firefox.\nexport var gecko = userAgentContains('gecko') && !webkit && !opera && !ie;\n\n// @property safari: Boolean; `true` for the Safari browser.\nexport var safari = !chrome && userAgentContains('safari');\n\nexport var phantom = userAgentContains('phantom');\n\n// @property opera12: Boolean\n// `true` for the Opera browser supporting CSS transforms (version 12 or later).\nexport var opera12 = 'OTransition' in style;\n\n// @property win: Boolean; `true` when the browser is running in a Windows platform\nexport var win = navigator.platform.indexOf('Win') === 0;\n\n// @property ie3d: Boolean; `true` for all Internet Explorer versions supporting CSS transforms.\nexport var ie3d = ie && ('transition' in style);\n\n// @property webkit3d: Boolean; `true` for webkit-based browsers supporting CSS transforms.\nexport var webkit3d = ('WebKitCSSMatrix' in window) && ('m11' in new window.WebKitCSSMatrix()) && !android23;\n\n// @property gecko3d: Boolean; `true` for gecko-based browsers supporting CSS transforms.\nexport var gecko3d = 'MozPerspective' in style;\n\n// @property any3d: Boolean\n// `true` for all browsers supporting CSS transforms.\nexport var any3d = !window.L_DISABLE_3D && (ie3d || webkit3d || gecko3d) && !opera12 && !phantom;\n\n// @property mobile: Boolean; `true` for all browsers running in a mobile device.\nexport var mobile = typeof orientation !== 'undefined' || userAgentContains('mobile');\n\n// @property mobileWebkit: Boolean; `true` for all webkit-based browsers in a mobile device.\nexport var mobileWebkit = mobile && webkit;\n\n// @property mobileWebkit3d: Boolean\n// `true` for all webkit-based browsers in a mobile device supporting CSS transforms.\nexport var mobileWebkit3d = mobile && webkit3d;\n\n// @property msPointer: Boolean\n// `true` for browsers implementing the Microsoft touch events model (notably IE10).\nexport var msPointer = !window.PointerEvent && window.MSPointerEvent;\n\n// @property pointer: Boolean\n// `true` for all browsers supporting [pointer events](https://msdn.microsoft.com/en-us/library/dn433244%28v=vs.85%29.aspx).\nexport var pointer = !!(window.PointerEvent || msPointer);\n\n// @property touch: Boolean\n// `true` for all browsers supporting [touch events](https://developer.mozilla.org/docs/Web/API/Touch_events).\n// This does not necessarily mean that the browser is running in a computer with\n// a touchscreen, it only means that the browser is capable of understanding\n// touch events.\nexport var touch = !window.L_NO_TOUCH && (pointer || 'ontouchstart' in window ||\n        (window.DocumentTouch && document instanceof window.DocumentTouch));\n\n// @property mobileOpera: Boolean; `true` for the Opera browser in a mobile device.\nexport var mobileOpera = mobile && opera;\n\n// @property mobileGecko: Boolean\n// `true` for gecko-based browsers running in a mobile device.\nexport var mobileGecko = mobile && gecko;\n\n// @property retina: Boolean\n// `true` for browsers on a high-resolution \"retina\" screen.\nexport var retina = (window.devicePixelRatio || (window.screen.deviceXDPI / window.screen.logicalXDPI)) > 1;\n\n\n// @property canvas: Boolean\n// `true` when the browser supports [`<canvas>`](https://developer.mozilla.org/docs/Web/API/Canvas_API).\nexport var canvas = (function () {\n    return !!document.createElement('canvas').getContext;\n}());\n\n// @property svg: Boolean\n// `true` when the browser supports [SVG](https://developer.mozilla.org/docs/Web/SVG).\n// export var svg = !!(document.createElementNS && svgCreate('svg').createSVGRect);\nexport var svg = true;\n\n// @property vml: Boolean\n// `true` if the browser supports [VML](https://en.wikipedia.org/wiki/Vector_Markup_Language).\nexport var vml = !svg && (function () {\n    try {\n        var div = document.createElement('div');\n        div.innerHTML = '<v:shape adj=\"1\"/>';\n\n        var shape = div.firstChild;\n        shape.style.behavior = 'url(#default#VML)';\n\n        return shape && (typeof shape.adj === 'object');\n\n    } catch (e) {\n        return false;\n    }\n}());\n\nexport var columnCount = ( 'columnCount' in style );\nexport var classList = ( document.documentElement.classList !== undefined );\n\nfunction userAgentContains(str) {\n    return navigator.userAgent.toLowerCase().indexOf(str) >= 0;\n}\n","import {isArray, formatNum} from '../core/Util';\r\n\r\n/*\r\n * @class Point\r\n * @aka L.Point\r\n *\r\n * Represents a point with `x` and `y` coordinates in pixels.\r\n *\r\n * @example\r\n *\r\n * ```js\r\n * var point = L.point(200, 300);\r\n * ```\r\n *\r\n * All Leaflet methods and options that accept `Point` objects also accept them in a simple Array form (unless noted otherwise), so these lines are equivalent:\r\n *\r\n * ```js\r\n * map.panBy([200, 300]);\r\n * map.panBy(L.point(200, 300));\r\n * ```\r\n */\r\n\r\nexport function Point(x, y, round) {\r\n\t// @property x: Number; The `x` coordinate of the point\r\n\tthis.x = (round ? Math.round(x) : x);\r\n\t// @property y: Number; The `y` coordinate of the point\r\n\tthis.y = (round ? Math.round(y) : y);\r\n}\r\n\r\nPoint.prototype = {\r\n\r\n\t// @method clone(): Point\r\n\t// Returns a copy of the current point.\r\n\tclone: function () {\r\n\t\treturn new Point(this.x, this.y);\r\n\t},\r\n\r\n\t// @method add(otherPoint: Point): Point\r\n\t// Returns the result of addition of the current and the given points.\r\n\tadd: function (point) {\r\n\t\t// non-destructive, returns a new point\r\n\t\treturn this.clone()._add(toPoint(point));\r\n\t},\r\n\r\n\t_add: function (point) {\r\n\t\t// destructive, used directly for performance in situations where it's safe to modify existing point\r\n\t\tthis.x += point.x;\r\n\t\tthis.y += point.y;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method subtract(otherPoint: Point): Point\r\n\t// Returns the result of subtraction of the given point from the current.\r\n\tsubtract: function (point) {\r\n\t\treturn this.clone()._subtract(toPoint(point));\r\n\t},\r\n\r\n\t_subtract: function (point) {\r\n\t\tthis.x -= point.x;\r\n\t\tthis.y -= point.y;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method divideBy(num: Number): Point\r\n\t// Returns the result of division of the current point by the given number.\r\n\tdivideBy: function (num) {\r\n\t\treturn this.clone()._divideBy(num);\r\n\t},\r\n\r\n\t_divideBy: function (num) {\r\n\t\tthis.x /= num;\r\n\t\tthis.y /= num;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method multiplyBy(num: Number): Point\r\n\t// Returns the result of multiplication of the current point by the given number.\r\n\tmultiplyBy: function (num) {\r\n\t\treturn this.clone()._multiplyBy(num);\r\n\t},\r\n\r\n\t_multiplyBy: function (num) {\r\n\t\tthis.x *= num;\r\n\t\tthis.y *= num;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method scaleBy(scale: Point): Point\r\n\t// Multiply each coordinate of the current point by each coordinate of\r\n\t// `scale`. In linear algebra terms, multiply the point by the\r\n\t// [scaling matrix](https://en.wikipedia.org/wiki/Scaling_%28geometry%29#Matrix_representation)\r\n\t// defined by `scale`.\r\n\tscaleBy: function (point) {\r\n\t\treturn new Point(this.x * point.x, this.y * point.y);\r\n\t},\r\n\r\n\t// @method unscaleBy(scale: Point): Point\r\n\t// Inverse of `scaleBy`. Divide each coordinate of the current point by\r\n\t// each coordinate of `scale`.\r\n\tunscaleBy: function (point) {\r\n\t\treturn new Point(this.x / point.x, this.y / point.y);\r\n\t},\r\n\r\n\t// @method round(): Point\r\n\t// Returns a copy of the current point with rounded coordinates.\r\n\tround: function () {\r\n\t\treturn this.clone()._round();\r\n\t},\r\n\r\n\t_round: function () {\r\n\t\tthis.x = Math.round(this.x);\r\n\t\tthis.y = Math.round(this.y);\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method floor(): Point\r\n\t// Returns a copy of the current point with floored coordinates (rounded down).\r\n\tfloor: function () {\r\n\t\treturn this.clone()._floor();\r\n\t},\r\n\r\n\t_floor: function () {\r\n\t\tthis.x = Math.floor(this.x);\r\n\t\tthis.y = Math.floor(this.y);\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method ceil(): Point\r\n\t// Returns a copy of the current point with ceiled coordinates (rounded up).\r\n\tceil: function () {\r\n\t\treturn this.clone()._ceil();\r\n\t},\r\n\r\n\t_ceil: function () {\r\n\t\tthis.x = Math.ceil(this.x);\r\n\t\tthis.y = Math.ceil(this.y);\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method distanceTo(otherPoint: Point): Number\r\n\t// Returns the cartesian distance between the current and the given points.\r\n\tdistanceTo: function (point) {\r\n\t\tpoint = toPoint(point);\r\n\r\n\t\tvar x = point.x - this.x,\r\n\t\t    y = point.y - this.y;\r\n\r\n\t\treturn Math.sqrt(x * x + y * y);\r\n\t},\r\n\r\n\t// @method equals(otherPoint: Point): Boolean\r\n\t// Returns `true` if the given point has the same coordinates.\r\n\tequals: function (point) {\r\n\t\tpoint = toPoint(point);\r\n\r\n\t\treturn point.x === this.x &&\r\n\t\t       point.y === this.y;\r\n\t},\r\n\r\n\t// @method contains(otherPoint: Point): Boolean\r\n\t// Returns `true` if both coordinates of the given point are less than the corresponding current point coordinates (in absolute values).\r\n\tcontains: function (point) {\r\n\t\tpoint = toPoint(point);\r\n\r\n\t\treturn Math.abs(point.x) <= Math.abs(this.x) &&\r\n\t\t       Math.abs(point.y) <= Math.abs(this.y);\r\n\t},\r\n\r\n\t// @method toString(): String\r\n\t// Returns a string representation of the point for debugging purposes.\r\n\ttoString: function () {\r\n\t\treturn 'Point(' +\r\n\t\t        formatNum(this.x) + ', ' +\r\n\t\t        formatNum(this.y) + ')';\r\n\t}\r\n};\r\n\r\n// @factory L.point(x: Number, y: Number, round?: Boolean)\r\n// Creates a Point object with the given `x` and `y` coordinates. If optional `round` is set to true, rounds the `x` and `y` values.\r\n\r\n// @alternative\r\n// @factory L.point(coords: Number[])\r\n// Expects an array of the form `[x, y]` instead.\r\n\r\n// @alternative\r\n// @factory L.point(coords: Object)\r\n// Expects a plain object of the form `{x: Number, y: Number}` instead.\r\nexport function toPoint(x, y, round) {\r\n\tif (x instanceof Point) {\r\n\t\treturn x;\r\n\t}\r\n\tif (isArray(x)) {\r\n\t\treturn new Point(x[0], x[1]);\r\n\t}\r\n\tif (x === undefined || x === null) {\r\n\t\treturn x;\r\n\t}\r\n\tif (typeof x === 'object' && 'x' in x && 'y' in x) {\r\n\t\treturn new Point(x.x, x.y);\r\n\t}\r\n\treturn new Point(x, y, round);\r\n}\r\n","import * as DomEvent from './DomEvent';\nimport * as Util from '../core/Util';\nimport * as Browser from '../core/Browser';\n\n/*\n * Extends L.DomEvent to provide touch support for Internet Explorer and Windows-based devices.\n */\n\n\nvar POINTER_DOWN =   Browser.msPointer ? 'MSPointerDown'   : 'pointerdown',\n    POINTER_MOVE =   Browser.msPointer ? 'MSPointerMove'   : 'pointermove',\n    POINTER_UP =     Browser.msPointer ? 'MSPointerUp'     : 'pointerup',\n    POINTER_CANCEL = Browser.msPointer ? 'MSPointerCancel' : 'pointercancel',\n    TAG_WHITE_LIST = ['INPUT', 'SELECT', 'OPTION'],\n\n    _pointers = {},\n    _pointerDocListener = false;\n\n// DomEvent.DoubleTap needs to know about this\nexport var _pointersCount = 0;\n\n// Provides a touch events wrapper for (ms)pointer events.\n// ref http://www.w3.org/TR/pointerevents/ https://www.w3.org/Bugs/Public/show_bug.cgi?id=22890\n\nexport function addPointerListener(obj, type, handler, id) {\n\tif (type === 'touchstart') {\n\t\t_addPointerStart(obj, handler, id);\n\n\t} else if (type === 'touchmove') {\n\t\t_addPointerMove(obj, handler, id);\n\n\t} else if (type === 'touchend') {\n\t\t_addPointerEnd(obj, handler, id);\n\t}\n\n\treturn this;\n}\n\nexport function removePointerListener(obj, type, id) {\n\tvar handler = obj['_leaflet_' + type + id];\n\n\tif (type === 'touchstart') {\n\t\tobj.removeEventListener(POINTER_DOWN, handler, false);\n\n\t} else if (type === 'touchmove') {\n\t\tobj.removeEventListener(POINTER_MOVE, handler, false);\n\n\t} else if (type === 'touchend') {\n\t\tobj.removeEventListener(POINTER_UP, handler, false);\n\t\tobj.removeEventListener(POINTER_CANCEL, handler, false);\n\t}\n\n\treturn this;\n}\n\nfunction _addPointerStart(obj, handler, id) {\n\tvar onDown = Util.bind(function (e) {\n\t\tif (e.pointerType !== 'mouse' && e.pointerType !== e.MSPOINTER_TYPE_MOUSE && e.pointerType !== e.MSPOINTER_TYPE_MOUSE) {\n\t\t\t// In IE11, some touch events needs to fire for form controls, or\n\t\t\t// the controls will stop working. We keep a whitelist of tag names that\n\t\t\t// need these events. For other target tags, we prevent default on the event.\n\t\t\tif (TAG_WHITE_LIST.indexOf(e.target.tagName) < 0) {\n\t\t\t\tDomEvent.preventDefault(e);\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t_handlePointer(e, handler);\n\t});\n\n\tobj['_leaflet_touchstart' + id] = onDown;\n\tobj.addEventListener(POINTER_DOWN, onDown, false);\n\n\t// need to keep track of what pointers and how many are active to provide e.touches emulation\n\tif (!_pointerDocListener) {\n\t\t// we listen documentElement as any drags that end by moving the touch off the screen get fired there\n\t\tdocument.documentElement.addEventListener(POINTER_DOWN, _globalPointerDown, true);\n\t\tdocument.documentElement.addEventListener(POINTER_MOVE, _globalPointerMove, true);\n\t\tdocument.documentElement.addEventListener(POINTER_UP, _globalPointerUp, true);\n\t\tdocument.documentElement.addEventListener(POINTER_CANCEL, _globalPointerUp, true);\n\n\t\t_pointerDocListener = true;\n\t}\n}\n\nfunction _globalPointerDown(e) {\n\t_pointers[e.pointerId] = e;\n\t_pointersCount++;\n}\n\nfunction _globalPointerMove(e) {\n\tif (_pointers[e.pointerId]) {\n\t\t_pointers[e.pointerId] = e;\n\t}\n}\n\nfunction _globalPointerUp(e) {\n\tdelete _pointers[e.pointerId];\n\t_pointersCount--;\n}\n\nfunction _handlePointer(e, handler) {\n\te.touches = [];\n\tfor (var i in _pointers) {\n\t\te.touches.push(_pointers[i]);\n\t}\n\te.changedTouches = [e];\n\n\thandler(e);\n}\n\nfunction _addPointerMove(obj, handler, id) {\n\tvar onMove = function (e) {\n\t\t// don't fire touch moves when mouse isn't down\n\t\tif ((e.pointerType === e.MSPOINTER_TYPE_MOUSE || e.pointerType === 'mouse') && e.buttons === 0) { return; }\n\n\t\t_handlePointer(e, handler);\n\t};\n\n\tobj['_leaflet_touchmove' + id] = onMove;\n\tobj.addEventListener(POINTER_MOVE, onMove, false);\n}\n\nfunction _addPointerEnd(obj, handler, id) {\n\tvar onUp = function (e) {\n\t\t_handlePointer(e, handler);\n\t};\n\n\tobj['_leaflet_touchend' + id] = onUp;\n\tobj.addEventListener(POINTER_UP, onUp, false);\n\tobj.addEventListener(POINTER_CANCEL, onUp, false);\n}\n\n","import * as Browser from '../core/Browser';\r\nimport {_pointersCount} from './DomEvent.Pointer';\r\n\r\n/*\r\n * Extends the event handling code with double tap support for mobile browsers.\r\n */\r\n\r\nvar _touchstart = Browser.msPointer ? 'MSPointerDown' : Browser.pointer ? 'pointerdown' : 'touchstart',\r\n    _touchend = Browser.msPointer ? 'MSPointerUp' : Browser.pointer ? 'pointerup' : 'touchend',\r\n    _pre = '_leaflet_';\r\n\r\n// inspired by Zepto touch code by Thomas Fuchs\r\nexport function addDoubleTapListener(obj, handler, id) {\r\n\tvar last, touch,\r\n\t    doubleTap = false,\r\n\t    delay = 250;\r\n\r\n\tfunction onTouchStart(e) {\r\n\t\tvar count;\r\n\r\n\t\tif (Browser.pointer) {\r\n\t\t\tif ((!Browser.edge) || e.pointerType === 'mouse') { return; }\r\n\t\t\tcount = _pointersCount;\r\n\t\t} else {\r\n\t\t\tcount = e.touches.length;\r\n\t\t}\r\n\r\n\t\tif (count > 1) { return; }\r\n\r\n\t\tvar now = Date.now(),\r\n\t\t    delta = now - (last || now);\r\n\r\n\t\ttouch = e.touches ? e.touches[0] : e;\r\n\t\tdoubleTap = (delta > 0 && delta <= delay);\r\n\t\tlast = now;\r\n\t}\r\n\r\n\tfunction onTouchEnd(e) {\r\n\t\tif (doubleTap && !touch.cancelBubble) {\r\n\t\t\tif (Browser.pointer) {\r\n\t\t\t\tif ((!Browser.edge) || e.pointerType === 'mouse') { return; }\r\n\t\t\t\t// work around .type being readonly with MSPointer* events\r\n\t\t\t\tvar newTouch = {},\r\n\t\t\t\t    prop, i;\r\n\r\n\t\t\t\tfor (i in touch) {\r\n\t\t\t\t\tprop = touch[i];\r\n\t\t\t\t\tnewTouch[i] = prop && prop.bind ? prop.bind(touch) : prop;\r\n\t\t\t\t}\r\n\t\t\t\ttouch = newTouch;\r\n\t\t\t}\r\n\t\t\ttouch.type = 'dblclick';\r\n\t\t\thandler(touch);\r\n\t\t\tlast = null;\r\n\t\t}\r\n\t}\r\n\r\n\tobj[_pre + _touchstart + id] = onTouchStart;\r\n\tobj[_pre + _touchend + id] = onTouchEnd;\r\n\tobj[_pre + 'dblclick' + id] = handler;\r\n\r\n\tobj.addEventListener(_touchstart, onTouchStart, false);\r\n\tobj.addEventListener(_touchend, onTouchEnd, false);\r\n\r\n\t// On some platforms (notably, chrome<55 on win10 + touchscreen + mouse),\r\n\t// the browser doesn't fire touchend/pointerup events but does fire\r\n\t// native dblclicks. See #4127.\r\n\t// Edge 14 also fires native dblclicks, but only for pointerType mouse, see #5180.\r\n\tobj.addEventListener('dblclick', handler, false);\r\n\r\n\treturn this;\r\n}\r\n\r\nexport function removeDoubleTapListener(obj, id) {\r\n\tvar touchstart = obj[_pre + _touchstart + id],\r\n\t    touchend = obj[_pre + _touchend + id],\r\n\t    dblclick = obj[_pre + 'dblclick' + id];\r\n\r\n\tobj.removeEventListener(_touchstart, touchstart, false);\r\n\tobj.removeEventListener(_touchend, touchend, false);\r\n\tif (!Browser.edge) {\r\n\t\tobj.removeEventListener('dblclick', dblclick, false);\r\n\t}\r\n\r\n\treturn this;\r\n}\r\n","import {Point} from '../geometry/Point';\r\nimport * as Util from '../core/Util';\r\nimport * as Browser from '../core/Browser';\r\nimport {addPointerListener, removePointerListener} from './DomEvent.Pointer';\r\nimport {addDoubleTapListener, removeDoubleTapListener} from './DomEvent.DoubleTap';\r\n\r\n/*\r\n * @namespace DomEvent\r\n * Utility functions to work with the [DOM events](https://developer.mozilla.org/docs/Web/API/Event), used by Leaflet internally.\r\n */\r\n\r\n// Inspired by John Resig, Dean Edwards and YUI addEvent implementations.\r\n\r\n// @function on(el: HTMLElement, types: String, fn: Function, context?: Object): this\r\n// Adds a listener function (`fn`) to a particular DOM event type of the\r\n// element `el`. You can optionally specify the context of the listener\r\n// (object the `this` keyword will point to). You can also pass several\r\n// space-separated types (e.g. `'click dblclick'`).\r\n\r\n// @alternative\r\n// @function on(el: HTMLElement, eventMap: Object, context?: Object): this\r\n// Adds a set of type/listener pairs, e.g. `{click: onClick, mousemove: onMouseMove}`\r\nexport function on(obj, types, fn, context) {\r\n\r\n\tif (typeof types === 'object') {\r\n\t\tfor (var type in types) {\r\n\t\t\taddOne(obj, type, types[type], fn);\r\n\t\t}\r\n\t} else {\r\n\t\ttypes = Util.splitWords(types);\r\n\r\n\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\taddOne(obj, types[i], fn, context);\r\n\t\t}\r\n\t}\r\n\r\n\treturn this;\r\n}\r\n\r\nvar eventsKey = '_leaflet_events';\r\n\r\n// @function off(el: HTMLElement, types: String, fn: Function, context?: Object): this\r\n// Removes a previously added listener function. If no function is specified,\r\n// it will remove all the listeners of that particular DOM event from the element.\r\n// Note that if you passed a custom context to on, you must pass the same\r\n// context to `off` in order to remove the listener.\r\n\r\n// @alternative\r\n// @function off(el: HTMLElement, eventMap: Object, context?: Object): this\r\n// Removes a set of type/listener pairs, e.g. `{click: onClick, mousemove: onMouseMove}`\r\n\r\n// @alternative\r\n// @function off(el: HTMLElement): this\r\n// Removes all known event listeners\r\nexport function off(obj, types, fn, context) {\r\n\r\n\tif (typeof types === 'object') {\r\n\t\tfor (var type in types) {\r\n\t\t\tremoveOne(obj, type, types[type], fn);\r\n\t\t}\r\n\t} else if (types) {\r\n\t\ttypes = Util.splitWords(types);\r\n\r\n\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\tremoveOne(obj, types[i], fn, context);\r\n\t\t}\r\n\t} else {\r\n\t\tfor (var j in obj[eventsKey]) {\r\n\t\t\tremoveOne(obj, j, obj[eventsKey][j]);\r\n\t\t}\r\n\t\tdelete obj[eventsKey];\r\n\t}\r\n}\r\n\r\nfunction addOne(obj, type, fn, context) {\r\n\tvar id = type + Util.stamp(fn) + (context ? '_' + Util.stamp(context) : '');\r\n\r\n\tif (obj[eventsKey] && obj[eventsKey][id]) { return this; }\r\n\r\n\tvar handler = function (e) {\r\n\t\treturn fn.call(context || obj, e || window.event);\r\n\t};\r\n\r\n\tvar originalHandler = handler;\r\n\r\n\tif (Browser.pointer && type.indexOf('touch') === 0) {\r\n\t\t// Needs DomEvent.Pointer.js\r\n\t\taddPointerListener(obj, type, handler, id);\r\n\r\n\t} else if (Browser.touch && (type === 'dblclick') && addDoubleTapListener &&\r\n\t           !(Browser.pointer && Browser.chrome)) {\r\n\t\t// Chrome >55 does not need the synthetic dblclicks from addDoubleTapListener\r\n\t\t// See #5180\r\n\t\taddDoubleTapListener(obj, handler, id);\r\n\r\n\t} else if ('addEventListener' in obj) {\r\n\r\n\t\tif (type === 'mousewheel') {\r\n\t\t\tobj.addEventListener('onwheel' in obj ? 'wheel' : 'mousewheel', handler, false);\r\n\r\n\t\t} else if ((type === 'mouseenter') || (type === 'mouseleave')) {\r\n\t\t\thandler = function (e) {\r\n\t\t\t\te = e || window.event;\r\n\t\t\t\tif (isExternalTarget(obj, e)) {\r\n\t\t\t\t\toriginalHandler(e);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tobj.addEventListener(type === 'mouseenter' ? 'mouseover' : 'mouseout', handler, false);\r\n\r\n\t\t} else {\r\n\t\t\tif (type === 'click' && Browser.android) {\r\n\t\t\t\thandler = function (e) {\r\n\t\t\t\t\tfilterClick(e, originalHandler);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tobj.addEventListener(type, handler, false);\r\n\t\t}\r\n\r\n\t} else if ('attachEvent' in obj) {\r\n\t\tobj.attachEvent('on' + type, handler);\r\n\t}\r\n\r\n\tobj[eventsKey] = obj[eventsKey] || {};\r\n\tobj[eventsKey][id] = handler;\r\n}\r\n\r\nfunction removeOne(obj, type, fn, context) {\r\n\r\n\tvar id = type + Util.stamp(fn) + (context ? '_' + Util.stamp(context) : ''),\r\n\t    handler = obj[eventsKey] && obj[eventsKey][id];\r\n\r\n\tif (!handler) { return this; }\r\n\r\n\tif (Browser.pointer && type.indexOf('touch') === 0) {\r\n\t\tremovePointerListener(obj, type, id);\r\n\r\n\t} else if (Browser.touch && (type === 'dblclick') && removeDoubleTapListener) {\r\n\t\tremoveDoubleTapListener(obj, id);\r\n\r\n\t} else if ('removeEventListener' in obj) {\r\n\r\n\t\tif (type === 'mousewheel') {\r\n\t\t\tobj.removeEventListener('onwheel' in obj ? 'wheel' : 'mousewheel', handler, false);\r\n\r\n\t\t} else {\r\n\t\t\tobj.removeEventListener(\r\n\t\t\t\ttype === 'mouseenter' ? 'mouseover' :\r\n\t\t\t\ttype === 'mouseleave' ? 'mouseout' : type, handler, false);\r\n\t\t}\r\n\r\n\t} else if ('detachEvent' in obj) {\r\n\t\tobj.detachEvent('on' + type, handler);\r\n\t}\r\n\r\n\tobj[eventsKey][id] = null;\r\n}\r\n\r\n// @function stopPropagation(ev: DOMEvent): this\r\n// Stop the given event from propagation to parent elements. Used inside the listener functions:\r\n// ```js\r\n// L.DomEvent.on(div, 'click', function (ev) {\r\n// \tL.DomEvent.stopPropagation(ev);\r\n// });\r\n// ```\r\nexport function stopPropagation(e) {\r\n\r\n\tif (e.stopPropagation) {\r\n\t\te.stopPropagation();\r\n\t} else if (e.originalEvent) {  // In case of Leaflet event.\r\n\t\te.originalEvent._stopped = true;\r\n\t} else {\r\n\t\te.cancelBubble = true;\r\n\t}\r\n\tskipped(e);\r\n\r\n\treturn this;\r\n}\r\n\r\n// @function disableScrollPropagation(el: HTMLElement): this\r\n// Adds `stopPropagation` to the element's `'mousewheel'` events (plus browser variants).\r\nexport function disableScrollPropagation(el) {\r\n\treturn addOne(el, 'mousewheel', stopPropagation);\r\n}\r\n\r\n// @function disableClickPropagation(el: HTMLElement): this\r\n// Adds `stopPropagation` to the element's `'click'`, `'doubleclick'`,\r\n// `'mousedown'` and `'touchstart'` events (plus browser variants).\r\nexport function disableClickPropagation(el) {\r\n\ton(el, 'mousedown touchstart dblclick', stopPropagation);\r\n\taddOne(el, 'click', fakeStop);\r\n\treturn this;\r\n}\r\n\r\n// @function preventDefault(ev: DOMEvent): this\r\n// Prevents the default action of the DOM Event `ev` from happening (such as\r\n// following a link in the href of the a element, or doing a POST request\r\n// with page reload when a `<form>` is submitted).\r\n// Use it inside listener functions.\r\nexport function preventDefault(e) {\r\n\tif (e.preventDefault) {\r\n\t\te.preventDefault();\r\n\t} else {\r\n\t\te.returnValue = false;\r\n\t}\r\n\treturn this;\r\n}\r\n\r\n// @function stop(ev): this\r\n// Does `stopPropagation` and `preventDefault` at the same time.\r\nexport function stop(e) {\r\n\tpreventDefault(e);\r\n\tstopPropagation(e);\r\n\treturn this;\r\n}\r\n\r\n// @function getMousePosition(ev: DOMEvent, container?: HTMLElement): Point\r\n// Gets normalized mouse position from a DOM event relative to the\r\n// `container` or to the whole page if not specified.\r\nexport function getMousePosition(e, container) {\r\n\tif (!container) {\r\n\t\treturn new Point(e.clientX, e.clientY);\r\n\t}\r\n\r\n\tvar rect = container.getBoundingClientRect();\r\n\r\n\treturn new Point(\r\n\t\te.clientX - rect.left - container.clientLeft,\r\n\t\te.clientY - rect.top - container.clientTop);\r\n}\r\n\r\n// Chrome on Win scrolls double the pixels as in other platforms (see #4538),\r\n// and Firefox scrolls device pixels, not CSS pixels\r\nvar wheelPxFactor =\r\n\t(Browser.win && Browser.chrome) ? 2 :\r\n\tBrowser.gecko ? window.devicePixelRatio : 1;\r\n\r\n// @function getWheelDelta(ev: DOMEvent): Number\r\n// Gets normalized wheel delta from a mousewheel DOM event, in vertical\r\n// pixels scrolled (negative if scrolling down).\r\n// Events from pointing devices without precise scrolling are mapped to\r\n// a best guess of 60 pixels.\r\nexport function getWheelDelta(e) {\r\n\treturn (Browser.edge) ? e.wheelDeltaY / 2 : // Don't trust window-geometry-based delta\r\n\t       (e.deltaY && e.deltaMode === 0) ? -e.deltaY / wheelPxFactor : // Pixels\r\n\t       (e.deltaY && e.deltaMode === 1) ? -e.deltaY * 20 : // Lines\r\n\t       (e.deltaY && e.deltaMode === 2) ? -e.deltaY * 60 : // Pages\r\n\t       (e.deltaX || e.deltaZ) ? 0 :\t// Skip horizontal/depth wheel events\r\n\t       e.wheelDelta ? (e.wheelDeltaY || e.wheelDelta) / 2 : // Legacy IE pixels\r\n\t       (e.detail && Math.abs(e.detail) < 32765) ? -e.detail * 20 : // Legacy Moz lines\r\n\t       e.detail ? e.detail / -32765 * 60 : // Legacy Moz pages\r\n\t       0;\r\n}\r\n\r\nvar skipEvents = {};\r\n\r\nexport function fakeStop(e) {\r\n\t// fakes stopPropagation by setting a special event flag, checked/reset with skipped(e)\r\n\tskipEvents[e.type] = true;\r\n}\r\n\r\nexport function skipped(e) {\r\n\tvar events = skipEvents[e.type];\r\n\t// reset when checking, as it's only used in map container and propagates outside of the map\r\n\tskipEvents[e.type] = false;\r\n\treturn events;\r\n}\r\n\r\n// check if element really left/entered the event target (for mouseenter/mouseleave)\r\nexport function isExternalTarget(el, e) {\r\n\r\n\tvar related = e.relatedTarget;\r\n\r\n\tif (!related) { return true; }\r\n\r\n\ttry {\r\n\t\twhile (related && (related !== el)) {\r\n\t\t\trelated = related.parentNode;\r\n\t\t}\r\n\t} catch (err) {\r\n\t\treturn false;\r\n\t}\r\n\treturn (related !== el);\r\n}\r\n\r\nvar lastClick;\r\n\r\n// this is a horrible workaround for a bug in Android where a single touch triggers two click events\r\nfunction filterClick(e, handler) {\r\n\tvar timeStamp = (e.timeStamp || (e.originalEvent && e.originalEvent.timeStamp)),\r\n\t    elapsed = lastClick && (timeStamp - lastClick);\r\n\r\n\t// are they closer together than 500ms yet more than 100ms?\r\n\t// Android typically triggers them ~300ms apart while multiple listeners\r\n\t// on the same event should be triggered far faster;\r\n\t// or check if click is simulated on the element, and if it is, reject any non-simulated events\r\n\r\n\tif ((elapsed && elapsed > 100 && elapsed < 500) || (e.target._simulatedClick && !e._simulated)) {\r\n\t\tstop(e);\r\n\t\treturn;\r\n\t}\r\n\tlastClick = timeStamp;\r\n\r\n\thandler(e);\r\n}\r\n\r\n// @function addListener(…): this\r\n// Alias to [`L.DomEvent.on`](#domevent-on)\r\nexport {on as addListener};\r\n\r\n// @function removeListener(…): this\r\n// Alias to [`L.DomEvent.off`](#domevent-off)\r\nexport {off as removeListener};\r\n","import * as DomEvent from './DomEvent';\nimport * as Util from '../core/Util';\nimport {Point} from '../geometry/Point';\nimport * as Browser from '../core/Browser';\n\n/*\n * @namespace DomUtil\n *\n * Utility functions to work with the [DOM](https://developer.mozilla.org/docs/Web/API/Document_Object_Model)\n * tree, used by Leaflet internally.\n *\n * Most functions expecting or returning a `HTMLElement` also work for\n * SVG elements. The only difference is that classes refer to CSS classes\n * in HTML and SVG classes in SVG.\n */\n\n if (!Element.prototype.matches) {\n    var ep = Element.prototype;\n \n    if (ep.webkitMatchesSelector) // Chrome <34, SF<7.1, iOS<8\n      ep.matches = ep.webkitMatchesSelector;\n \n    if (ep.msMatchesSelector) // IE9/10/11 & Edge\n      ep.matches = ep.msMatchesSelector;\n \n    if (ep.mozMatchesSelector) // FF<34\n      ep.matches = ep.mozMatchesSelector;\n }\n\n// @property TRANSFORM: String\n// Vendor-prefixed fransform style name (e.g. `'webkitTransform'` for WebKit).\nexport var TRANSFORM = testProp(\n    ['transform', 'WebkitTransform', 'OTransform', 'MozTransform', 'msTransform']);\n\n// webkitTransition comes first because some browser versions that drop vendor prefix don't do\n// the same for the transitionend event, in particular the Android 4.1 stock browser\n\n// @property TRANSITION: String\n// Vendor-prefixed transform style name.\nexport var TRANSITION = testProp(\n    ['webkitTransition', 'transition', 'OTransition', 'MozTransition', 'msTransition']);\n\nexport var TRANSITION_END =\n    TRANSITION === 'webkitTransition' || TRANSITION === 'OTransition' ? TRANSITION + 'End' : 'transitionend';\n\n\n// @function get(id: String|HTMLElement): HTMLElement\n// Returns an element given its DOM id, or returns the element itself\n// if it was passed directly.\nexport function get(id) {\n    return typeof id === 'string' ? document.getElementById(id) : id;\n}\n\n// @function getStyle(el: HTMLElement, styleAttrib: String): String\n// Returns the value for a certain style attribute on an element,\n// including computed values or values set through CSS.\nexport function getStyle(el, style) {\n    var value = el.style[style] || (el.currentStyle && el.currentStyle[style]);\n\n    if ((!value || value === 'auto') && document.defaultView) {\n        var css = document.defaultView.getComputedStyle(el, null);\n        value = css ? css[style] : null;\n    }\n    return value === 'auto' ? null : value;\n}\n\n// @function create(tagName: String, className?: String, container?: HTMLElement): HTMLElement\n// Creates an HTML element with `tagName`, sets its class to `className`, and optionally appends it to `container` element.\nexport function create(tagName, className, container) {\n    var el = document.createElement(tagName);\n    el.className = className || '';\n\n    if (container) {\n        container.appendChild(el);\n    }\n    return el;\n}\n\n// @function remove(el: HTMLElement)\n// Removes `el` from its parent element\nexport function remove(el) {\n    var parent = el.parentNode;\n    if (parent) {\n        parent.removeChild(el);\n    }\n}\n\n// @function empty(el: HTMLElement)\n// Removes all of `el`'s children elements from `el`\nexport function empty(el) {\n    while (el.firstChild) {\n        el.removeChild(el.firstChild);\n    }\n}\n\n// @function toFront(el: HTMLElement)\n// Makes `el` the last child of its parent, so it renders in front of the other children.\nexport function toFront(el) {\n    el.parentNode.appendChild(el);\n}\n\n// @function toBack(el: HTMLElement)\n// Makes `el` the first child of its parent, so it renders behind the other children.\nexport function toBack(el) {\n    var parent = el.parentNode;\n    parent.insertBefore(el, parent.firstChild);\n}\n\n// @function hasClass(el: HTMLElement, name: String): Boolean\n// Returns `true` if the element's class attribute contains `name`.\nexport function hasClass(el, name) {\n    if (el.classList !== undefined) {\n        return el.classList.contains(name);\n    }\n    var className = getClass(el);\n    return className.length > 0 && new RegExp('(^|\\\\s)' + name + '(\\\\s|$)').test(className);\n}\n\n// @function addClass(el: HTMLElement, name: String)\n// Adds `name` to the element's class attribute.\nexport function addClass(el, name) {\n    if (el.classList !== undefined) {\n        var classes = Util.splitWords(name);\n        for (var i = 0, len = classes.length; i < len; i++) {\n            el.classList.add(classes[i]);\n        }\n    } else if (!hasClass(el, name)) {\n        var className = getClass(el);\n        setClass(el, (className ? className + ' ' : '') + name);\n    }\n}\n\n// @function removeClass(el: HTMLElement, name: String)\n// Removes `name` from the element's class attribute.\nexport function removeClass(el, name) {\n    if (el.classList !== undefined) {\n        el.classList.remove(name);\n    } else {\n        setClass(el, Util.trim((' ' + getClass(el) + ' ').replace(' ' + name + ' ', ' ')));\n    }\n}\n\n// @function setClass(el: HTMLElement, name: String)\n// Sets the element's class.\nexport function setClass(el, name) {\n    if (el.className.baseVal === undefined) {\n        el.className = name;\n    } else {\n        // in case of SVG element\n        el.className.baseVal = name;\n    }\n}\n\n// @function getClass(el: HTMLElement): String\n// Returns the element's class.\nexport function getClass(el) {\n    return el.className.baseVal === undefined ? el.className : el.className.baseVal;\n}\n\n// @function setOpacity(el: HTMLElement, opacity: Number)\n// Set the opacity of an element (including old IE support).\n// `opacity` must be a number from `0` to `1`.\nexport function setOpacity(el, value) {\n    if ('opacity' in el.style) {\n        el.style.opacity = value;\n    } else if ('filter' in el.style) {\n        _setOpacityIE(el, value);\n    }\n}\n\nfunction _setOpacityIE(el, value) {\n    var filter = false,\n        filterName = 'DXImageTransform.Microsoft.Alpha';\n\n    // filters collection throws an error if we try to retrieve a filter that doesn't exist\n    try {\n        filter = el.filters.item(filterName);\n    } catch (e) {\n        // don't set opacity to 1 if we haven't already set an opacity,\n        // it isn't needed and breaks transparent pngs.\n        if (value === 1) { return; }\n    }\n\n    value = Math.round(value * 100);\n\n    if (filter) {\n        filter.Enabled = (value !== 100);\n        filter.Opacity = value;\n    } else {\n        el.style.filter += ' progid:' + filterName + '(opacity=' + value + ')';\n    }\n}\n\n// @function testProp(props: String[]): String|false\n// Goes through the array of style names and returns the first name\n// that is a valid style name for an element. If no such name is found,\n// it returns false. Useful for vendor-prefixed styles like `transform`.\nexport function testProp(props) {\n    var style = document.documentElement.style;\n\n    for (var i = 0; i < props.length; i++) {\n        if (props[i] in style) {\n            return props[i];\n        }\n    }\n    return false;\n}\n\nexport function isPropertySupported(prop) {\n    var style = document.documentElement.style;\n    return prop in style;\n}\n\n// @function setTransform(el: HTMLElement, offset: Point, scale?: Number)\n// Resets the 3D CSS transform of `el` so it is translated by `offset` pixels\n// and optionally scaled by `scale`. Does not have an effect if the\n// browser doesn't support 3D CSS transforms.\nexport function setTransform(el, offset, scale) {\n    var pos = offset || new Point(0, 0);\n\n    el.style[TRANSFORM] =\n        (Browser.ie3d ?\n            'translate(' + pos.x + 'px,' + pos.y + 'px)' :\n            'translate3d(' + pos.x + 'px,' + pos.y + 'px,0)') +\n        (scale ? ' scale(' + scale + ')' : '');\n}\n\n// @function setPosition(el: HTMLElement, position: Point)\n// Sets the position of `el` to coordinates specified by `position`,\n// using CSS translate or top/left positioning depending on the browser\n// (used by Leaflet internally to position its layers).\nexport function setPosition(el, point) {\n\n    /*eslint-disable */\n    el._leaflet_pos = point;\n    /*eslint-enable */\n\n    if (Browser.any3d) {\n        setTransform(el, point);\n    } else {\n        el.style.left = point.x + 'px';\n        el.style.top = point.y + 'px';\n    }\n}\n\n// @function getPosition(el: HTMLElement): Point\n// Returns the coordinates of an element previously positioned with setPosition.\nexport function getPosition(el) {\n    // this method is only used for elements previously positioned using setPosition,\n    // so it's safe to cache the position for performance\n\n    return el._leaflet_pos || new Point(0, 0);\n}\n\n// @function disableTextSelection()\n// Prevents the user from generating `selectstart` DOM events, usually generated\n// when the user drags the mouse through a page with text. Used internally\n// by Leaflet to override the behaviour of any click-and-drag interaction on\n// the map. Affects drag interactions on the whole document.\n\n// @function enableTextSelection()\n// Cancels the effects of a previous [`L.DomUtil.disableTextSelection`](#domutil-disabletextselection).\nexport var disableTextSelection;\nexport var enableTextSelection;\nvar _userSelect;\nif ('onselectstart' in document) {\n    disableTextSelection = function () {\n        DomEvent.on(window, 'selectstart', DomEvent.preventDefault);\n    };\n    enableTextSelection = function () {\n        DomEvent.off(window, 'selectstart', DomEvent.preventDefault);\n    };\n} else {\n    var userSelectProperty = testProp(\n        ['userSelect', 'WebkitUserSelect', 'OUserSelect', 'MozUserSelect', 'msUserSelect']);\n\n    disableTextSelection = function () {\n        if (userSelectProperty) {\n            var style = document.documentElement.style;\n            _userSelect = style[userSelectProperty];\n            style[userSelectProperty] = 'none';\n        }\n    };\n    enableTextSelection = function () {\n        if (userSelectProperty) {\n            document.documentElement.style[userSelectProperty] = _userSelect;\n            _userSelect = undefined;\n        }\n    };\n}\n\n// @function disableImageDrag()\n// As [`L.DomUtil.disableTextSelection`](#domutil-disabletextselection), but\n// for `dragstart` DOM events, usually generated when the user drags an image.\nexport function disableImageDrag() {\n    DomEvent.on(window, 'dragstart', DomEvent.preventDefault);\n}\n\n// @function enableImageDrag()\n// Cancels the effects of a previous [`L.DomUtil.disableImageDrag`](#domutil-disabletextselection).\nexport function enableImageDrag() {\n    DomEvent.off(window, 'dragstart', DomEvent.preventDefault);\n}\n\nvar _outlineElement, _outlineStyle;\n// @function preventOutline(el: HTMLElement)\n// Makes the [outline](https://developer.mozilla.org/docs/Web/CSS/outline)\n// of the element `el` invisible. Used internally by Leaflet to prevent\n// focusable elements from displaying an outline when the user performs a\n// drag interaction on them.\nexport function preventOutline(element) {\n    while (element.tabIndex === -1) {\n        element = element.parentNode;\n    }\n    if (!element || !element.style) { return; }\n    restoreOutline();\n    _outlineElement = element;\n    _outlineStyle = element.style.outline;\n    element.style.outline = 'none';\n    DomEvent.on(window, 'keydown', restoreOutline);\n}\n\n// @function restoreOutline()\n// Cancels the effects of a previous [`L.DomUtil.preventOutline`]().\nexport function restoreOutline() {\n    if (!_outlineElement) { return; }\n    _outlineElement.style.outline = _outlineStyle;\n    _outlineElement = undefined;\n    _outlineStyle = undefined;\n    DomEvent.off(window, 'keydown', restoreOutline);\n}\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var baseGetTag = require('./_baseGetTag'),\n    isObject = require('./isObject');\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nmodule.exports = isFunction;\n","var root = require('./_root');\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nmodule.exports = coreJsData;\n","var coreJsData = require('./_coreJsData');\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nmodule.exports = isMasked;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nmodule.exports = toSource;\n","var isFunction = require('./isFunction'),\n    isMasked = require('./_isMasked'),\n    isObject = require('./isObject'),\n    toSource = require('./_toSource');\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nmodule.exports = baseIsNative;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nmodule.exports = getValue;\n","var baseIsNative = require('./_baseIsNative'),\n    getValue = require('./_getValue');\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nmodule.exports = getNative;\n","var getNative = require('./_getNative');\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nmodule.exports = defineProperty;\n","var defineProperty = require('./_defineProperty');\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\nmodule.exports = baseAssignValue;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nmodule.exports = eq;\n","var baseAssignValue = require('./_baseAssignValue'),\n    eq = require('./eq');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nmodule.exports = assignValue;\n","var assignValue = require('./_assignValue'),\n    baseAssignValue = require('./_baseAssignValue');\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property identifiers to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @param {Function} [customizer] The function to customize copied values.\n * @returns {Object} Returns `object`.\n */\nfunction copyObject(source, props, object, customizer) {\n  var isNew = !object;\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n\n    var newValue = customizer\n      ? customizer(object[key], source[key], key, object, source)\n      : undefined;\n\n    if (newValue === undefined) {\n      newValue = source[key];\n    }\n    if (isNew) {\n      baseAssignValue(object, key, newValue);\n    } else {\n      assignValue(object, key, newValue);\n    }\n  }\n  return object;\n}\n\nmodule.exports = copyObject;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nmodule.exports = identity;\n","/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\nmodule.exports = apply;\n","var apply = require('./_apply');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * A specialized version of `baseRest` which transforms the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @param {Function} transform The rest array transform.\n * @returns {Function} Returns the new function.\n */\nfunction overRest(func, start, transform) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = transform(array);\n    return apply(func, this, otherArgs);\n  };\n}\n\nmodule.exports = overRest;\n","/**\n * Creates a function that returns `value`.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {*} value The value to return from the new function.\n * @returns {Function} Returns the new constant function.\n * @example\n *\n * var objects = _.times(2, _.constant({ 'a': 1 }));\n *\n * console.log(objects);\n * // => [{ 'a': 1 }, { 'a': 1 }]\n *\n * console.log(objects[0] === objects[1]);\n * // => true\n */\nfunction constant(value) {\n  return function() {\n    return value;\n  };\n}\n\nmodule.exports = constant;\n","var constant = require('./constant'),\n    defineProperty = require('./_defineProperty'),\n    identity = require('./identity');\n\n/**\n * The base implementation of `setToString` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar baseSetToString = !defineProperty ? identity : function(func, string) {\n  return defineProperty(func, 'toString', {\n    'configurable': true,\n    'enumerable': false,\n    'value': constant(string),\n    'writable': true\n  });\n};\n\nmodule.exports = baseSetToString;\n","/** Used to detect hot functions by number of calls within a span of milliseconds. */\nvar HOT_COUNT = 800,\n    HOT_SPAN = 16;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeNow = Date.now;\n\n/**\n * Creates a function that'll short out and invoke `identity` instead\n * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n * milliseconds.\n *\n * @private\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new shortable function.\n */\nfunction shortOut(func) {\n  var count = 0,\n      lastCalled = 0;\n\n  return function() {\n    var stamp = nativeNow(),\n        remaining = HOT_SPAN - (stamp - lastCalled);\n\n    lastCalled = stamp;\n    if (remaining > 0) {\n      if (++count >= HOT_COUNT) {\n        return arguments[0];\n      }\n    } else {\n      count = 0;\n    }\n    return func.apply(undefined, arguments);\n  };\n}\n\nmodule.exports = shortOut;\n","var baseSetToString = require('./_baseSetToString'),\n    shortOut = require('./_shortOut');\n\n/**\n * Sets the `toString` method of `func` to return `string`.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar setToString = shortOut(baseSetToString);\n\nmodule.exports = setToString;\n","var identity = require('./identity'),\n    overRest = require('./_overRest'),\n    setToString = require('./_setToString');\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  return setToString(overRest(func, start, identity), func + '');\n}\n\nmodule.exports = baseRest;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nmodule.exports = isLength;\n","var isFunction = require('./isFunction'),\n    isLength = require('./isLength');\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nmodule.exports = isArrayLike;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  length = length == null ? MAX_SAFE_INTEGER : length;\n  return !!length &&\n    (typeof value == 'number' || reIsUint.test(value)) &&\n    (value > -1 && value % 1 == 0 && value < length);\n}\n\nmodule.exports = isIndex;\n","var eq = require('./eq'),\n    isArrayLike = require('./isArrayLike'),\n    isIndex = require('./_isIndex'),\n    isObject = require('./isObject');\n\n/**\n * Checks if the given arguments are from an iteratee call.\n *\n * @private\n * @param {*} value The potential iteratee value argument.\n * @param {*} index The potential iteratee index or key argument.\n * @param {*} object The potential iteratee object argument.\n * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n *  else `false`.\n */\nfunction isIterateeCall(value, index, object) {\n  if (!isObject(object)) {\n    return false;\n  }\n  var type = typeof index;\n  if (type == 'number'\n        ? (isArrayLike(object) && isIndex(index, object.length))\n        : (type == 'string' && index in object)\n      ) {\n    return eq(object[index], value);\n  }\n  return false;\n}\n\nmodule.exports = isIterateeCall;\n","var baseRest = require('./_baseRest'),\n    isIterateeCall = require('./_isIterateeCall');\n\n/**\n * Creates a function like `_.assign`.\n *\n * @private\n * @param {Function} assigner The function to assign values.\n * @returns {Function} Returns the new assigner function.\n */\nfunction createAssigner(assigner) {\n  return baseRest(function(object, sources) {\n    var index = -1,\n        length = sources.length,\n        customizer = length > 1 ? sources[length - 1] : undefined,\n        guard = length > 2 ? sources[2] : undefined;\n\n    customizer = (assigner.length > 3 && typeof customizer == 'function')\n      ? (length--, customizer)\n      : undefined;\n\n    if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n      customizer = length < 3 ? undefined : customizer;\n      length = 1;\n    }\n    object = Object(object);\n    while (++index < length) {\n      var source = sources[index];\n      if (source) {\n        assigner(object, source, index, customizer);\n      }\n    }\n    return object;\n  });\n}\n\nmodule.exports = createAssigner;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nmodule.exports = isPrototype;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nmodule.exports = baseTimes;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nmodule.exports = baseIsArguments;\n","var baseIsArguments = require('./_baseIsArguments'),\n    isObjectLike = require('./isObjectLike');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nmodule.exports = isArguments;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nmodule.exports = isArray;\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = stubFalse;\n","var root = require('./_root'),\n    stubFalse = require('./stubFalse');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nmodule.exports = isBuffer;\n","var baseGetTag = require('./_baseGetTag'),\n    isLength = require('./isLength'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nmodule.exports = baseIsTypedArray;\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nmodule.exports = baseUnary;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nmodule.exports = nodeUtil;\n","var baseIsTypedArray = require('./_baseIsTypedArray'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nmodule.exports = isTypedArray;\n","var baseTimes = require('./_baseTimes'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isIndex = require('./_isIndex'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayLikeKeys;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nmodule.exports = overArg;\n","var overArg = require('./_overArg');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nmodule.exports = nativeKeys;\n","var isPrototype = require('./_isPrototype'),\n    nativeKeys = require('./_nativeKeys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseKeys;\n","var arrayLikeKeys = require('./_arrayLikeKeys'),\n    baseKeys = require('./_baseKeys'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nmodule.exports = keys;\n","var assignValue = require('./_assignValue'),\n    copyObject = require('./_copyObject'),\n    createAssigner = require('./_createAssigner'),\n    isArrayLike = require('./isArrayLike'),\n    isPrototype = require('./_isPrototype'),\n    keys = require('./keys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns own enumerable string keyed properties of source objects to the\n * destination object. Source objects are applied from left to right.\n * Subsequent sources overwrite property assignments of previous sources.\n *\n * **Note:** This method mutates `object` and is loosely based on\n * [`Object.assign`](https://mdn.io/Object/assign).\n *\n * @static\n * @memberOf _\n * @since 0.10.0\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} [sources] The source objects.\n * @returns {Object} Returns `object`.\n * @see _.assignIn\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * function Bar() {\n *   this.c = 3;\n * }\n *\n * Foo.prototype.b = 2;\n * Bar.prototype.d = 4;\n *\n * _.assign({ 'a': 0 }, new Foo, new Bar);\n * // => { 'a': 1, 'c': 3 }\n */\nvar assign = createAssigner(function(object, source) {\n  if (isPrototype(source) || isArrayLike(source)) {\n    copyObject(source, keys(source), object);\n    return;\n  }\n  for (var key in source) {\n    if (hasOwnProperty.call(source, key)) {\n      assignValue(object, key, source[key]);\n    }\n  }\n});\n\nmodule.exports = assign;\n","var document = typeof window !== 'undefined' && typeof window.document !== 'undefined' ? window.document : {};\nvar keyboardAllowed = typeof Element !== 'undefined' && 'ALLOW_KEYBOARD_INPUT' in Element;\n\nvar fn = (function () {\n  var val;\n\n  var fnMap = [\n    [\n      'requestFullscreen',\n      'exitFullscreen',\n      'fullscreenElement',\n      'fullscreenEnabled',\n      'fullscreenchange',\n      'fullscreenerror'\n    ],\n    // New WebKit\n    [\n      'webkitRequestFullscreen',\n      'webkitExitFullscreen',\n      'webkitFullscreenElement',\n      'webkitFullscreenEnabled',\n      'webkitfullscreenchange',\n      'webkitfullscreenerror'\n\n    ],\n    // Old WebKit (Safari 5.1)\n    [\n      'webkitRequestFullScreen',\n      'webkitCancelFullScreen',\n      'webkitCurrentFullScreenElement',\n      'webkitCancelFullScreen',\n      'webkitfullscreenchange',\n      'webkitfullscreenerror'\n\n    ],\n    [\n      'mozRequestFullScreen',\n      'mozCancelFullScreen',\n      'mozFullScreenElement',\n      'mozFullScreenEnabled',\n      'mozfullscreenchange',\n      'mozfullscreenerror'\n    ],\n    [\n      'msRequestFullscreen',\n      'msExitFullscreen',\n      'msFullscreenElement',\n      'msFullscreenEnabled',\n      'MSFullscreenChange',\n      'MSFullscreenError'\n    ]\n  ];\n\n  var i = 0;\n  var l = fnMap.length;\n  var ret = {};\n\n  for (; i < l; i++) {\n    val = fnMap[i];\n    if (val && val[1] in document) {\n      for (i = 0; i < val.length; i++) {\n        ret[fnMap[0][i]] = val[i];\n      }\n      return ret;\n    }\n  }\n\n  return false;\n})();\n\nvar eventNameMap = {\n  change: fn.fullscreenchange,\n  error: fn.fullscreenerror\n};\n\nvar screenfull = {\n  request: function (elem) {\n    var request = fn.requestFullscreen;\n\n    elem = elem || document.documentElement;\n\n    // Work around Safari 5.1 bug: reports support for\n    // keyboard in fullscreen even though it doesn't.\n    // Browser sniffing, since the alternative with\n    // setTimeout is even worse.\n    if (/5\\.1[.\\d]* Safari/.test(navigator.userAgent)) {\n      elem[request]();\n    } else {\n      elem[request](keyboardAllowed && Element.ALLOW_KEYBOARD_INPUT);\n    }\n  },\n  exit: function () {\n    document[fn.exitFullscreen]();\n  },\n  toggle: function (elem) {\n    if (this.isFullscreen) {\n      this.exit();\n    } else {\n      this.request(elem);\n    }\n  },\n  onchange: function (callback) {\n    this.on('change', callback);\n  },\n  onerror: function (callback) {\n    this.on('error', callback);\n  },\n  on: function (event, callback) {\n    var eventName = eventNameMap[event];\n    if (eventName) {\n      document.addEventListener(eventName, callback, false);\n    }\n  },\n  off: function (event, callback) {\n    var eventName = eventNameMap[event];\n    if (eventName) {\n      document.removeEventListener(eventName, callback, false);\n    }\n  },\n  raw: fn\n};\n\nObject.defineProperties(screenfull, {\n  isFullscreen: {\n    get: function () {\n      return Boolean(document[fn.fullscreenElement]);\n    }\n  },\n  element: {\n    enumerable: true,\n    get: function () {\n      return document[fn.fullscreenElement];\n    }\n  },\n  enabled: {\n    enumerable: true,\n    get: function () {\n      // Coerce to boolean in case of old WebKit\n      return Boolean(document[fn.fullscreenEnabled]);\n    }\n  }\n});\n\nexport {screenfull};","import * as Util from '../core/Util';\nimport {Evented} from '../core/Events';\n// import {Class} from '../core/Class';\nimport * as Browser from '../core/Browser';\nimport * as DomEvent from '../dom/DomEvent';\nimport * as DomUtil from '../dom/DomUtil';\n\nimport debounce from 'lodash/debounce';\nimport assign from 'lodash/assign';\n\nimport {screenfull} from '../screenfull';\n\n/*\n * @class Reader\n * @aka cozy.Map\n * @inherits Evented\n *\n * The central class of the API — it is used to create a book on a page and manipulate it.\n *\n * @example\n *\n * ```js\n * // initialize the map on the \"map\" div with a given center and zoom\n * var map = L.map('map', {\n *  center: [51.505, -0.09],\n *  zoom: 13\n * });\n * ```\n *\n */\n\nvar _padding = 1.0;\nexport var Reader = Evented.extend({\n  options: {\n    regions: [\n      'header',\n      'toolbar.top',\n      'toolbar.left',\n      'main',\n      'toolbar.right',\n      'toolbar.bottom',\n      'footer'\n    ],\n    metadata: {},\n    flow: 'auto',\n    engine: 'epubjs',\n    fontSizeLarge: '140%',\n    fontSizeSmall: '90%',\n    fontSizeDefault: '100%',\n    trackResize: true,\n    text_size: 100,\n    mobileMediaQuery: '(min-device-width : 300px) and (max-device-width : 600px)',\n    forceScrolledDocHeight: 1200,\n    theme: 'default',\n    rootfilePath: '',\n    themes: []\n  },\n\n  initialize: function(id, options) {\n    var self = this\n\n    self._original_document_title = document.title;\n\n    if ( localStorage.getItem('cozy.options') ) {\n      options = assign(options, JSON.parse(localStorage.getItem('cozy.options')));\n    }\n    options = Util.setOptions(this, options);\n\n    this._checkFeatureCompatibility();\n\n    this.metadata = this.options.metadata; // initial seed\n\n    this._initContainer(id);\n    this._initLayout();\n\n    if ( this.options.themes && this.options.themes.length > 0 ) {\n        this.options.themes.forEach(function(theme) {\n            if ( theme.href ) { return; }\n            var klass = theme.klass;\n            var rules = {};\n            for(var rule in theme.rules) {\n                var new_rule = '.' + klass;\n                if ( rule == 'body' ) { new_rule = 'body' + new_rule; }\n                else { new_rule += ' ' + rule ; }\n                rules[new_rule] = theme.rules[rule];\n            }\n            theme.rules = rules;\n        });\n    }\n\n    this._updateTheme();\n\n    // hack for https://github.com/Leaflet/Leaflet/issues/1980\n    // this._onResize = Util.bind(this._onResize, this);\n\n    this._initEvents();\n\n    this.callInitHooks();\n\n    this._mode = this.options.mode;\n  },\n\n  start: function(target, cb) {\n    var self = this;\n\n    if ( typeof(target) == 'function' && cb === undefined ) {\n      cb = target;\n      target = undefined;\n    }\n\n    Util.loader.js(this.options.engine_href).then(function() {\n      self._start(target, cb);\n      self._loaded = true;\n    })\n  },\n\n  _start: function(target, cb) {\n    var self = this;\n    target = target || 0;\n\n    // self.open(function() {\n    //   self.draw(target, cb);\n    // });\n\n    self.open(target, cb);\n  },\n\n  reopen: function(options, target) {\n    /* NOP */\n  },\n\n  saveOptions: function(options) {\n    var saved_options = {};\n    assign(saved_options, options);\n    if ( saved_options.flow == 'auto' ) {\n      // do not save\n      delete saved_options.flow;\n    }\n    localStorage.setItem('cozy.options', JSON.stringify(saved_options));\n  },\n\n  _updateTheme: function() {\n    DomUtil.removeClass(this._container, 'cozy-theme-' + ( this._container.dataset.theme || 'default' ));\n    DomUtil.addClass(this._container, 'cozy-theme-' + this.options.theme);\n    this._container.dataset.theme = this.options.theme;\n  },\n\n  draw: function(target) {\n    // NOOP\n  },\n\n  next: function() {\n    // NOOP\n  },\n\n  prev: function() {\n    // NOOP\n  },\n\n  display: function(index) {\n    // NOOP\n  },\n\n  gotoPage: function(target) {\n    // NOOP\n  },\n\n  goBack: function() {\n    history.back();\n  },\n\n  goForward: function() {\n    history.forward();\n  },\n\n  requestFullscreen: function() {\n    if ( screenfull.enabled ) {\n      // this._preResize();\n      screenfull.toggle(this._container);\n    }\n  },\n\n  _preResize: function() {\n\n  },\n\n  _initContainer: function (id) {\n    var container = this._container = DomUtil.get(id);\n\n    if (!container) {\n      throw new Error('Reader container not found.');\n    } else if (container._cozy_id) {\n      throw new Error('Reader container is already initialized.');\n    }\n\n    DomEvent.on(container, 'scroll', this._onScroll, this);\n    this._containerId = Util.stamp(container);\n  },\n\n  _initLayout: function () {\n    var container = this._container;\n\n    this._fadeAnimated = this.options.fadeAnimation && Browser.any3d;\n\n    DomUtil.addClass(container, 'cozy-container' +\n      (Browser.touch ? ' cozy-touch' : '') +\n      (Browser.retina ? ' cozy-retina' : '') +\n      (Browser.ielt9 ? ' cozy-oldie' : '') +\n      (Browser.safari ? ' cozy-safari' : '') +\n      (this._fadeAnimated ? ' cozy-fade-anim' : '') +\n      ' cozy-engine-' + this.options.engine +\n      ' cozy-theme-' + this.options.theme);\n\n    var position = DomUtil.getStyle(container, 'position');\n\n    this._initPanes();\n\n    if ( ! Browser.columnCount ) {\n      this.options.flow = 'scrolled-doc';\n    }\n  },\n\n  _initPanes: function () {\n    var self = this;\n\n    var panes = this._panes = {};\n\n    var l = 'cozy-';\n    var container = this._container;\n\n    var prefix = 'cozy-module-';\n\n    DomUtil.addClass(container, 'cozy-container');\n    panes['top'] = DomUtil.create('div', prefix + 'top', container);\n    panes['main'] = DomUtil.create('div', prefix + 'main', container);\n    panes['bottom'] = DomUtil.create('div', prefix + 'bottom', container);\n\n    panes['left'] = DomUtil.create('div', prefix + 'left', panes['main']);\n    panes['book-cover'] = DomUtil.create('div', prefix + 'book-cover', panes['main']);\n    panes['right'] = DomUtil.create('div', prefix + 'right', panes['main']);\n    panes['book'] = DomUtil.create('div', prefix + 'book', panes['book-cover']);\n    panes['loader'] = DomUtil.create('div', prefix + 'book-loading', panes['book']);\n    panes['epub'] = DomUtil.create('div', prefix + 'book-epub', panes['book']);\n    this._initBookLoader();\n  },\n\n  _checkIfLoaded: function () {\n    if (!this._loaded) {\n      throw new Error('Set map center and zoom first.');\n    }\n  },\n\n  // DOM event handling\n\n  // @section Interaction events\n  _initEvents: function (remove) {\n    this._targets = {};\n    this._targets[Util.stamp(this._container)] = this;\n\n    this.tracking = function(reader) {\n      var _action = [];\n      var _last_location_start;\n      var _reader = reader;\n      return {\n        action: function(v) {\n          if ( v ) {\n            _action = [v];\n            this.event(v);\n            // _reader.fire('trackAction', { action: v })\n          } else {\n            return _action.pop();\n          }\n        },\n\n        event: function(action, data) {\n          if ( data == null ) { data = {}; }\n          data.action = action;\n          _reader.fire(\"trackAction\", data);\n        },\n\n        pageview: function(location) {\n          if ( location.start != _last_location_start ) {\n            _last_location_start = location.start;\n            // console.log(\"AHOY RELOCATED\", location, location.start, location.href, location.location, this.action());\n            _reader.fire('trackPageview', { cfi: location.start, href: location.href, action: this.action()})\n            return true;\n          }\n          return false;\n        }\n      }\n    }(this);\n\n    var onOff = remove ? DomEvent.off : DomEvent.on;\n\n    // @event click: MouseEvent\n    // Fired when the user clicks (or taps) the map.\n    // @event dblclick: MouseEvent\n    // Fired when the user double-clicks (or double-taps) the map.\n    // @event mousedown: MouseEvent\n    // Fired when the user pushes the mouse button on the map.\n    // @event mouseup: MouseEvent\n    // Fired when the user releases the mouse button on the map.\n    // @event mouseover: MouseEvent\n    // Fired when the mouse enters the map.\n    // @event mouseout: MouseEvent\n    // Fired when the mouse leaves the map.\n    // @event mousemove: MouseEvent\n    // Fired while the mouse moves over the map.\n    // @event contextmenu: MouseEvent\n    // Fired when the user pushes the right mouse button on the map, prevents\n    // default browser context menu from showing if there are listeners on\n    // this event. Also fired on mobile when the user holds a single touch\n    // for a second (also called long press).\n    // @event keypress: KeyboardEvent\n    // Fired when the user presses a key from the keyboard while the map is focused.\n    // onOff(this._container, 'click dblclick mousedown mouseup ' +\n    //   'mouseover mouseout mousemove contextmenu keypress', this._handleDOMEvent, this);\n\n    // if (this.options.trackResize) {\n    //   var self = this;\n    //   var fn = debounce(function(){ self.invalidateSize({}); }, 150);\n    //   onOff(window, 'resize', fn, this);\n    // }\n\n    if (Browser.any3d && this.options.transform3DLimit) {\n      (remove ? this.off : this.on).call(this, 'moveend', this._onMoveEnd);\n    }\n\n    var self = this;\n    if (screenfull.enabled) {\n      screenfull.on('change', function() {\n        // setTimeout(function() {\n        //   self.invalidateSize({});\n        // }, 100);\n        console.log('AHOY: Am I fullscreen?', screenfull.isFullscreen ? 'YES' : 'NO');\n      });\n    }\n\n    self.on(\"updateLocation\", function(location) {\n      var location_href = location.start;\n\n      if ( self._ignoreHistory ) {\n        self._ignoreHistory = false;\n        return;\n      }\n\n      if ( self.tracking.pageview(location) ) {\n        var tmp_href = window.location.href.split(\"#\");\n        tmp_href[1] = location.start.substr(8, location.start.length - 8 - 1);\n        history.pushState({ cfi: location.start }, '', tmp_href.join('#'));\n\n        if ( location.percentage ) {\n          var p = Math.ceil(location.percentage * 100);\n          document.title = `${self._original_document_title} - ${p}%`;\n        }        \n      }\n    })\n\n    window.addEventListener('popstate', function(event) {\n      if ( event.isTrusted && event.state !== null ) {\n        self._ignoreHistory = true;\n        self.gotoPage(event.state.cfi);\n      }\n    })\n\n    document.addEventListener('keydown', function(event) {\n      var keyName = event.key;\n      var target = event.target;\n\n      // check if the activeElement is \".special-panel\"\n      var check = document.activeElement;\n      while ( check.localName != 'body' ) {\n        if ( check.classList.contains('special-panel') ) {\n          return;\n        }\n        check = check.parentElement;\n      }\n\n      var IGNORE_TARGETS = [ 'input', 'target' ];\n      if ( IGNORE_TARGETS.indexOf(target.localName) >= 0 ) {\n        return;\n      }\n\n      self.fire('keyDown', { keyName: keyName, shiftKey: event.shiftKey });\n    });\n\n    self.on('keyDown', function(data) {\n      switch(data.keyName) {\n        case 'ArrowRight':\n        case 'PageDown':\n          self.next();\n          break;\n        case 'ArrowLeft':\n        case 'PageUp':\n          self.prev();\n          break;\n        case 'Home':\n          self._scroll('HOME');\n          break;\n        case 'End':\n          self._scroll('END')\n          break;\n      }\n    });\n  },\n\n  // _onResize: function() {\n  //   if ( ! this._resizeRequest ) {\n  //     this._resizeRequest = Util.requestAnimFrame(function() {\n  //       this.invalidateSize({})\n  //     }, this);\n  //   }\n  // },\n\n  _onScroll: function () {\n    this._container.scrollTop  = 0;\n    this._container.scrollLeft = 0;\n  },\n\n  _handleDOMEvent: function (e) {\n    if (!this._loaded || DomEvent.skipped(e)) { return; }\n\n    var type = e.type === 'keypress' && e.keyCode === 13 ? 'click' : e.type;\n\n    if (type === 'mousedown') {\n      // prevents outline when clicking on keyboard-focusable element\n      DomUtil.preventOutline(e.target || e.srcElement);\n    }\n\n    this._fireDOMEvent(e, type);\n  },\n\n  _fireDOMEvent: function (e, type, targets) {\n\n    if (e.type === 'click') {\n      // Fire a synthetic 'preclick' event which propagates up (mainly for closing popups).\n      // @event preclick: MouseEvent\n      // Fired before mouse click on the map (sometimes useful when you\n      // want something to happen on click before any existing click\n      // handlers start running).\n      var synth = Util.extend({}, e);\n      synth.type = 'preclick';\n      this._fireDOMEvent(synth, synth.type, targets);\n    }\n\n    if (e._stopped) { return; }\n\n    // Find the layer the event is propagating from and its parents.\n    targets = (targets || []).concat(this._findEventTargets(e, type));\n\n    if (!targets.length) { return; }\n\n    var target = targets[0];\n    if (type === 'contextmenu' && target.listens(type, true)) {\n      DomEvent.preventDefault(e);\n    }\n\n    var data = {\n      originalEvent: e\n    };\n\n    if (e.type !== 'keypress') {\n      var isMarker = (target.options && 'icon' in target.options);\n      data.containerPoint = isMarker ?\n          this.latLngToContainerPoint(target.getLatLng()) : this.mouseEventToContainerPoint(e);\n      data.layerPoint = this.containerPointToLayerPoint(data.containerPoint);\n      data.latlng = isMarker ? target.getLatLng() : this.layerPointToLatLng(data.layerPoint);\n    }\n\n    for (var i = 0; i < targets.length; i++) {\n      targets[i].fire(type, data, true);\n      if (data.originalEvent._stopped ||\n        (targets[i].options.nonBubblingEvents && Util.indexOf(targets[i].options.nonBubblingEvents, type) !== -1)) { return; }\n    }\n  },\n\n  getFixedBookPanelSize: function() {\n    // have to make the book\n    var style = window.getComputedStyle(this._panes['book']);\n    var h = this._panes['book'].clientHeight - parseFloat(style.paddingTop) - parseFloat(style.paddingBottom);\n    var w = this._panes['book'].clientWidth - parseFloat(style.paddingRight) - parseFloat(style.paddingLeft);\n    return { height: Math.floor(h * 1.00), width: Math.floor(w * 1.00) };\n  },\n\n  invalidateSize: function(options) {\n    // TODO: IS THIS EVER USED?\n    var self = this;\n\n    if ( ! self._drawn ) { return; }\n\n    Util.cancelAnimFrame(this._resizeRequest);\n\n    if (! this._loaded) { return this; }\n\n    this.fire('resized');\n  },\n\n  _resizeBookPane: function() {\n\n  },\n\n  _setupHooks: function() {\n\n  },\n\n  _checkFeatureCompatibility: function() {\n    if ( ! DomUtil.isPropertySupported('columnCount') || this._checkMobileDevice() ) {\n      // force\n      this.options.flow = 'scrolled-doc';\n    }\n    if ( this._checkMobileDevice() ) {\n      // this.options.fontSizeLarge = '160%';\n      // this.options.fontSizeSmall ='100%';\n      // this.options.fontSizeDefault = '120%';\n      this.options.text_size = 120;\n    }\n  },\n\n  _checkMobileDevice: function() {\n    if ( this._isMobile === undefined ) {\n      this._isMobile = false;\n      if ( this.options.mobileMediaQuery ) {\n        this._isMobile = window.matchMedia(this.options.mobileMediaQuery).matches;\n      }\n    }\n    return this._isMobile;\n  },\n\n  _enableBookLoader: function(delay=0) {\n    var self = this;\n    self._clearBookLoaderTimeout();\n    if ( delay < 0 ) {\n      delay = 0;\n      self._force_progress = true;\n    }\n    self._loader_timeout = setTimeout(function() {\n      self._panes['loader'].style.display = 'block';\n    }, delay);\n  },\n\n  _disableBookLoader: function(force=false) {\n    var self = this;\n    self._clearBookLoaderTimeout();\n    if ( ! self._force_progress || force ) {\n      self._panes['loader'].style.display = 'none';\n      self._force_progress = false;\n      self._panes['loader-status'].innerHTML = '';\n    }\n  },\n\n  _clearBookLoaderTimeout: function() {\n    var self = this;\n    if ( self._loader_timeout ) {\n      clearTimeout(self._loader_timeout);\n      self._loader_timeout = null;\n    }\n  },\n\n  _initBookLoader: function() {\n    // is this not awesome?\n    var template = this.options.loader_template || this.loaderTemplate();\n\n    var body = new DOMParser().parseFromString(template, \"text/html\").body;\n    while ( body.children.length ) {\n      this._panes['loader'].appendChild(body.children[0]);\n    }\n    this._panes['loader-status'] = DomUtil.create('div', 'cozy-module-book-loading-status', this._panes['loader']);\n  },\n\n  loaderTemplate: function() {\n    return `<div class=\"cozy-loader-spinner\">\n    <div class=\"spinner-backdrop spinner-backdrop--1\"></div>\n    <div class=\"spinner-backdrop spinner-backdrop--2\"></div>\n    <div class=\"spinner-backdrop spinner-backdrop--3\"></div>\n    <div class=\"spinner-backdrop spinner-backdrop--4\"></div>\n    <div class=\"spinner-quarter spinner-quarter--1\"></div>\n    <div class=\"spinner-quarter spinner-quarter--2\"></div>\n    <div class=\"spinner-quarter spinner-quarter--3\"></div>\n    <div class=\"spinner-quarter spinner-quarter--4\"></div>\n  </div>`;\n  },\n\n  EOT: true\n});\n\nexport function createReader(id, options) {\n  return new Reader(id, options);\n}\n","import {Class} from '../core/Class';\nimport {Reader} from '../reader/Reader';\nimport * as Util from '../core/Util';\nimport * as DomUtil from '../dom/DomUtil';\n\n/*\n * @class Control\n * @aka L.Control\n * @inherits Class\n *\n * L.Control is a base class for implementing reader controls. Handles regioning.\n * All other controls extend from this class.\n */\n\nexport var Control = Class.extend({\n    // @section\n    // @aka Control options\n    options: {\n        // @option region: String = 'topright'\n        // The region of the control (one of the reader corners). Possible values are `'topleft'`,\n        // `'topright'`, `'bottomleft'` or `'bottomright'`\n    },\n\n    initialize: function (options) {\n        Util.setOptions(this, options);\n        if ( options.container ) {\n            this._container = options.container;\n            this._locked = true;\n        }\n        this._id = (new Date()).getTime() + '-' + parseInt(Math.random((new Date()).getTime()) * 1000, 10);\n    },\n\n    /* @section\n     * Classes extending L.Control will inherit the following methods:\n     *\n     * @method getRegion: string\n     * Returns the region of the control.\n     */\n    getRegion: function () {\n        return this.options.region;\n    },\n\n    // @method setRegion(region: string): this\n    // Sets the region of the control.\n    setRegion: function (region) {\n        var reader = this._reader;\n\n        if (reader) {\n            reader.removeControl(this);\n        }\n\n        this.options.region = region;\n\n        if (reader) {\n            reader.addControl(this);\n        }\n\n        return this;\n    },\n\n    // @method getContainer: HTMLElement\n    // Returns the HTMLElement that contains the control.\n    getContainer: function () {\n        return this._container;\n    },\n\n    // @method addTo(reader: Map): this\n    // Adds the control to the given reader.\n    addTo: function (reader) {\n        this.remove();\n        this._reader = reader;\n\n        var container = this._container = this.onAdd(reader);\n\n        DomUtil.addClass(container, 'cozy-control');\n\n        if ( ! this._locked ) {\n            var region = this.getRegion();\n            var area = reader.getControlRegion(region);\n            area.appendChild(container);\n        }\n\n        return this;\n    },\n\n    // @method remove: this\n    // Removes the control from the reader it is currently active on.\n    remove: function () {\n        if (!this._reader) {\n            return this;\n        }\n\n        if (! this._container) {\n            return this;\n        }\n\n        if ( ! this._locked ) {\n            DomUtil.remove(this._container);\n        }\n\n        if (this.onRemove) {\n            this.onRemove(this._reader);\n        }\n\n        this._reader = null;\n\n        return this;\n    },\n\n    _refocusOnMap: function (e) {\n        // if reader exists and event is not a keyboard event\n        if (this._reader && e && e.screenX > 0 && e.screenY > 0) {\n            this._reader.getContainer().focus();\n        }\n    },\n\n    _className: function(widget) {\n        var className = [ 'cozy-control' ];\n        if ( this.options.direction ) {\n            className.push('cozy-control-' + this.options.direction);\n        }\n        if ( widget ) {\n            className.push('cozy-control-' + widget);\n        }\n        return className.join(' ');\n    }\n});\n\nexport var control = function (options) {\n    return new Control(options);\n};\n\n/* @section Extension methods\n * @uninheritable\n *\n * Every control should extend from `L.Control` and (re-)implement the following methods.\n *\n * @method onAdd(reader: Map): HTMLElement\n * Should return the container DOM element for the control and add listeners on relevant reader events. Called on [`control.addTo(reader)`](#control-addTo).\n *\n * @method onRemove(reader: Map)\n * Optional method. Should contain all clean up code that removes the listeners previously added in [`onAdd`](#control-onadd). Called on [`control.remove()`](#control-remove).\n */\n\n/* @namespace Map\n * @section Methods for Layers and Controls\n */\nReader.include({\n    // @method addControl(control: Control): this\n    // Adds the given control to the reader\n    addControl: function (control) {\n        control.addTo(this);\n        return this;\n    },\n\n    // @method removeControl(control: Control): this\n    // Removes the given control from the reader\n    removeControl: function (control) {\n        control.remove();\n        return this;\n    },\n\n    getControlContainer: function() {\n        var l = 'cozy-';\n        if ( ! this._controlContainer ) {\n            this._controlContainer =\n                DomUtil.create('div', l + 'control-container', this._container);\n        }\n        return this._controlContainer;\n    },\n\n    getControlRegion: function (target) {\n\n        if ( ! this._panes[target] ) {\n            // target is dot-delimited string\n            // first dot is the panel\n            var parts = target.split('.');\n            var tmp = [];\n            var parent = this._container;\n            var x = 0;\n            while ( parts.length ) {\n                var slug = parts.shift();\n                tmp.push(slug);\n                var panel = tmp.join(\".\");\n                var className = 'cozy-panel-' + slug;\n                if ( ! this._panes[panel] ) {\n                    this._panes[panel] = DomUtil.create('div', className, parent);\n                }\n                parent = this._panes[panel];\n                x += 1;\n                if ( x > 100 ) { break; }\n            }\n        }\n        return this._panes[target];\n    },\n\n    getControlRegion_1: function (target) {\n\n        var tmp = target.split('.');\n        var region = tmp.shift();\n        var slot = tmp.pop() || '-slot';\n\n        var container = this._panes[region];\n        if ( ! this._panes[target] ) {\n            var className = 'cozy-' + region + '--item cozy-slot-' + slot\n            if ( ! this._panes[region + '.' + slot] ) {\n                var div = DomUtil.create('div', className);\n                if ( slot == 'left' || slot == 'bottom' ) {\n                    var childElement = this._panes[region].firstChild;\n                    this._panes[region].insertBefore(div, childElement);\n                } else {\n                    this._panes[region].appendChild(div);\n                }\n                this._panes[region + '.' + slot] = div;\n            }\n            className = this._classify(tmp);\n            this._panes[target] = DomUtil.create('div', className, this._panes[region + '.' + slot]);\n        }\n\n        return this._panes[target];\n    },\n\n    _classify: function(tmp) {\n        var l = 'cozy-';\n        var className = [];\n        for(var i in tmp) {\n            className.push(l + tmp[i]);\n        }\n        className = className.join(' ');\n        return className;\n    },\n\n    _clearControlRegion: function () {\n        for (var i in this._controlRegions) {\n            DomUtil.remove(this._controlRegions[i]);\n        }\n        DomUtil.remove(this._controlContainer);\n        delete this._controlRegions;\n        delete this._controlContainer;\n    }\n});\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nvar PageControl = Control.extend({\n  onAdd: function(reader) {\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n      container = DomUtil.create('div', className),\n\n      this._control  = this._createButton(this._fill(options.html || options.label), this._fill(options.label),\n              className, container);\n    }\n    this._bindEvents();\n\n    return container;\n  },\n\n  _createButton: function (html, title, className, container) {\n    var link = DomUtil.create('a', className, container);\n    link.innerHTML = html;\n    link.href = '#';\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    return link;\n  },\n\n  _bindEvents: function() {\n    var self = this;\n    DomEvent.disableClickPropagation(this._control);\n    DomEvent.on(this._control, 'click', DomEvent.stop);\n    DomEvent.on(this._control, 'click', this._action, this);\n\n    this._reader.on('reopen', function(data) {\n      // update the button text / titles\n      var html = self.options.html || self.options.label;\n      self._control.innerHTML = self._fill(html);\n      self._control.setAttribute('title', self._fill(self.options.label));\n      self._control.setAttribute('aria-label', self._fill(self.options.label));\n    });\n\n  },\n\n  _unit: function() {\n    return ( this._reader.options.flow == 'scrolled-doc' ) ? 'Section' : 'Page';\n  },\n\n  _fill: function(s) {\n    var unit = this._unit();\n    return s.replace(/\\$\\{unit\\}/g, unit);\n  },\n\n  _label: function() {\n    return this.options.label + \" \" + ( this._reader.options.flow == 'scrolled-doc' ) ? 'Section' : 'Page';\n  },\n\n  EOT: true\n});\n\nexport var PagePrevious = PageControl.extend({\n  options: {\n    region: 'edge.left',\n    direction: 'previous',\n    label: 'Previous ${unit}',\n    html: '<i class=\"icon-chevron-left oi\" data-glyph=\"chevron-left\" title=\"Previous ${unit}\" aria-hidden=\"true\"></i>'\n  },\n\n  _action: function(e) {\n    this._reader.prev();\n  }\n});\n\nexport var PageNext = PageControl.extend({\n  options: {\n    region: 'edge.right',\n    direction: 'next',\n    label: 'Next ${unit}',\n    html: '<i class=\"icon-chevron-right oi\" data-glyph=\"chevron-right\" title=\"Next ${unit}\" aria-hidden=\"true\"></i>'\n  },\n\n  _action: function(e) {\n    this._reader.next();\n  }\n});\n\nexport var PageFirst = PageControl.extend({\n  options: {\n    direction: 'first',\n    label: 'First ${unit}'\n  },\n  _action: function(e) {\n      this._reader.first();\n  }\n});\n\nexport var PageLast = PageControl.extend({\n  options: {\n    direction: 'last',\n    label: 'Last ${unit}'\n  },\n  _action: function(e) {\n      this._reader.last();\n  }\n});\n\nexport var pageNext = function(options) {\n  return new PageNext(options);\n}\n\nexport var pagePrevious = function(options) {\n  return new PagePrevious(options);\n}\n\nexport var pageFirst = function(options) {\n  return new PageFirst(options);\n}\n\nexport var pageLast = function(options) {\n  return new PageLast(options);\n}\n","import {Class} from '../core/Class';\nimport {Reader} from '../reader/Reader';\nimport * as Util from '../core/Util';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nimport assign from 'lodash/assign';\n\nvar activeModal;\nvar dismissModalListener = false;\n\n// from https://github.com/ghosh/micromodal/blob/master/src/index.js\nconst FOCUSABLE_ELEMENTS = [\n    'a[href]',\n    'area[href]',\n    'input:not([disabled]):not([type=\"hidden\"])',\n    'select:not([disabled])',\n    'textarea:not([disabled])',\n    'button:not([disabled])',\n    'iframe',\n    'object',\n    'embed',\n    '[contenteditable]',\n    '[tabindex]:not([tabindex^=\"-\"])'\n  ];\n\nconst ACTIONABLE_ELEMENTS = [\n    'a[href]',\n    'area[href]',\n    'input[type=\"submit\"]:not([disabled])',\n    'button:not([disabled])'\n  ];\n\nexport var Modal = Class.extend({\n  options: {\n    // @option region: String = 'topright'\n    // The region of the control (one of the reader edges). Possible values are `'left' ad 'right'`\n    region: 'left',\n    fraction: 0,\n    width: null,\n    className: {},\n    actions: null,\n    callbacks: { onShow: function() {}, onClose: function() {} },\n    handlers: {}\n  },\n\n  initialize: function (options) {\n    options = Util.setOptions(this, options);\n    this._id = (new Date()).getTime() + '-' + parseInt(Math.random((new Date()).getTime()) * 1000, 10);\n    this._initializedEvents = false;\n    this.callbacks = assign({}, this.options.callbacks);\n    this.actions = this.options.actions ? assign({}, this.options.actions) : null;\n    this.handlers = assign({}, this.options.handlers);\n    if ( typeof(this.options.className) == 'string' ) {\n      this.options.className = { container: this.options.className };\n    }\n  },\n\n  addTo: function(reader) {\n    var self = this;\n    this._reader = reader;\n    var template = this.options.template;\n\n    var panelHTML = `<div class=\"cozy-modal modal-slide ${this.options.region || 'left'}\" id=\"modal-${this._id}\" aria-labelledby=\"modal-${this._id}-title\" role=\"dialog\" aria-describedby=\"modal-${this._id}-content\" aria-hidden=\"true\">\n      <div class=\"modal__overlay\" tabindex=\"-1\" data-modal-close>\n        <div class=\"modal__container ${this.options.className.container ? this.options.className.container : ''}\" role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"modal-${this._id}-title\" aria-describedby=\"modal-${this._id}-content\" id=\"modal-${this._id}-container\">\n          <div role=\"document\">\n            <header class=\"modal__header\">\n              <h3 class=\"modal__title\" id=\"modal-${this._id}-title\">${this.options.title}</h3>\n              <button class=\"modal__close\" aria-label=\"Close modal\" aria-controls=\"modal-${this._id}-container\" data-modal-close></button>\n            </header>\n            <main class=\"modal__content ${this.options.className.main ? this.options.className.main : ''}\" id=\"modal-${this._id}-content\">\n              ${template}\n            </main>`;\n\n    if ( this.options.actions ) {\n      panelHTML += '<footer class=\"modal__footer\">'\n      for(var i in this.options.actions) {\n        var action = this.options.actions[i];\n        var button_cls = action.className || 'button--default';\n        panelHTML += `<button id=\"action-${this._id}-${i}\" class=\"button button--lg ${button_cls}\">${action.label}</button>`;\n      }\n      panelHTML += '</footer>';\n    }\n\n    panelHTML += '</div></div></div></div>';\n\n    var body = new DOMParser().parseFromString(panelHTML, \"text/html\").body;\n\n    this.modal = reader._container.appendChild(body.children[0]);\n    this._container = this.modal; // compatibility\n\n    this.container = this.modal.querySelector('.modal__container');\n    this._bindEvents();\n    return this;\n  },\n\n  _bindEvents: function() {\n    var self = this;\n    this.onClick = this.onClick.bind(this);\n    this.onKeydown = this.onKeydown.bind(this);\n    this.onModalTransition = this.onModalTransition.bind(this);\n\n    this.modal.addEventListener('transitionend', function() {\n    }.bind(this));\n\n    // bind any actions\n    if ( this.actions ) {\n      for(var i in this.actions) {\n        let action = this.actions[i];\n        let button_id = '#action-' + this._id + '-' + i;\n        let button = this.modal.querySelector(button_id);\n        if ( button ) {\n          DomEvent.on(button, 'click', function(event) {\n            event.preventDefault();\n            action.callback(event);\n            if ( action.close ) {\n              self.closeModal();\n            }\n          })\n        }\n      }\n    }\n  },\n\n  deactivate: function() {\n    this.closeModal();\n  },\n\n  closeModal: function() {\n    var self = this;\n    this.modal.setAttribute('aria-hidden', 'true');\n    this.removeEventListeners();\n    if ( this.activeElement ) {\n      this.activeElement.focus();\n    }\n    this.callbacks.onClose(this.modal);\n  },\n\n  showModal: function() {\n    this.activeElement = document.activeElement\n    this._resize();\n    this.modal.setAttribute('aria-hidden', 'false')\n    this.setFocusToFirstNode()\n    this.addEventListeners()\n    this.callbacks.onShow(this.modal)\n  },\n\n  activate: function() {\n    return this.showModal();\n    var self = this;\n    activeModal = this;\n    DomUtil.addClass(self._reader._container, 'st-modal-activating');\n    this._resize();\n    DomUtil.addClass(this._reader._container, 'st-modal-open');\n    setTimeout(function() {\n      DomUtil.addClass(self._container, 'active');\n      DomUtil.removeClass(self._reader._container, 'st-modal-activating');\n      self._container.setAttribute('aria-hidden', 'false');\n      self.setFocusToFirstNode();\n    }, 25);\n  },\n\n  addEventListeners: function () {\n    // --- do we need touch listeners?\n    // this.modal.addEventListener('touchstart', this.onClick)\n    // this.modal.addEventListener('touchend', this.onClick)\n    this.modal.addEventListener('click', this.onClick)\n    document.addEventListener('keydown', this.onKeydown)\n    'webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend'.split(' ').forEach(function(event) {\n      this.modal.addEventListener(event, this.onModalTransition);\n    }.bind(this))\n  },\n\n  removeEventListeners: function () {\n    this.modal.removeEventListener('touchstart', this.onClick)\n    this.modal.removeEventListener('click', this.onClick)\n    'webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend'.split(' ').forEach(function(event) {\n      this.modal.removeEventListener(event, this.onModalTransition);\n    }.bind(this))\n    document.removeEventListener('keydown', this.onKeydown)\n  },\n\n  _resize: function() {\n    var container = this._reader._container;\n    this.container.style.height = container.offsetHeight + 'px';\n    console.log(\"AHOY MODAL\", this.container.style.height);\n    if ( ! this.options.className.container  ) {\n      this.container.style.width = this.options.width || parseInt(container.offsetWidth * this.options.fraction) + 'px';\n    }\n\n    var header = this.container.querySelector('header');\n    var footer = this.container.querySelector('footer');\n    var main = this.container.querySelector('main');\n    var height = this.container.clientHeight - header.clientHeight;\n    if ( footer ) {\n      height -= footer.clientHeight;\n    }\n    main.style.height = height + 'px';\n  },\n\n  getFocusableNodes: function() {\n    const nodes = this.modal.querySelectorAll(FOCUSABLE_ELEMENTS);\n    return Object.keys(nodes).map((key) => nodes[key]);\n  },\n\n  setFocusToFirstNode: function() {\n    var focusableNodes = this.getFocusableNodes();\n    if ( focusableNodes.length ) {\n      focusableNodes[0].focus();\n    } else {\n      activeModal._container.focus();\n    }\n  },\n\n  getActionableNodes: function() {\n    const nodes = this.modal.querySelectorAll(ACTIONABLE_ELEMENTS);\n    return Object.keys(nodes).map((key) => nodes[key]);\n  },\n\n  onKeydown: function(event) {\n    if ( event.keyCode == 27 ) { this.closeModal(); }\n    if ( event.keyCode == 9 ) {\n      this.maintainFocus(event);\n    }\n  },\n\n  onClick: function(event) {\n\n    var closeAfterAction = false;\n    var target = event.target;\n\n    // As far as I can tell, the code below isn't catching direct clicks on\n    // items with class='data-modal-close' as they're not ACTIONABLE_ELEMENTS.\n    // Adding them to ACTIONABLE_ELEMENTS causes undesirable behavior where\n    // their child items also close the modal thanks to the loop below.\n    // Children of .modal__overlay include the modal header, border area and\n    // padding. We don't want clicks on these closing the modal.\n    // Just close the modal now for direct clicks on a '.data-modal-close'.\n    if (target.hasAttribute('data-modal-close')) {\n      this.fire('closed');\n      this.closeModal();\n      return;\n    }\n\n    // if the target isn't an actionable type, walk the DOM until\n    // one is found\n    var actionableNodes = this.getActionableNodes();\n    while ( actionableNodes.indexOf(target) < 0 && target != this.modal ) {\n      target = target.parentElement;\n    }\n\n    // no target found, punt\n    if ( actionableNodes.indexOf(target) < 0 ) {\n      return;\n    }\n\n    if (this.handlers.click) {\n      var did_match = false;\n      for(var selector in this.handlers.click) {\n        if ( target.matches(selector) ) {\n          closeAfterAction = this.handlers.click[selector](this, target);\n          break;\n        }\n      }\n    }\n\n    if (closeAfterAction || target.hasAttribute('data-modal-close')) this.closeModal();\n\n    event.preventDefault();\n  },\n\n  onModalTransition: function(event) {\n    if ( this.modal.getAttribute('aria-hidden') == 'true' ) {\n      this._reader.fire('modal-closed');\n    } else {\n      this._reader.fire('modal-opened');\n    }\n  },\n\n  on: function(event, selector, handler) {\n    if (! this.handlers[event] ) {\n      this.handlers[event] = {};\n    }\n    if (typeof(selector) == 'function') {\n      handler = selector;\n      selector = '*';\n    }\n    this.handlers[event][selector] = handler;\n  },\n\n  fire: function(event) {\n    if ( this.handlers[event] && this.handlers[event]['*'] ) {\n      this.handlers[event]['*'](this);\n    }\n  },\n\n  maintainFocus: function(event) {\n    var focusableNodes = this.getFocusableNodes();\n    var focusedItemIndex = focusableNodes.indexOf(document.activeElement);\n    if (event.shiftKey && focusedItemIndex === 0) {\n      focusableNodes[focusableNodes.length - 1].focus()\n      event.preventDefault()\n    }\n\n    if (!event.shiftKey && focusedItemIndex === focusableNodes.length - 1) {\n      focusableNodes[0].focus()\n      event.preventDefault()\n    }\n  },\n\n  EOT: true\n});\n\nReader.include({\n  modal: function (options) {\n    var modal = new Modal(options);\n    return modal.addTo(this);\n    // return this;\n  },\n\n  EOT: true\n});\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport {Modal} from './Modal';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Contents = Control.extend({\n\n  defaultTemplate: `<button class=\"button--sm\" data-toggle=\"open\" aria-label=\"Table of Contents\"><i class=\"icon-menu oi\" data-glyph=\"menu\" title=\"Table of Contents\" aria-hidden=\"true\"></i></button>`,\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    this._control.setAttribute('id', 'action-' + this._id);\n    container.style.position = 'relative';\n\n    this._reader.on('updateContents', function(data) {\n\n      DomEvent.on(this._control, 'click', function(event) {\n        event.preventDefault();\n        self._reader.tracking.action('contents/open');\n        self._modal.activate();\n      }, this)\n\n      this._modal = this._reader.modal({\n        template: '<ul></ul>',\n        title: 'Contents',\n        region: 'left',\n        className: 'cozy-modal-contents'\n      });\n\n      this._modal.on('click', 'a[href]', function(modal, target) {\n        target = target.getAttribute('data-href');\n        this._reader.tracking.action('contents/go');\n        this._reader.gotoPage(target);\n        return true;\n      }.bind(this))\n\n      this._modal.on('closed', function() {\n        self._reader.tracking.action('contents/close');\n      })\n\n      this._setupSkipLink();\n\n      var parent = self._modal._container.querySelector('ul');\n      // var s = data.toc.filter(function(value) { return value.parent == null }).map(function(value) { return [ value, 0, parent ] });\n      // while ( s.length ) {\n      //   var tuple = s.shift();\n      //   var chapter = tuple[0];\n      //   var tabindex = tuple[1];\n      //   var parent = tuple[2];\n\n      //   var option = self._createOption(chapter, tabindex, parent);\n      //   data.toc.filter(function(value) { return value.parent == chapter.id }).reverse().forEach(function(chapter_) {\n      //     s.unshift([chapter_, tabindex + 1, option]);\n      //   });\n      // }\n      var _process = function(items, tabindex, parent) {\n        items.forEach(function(item) {\n          var option = self._createOption(item, tabindex, parent);\n          if ( item.subitems.length ) {\n            _process(item.subitems, tabindex + 1, option);\n          }\n        })\n      }\n      _process(data.toc, 0, parent);\n    }.bind(this))\n\n    return container;\n  },\n\n  _createOption(chapter, tabindex, parent) {\n\n    function pad(value, length) {\n        return (value.toString().length < length) ? pad(\"-\"+value, length):value;\n    }\n    var option = DomUtil.create('li');\n    if ( chapter.href ) {\n      var anchor = DomUtil.create('a', null, option);\n      anchor.textContent = chapter.label;\n      // var tab = pad('', tabindex); tab = tab.length ? tab + ' ' : '';\n      // option.textContent = tab + chapter.label;\n      anchor.setAttribute('href', chapter.href);\n      anchor.setAttribute('data-href', chapter.href);\n    } else {\n      var span = DomUtil.create('span', null, option);\n      span.textContent = chapter.label;\n    }\n\n    if ( parent.tagName == 'LI' ) {\n      // need to nest\n      var tmp = parent.querySelector('ul');\n      if ( ! tmp ) {\n        tmp = DomUtil.create('ul', null, parent);\n      }\n      parent = tmp;\n    }\n\n    parent.appendChild(option);\n    return option;\n  },\n\n  _setupSkipLink: function() {\n    if ( ! this.options.skipLink ) { return; }\n      \n    var target = document.querySelector(this.options.skipLink);\n    if ( ! target ) { return; }\n\n    var link = document.createElement('a');\n    link.textContent = 'Skip to contents';\n    link.setAttribute('href', '#action-' + this._id);\n\n    var ul = target.querySelector('ul');\n    if ( ul ) {\n      // add to list\n      target = document.createElement('li');\n      ul.appendChild(target);\n    }\n    target.appendChild(link);\n    link.addEventListener('click', function(event) {\n      event.preventDefault();\n      event.stopPropagation();\n      this._control.click();\n    }.bind(this))\n\n  },\n\n  EOT: true\n});\n\nexport var contents = function(options) {\n  return new Contents(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\n// Title + Chapter\n\nexport var Title = Control.extend({\n  onAdd: function(reader) {\n    var self = this;\n    var className = this._className(),\n        container = DomUtil.create('div', className),\n        options = this.options;\n\n    // var template = '<h1><span class=\"cozy-title\">Contents: </span><select size=\"1\" name=\"contents\"></select></label>';\n    // var control = new DOMParser().parseFromString(template, \"text/html\").body.firstChild;\n\n    var h1 = DomUtil.create('h1', 'cozy-h1', container);\n    DomUtil.setOpacity(h1, 0);\n    this._title = DomUtil.create('span', 'cozy-title', h1);\n    this._divider = DomUtil.create('span', 'cozy-divider', h1);\n    this._divider.textContent = \" · \";\n    this._section = DomUtil.create('span', 'cozy-section', h1);\n\n    // --- TODO: disable until we can work out how to \n    // --- more reliably match the current section to the contents\n    // this._reader.on('updateSection', function(data) {\n    //   if ( data && data.label ) {\n    //     self._section.textContent = data.label;\n    //     DomUtil.setOpacity(self._section, 1.0);\n    //     DomUtil.setOpacity(self._divider, 1.0);\n    //   } else {\n    //     DomUtil.setOpacity(self._section, 0);\n    //     DomUtil.setOpacity(self._divider, 0);\n    //   }\n    // })\n\n    this._reader.on('updateTitle', function(data) {\n      if ( data ) {\n        self._title.textContent = data.title || data.bookTitle;\n        DomUtil.setOpacity(self._section, 0);\n        DomUtil.setOpacity(self._divider, 0);\n        DomUtil.setOpacity(h1, 1);\n      }\n    })\n\n    return container;\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('a', className, container);\n    link.innerHTML = html;\n    link.href = '#';\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n    // DomEvent.on(link, 'click', this._refocusOnMap, this);\n\n    return link;\n  },\n\n  EOT: true\n});\n\nexport var title = function(options) {\n  return new Title(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\n// Title + Chapter\n\nexport var PublicationMetadata = Control.extend({\n  onAdd: function(reader) {\n    var self = this;\n    var className = this._className(),\n        container = DomUtil.create('div', className),\n        options = this.options;\n\n    // var template = '<h1><span class=\"cozy-title\">Contents: </span><select size=\"1\" name=\"contents\"></select></label>';\n    // var control = new DOMParser().parseFromString(template, \"text/html\").body.firstChild;\n\n    this._publisher = DomUtil.create('div', 'cozy-publisher', container);\n    this._rights = DomUtil.create('div', 'cozy-rights', container);\n\n    this._reader.on('updateTitle', function(data) {\n      if ( data ) {\n        self._publisher.textContent = data.publisher;\n        self._rights.textContent = data.rights;\n      }\n    })\n\n    return container;\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('a', className, container);\n    link.innerHTML = html;\n    link.href = '#';\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n    // DomEvent.on(link, 'click', this._refocusOnMap, this);\n\n    return link;\n  },\n\n  EOT: true\n});\n\nexport var publicationMetadata = function(options) {\n  return new PublicationMetadata(options);\n}\n","import {Class} from '../core/Class';\nimport {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\nimport * as Util from '../core/Util';\n\nimport assign from 'lodash/assign';\nimport keys from 'lodash/keys';\n\nexport var Preferences = Control.extend({\n  options: {\n    label: 'Preferences',\n    hasThemes: false,\n    html: '<i class=\"icon-cog oi\" data-glyph=\"cog\" title=\"Preferences and Settings\" aria-hidden=\"true\"></i>'\n  },\n\n  onAdd: function(reader) {\n    var self = this;\n    var className = this._className('preferences'),\n        container = DomUtil.create('div', className),\n        options = this.options;\n\n    this._activated = false;\n    this._control = this._createButton(options.html || options.label, options.label,\n            className, container, this._action)\n\n    // self.initializeForm();\n    this._modal = this._reader.modal({\n      // template: '<form></form>',\n      title: 'Preferences',\n      className: 'cozy-modal-preferences',\n      actions: [\n        {\n          label: 'Save Changes',\n          callback: function(event) {\n            self.updatePreferences(event);\n          }\n        }\n      ],\n      region: 'right'\n    });\n\n\n    return container;\n  },\n\n  _action: function() {\n    var self = this;\n    self.initializeForm();\n    self._modal.activate();\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('button', className, container);\n    link.innerHTML = html;\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n\n    return link;\n  },\n\n  _createPanel: function() {\n    var self = this;\n    if ( this._modal._container.querySelector('form') ) { return; }\n\n    var template = '';\n\n    var possible_fieldsets = [];\n    if ( this._reader.metadata.layout == 'pre-paginated' ) {\n      // different panel\n      possible_fieldsets.push('Scale');\n    } else {\n      possible_fieldsets.push('TextSize');\n    }\n    possible_fieldsets.push('Display');\n\n    if ( this._reader.rootfiles && this._reader.rootfiles.length > 1 ) {\n      // this.options.hasPackagePaths = true;\n      possible_fieldsets.push('Rendition');\n    }\n\n    if ( this._reader.options.themes && this._reader.options.themes.length > 0 ) {\n      this.options.hasThemes = true;\n      possible_fieldsets.push('Theme');\n    }\n\n    this._fieldsets = [];\n    possible_fieldsets.forEach(function(cls) {\n      var fieldset = new Preferences.fieldset[cls](this);\n      template += fieldset.template();\n      this._fieldsets.push(fieldset);\n    }.bind(this))\n\n    if ( this.options.fields ) {\n      this.options.hasFields = true;\n      for(var i in this.options.fields) {\n        var field = this.options.fields[i];\n        var id = \"preferences-custom-\" + i;\n        template += `<fieldset class=\"custom-field\">\n          <legend>${field.label}</legend>\n        `;\n        for(var j in field.inputs) {\n          var input = field.inputs[j];\n          var checked = input.value == field.value ? ' checked=\"checked\"' : '';\n          template += `<label><input id=\"preferences-custom-${i}-${j}\" type=\"radio\" name=\"x${field.name}\" value=\"${input.value}\" ${checked}/>${input.label}</label>`;\n        }\n        if ( field.hint ) {\n          template += `<p class=\"hint\" style=\"font-size: 90%\">${field.hint}</p>`;\n        }\n      }\n    }\n\n    template = '<form>' + template + '</form>';\n\n    // this._modal = this._reader.modal({\n    //   template: template,\n    //   title: 'Preferences',\n    //   className: 'cozy-modal-preferences',\n    //   actions: [\n    //     {\n    //       label: 'Save Changes',\n    //       callback: function(event) {\n    //         self.updatePreferences(event);\n    //       }\n    //     }\n    //   ],\n    //   region: 'right'\n    // });\n\n    this._modal._container.querySelector('main').innerHTML = template;\n    this._form = this._modal._container.querySelector('form');\n  },\n\n  initializeForm: function() {\n    this._createPanel();\n    this._fieldsets.forEach(function(fieldset) {\n      fieldset.initializeForm(this._form);\n    }.bind(this));\n  },\n\n  updatePreferences: function(event) {\n    event.preventDefault();\n\n    var doUpdate = false;\n    var new_options = {};\n    var saveable_options = {};\n    this._fieldsets.forEach(function(fieldset) {\n      // doUpdate = doUpdate || fieldset.updateForm(this._form, new_options);\n      // assign(new_options, fieldset.updateForm(this._form));\n      fieldset.updateForm(this._form, new_options, saveable_options);\n    }.bind(this));\n\n    if ( this.options.hasFields ) {\n      for(var i in this.options.fields) {\n        var field = this.options.fields[i];\n        var id = \"preferences-custom-\" + i;\n        var input = this._form.querySelector(`input[name=\"x${field.name}\"]:checked`);\n        if ( input.value != field.value ) {\n          field.value = input.value;\n          field.callback(field.value);\n        }\n      }\n    }\n\n    this._modal.deactivate();\n\n    setTimeout(function() {\n      this._reader.saveOptions(saveable_options);\n      this._reader.reopen(new_options);\n    }.bind(this), 100);\n  },\n\n  EOT: true\n});\n\nPreferences.fieldset = {};\n\nvar Fieldset = Class.extend({\n\n  options: {},\n\n  initialize: function (control, options) {\n      Util.setOptions(this, options);\n      this._control = control;\n      this._current = {};\n      this._id = (new Date()).getTime() + '-' + parseInt(Math.random((new Date()).getTime()) * 1000, 10);\n  },\n\n  template: function() {\n\n  },\n\n  EOT: true\n\n\n});\n\nPreferences.fieldset.TextSize = Fieldset.extend({\n\n  initializeForm: function(form) {\n    if ( ! this._input ) {\n      this._input = form.querySelector(`#x${this._id}-input`);\n      this._output = form.querySelector(`#x${this._id}-output`);\n      this._preview = form.querySelector(`#x${this._id}-preview`);\n      this._actionReset = form.querySelector(`#x${this._id}-reset`);\n\n      this._input.addEventListener('input', this._updatePreview.bind(this));\n      this._input.addEventListener('change', this._updatePreview.bind(this));\n\n      this._actionReset.addEventListener('click', function(event) {\n        event.preventDefault();\n        this._input.value = 100;\n        this._updatePreview();\n      }.bind(this));\n    }\n\n    var text_size = this._control._reader.options.text_size || 100;\n    if ( text_size == 'auto' ) { text_size = 100; }\n    this._current.text_size = text_size;\n    this._input.value = text_size;\n    this._updatePreview();\n  },\n\n  updateForm: function(form, options, saveable) {\n    // return { text_size: this._input.value };\n    options.text_size = saveable.text_size = this._input.value;\n    // options.text_size = this._input.value;\n    // return ( this._input.value != this._current.text_size );\n  },\n\n  template: function() {\n    return `<fieldset class=\"cozy-fieldset-text_size\">\n        <legend>Text Size</legend>\n        <div class=\"preview--text_size\" id=\"x${this._id}-preview\">\n          ‘Yes, that’s it,’ said the Hatter with a sigh: ‘it’s always tea-time, and we’ve no time to wash the things between whiles.’\n        </div>\n        <p style=\"white-space: no-wrap\">\n          <span>T-</span>\n          <input name=\"text_size\" type=\"range\" id=\"x${this._id}-input\" value=\"100\" min=\"50\" max=\"400\" step=\"10\" style=\"width: 75%; display: inline-block\" />\n          <span>T+</span>\n        </p>\n        <p>\n          <span>Text Size: </span>\n          <output for=\"preferences-input-text_size\" id=\"x${this._id}-output\">100</output>\n          <button id=\"x${this._id}-reset\" class=\"reset button--inline\" style=\"margin-left: 8px\">Reset</button> \n        </p>\n      </fieldset>`;\n  },\n\n  _updatePreview: function() {\n    this._preview.style.fontSize = `${( parseInt(this._input.value, 10) / 100 )}em`;\n    this._output.value = `${this._input.value}%`;\n  },\n\n  EOT: true\n\n});\n\nPreferences.fieldset.Display = Fieldset.extend({\n\n  initializeForm: function(form) {\n    var flow = this._control._reader.options.flow || this._control._reader.metadata.flow || 'auto';\n    // if ( flow == 'auto' ) { flow = 'paginated'; }\n\n    var input = form.querySelector(`#x${this._id}-input-${flow}`);\n    input.checked = true;\n    this._current.flow = flow;\n\n  },\n\n  updateForm: function(form, options, saveable) {\n    var input = form.querySelector(`input[name=\"x${this._id}-flow\"]:checked`);\n    options.flow = input.value;\n    if ( options.flow != 'auto' ) {\n      saveable.flow = options.flow;\n    }\n    // if ( input.value == 'auto' ) {\n    //   // we do NOT want to save flow as a preference\n    //   return {};\n    // }\n    // return { flow: input.value };\n  },\n\n  template: function() {\n    var scrolled_help = '';\n    if ( this._control._reader.metadata.layout != 'pre-paginated' ) {\n      scrolled_help = \"<br /><small>This is an experimental feature that may cause display and loading issues for the book when enabled.</small>\";\n    }\n    return `<fieldset>\n            <legend>Display</legend>\n            <label><input name=\"x${this._id}-flow\" type=\"radio\" id=\"x${this._id}-input-auto\" value=\"auto\" /> Auto<br /><small>Let the reader determine display mode based on your browser dimensions and the type of content you're reading</small></label>\n            <label><input name=\"x${this._id}-flow\" type=\"radio\" id=\"x${this._id}-input-paginated\" value=\"paginated\" /> Page-by-Page</label>\n            <label><input name=\"x${this._id}-flow\" type=\"radio\" id=\"x${this._id}-input-scrolled-doc\" value=\"scrolled-doc\" /> Scroll${scrolled_help}</label>\n          </fieldset>`;\n  },\n\n  EOT: true\n\n});\n\nPreferences.fieldset.Theme = Fieldset.extend({\n\n  initializeForm: function(form) {\n    var theme = this._control._reader.options.theme || 'default';\n\n    var input = form.querySelector(`#x${this._id}-input-theme-${theme}`);\n    input.checked = true;\n    this._current.theme = theme;\n  },\n\n  updateForm: function(form, options, saveable) {\n    var input = form.querySelector(`input[name=\"x${this._id}-theme\"]:checked`);\n    options.theme = saveable.theme = input.value;\n    // return { theme: input.value };\n  },\n\n  template: function() {\n    var template = `<fieldset>\n            <legend>Theme</legend>\n            <label><input name=\"x${this._id}-theme\" type=\"radio\" id=\"x${this._id}-input-theme-default\" value=\"default\" />Default</label>`;\n\n    this._control._reader.options.themes.forEach(function(theme) {\n      template += `<label><input name=\"x${this._id}-theme\" type=\"radio\" id=\"x${this._id}-input-theme-${theme.klass}\" value=\"${theme.klass}\" />${theme.name}</label>`\n    }.bind(this));\n\n    template += '</fieldset>';\n\n    return template;\n\n  },\n\n  EOT: true\n\n});\n\nPreferences.fieldset.Rendition = Fieldset.extend({\n\n  initializeForm: function(form) {\n    var rootfiles = this._control._reader.rootfiles;\n    var rootfilePath = this._control._reader.options.rootfilePath;\n    var expr = rootfilePath ? `[value=\"${rootfilePath}\"]` : \":first-child\";\n    var input = form.querySelector(`input[name=\"x${this._id}-rootfilePath\"]${expr}`);\n    input.checked = true;\n    this._current.rootfilePath = rootfilePath || rootfiles[0].rootfilePath;\n  },\n\n  updateForm: function(form, options, saveable) {\n    var input = form.querySelector(`input[name=\"x${this._id}-rootfilePath\"]:checked`);\n    if ( input.value != this._current.rootfilePath ) {\n      options.rootfilePath = input.value;\n      this._current.rootfilePath = input.value;\n    }\n  },\n\n  template: function() {\n    var template = `<fieldset>\n            <legend>Rendition</legend>\n    `;\n\n    this._control._reader.rootfiles.forEach(function(rootfile, i) {\n      template += `<label><input name=\"x${this._id}-rootfilePath\" type=\"radio\" id=\"x${this._id}-input-rootfilePath-${i}\" value=\"${rootfile.rootfilePath}\" />${rootfile.label || rootfile.accessMode || rootfile.rootfilePath}</label>`;\n    }.bind(this))\n\n    template += '</fieldset>';\n\n    return template;\n\n  },\n\n  EOT: true\n\n});\n\nPreferences.fieldset.Scale = Fieldset.extend({\n\n  initializeForm: function(form) {\n    if ( ! this._input ) {\n      this._input = form.querySelector(`#x${this._id}-input`);\n      this._output = form.querySelector(`#x${this._id}-output`);\n      this._preview = form.querySelector(`#x${this._id}-preview > div`);\n      this._actionReset = form.querySelector(`#x${this._id}-reset`);\n\n      this._input.addEventListener('input', this._updatePreview.bind(this));\n      this._input.addEventListener('change', this._updatePreview.bind(this));\n\n      this._actionReset.addEventListener('click', function(event) {\n        event.preventDefault();\n        this._input.value = 100;\n        this._updatePreview();\n      }.bind(this));\n    }\n\n    var scale = this._control._reader.options.scale || 100;\n    if ( ! scale ) { scale = 100; }\n    this._current.scale = scale;\n    this._input.value = scale;\n    this._updatePreview();\n  },\n\n  updateForm: function(form, options, saveable) {\n    // return { text_size: this._input.value };\n    options.scale = saveable.scale = this._input.value;\n    // options.text_size = this._input.value;\n    // return ( this._input.value != this._current.text_size );\n  },\n\n  template: function() {\n    return `<fieldset class=\"cozy-fieldset-text_size\">\n        <legend>Zoom In/Out</legend>\n        <div class=\"preview--scale\" id=\"x${this._id}-preview\" style=\"overflow: hidden; height: 5rem\">\n          <div>\n            ‘Yes, that’s it,’ said the Hatter with a sigh: ‘it’s always tea-time, and we’ve no time to wash the things between whiles.’\n          </div>\n        </div>\n        <p style=\"white-space: no-wrap\">\n          <span style=\"font-size: 150%\">⊖<span class=\"u-screenreader\"> Zoom Out</span></span>\n          <input name=\"scale\" type=\"range\" id=\"x${this._id}-input\" value=\"100\" min=\"50\" max=\"400\" step=\"10\" style=\"width: 75%; display: inline-block\" />\n          <span style=\"font-size: 150%\">⊕<span class=\"u-screenreader\">Zoom In </span></span>\n        </p>\n        <p>\n          <span>Scale: </span>\n          <output for=\"preferences-input-text_size\" id=\"x${this._id}-output\">100</output>\n          <button id=\"x${this._id}-reset\" class=\"reset button--inline\" style=\"margin-left: 8px\">Reset</button> \n        </p>\n      </fieldset>`;\n  },\n\n  _updatePreview: function() {\n    this._preview.style.transform = `scale(${( parseInt(this._input.value, 10) / 100 )}) translate(0,0)`;\n    this._output.value = `${this._input.value}%`;\n  },\n\n  EOT: true\n\n});\n\nexport var preferences = function(options) {\n  return new Preferences(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Widget = Control.extend({\n\n\n  options: {\n      // @option region: String = 'topright'\n      // The region of the control (one of the reader corners). Possible values are `'topleft'`,\n      // `'topright'`, `'bottomleft'` or `'bottomright'`\n  },\n\n  onAdd: function(reader) {\n    var container = this._container;\n    if ( container ) {\n      // NOOP\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n\n    }\n\n    this._onAddExtra(container);\n    this._updateTemplate(container);\n    this._updateClass(container);\n    this._bindEvents(container);\n\n    return container;\n  },\n\n  _updateTemplate: function(container) {\n    var data = this.data();\n    for(var slot in data) {\n      if ( data.hasOwnProperty(slot) ) {\n        var value = data[slot];\n        if ( typeof(value) == \"function\" ) { value = value(); }\n        var node = container.querySelector(`[data-slot=${slot}]`);\n        if ( node ) {\n          if ( node.hasAttribute('value') ) {\n            node.setAttribute('value', value);\n          } else {\n            node.innerHTML = value;\n          }\n        }\n      }\n    }\n  },\n\n  _updateClass: function(container) {\n    if ( this.options.className ) {\n      DomUtil.addClass(container, this.options.className);\n    }\n  },\n\n  _onAddExtra: function() { },\n\n  _bindEvents: function(container) {\n    var control = container.querySelector(\"[data-toggle=button]\");\n    if ( ! control ) { return ; }\n    DomEvent.disableClickPropagation(control);\n    DomEvent.on(control, 'click', DomEvent.stop);\n    DomEvent.on(control, 'click', this._action, this);\n  },\n\n  _action: function() {\n  },\n\n  data: function() {\n    return this.options.data || {};\n  },\n\n  EOT: true\n});\n\nWidget.Button = Widget.extend({\n  defaultTemplate: `<button data-toggle=\"button\" data-slot=\"label\"></button>`,\n\n  _action: function() {\n    this.options.onClick(this, this._reader);\n  },\n\n  EOT: true\n});\n\nWidget.Panel = Widget.extend({\n  defaultTemplate: `<div><span data-slot=\"text\"></span></div>`,\n\n\n  EOT: true\n});\n\nWidget.Toggle = Widget.extend({\n  defaultTemplate: `<button data-toggle=\"button\" data-slot=\"label\"></button>`,\n\n  _onAddExtra: function(container) {\n    this.state(this.options.states[0].stateName, container);\n\n    return container;\n  },\n\n  state: function(stateName, container) {\n    container = container || this._container;\n    this._resetState(container);\n    this._state = this.options.states.filter(function(s) { return s.stateName == stateName })[0];\n    this._updateClass(container);\n    this._updateTemplate(container);\n  },\n\n  _resetState: function(container) {\n    if ( ! this._state ) { return; }\n    if ( this._state.className ) {\n      DomUtil.removeClass(container, this._state.className);\n    }\n  },\n\n  _updateClass: function(container) {\n    if ( this._state.className ) {\n      DomUtil.addClass(container, this._state.className);\n    }\n  },\n\n  _action: function() {\n    this._state.onClick(this, this._reader);\n  },\n\n  data: function() {\n    return this._state.data || {};\n  },\n\n  EOT: true\n});\n\n// export var widget = function(options) {\n//   return new Widget(options);\n// }\n\nexport var widget = {\n  button: function(options) { return new Widget.Button(options); },\n  panel: function(options) { return new Widget.Panel(options); },\n  toggle: function(options) { return new Widget.Toggle(options); }\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Citation = Control.extend({\n  options: {\n    label: 'Citation',\n    html: '<span>Get Citation</span>'\n  },\n\n  defaultTemplate: `<button class=\"button--sm cozy-citation\" data-toggle=\"open\">Get Citation</button>`,\n\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._reader.on('updateContents', function(data) {\n      self._createPanel();\n    });\n\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n      self._modal.activate();\n    }, this)\n\n    return container;\n  },\n\n  _action: function() {\n    var self = this;\n    self._modal.activate();\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('button', className, container);\n    link.innerHTML = html;\n    link.title = title;\n\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n\n    return link;\n  },\n\n  _createPanel: function() {\n    var self = this;\n\n    var template = `<form>\n      <fieldset>\n        <legend>Select Citation Format</legend>\n      </fieldset>\n    </form>\n    <blockquote id=\"formatted\" style=\"padding: 8px; border-left: 4px solid black; background-color: #fff\"></blockquote>\n    <div class=\"alert alert-info\" id=\"message\" style=\"display: none\"></div>`;\n\n    this._modal = this._reader.modal({\n      template: template,\n      title: 'Copy Citation to Clipboard',\n      className: 'cozy-modal-citatation',\n      actions: [\n        {\n          label: 'Copy Citation',\n          callback: function(event) {\n            document.designMode = \"on\";\n            var formatted = self._modal._container.querySelector(\"#formatted\");\n\n            var range = document.createRange();\n            range.selectNode(formatted);\n            var sel = window.getSelection();\n            sel.removeAllRanges();\n            sel.addRange(range);\n\n            // formatted.select();\n\n            try {\n              var flag = document.execCommand('copy');\n            } catch(err) {\n              console.log(\"AHOY COPY FAILED\", err);\n            }\n\n            self._message.innerHTML = 'Success! Citation copied to your clipboard.';\n            self._message.style.display = 'block';\n            sel.removeAllRanges();\n            range.detach();\n            document.designMode = \"off\";\n          }\n        }\n      ],\n      region: 'left',\n      fraction: 1.0\n    });\n\n    this._form = this._modal._container.querySelector('form');\n    var fieldset = this._form.querySelector('fieldset');\n\n    var citations = this.options.citations || this._reader.metadata.citations;\n\n    citations.forEach(function(citation, index) {\n      var label = DomUtil.create('label', null, fieldset);\n      var input = DomUtil.create('input', null, label);\n      input.setAttribute('name', 'format');\n      input.setAttribute('value', citation.format);\n      input.setAttribute('type', 'radio');\n      if ( index == 0 ) {\n        input.setAttribute('checked', 'checked');\n      }\n      var text = document.createTextNode(\" \" + citation.format);\n      label.appendChild(text);\n      input.setAttribute('data-text', citation.text);\n    });\n\n    this._formatted = this._modal._container.querySelector(\"#formatted\");\n    this._message = this._modal._container.querySelector(\"#message\");\n    DomEvent.on(this._form, 'change', function(event) {\n      var target = event.target;\n      if ( target.tagName == 'INPUT' ) {\n        this._initializeForm();\n      }\n    }, this);\n\n    this._initializeForm();\n  },\n\n  _initializeForm: function() {\n    var formatted = this._formatCitation();\n    this._formatted.innerHTML = formatted;\n    this._message.style.display = 'none';\n    this._message.innerHTML = '';\n  },\n\n  _formatCitation: function(format) {\n    if ( format == null ) {\n      var selected = this._form.querySelector(\"input:checked\");\n      format = selected.value;\n    }\n    var selected = this._form.querySelector(\"input[value=\" + format + \"]\");\n    return selected.getAttribute('data-text');\n    // return selected.dataset.text;\n  },\n\n  EOT: true\n});\n\nexport var citation = function(options) {\n  return new Citation(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Search = Control.extend({\n  options: {\n    label: 'Search',\n    html: '<span>Search</span>'\n  },\n\n  defaultTemplate: `<form class=\"search\">\n    <label class=\"u-screenreader\" for=\"cozy-search-string\">Search in this text</label>\n    <input id=\"cozy-search-string\" name=\"search\" type=\"text\" placeholder=\"Search in this text...\"/>\n    <button class=\"button--sm\" data-toggle=\"open\" aria-label=\"Search\"><i class=\"icon-magnifying-glass oi\" data-glyph=\"magnifying-glass\" title=\"Search\" aria-hidden=\"true\"></i></button>\n  </form>`,\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    container.style.position = 'relative';\n\n    this._data = null;\n    this._canceled = false;\n    this._processing = false;\n\n    this._reader.on('ready', function() {\n\n      this._modal = this._reader.modal({\n        template: '<article></article>',\n        title: 'Search Results',\n        className: { container: 'cozy-modal-search' },\n        region: 'left',\n      });\n\n      this._modal.callbacks.onClose = function() {\n        if ( self._processing ) {\n          self._canceled = true;\n        }\n      };\n\n      this._article = this._modal._container.querySelector('article');\n\n      this._modal.on('click', 'a[href]', function(modal, target) {\n        target = target.getAttribute('href');\n        this._reader.tracking.action('search/go');\n        this._reader.gotoPage(target);\n        return true;\n      }.bind(this));\n\n      this._modal.on('closed', function() {\n        this._reader.tracking.action('contents/close');\n      }.bind(this))\n\n    }.bind(this));\n\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n\n      var searchString = this._container.querySelector(\"#cozy-search-string\").value;\n      searchString = searchString.replace(/^\\s*/, '').replace(/\\s*$/, '');\n\n      if ( ! searchString ) {\n        // just punt\n        return;\n      }\n\n      if ( searchString == this.searchString ) {\n        // cached results\n        self.openModalResults();\n      } else {\n        this.searchString = searchString;\n        self.openModalWaiting();\n        self.submitQuery();\n      }\n    }, this);\n\n    return container;\n  },\n\n  openModalWaiting: function() {\n    this._processing = true;\n    this._emptyArticle();\n    var value = this.searchString;\n    this._article.innerHTML = '<p>Submitting query for <em>' + value + '</em>...</p>' + this._reader.loaderTemplate();\n    this._modal.activate();\n  },\n\n  openModalResults: function() {\n    if ( this._canceled ) {\n      this._canceled = false;\n      return;\n    }\n    this._buildResults();\n    this._modal.activate();\n    this._reader.tracking.action(\"search/open\");\n  },\n\n  submitQuery: function() {\n    var self = this;\n\n    var url = this.options.searchUrl + this.searchString;\n\n    var request = new XMLHttpRequest();\n    request.open('GET', url, true);\n\n    request.onload = function() {\n      if (this.status >= 200 && this.status < 400) {\n        // Success!\n        var data = JSON.parse(this.response);\n        console.log(\"SEARCH DATA\", data);\n\n        self._data = data;\n\n      } else {\n        // We reached our target server, but it returned an error\n\n        self._data = null;\n        console.log(this.response);\n      }\n\n      self._reader.tracking.action(\"search/submitQuery\");\n      self.openModalResults();\n\n    };\n\n    request.onerror = function() {\n      // There was a connection error of some sort\n      self._data = null;\n      self.openModalResults();\n    };\n\n    request.send();\n\n  },\n\n  _emptyArticle: function() {\n    while (this._article && this._article.hasChildNodes()) {\n      this._article.removeChild(this._article.lastChild);\n    }\n  },\n\n  _buildResults: function() {\n    var self = this;\n    var content;\n\n    this._processing = false;\n\n    self._emptyArticle();\n\n    var reader = this._reader;\n    reader.annotations.reset();\n\n    if ( this._data ) {\n      var highlight = true\n      if (this._data.highlight_off == \"yes\") {\n        highlight = false;\n      }\n      if ( this._data.search_results.length ) {\n        content = DomUtil.create('ul');\n\n        this._data.search_results.forEach(function(result) {\n          var option = DomUtil.create('li');\n          var anchor = DomUtil.create('a', null, option);\n          var cfiRange = \"epubcfi(\" + result.cfi + \")\";\n\n          if (result.snippet) {\n            if (result.title) {\n              var chapterTitle = DomUtil.create('i');\n              chapterTitle.textContent = result.title + \": \";\n              anchor.appendChild(chapterTitle);\n            }\n            anchor.appendChild(document.createTextNode(result.snippet));\n\n            anchor.setAttribute(\"href\", cfiRange);\n            content.appendChild(option);\n          }\n          if (highlight) {\n            reader.annotations.highlight(cfiRange);\n          }\n        });\n      } else {\n        content = DomUtil.create(\"p\")\n        content.textContent = 'No results found for \"' + self.searchString + '\"';\n      }\n    } else {\n      content = DomUtil.create(\"p\")\n      content.textContent = 'There was a problem processing this query.';\n    }\n\n    self._article.appendChild(content);\n  },\n\n  EOT: true\n});\n\nexport var search = function(options) {\n  return new Search(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\n// Title + Chapter\n\nexport var BibliographicInformation = Control.extend({\n  options: {\n    label: 'Info',\n    direction: 'left',\n    html: '<span class=\"oi\" data-glyph=\"info\">Info</span>'\n  },\n\n  defaultTemplate: `<button class=\"button--sm cozy-bib-info oi\" data-glyph=\"info\" data-toggle=\"open\" aria-label=\"Bibliographic Information\"> Info</button>`,\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._reader.on('updateContents', function(data) {\n      self._createPanel();\n    });\n\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n      self._modal.activate();\n    }, this)\n\n    return container;\n  },\n\n  _createPanel: function() {\n    var self = this;\n\n    var template = `<dl>\n    </dl>`;\n\n    this._modal = this._reader.modal({\n      template: template,\n      title: 'Info',\n      region: 'left',\n      fraction: 1.0\n    });\n\n    var dl = this._modal._container.querySelector('dl');\n\n    var metadata_fields = [\n      [ 'title', 'Title' ],\n      [ 'creator', 'Author' ],\n      [ 'pubdate', 'Publication Date' ],\n      [ 'modified_date', 'Modified Date' ],\n      [ 'publisher', 'Publisher' ],\n      [ 'rights', 'Rights' ],\n      [ 'doi', 'DOI' ],\n      [ 'description', 'Description' ],\n    ];\n\n    var metadata_fields_seen = {};\n\n    var metadata = this._reader.metadata;\n\n    for(var idx in metadata_fields) {\n      var key = metadata_fields[idx][0];\n      var label = metadata_fields[idx][1];\n      if ( metadata[key] ) {\n        var value = metadata[key];\n        if ( key == 'pubdate' || key == 'modified_date' ) {\n          value = this._formatDate(value);\n          if ( ! value ) { continue; }\n          // value = d.toISOString().slice(0,10); // for YYYY-MM-DD\n        }\n        metadata_fields_seen[key] = true;\n        var dt = DomUtil.create('dt', 'cozy-bib-info-label', dl);\n        dt.innerHTML = label;\n        var dd = DomUtil.create('dd', 'cozy-bib-info-value cozy-bib-info-value-' + key, dl);\n        dd.innerHTML = value;\n      }\n    }\n\n  },\n\n  _formatDate: function(value) {\n    var match = value.match(/\\d{4}/);\n    if ( match ) {\n      return match[0];\n    }\n    return null;\n  },\n\n  EOT: true\n});\n\nexport var bibliographicInformation = function(options) {\n  return new BibliographicInformation(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Download = Control.extend({\n  options: {\n    label: 'Download Book',\n    html: '<span>Download Book</span>'\n  },\n\n  defaultTemplate: `<button class=\"button--sm cozy-download oi\" data-toggle=\"open\" data-glyph=\"data-transfer-download\"> Download Book</button>`,\n\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._reader.on('updateContents', function(data) {\n      self._createPanel();\n    });\n\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n      self._modal.activate();\n    }, this)\n\n    return container;\n  },\n\n  _createPanel: function() {\n    var self = this;\n\n    var template = `<form>\n      <fieldset>\n        <legend>Choose File Format</legend>\n      </fieldset>\n    </form>`;\n\n    this._modal = this._reader.modal({\n      template: template,\n      title: 'Download Book',\n      className: 'cozy-modal-download',\n      actions: [\n        {\n          label: 'Download',\n          callback: function(event) {\n            var selected = self._form.querySelector(\"input:checked\");\n            var href = selected.getAttribute('data-href');\n            self._configureDownloadForm(href);\n            self._form.submit();\n          }\n        }\n      ],\n      region: 'left',\n      fraction: 1.0\n    });\n\n    this._form = this._modal._container.querySelector('form');    \n    var fieldset = this._form.querySelector('fieldset');\n    this._reader.options.download_links.forEach(function(link, index) {\n      var label = DomUtil.create('label', null, fieldset);\n      var input = DomUtil.create('input', null, label);\n      input.setAttribute('name', 'format');\n      input.setAttribute('value', link.format);\n      input.setAttribute('data-href', link.href);\n      input.setAttribute('type', 'radio');\n      if ( index == 0 ) {\n        input.setAttribute('checked', 'checked');\n      }\n      var text = link.format;\n      if ( link.size ) {\n        text += \" (\" + link.size + \")\";\n      }\n      var text = document.createTextNode(\" \" + text);\n      label.appendChild(text);\n    });\n\n  },\n\n  _configureDownloadForm: function(href) {\n    var self = this;\n    self._form.setAttribute('method', 'GET');\n    self._form.setAttribute('action', href);\n    self._form.setAttribute('target', '_blank');\n  },\n\n\n  EOT: true\n});\n\nexport var download = function(options) {\n  return new Download(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Navigator = Control.extend({\n  onAdd: function(reader) {\n    var container = this._container;\n    if ( container ) {\n    } else {\n\n      var className = this._className('navigator'),\n          options = this.options;\n      \n      container = DomUtil.create('div', className);\n    }\n    this._setup(container);\n\n    this._reader.on('updateLocations', function(locations) {      \n      // if ( ! this._reader.currentLocation() || ! this._reader.currentLocation().start ) {\n      //   console.log(\"AHOY updateLocations NO START\", this._reader.currentLocation().then);\n      //   setTimeout(function() {\n      //     this._initializeNavigator(locations);\n      //   }.bind(this), 100);\n      //   return;\n      // }\n      this._initializeNavigator(locations);\n    }.bind(this));\n\n    return container;\n  },\n\n  _setup: function(container) {\n    this._control = container.querySelector(\"input[type=range]\");\n    if ( ! this._control ) {\n      this._createControl(container);\n    }\n    this._background = container.querySelector(\".cozy-navigator-range__background\");\n    this._status = container.querySelector(\".cozy-navigator-range__status\");\n    this._spanCurrentPercentage = container.querySelector(\".currentPercentage\");\n    this._spanCurrentLocation = container.querySelector(\".currentLocation\");\n    this._spanTotalLocations = container.querySelector(\".totalLocations\");\n\n    this._bindEvents();\n  },\n\n  _createControl: function (container) {\n    var template = `<div class=\"cozy-navigator-range\">\n        <label class=\"u-screenreader\" for=\"cozy-navigator-range-input\">Location: </label>\n        <input class=\"cozy-navigator-range__input\" id=\"cozy-navigator-range-input\" type=\"range\" name=\"locations-range-value\" min=\"0\" max=\"100\" aria-valuemin=\"0\" aria-valuemax=\"100\" aria-valuenow=\"0\" aria-valuetext=\"0% • Location 0 of ?\" value=\"0\" data-background-position=\"0\" />\n        <div class=\"cozy-navigator-range__background\"></div>\n      </div>\n      <div class=\"cozy-navigator-range__status\"><span class=\"currentPercentage\">0%</span> • Location <span class=\"currentLocation\">0</span> of <span class=\"totalLocations\">?</span></div>\n    `;\n\n    var body = new DOMParser().parseFromString(template, \"text/html\").body;\n    while ( body.children.length ) {\n      container.appendChild(body.children[0]);\n    }\n\n    this._control = container.querySelector(\"input[type=range]\");\n  },\n\n  _bindEvents: function() {\n    var self = this;\n\n    this._control.addEventListener(\"input\", function() {\n      self._update();\n    }, false);\n    this._control.addEventListener(\"change\", function() { self._action(); }, false);\n    this._control.addEventListener(\"mousedown\", function(){\n        self._mouseDown = true;\n    }, false);\n    this._control.addEventListener(\"mouseup\", function(){\n        self._mouseDown = false;\n    }, false);\n    this._control.addEventListener(\"keydown\", function(){\n      self._mouseDown = true;\n    }, false);\n    this._control.addEventListener(\"keyup\", function(){\n      self._mouseDown = false;\n    }, false);\n\n    this._reader.on('relocated', function(location) {\n      if ( ! self._initiated ) { return; }\n      if ( ! self._mouseDown ) {\n        self._control.value = Math.ceil(self._reader.locations.percentageFromCfi(self._reader.currentLocation().start.cfi) * 100);\n        self._update();\n      }\n    })\n\n  },\n\n  _action: function() {\n    var value = this._control.value;\n    var locations = this._reader.locations;\n    var cfi = locations.cfiFromPercentage(value / 100);\n    this._reader.tracking.action(\"navigator/go\");\n    this._reader.gotoPage(cfi);\n  },\n\n  _update: function() {\n    var self = this;\n\n    var current = this._reader.currentLocation();\n    if ( ! current || ! current.start ) {\n      setTimeout(function() {\n        this._update();\n      }.bind(this), 100);\n    }\n\n    var rangeBg = this._background;\n    var range = self._control;\n\n    var value = parseInt(range.value, 10);\n    var percentage = value;\n\n    rangeBg.setAttribute('style', 'background-position: ' + (-percentage) + '% 0%, left top;');\n    self._control.setAttribute('data-background-position', Math.ceil(percentage));\n\n    this._spanCurrentPercentage.innerHTML = percentage + '%';\n    if ( current && current.start ) {\n      var current_location = this._reader.locations.locationFromCfi(current.start.cfi);\n      this._spanCurrentLocation.innerHTML = ( current_location );\n    }\n    self._last_delta = self._last_value > value; self._last_value = value;\n  },\n\n  _initializeNavigator: function(locations) {\n    console.log(\"AHOY updateLocations PROCESSING LOCATION\");\n    this._initiated = true;\n    this._total = this._reader.locations.total;\n    if ( this._reader.currentLocation().start ) {\n      this._control.value = Math.ceil(this._reader.locations.percentageFromCfi(this._reader.currentLocation().start.cfi) * 100);\n      this._last_value = this._control.value;\n    } else {\n      this._last_value = this._control.value;\n    }\n\n    this._spanTotalLocations.innerHTML = this._total;\n\n    this._update();\n    setTimeout(function() {\n      DomUtil.addClass(this._container, 'initialized');\n    }.bind(this), 0);\n  },\n\n  EOT: true\n});\n\nexport var navigator = function(options) {\n  return new Navigator(options);\n}\n","import {Control, control} from './Control';\nimport {PageNext, PagePrevious, pageNext, pagePrevious, PageFirst, pageFirst, PageLast, pageLast} from './Control.Paging';\nimport {Contents, contents} from './Control.Contents';\nimport {Title, title} from './Control.Title';\nimport {PublicationMetadata, publicationMetadata} from './Control.PublicationMetadata';\nimport {Preferences, preferences} from './Control.Preferences';\nimport {Widget, widget} from './Control.Widget';\nimport {Citation, citation} from './Control.Citation';\nimport {Search, search} from './Control.Search';\nimport {BibliographicInformation, bibliographicInformation} from './Control.BibliographicInformation';\nimport {Download, download} from './Control.Download';\nimport {Navigator, navigator} from './Control.Navigator';\n\n// import {Zoom, zoom} from './Control.Zoom';\n// import {Attribution, attribution} from './Control.Attribution';\n\nControl.PageNext = PageNext;\nControl.PagePrevious = PagePrevious;\nControl.PageFirst = PageFirst;\nControl.PageLast = PageLast;\ncontrol.pagePrevious = pagePrevious;\ncontrol.pageNext = pageNext;\ncontrol.pageFirst = pageFirst;\ncontrol.pageLast = pageLast;\n\nControl.Contents = Contents;\ncontrol.contents = contents;\n\nControl.Title = Title;\ncontrol.title = title;\n\nControl.PublicationMetadata = PublicationMetadata;\ncontrol.publicationMetadata = publicationMetadata;\n\nControl.Preferences = Preferences;\ncontrol.preferences = preferences;\n\nControl.Widget = Widget;\ncontrol.widget = widget;\n\nControl.Citation = Citation;\ncontrol.citation = citation;\n\nControl.Search = Search;\ncontrol.search = search;\n\nControl.BibliographicInformation = BibliographicInformation;\ncontrol.bibliographicInformation = bibliographicInformation;\n\nControl.Download = Download;\ncontrol.download = download;\n\nControl.Navigator = Navigator;\ncontrol.navigator = navigator;\n\nexport {Control, control};\n","import {Evented} from './Events';\n\nvar Bus = Evented.extend({\n});\n\nvar instance;\nexport var bus = function() {\n  return instance || ( instance = new Bus() );\n}\n","import * as Browser from './Browser';\nexport {Browser};\n\nexport {Class} from './Class';\n\nimport {Evented} from './Events';\nexport {Evented};\nexport var Mixin = {Events: Evented.prototype};\n\nimport * as Util from './Util';\nexport {Util};\nexport {extend, bind, stamp, setOptions} from './Util';\nexport {bus} from './Bus';\n","\n// var ePub = window.ePub;\n// export {ePub};\n\nexport function ePub(href, options) {\n\tif ( window.require !== undefined ) {\n\t\twindow.ePub = require(\"ePub\");\n\t}\n  return window.ePub(href, options);\n}\n","'use strict';\n\nif (!process) {\n  var process = {\n    \"cwd\" : function () { return '/' }\n  };\n}\n\nfunction assertPath(path) {\n  if (typeof path !== 'string') {\n    throw new TypeError('Path must be a string. Received ' + path);\n  }\n}\n\n// Resolves . and .. elements in a path with directory names\nfunction normalizeStringPosix(path, allowAboveRoot) {\n  var res = '';\n  var lastSlash = -1;\n  var dots = 0;\n  var code;\n  for (var i = 0; i <= path.length; ++i) {\n    if (i < path.length)\n      code = path.charCodeAt(i);\n    else if (code === 47/*/*/)\n      break;\n    else\n      code = 47/*/*/;\n    if (code === 47/*/*/) {\n      if (lastSlash === i - 1 || dots === 1) {\n        // NOOP\n      } else if (lastSlash !== i - 1 && dots === 2) {\n        if (res.length < 2 ||\n            res.charCodeAt(res.length - 1) !== 46/*.*/ ||\n            res.charCodeAt(res.length - 2) !== 46/*.*/) {\n          if (res.length > 2) {\n            var start = res.length - 1;\n            var j = start;\n            for (; j >= 0; --j) {\n              if (res.charCodeAt(j) === 47/*/*/)\n                break;\n            }\n            if (j !== start) {\n              if (j === -1)\n                res = '';\n              else\n                res = res.slice(0, j);\n              lastSlash = i;\n              dots = 0;\n              continue;\n            }\n          } else if (res.length === 2 || res.length === 1) {\n            res = '';\n            lastSlash = i;\n            dots = 0;\n            continue;\n          }\n        }\n        if (allowAboveRoot) {\n          if (res.length > 0)\n            res += '/..';\n          else\n            res = '..';\n        }\n      } else {\n        if (res.length > 0)\n          res += '/' + path.slice(lastSlash + 1, i);\n        else\n          res = path.slice(lastSlash + 1, i);\n      }\n      lastSlash = i;\n      dots = 0;\n    } else if (code === 46/*.*/ && dots !== -1) {\n      ++dots;\n    } else {\n      dots = -1;\n    }\n  }\n  return res;\n}\n\nfunction _format(sep, pathObject) {\n  var dir = pathObject.dir || pathObject.root;\n  var base = pathObject.base ||\n    ((pathObject.name || '') + (pathObject.ext || ''));\n  if (!dir) {\n    return base;\n  }\n  if (dir === pathObject.root) {\n    return dir + base;\n  }\n  return dir + sep + base;\n}\n\nvar posix = {\n  // path.resolve([from ...], to)\n  resolve: function resolve() {\n    var resolvedPath = '';\n    var resolvedAbsolute = false;\n    var cwd;\n\n    for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n      var path;\n      if (i >= 0)\n        path = arguments[i];\n      else {\n        if (cwd === undefined)\n          cwd = process.cwd();\n        path = cwd;\n      }\n\n      assertPath(path);\n\n      // Skip empty entries\n      if (path.length === 0) {\n        continue;\n      }\n\n      resolvedPath = path + '/' + resolvedPath;\n      resolvedAbsolute = path.charCodeAt(0) === 47/*/*/;\n    }\n\n    // At this point the path should be resolved to a full absolute path, but\n    // handle relative paths to be safe (might happen when process.cwd() fails)\n\n    // Normalize the path\n    resolvedPath = normalizeStringPosix(resolvedPath, !resolvedAbsolute);\n\n    if (resolvedAbsolute) {\n      if (resolvedPath.length > 0)\n        return '/' + resolvedPath;\n      else\n        return '/';\n    } else if (resolvedPath.length > 0) {\n      return resolvedPath;\n    } else {\n      return '.';\n    }\n  },\n\n\n  normalize: function normalize(path) {\n    assertPath(path);\n\n    if (path.length === 0)\n      return '.';\n\n    var isAbsolute = path.charCodeAt(0) === 47/*/*/;\n    var trailingSeparator = path.charCodeAt(path.length - 1) === 47/*/*/;\n\n    // Normalize the path\n    path = normalizeStringPosix(path, !isAbsolute);\n\n    if (path.length === 0 && !isAbsolute)\n      path = '.';\n    if (path.length > 0 && trailingSeparator)\n      path += '/';\n\n    if (isAbsolute)\n      return '/' + path;\n    return path;\n  },\n\n\n  isAbsolute: function isAbsolute(path) {\n    assertPath(path);\n    return path.length > 0 && path.charCodeAt(0) === 47/*/*/;\n  },\n\n\n  join: function join() {\n    if (arguments.length === 0)\n      return '.';\n    var joined;\n    for (var i = 0; i < arguments.length; ++i) {\n      var arg = arguments[i];\n      assertPath(arg);\n      if (arg.length > 0) {\n        if (joined === undefined)\n          joined = arg;\n        else\n          joined += '/' + arg;\n      }\n    }\n    if (joined === undefined)\n      return '.';\n    return posix.normalize(joined);\n  },\n\n\n  relative: function relative(from, to) {\n    assertPath(from);\n    assertPath(to);\n\n    if (from === to)\n      return '';\n\n    from = posix.resolve(from);\n    to = posix.resolve(to);\n\n    if (from === to)\n      return '';\n\n    // Trim any leading backslashes\n    var fromStart = 1;\n    for (; fromStart < from.length; ++fromStart) {\n      if (from.charCodeAt(fromStart) !== 47/*/*/)\n        break;\n    }\n    var fromEnd = from.length;\n    var fromLen = (fromEnd - fromStart);\n\n    // Trim any leading backslashes\n    var toStart = 1;\n    for (; toStart < to.length; ++toStart) {\n      if (to.charCodeAt(toStart) !== 47/*/*/)\n        break;\n    }\n    var toEnd = to.length;\n    var toLen = (toEnd - toStart);\n\n    // Compare paths to find the longest common path from root\n    var length = (fromLen < toLen ? fromLen : toLen);\n    var lastCommonSep = -1;\n    var i = 0;\n    for (; i <= length; ++i) {\n      if (i === length) {\n        if (toLen > length) {\n          if (to.charCodeAt(toStart + i) === 47/*/*/) {\n            // We get here if `from` is the exact base path for `to`.\n            // For example: from='/foo/bar'; to='/foo/bar/baz'\n            return to.slice(toStart + i + 1);\n          } else if (i === 0) {\n            // We get here if `from` is the root\n            // For example: from='/'; to='/foo'\n            return to.slice(toStart + i);\n          }\n        } else if (fromLen > length) {\n          if (from.charCodeAt(fromStart + i) === 47/*/*/) {\n            // We get here if `to` is the exact base path for `from`.\n            // For example: from='/foo/bar/baz'; to='/foo/bar'\n            lastCommonSep = i;\n          } else if (i === 0) {\n            // We get here if `to` is the root.\n            // For example: from='/foo'; to='/'\n            lastCommonSep = 0;\n          }\n        }\n        break;\n      }\n      var fromCode = from.charCodeAt(fromStart + i);\n      var toCode = to.charCodeAt(toStart + i);\n      if (fromCode !== toCode)\n        break;\n      else if (fromCode === 47/*/*/)\n        lastCommonSep = i;\n    }\n\n    var out = '';\n    // Generate the relative path based on the path difference between `to`\n    // and `from`\n    for (i = fromStart + lastCommonSep + 1; i <= fromEnd; ++i) {\n      if (i === fromEnd || from.charCodeAt(i) === 47/*/*/) {\n        if (out.length === 0)\n          out += '..';\n        else\n          out += '/..';\n      }\n    }\n\n    // Lastly, append the rest of the destination (`to`) path that comes after\n    // the common path parts\n    if (out.length > 0)\n      return out + to.slice(toStart + lastCommonSep);\n    else {\n      toStart += lastCommonSep;\n      if (to.charCodeAt(toStart) === 47/*/*/)\n        ++toStart;\n      return to.slice(toStart);\n    }\n  },\n\n\n  _makeLong: function _makeLong(path) {\n    return path;\n  },\n\n\n  dirname: function dirname(path) {\n    assertPath(path);\n    if (path.length === 0)\n      return '.';\n    var code = path.charCodeAt(0);\n    var hasRoot = (code === 47/*/*/);\n    var end = -1;\n    var matchedSlash = true;\n    for (var i = path.length - 1; i >= 1; --i) {\n      code = path.charCodeAt(i);\n      if (code === 47/*/*/) {\n        if (!matchedSlash) {\n          end = i;\n          break;\n        }\n      } else {\n        // We saw the first non-path separator\n        matchedSlash = false;\n      }\n    }\n\n    if (end === -1)\n      return hasRoot ? '/' : '.';\n    if (hasRoot && end === 1)\n      return '//';\n    return path.slice(0, end);\n  },\n\n\n  basename: function basename(path, ext) {\n    if (ext !== undefined && typeof ext !== 'string')\n      throw new TypeError('\"ext\" argument must be a string');\n    assertPath(path);\n\n    var start = 0;\n    var end = -1;\n    var matchedSlash = true;\n    var i;\n\n    if (ext !== undefined && ext.length > 0 && ext.length <= path.length) {\n      if (ext.length === path.length && ext === path)\n        return '';\n      var extIdx = ext.length - 1;\n      var firstNonSlashEnd = -1;\n      for (i = path.length - 1; i >= 0; --i) {\n        var code = path.charCodeAt(i);\n        if (code === 47/*/*/) {\n          // If we reached a path separator that was not part of a set of path\n          // separators at the end of the string, stop now\n          if (!matchedSlash) {\n            start = i + 1;\n            break;\n          }\n        } else {\n          if (firstNonSlashEnd === -1) {\n            // We saw the first non-path separator, remember this index in case\n            // we need it if the extension ends up not matching\n            matchedSlash = false;\n            firstNonSlashEnd = i + 1;\n          }\n          if (extIdx >= 0) {\n            // Try to match the explicit extension\n            if (code === ext.charCodeAt(extIdx)) {\n              if (--extIdx === -1) {\n                // We matched the extension, so mark this as the end of our path\n                // component\n                end = i;\n              }\n            } else {\n              // Extension does not match, so our result is the entire path\n              // component\n              extIdx = -1;\n              end = firstNonSlashEnd;\n            }\n          }\n        }\n      }\n\n      if (start === end)\n        end = firstNonSlashEnd;\n      else if (end === -1)\n        end = path.length;\n      return path.slice(start, end);\n    } else {\n      for (i = path.length - 1; i >= 0; --i) {\n        if (path.charCodeAt(i) === 47/*/*/) {\n          // If we reached a path separator that was not part of a set of path\n          // separators at the end of the string, stop now\n          if (!matchedSlash) {\n            start = i + 1;\n            break;\n          }\n        } else if (end === -1) {\n          // We saw the first non-path separator, mark this as the end of our\n          // path component\n          matchedSlash = false;\n          end = i + 1;\n        }\n      }\n\n      if (end === -1)\n        return '';\n      return path.slice(start, end);\n    }\n  },\n\n\n  extname: function extname(path) {\n    assertPath(path);\n    var startDot = -1;\n    var startPart = 0;\n    var end = -1;\n    var matchedSlash = true;\n    // Track the state of characters (if any) we see before our first dot and\n    // after any path separator we find\n    var preDotState = 0;\n    for (var i = path.length - 1; i >= 0; --i) {\n      var code = path.charCodeAt(i);\n      if (code === 47/*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          startPart = i + 1;\n          break;\n        }\n        continue;\n      }\n      if (end === -1) {\n        // We saw the first non-path separator, mark this as the end of our\n        // extension\n        matchedSlash = false;\n        end = i + 1;\n      }\n      if (code === 46/*.*/) {\n        // If this is our first dot, mark it as the start of our extension\n        if (startDot === -1)\n          startDot = i;\n        else if (preDotState !== 1)\n          preDotState = 1;\n      } else if (startDot !== -1) {\n        // We saw a non-dot and non-path separator before our dot, so we should\n        // have a good chance at having a non-empty extension\n        preDotState = -1;\n      }\n    }\n\n    if (startDot === -1 ||\n        end === -1 ||\n        // We saw a non-dot character immediately before the dot\n        preDotState === 0 ||\n        // The (right-most) trimmed path component is exactly '..'\n        (preDotState === 1 &&\n         startDot === end - 1 &&\n         startDot === startPart + 1)) {\n      return '';\n    }\n    return path.slice(startDot, end);\n  },\n\n\n  format: function format(pathObject) {\n    if (pathObject === null || typeof pathObject !== 'object') {\n      throw new TypeError(\n        'Parameter \"pathObject\" must be an object, not ' + typeof(pathObject)\n      );\n    }\n    return _format('/', pathObject);\n  },\n\n\n  parse: function parse(path) {\n    assertPath(path);\n\n    var ret = { root: '', dir: '', base: '', ext: '', name: '' };\n    if (path.length === 0)\n      return ret;\n    var code = path.charCodeAt(0);\n    var isAbsolute = (code === 47/*/*/);\n    var start;\n    if (isAbsolute) {\n      ret.root = '/';\n      start = 1;\n    } else {\n      start = 0;\n    }\n    var startDot = -1;\n    var startPart = 0;\n    var end = -1;\n    var matchedSlash = true;\n    var i = path.length - 1;\n\n    // Track the state of characters (if any) we see before our first dot and\n    // after any path separator we find\n    var preDotState = 0;\n\n    // Get non-dir info\n    for (; i >= start; --i) {\n      code = path.charCodeAt(i);\n      if (code === 47/*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          startPart = i + 1;\n          break;\n        }\n        continue;\n      }\n      if (end === -1) {\n        // We saw the first non-path separator, mark this as the end of our\n        // extension\n        matchedSlash = false;\n        end = i + 1;\n      }\n      if (code === 46/*.*/) {\n        // If this is our first dot, mark it as the start of our extension\n        if (startDot === -1)\n          startDot = i;\n        else if (preDotState !== 1)\n          preDotState = 1;\n      } else if (startDot !== -1) {\n        // We saw a non-dot and non-path separator before our dot, so we should\n        // have a good chance at having a non-empty extension\n        preDotState = -1;\n      }\n    }\n\n    if (startDot === -1 ||\n        end === -1 ||\n        // We saw a non-dot character immediately before the dot\n        preDotState === 0 ||\n        // The (right-most) trimmed path component is exactly '..'\n        (preDotState === 1 &&\n         startDot === end - 1 &&\n         startDot === startPart + 1)) {\n      if (end !== -1) {\n        if (startPart === 0 && isAbsolute)\n          ret.base = ret.name = path.slice(1, end);\n        else\n          ret.base = ret.name = path.slice(startPart, end);\n      }\n    } else {\n      if (startPart === 0 && isAbsolute) {\n        ret.name = path.slice(1, startDot);\n        ret.base = path.slice(1, end);\n      } else {\n        ret.name = path.slice(startPart, startDot);\n        ret.base = path.slice(startPart, end);\n      }\n      ret.ext = path.slice(startDot, end);\n    }\n\n    if (startPart > 0)\n      ret.dir = path.slice(0, startPart - 1);\n    else if (isAbsolute)\n      ret.dir = '/';\n\n    return ret;\n  },\n\n\n  sep: '/',\n  delimiter: ':',\n  posix: null\n};\n\n\nmodule.exports = posix;\n","import * as Util from '../core/Util';\nimport {Reader} from './Reader';\nimport * as epubjs from '../epubjs';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as Browser from '../core/Browser';\n\nimport path from \"path-webpack\";\n\nReader.EpubJS = Reader.extend({\n\n  initialize: function(id, options) {\n    Reader.prototype.initialize.apply(this, arguments);\n    this._epubjs_ready = false;\n    window.xpath = path;\n  },\n\n  open: function(target, callback) {\n    var self = this;\n    if ( typeof(target) == 'function' ) {\n      callback = target;\n      target = undefined;\n    }\n    if ( callback == null ) {\n      callback = function() { };\n    }\n\n    // okay, we need to do some hacking to fetch the dang files\n    // but this isn't going to be done async\n    self.rootfiles = [];\n    var request = new XMLHttpRequest();\n    request.open('GET', this.options.href + \"/META-INF/container.xml\");\n    request.responseType = 'document';\n    request.onload = function() {\n      var containerDoc = request.responseXML;\n      var rootfiles = containerDoc.querySelectorAll(\"rootfile\");\n      if ( rootfiles.length > 1 ) {\n        console.log(\"AHOY ROOTFILES MULTIPLE RENDITIONS\", rootfiles.length);\n        for(var i = 0; i < rootfiles.length; i++) {\n          var rootfile = rootfiles[i];\n          var rootfilePath = rootfile.getAttribute('full-path');\n          var label = rootfile.getAttribute('rendition:label');\n          var layout = rootfile.getAttribute('rendition:layout');\n          self.rootfiles.push({\n            rootfilePath: rootfilePath,\n            label: label,\n            layout: layout\n          })\n        }\n      }\n    }\n    request.send();\n\n    this.options.rootfilePath = this.options.rootfilePath || sessionStorage.getItem('rootfilePath');\n\n    var book_href = this.options.href;\n    var book_options = { packagePath: this.options.rootfilePath };\n    if ( this.options.useArchive ) {\n      book_href = book_href.replace(/\\/(\\w+)\\/$/, '/$1/$1.sm.epub');\n      book_options.openAs = 'epub';\n    }\n    this._book = epubjs.ePub(book_href, book_options);\n    sessionStorage.removeItem('rootfilePath');\n    // this._book = epubjs.ePub(this.options.href);\n    this._book.loaded.navigation.then(function(toc) {\n      self._contents = toc;\n      self.metadata = self._book.package.metadata;\n      self.fire('updateContents', toc);\n      self.fire('updateTitle', self._book.package.metadata);\n    })\n    this._book.ready.then(function() {\n      self.draw(target, callback);\n      if ( self.metadata.layout == 'pre-paginated' ) {\n        // fake it with the spine\n        var locations = [];\n        self._book.spine.each(function(item) {\n          locations.push(`epubcfi(${item.cfiBase}!/4/2)`);\n          self.locations._locations.push(`epubcfi(${item.cfiBase}!/4/2)`);\n        });\n        self.locations.total = locations.length;\n        var t;\n        var f = function() {\n          if ( self._rendition && self._rendition.manager && self._rendition.manager.stage ) {\n            var location = self._rendition.currentLocation();\n            if ( location && location.start) {\n              self.fire('updateLocations', locations);\n              clearTimeout(t);\n              return;\n            }\n          }\n          t = setTimeout(f, 100);\n        }\n\n        t = setTimeout(f, 100);\n      } else {\n        self._book.locations.generate(1600).then(function(locations) {\n          // console.log(\"AHOY WUT\", locations);\n          self.fire('updateLocations', locations);\n        })\n      }\n    })\n    // .then(callback);\n  },\n\n  draw: function(target, callback) {\n    var self = this;\n\n    if ( self._rendition ) {\n      // self._unbindEvents();\n      var container = self._rendition.manager.container;\n      Object.keys(self._rendition.hooks).forEach(function(key) {\n        console.log(\"AHOY draw clearing\", key);\n        self._rendition.hooks[key].clear();\n      })\n      self._rendition.destroy();\n      self._rendition = null;\n    }\n\n    this.settings = { flow: this.options.flow };\n    this.settings.manager = this.options.manager || 'default';\n\n    if ( this.settings.flow == 'auto' && this.metadata.layout == 'pre-paginated' ) {\n      // dumb check to see if the window is _tall_ enough to put\n      // two pages side by side\n      if ( this._container.offsetHeight <= this.options.forceScrolledDocHeight ) {\n        this.settings.flow = 'scrolled-doc';\n        this.settings.manager = 'prepaginated';\n      }\n    }\n\n    if ( this.settings.flow == 'auto' || this.settings.flow == 'paginated' ) {\n      this._panes['epub'].style.overflow = this.metadata.layout == 'pre-paginated' ? 'auto' : 'hidden';\n      this.settings.manager = 'default';\n    } else {\n      this._panes['epub'].style.overflow = 'auto';\n      if ( this.settings.manager == 'default' ) {\n        this.settings.manager = 'continuous';\n      }\n    }\n\n    if ( ! callback ) {\n      callback = function() { };\n    }\n\n    if ( this.metadata.layout == 'pre-paginated' && this.settings.manager == 'continuous' ) {\n        this.settings.manager = 'prepaginated';\n    }\n\n    if ( this.settings.manager == 'prepaginated' ) {\n      this.settings.spread = 'none';\n    }\n\n    // would pre-paginated work better if we scaled the default view from the start? maybe?\n    if ( false && this.metadata.layout == 'pre-paginated' && this.settings.manager == 'default' ) {\n      this.settings.spread = 'none';\n      this._panes['epub'].style.overflow = 'auto';\n    }\n\n    self.settings.height = '100%';\n    self.settings.width = '100%';\n    self.settings['ignoreClass'] = 'annotator-hl';\n\n    if ( self.options.scale != '100' ) {\n      self.settings.scale = parseInt(self.options.scale, 10) / 100;\n    }\n\n    self._panes['book'].dataset.manager = this.settings.manager + ( this.settings.spread ? `-${this.settings.spread}` : '');\n    self._panes['book'].dataset.layout = this.metadata.layout || 'reflowable';\n\n    self._drawRendition(target, callback);\n  },\n\n  _drawRendition: function(target, callback) {\n    var self = this;\n\n    self._rendition = self._book.renderTo(self._panes['epub'], self.settings);\n    self._updateFontSize();\n    self._bindEvents();\n    self._drawn = true;\n\n    // if ( this.metadata.layout == 'pre-paginated' && this.settings.manager == 'prepaginated' ) {\n    //   this._panes['epub'].style.overflowX = 'hidden';\n    // }\n\n    var status_index = 0;\n    self._rendition.on('started', function() {\n\n      //var t;\n      //t = setInterval(function() {\n      //  if ( self._rendition.manager.stage && self.metadata.layout == 'pre-paginated' && self.settings.manager == 'default' ) {\n      //    self._rendition.manager.scale(1.75);\n      //    clearInterval(t)\n      // }\n      //}, 100);\n\n      self._rendition.manager.on(\"building\", function(status) {\n        if ( status ) {\n          status_index += 1;\n          self._panes['loader-status'].innerHTML = `<span>${Math.round((status_index / status.total) * 100.0)}%</span>`;\n        } else {\n          self._enableBookLoader(-1);\n        }\n      })\n      self._rendition.manager.on(\"built\", function() {\n        console.log(\"AHOY manager built\");\n        self._disableBookLoader(true);\n      })\n    })\n    // self._rendition.on('attached', attached_callback)\n\n    self._rendition.hooks.content.register(function(contents) {\n      self.fire('ready:contents', contents);\n      self.fire('readyContents', contents);\n      contents.document.addEventListener('keydown', (event) => {\n        const keyName = event.key;\n        self.fire('keyDown', { keyName: keyName, shiftKey: event.shiftKey, inner: true });\n        console.log('inner keydown event: ', keyName);\n      });\n    })\n\n    if ( target && target.start ) { target = target.start; }\n    if ( ! target && window.location.hash ) {\n      if ( window.location.hash.substr(1, 3) == '/6/' ) {\n        target = \"epubcfi(\" + window.location.hash.substr(1) + \")\";\n      } else {\n        target = window.location.hash.substr(2);\n        target = self._book.url.path().resolve(target);\n      }\n    }\n\n    self.gotoPage(target, function() {\n      window._loaded = true;\n      self._initializeReaderStyles();\n\n      if ( callback ) { callback(); }\n\n      self._epubjs_ready = true;\n\n      setTimeout(function() {\n        self.fire('opened');\n        self.fire('ready');\n        clearTimeout(self._queueTimeout);\n        self.tracking.event(\"openBook\", {\n          rootFilePath: self.options.rootFilePath,\n          flow: self.settings.flow,\n          manager: self.settings.manager\n        });\n      }, 100);\n\n    })\n  },\n\n  _scroll: function(delta) {\n    var self = this;\n    if ( self.options.flow == 'XXscrolled-doc' ) {\n      var container = self._rendition.manager.container;\n      var rect = container.getBoundingClientRect();\n      var scrollTop = container.scrollTop;\n      var newScrollTop = scrollTop;\n      var scrollBy = ( rect.height * 0.98 );\n      switch(delta) {\n        case 'PREV':\n          newScrollTop = -( scrollTop + scrollBy );\n          break;\n        case 'NEXT':\n          newScrollTop = ( scrollTop + scrollBy );\n          break;\n        case 'HOME':\n          newScrollTop = 0;\n          break;\n        case 'END':\n          newScrollTop = container.scrollHeight - scrollBy;\n          break;\n      }\n      container.scrollTop = newScrollTop;\n      return ( Math.floor(container.scrollTop) != Math.floor(scrollTop) );\n    }\n    return false;\n  },\n\n  _navigate: function(promise, callback) {\n    var self = this;\n    self._enableBookLoader(100);\n    promise.then(function() {\n      console.log(\"AHOY NAVIGATE FIN\");\n      self._disableBookLoader();\n      if ( callback ) { callback(); }\n    }).catch(function(e) {\n      self._disableBookLoader();\n      if ( callback ) { callback(); }\n      console.log(\"AHOY NAVIGATE ERROR\", e);\n      throw(e);\n    })\n  },\n\n  next: function() {\n    var self = this;\n    this.tracking.action('reader/go/next');\n    self._scroll('NEXT') || self._navigate(this._rendition.next());\n  },\n\n  prev: function() {\n    this.tracking.action('reader/go/previous');\n    this._scroll('PREV') || this._navigate(this._rendition.prev());\n  },\n\n  first: function() {\n    this.tracking.action('reader/go/first');\n    this._navigate(this._rendition.display(0), undefined);\n  },\n\n  last: function() {\n    var self = this;\n    this.tracking.action('reader/go/last');\n    var target = this._book.spine.length - 1;\n    this._navigate(this._rendition.display(target), undefined);\n  },\n\n  gotoPage: function(target, callback) {\n    if ( target != null ) {\n      var section = this._book.spine.get(target);\n      if ( ! section) {\n        // maybe it needs to be resolved\n        var guessed = target;\n        if ( guessed.indexOf(\"://\") < 0 ) {\n          var path1 = path.resolve(this._book.path.directory, this._book.package.navPath);\n          var path2 = path.resolve(path.dirname(path1), target);\n          guessed = this._book.canonical(path2);\n        }\n        if ( guessed.indexOf(\"#\") !== 0 ) {\n          guessed = guessed.split('#')[0];\n        }\n\n        this._book.spine.each(function(item) {\n          if ( item.canonical == guessed ) {\n            section = item;\n            target = section.href;\n            return;\n          }\n        })\n\n        console.log(\"AHOY GUESSED\", target);\n      } else if ( target.toString().match(/^\\d+$/) ) {\n        console.log(\"AHOY USING\", section.href);\n        target = section.href;\n      }\n\n      if ( ! section ) {\n        if ( ! this._epubjs_ready ) {\n          target = 0;\n        } else {\n          return;\n        }\n      }\n    }\n\n    console.log(\"AHOY gotoPage\", target);\n\n    var navigating = this._rendition.display(target).then(function() {\n      this._rendition.display(target);\n    }.bind(this));\n    this._navigate(navigating, callback);\n  },\n\n  percentageFromCfi: function(cfi) {\n    return this._book.percentageFromCfi(cfi);\n  },\n\n  destroy: function() {\n    if ( this._rendition ) {\n      try {\n        this._rendition.destroy();\n      } catch(e) {}\n    }\n    this._rendition = null;\n    this._drawn = false;\n  },\n\n  reopen: function(options, target) {\n    // different per reader?\n    var target = target || this.currentLocation();\n    if( target.start ) { target = target.start ; }\n    if ( target.cfi ) { target = target.cfi ; }\n\n    var doUpdate = false;\n    if ( options === true ) { doUpdate = true; options = {}; }\n    var changed = {};\n    Object.keys(options).forEach(function(key) {\n      if ( options[key] != this.options[key] ) {\n        doUpdate = true;\n        changed[key] = true;\n      }\n      // doUpdate = doUpdate || ( options[key] != this.options[key] );\n    }.bind(this));\n\n    if ( ! doUpdate ) {\n      return;\n    }\n\n    // performance hack\n    if ( Object.keys(changed).length == 1 && changed.scale ) {\n      reader.options.scale = options.scale;\n      this._updateScale();\n      return;\n    }\n\n    if ( options.rootfilePath && options.rootfilePath != this.options.rootfilePath ) {\n      // we need to REOPEN THE DANG BOOK\n      sessionStorage.setItem('rootfilePath', options.rootfilePath);\n      location.reload();\n      return;\n    }\n\n    Util.extend(this.options, options);\n\n    this.draw(target, function() {\n      this._updateFontSize();\n      this._updateScale();\n      this._updateTheme();\n      this._selectTheme(true);\n    }.bind(this))\n  },\n\n  currentLocation: function() {\n    if ( this._rendition && this._rendition.manager ) {\n      this._cached_location = this._rendition.currentLocation();\n    }\n    return this._cached_location;\n  },\n\n  _bindEvents: function() {\n    var self = this;\n\n    // add a stylesheet to stop images from breaking their columns\n    var add_max_img_styles = false;\n    if ( this._book.package.metadata.layout == 'pre-paginated' ) {\n      // NOOP\n    } else if ( this.options.flow == 'auto' || this.options.flow == 'paginated' ) {\n      add_max_img_styles = true;\n    }\n\n    var custom_stylesheet_rules = [];\n\n    // force 90% height instead of default 60%\n    if ( this.metadata.layout != 'pre-paginated' ) {\n      this._rendition.hooks.content.register(function(contents) {\n        contents.addStylesheetRules({\n          \"img\" : {\n            \"max-width\": (this._layout.columnWidth ? this._layout.columnWidth + \"px\" : \"100%\") + \"!important\",\n            \"max-height\": (this._layout.height ? (this._layout.height * 0.9) + \"px\" : \"90%\") + \"!important\",\n            \"object-fit\": \"contain\",\n            \"page-break-inside\": \"avoid\"\n          },\n          \"svg\" : {\n            \"max-width\": (this._layout.columnWidth ? this._layout.columnWidth + \"px\" : \"100%\") + \"!important\",\n            \"max-height\": (this._layout.height ? (this._layout.height * 0.9) + \"px\" : \"90%\") + \"!important\",\n            \"page-break-inside\": \"avoid\"\n          }\n        });\n      }.bind(this._rendition))\n    } else {\n      this._rendition.hooks.content.register(function(contents) {\n        contents.addStylesheetRules({\n          \"img\" : {\n            // \"border\": \"64px solid black !important\",\n            \"box-sizing\": \"border-box !important\"\n          },\n          \"figure\": {\n            \"box-sizing\": \"border-box !important\",\n            \"margin\": \"0 !important\"\n          }\n        });\n      }.bind(this._rendition));\n    }\n\n    this._updateFontSize();\n\n    if ( custom_stylesheet_rules.length ) {\n      this._rendition.hooks.content.register(function(view) {\n        view.addStylesheetRules(custom_stylesheet_rules);\n      })\n    }\n\n    this._rendition.on('resized', function(box) {\n      self.fire('resized', box);\n    })\n\n    this._rendition.on('relocated', function(location) {\n      self.fire('relocated', location);\n    })\n\n    this._rendition.on('displayerror', function(err) {\n      console.log(\"AHOY RENDITION DISPLAY ERROR\", err);\n    })\n\n    this._rendition.on(\"locationChanged\", function(location) {\n      var view = this.manager.current();\n      var section = view.section;\n      var current = this.book.navigation.get(section.href);\n\n      self.fire(\"updateSection\", current);\n      self.fire(\"updateLocation\", location);\n      // self.fire(\"relocated\", location);\n    });\n\n    this._rendition.on(\"rendered\", function(section, view) {\n\n      if ( view.contents ) {\n        // view.contents.on(\"xxlinkClicked\", function(href) {\n        //   console.log(\"AHOY CLICKED\", href);\n        //   var tmp = href.split(\"#\");\n        //   href = tmp[0];\n        //   var hash = tmp[1]\n        //   // var current = self.currentLocation().start.href;\n        //   // var section = self._book.spine.get(current.href);\n        //   console.log(\"AHOY CLICKED CHECK\", section.canonical, href);\n        //   if ( section.canonical.indexOf(href) < 0 ) {\n        //     self.gotoPage(href);\n        //     // self._rendition.display(href);\n\n        //   } else if ( hash ) {\n        //     // we're already on this page, so we need to scroll to this location\n        //     var node = view.contents.content.querySelector('#' + hash);\n        //     console.log(\"AHOY INTERNAL\", hash, view.contents, node);\n        //   }\n        //   // self._rendition.display(href);\n        // })\n      }\n\n      if(false) {\n        if ( ! self._rendition.manager.container.dataset.__scroll ) {\n          var ticking;\n          self._rendition.manager.container.addEventListener(\"scroll\", function(event) {\n            if ( self._rendition && self._rendition.manager ) {\n              var container = self._rendition.manager.container;\n              var mod = container.scrollLeft % parseInt(self._rendition.manager.layout.delta, 10);\n              console.log(\"AHOY DETECTED SCROLL\", mod, mod / self._rendition.manager.layout.delta);\n            }\n          });\n          self._rendition.manager.container.dataset.__scroll = true;\n        }\n      }\n\n      self.on('keyDown', function(data) {\n        if ( data.keyName == 'Tab' && data.inner ) {\n          var container = self._rendition.manager.container;\n          var mod;\n          var delta;\n          var x; var xyz;\n          setTimeout(function() {\n            var scrollLeft = container.scrollLeft;\n            mod = scrollLeft % parseInt(self._rendition.manager.layout.delta, 10);\n            if ( mod > 0 && ( mod / self._rendition.manager.layout.delta ) < 0.99 ) {\n              // var x = Math.floor(event.target.scrollLeft / parseInt(self._rendition.manager.layout.delta, 10)) + 1;\n              // var delta = ( x * self._rendition.manager.layout.delta) - event.target.scrollLeft;\n              x = Math.floor(container.scrollLeft / parseInt(self._rendition.manager.layout.delta, 10));\n              if ( data.shiftKey ) { x -= 0 ; }\n              else { x += 1; }\n              var y = container.scrollLeft;\n              delta = ( x * self._rendition.manager.layout.delta ) - y;\n              xyz = ( x * self._rendition.manager.layout.delta );\n              // if ( data.shiftKey ) { delta *= -1 ; }\n              if ( true || ! data.shiftKey ) {\n                self._rendition.manager.scrollBy(delta);\n              }\n            }\n            console.log(\"AHOY DOING THE SCROLLING\", data.shiftKey, scrollLeft, mod, x, xyz, delta);\n          }, 0);\n        }\n      })\n\n\n    })\n  },\n\n  _initializeReaderStyles: function() {\n    var self = this;\n    var themes = this.options.themes;\n    if ( themes ) {\n      themes.forEach(function(theme) {\n        self._rendition.themes.register(theme['klass'], theme.href ? theme.href : theme.rules);\n      })\n    }\n\n    // base for highlights\n    this._rendition.themes.override('.epubjs-hl', \"fill: yellow; fill-opacity: 0.3; mix-blend-mode: multiply;\");\n  },\n\n  _selectTheme: function(refresh) {\n    var theme = this.options.theme || 'default';\n    this._rendition.themes.select(theme);\n    if ( 0 && refresh ) {\n      var cfi = this.currentLocation().end.cfi;\n      this._rendition.manager.clear();\n      console.log(\"AHOY\", cfi);\n      this._rendition.display(cfi);\n    }\n  },\n\n  _updateFontSize: function() {\n    if ( this.metadata.layout == 'pre-paginated') {\n      // we're not doing font changes for pre-paginted\n      return;\n    }\n\n    var text_size = this.options.text_size == 'auto' ? 100 : this.options.text_size;\n    this._rendition.themes.fontSize(`${text_size}%`);\n  },\n\n  _updateScale: function() {\n    if ( this.metadata.layout != 'pre-paginated') {\n      // we're not scaling for reflowable\n      return;\n    }\n    var scale = this.options.scale;\n    if ( scale ) {\n      scale = parseInt(scale, 10) / 100.0;\n      this._rendition.scale(scale);\n    }\n  },\n\n  EOT: true\n\n})\n\nObject.defineProperty(Reader.EpubJS.prototype, 'metadata', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    return this._metadata;\n  },\n\n  set: function(data) {\n    this._metadata = Util.extend({}, data, this.options.metadata);\n  }\n});\n\nObject.defineProperty(Reader.EpubJS.prototype, 'annotations', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    if ( Browser.ie ) {\n      return {\n        reset: function() { /* NOOP */ },\n        highlight: function(cfiRange) { /* NOOP */ }\n      }\n    }\n    if ( ! this._rendition.annotations.reset ) {\n      this._rendition.annotations.reset = function(){\n        for(var hash in this._annotations) {\n            var cfiRange = decodeURI(hash);\n            this.remove(cfiRange);\n        }\n        this._annotationsBySectionIndex = {};\n      }.bind(this._rendition.annotations);\n    }\n    return this._rendition.annotations;\n  }\n});\n\nObject.defineProperty(Reader.EpubJS.prototype, 'locations', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    return this._book.locations;\n  }\n});\n\nwindow.Reader = Reader;\n\nexport function createReader(id, options) {\n  return new Reader.EpubJS(id, options);\n}\n","import * as Util from '../core/Util';\nimport {Reader} from './Reader';\nimport * as DomUtil from '../dom/DomUtil';\n\nReader.Mock = Reader.extend({\n\n  initialize: function(id, options) {\n    Reader.prototype.initialize.apply(this, arguments);\n  },\n\n  open: function(target, callback) {\n    var self = this;\n    this._book = {\n      metadata: {\n        title: 'The Mock Life',\n        creator: 'Alex Mock',\n        publisher: 'University Press',\n        location: 'Ann Arbor, MI',\n        pubdate: '2017-05-23'\n      },\n      contents: {\n        toc: [\n          {id: 1, href: \"/epubs/mock/ops/xhtml/TitlePage.xhtml\", label: \"Title\", parent: null},\n          {id: 2, href: \"/epubs/mock/ops/xhtml/Chapter01.xhtml\", label: \"Chapter 1\", parent: null},\n          {id: 3, href: \"/epubs/mock/ops/xhtml/Chapter02.xhtml\", label: \"Chapter 2\", parent: null},\n          {id: 4, href: \"/epubs/mock/ops/xhtml/Chapter03.xhtml\", label: \"Chapter 3\", parent: null},\n          {id: 5, href: \"/epubs/mock/ops/xhtml/Chapter04.xhtml\", label: \"Chapter 4\", parent: null},\n          {id: 6, href: \"/epubs/mock/ops/xhtml/Chapter05.xhtml\", label: \"Chapter 5\", parent: null},\n          {id: 7, href: \"/epubs/mock/ops/xhtml/Chapter06.xhtml\", label: \"Chapter 6\", parent: null},\n          {id: 8, href: \"/epubs/mock/ops/xhtml/Chapter07.xhtml\", label: \"Chapter 7\", parent: null},\n          {id: 9, href: \"/epubs/mock/ops/xhtml/Index.xhtml\", label: \"Index\", parent: null},\n        ]\n      }\n    };\n\n    this._locations = [\n      'epubcfi(/6/4[TitlePage.xhtml])',\n      'epubcfi(/6/4[Chapter01.xhtml])',\n      'epubcfi(/6/4[Chapter02.xhtml])',\n      'epubcfi(/6/4[Chapter03.xhtml])',\n      'epubcfi(/6/4[Chapter04.xhtml])',\n      'epubcfi(/6/4[Chapter05.xhtml])',\n      'epubcfi(/6/4[Chapter06.xhtml])',\n      'epubcfi(/6/4[Chapter07.xhtml])',\n      'epubcfi(/6/4[Chapter08.xhtml])',\n      'epubcfi(/6/4[Index.xhtml])',\n    ];\n\n    this.__currentIndex = 0;\n\n    this.metadata = this._book.metadata;\n    this.fire('updateContents', this._book.contents);\n    this.fire('updateTitle', this._metadata);\n    this.fire('updateLocations', this._locations);\n    this.draw(target, callback);\n  },\n\n  draw: function(target, callback) {\n    var self = this;\n    this.settings = { flow: this.options.flow };\n    this.settings.height = '100%';\n    this.settings.width = '99%';\n    // this.settings.width = '100%';\n    if ( this.options.flow == 'auto' ) {\n      this._panes['book'].style.overflow = 'hidden';\n    } else {\n      this._panes['book'].style.overflow = 'auto';\n    }\n    if ( typeof(target) == 'function' && cb === undefined ) {\n      callback = target;\n      target = undefined;\n    }\n    callback();\n    self.fire('ready');\n  },\n\n  next: function() {\n    // this._rendition.next();\n  },\n\n  prev: function() {\n    // this._rendition.prev();\n  },\n\n  first: function() {\n    // this._rendition.display(0);\n  },\n\n  last: function() {\n  },\n\n  gotoPage: function(target) {\n    if ( typeof(target) == \"string\" ) {\n      this.__currentIndex = this._locations.indexOf(target);\n    } else {\n      this.__currentIndex = target;\n    }\n    this.fire(\"relocated\", this.currentLocation());\n  },\n\n  destroy: function() {\n    // if ( this._rendition ) {\n    //   this._rendition.destroy();\n    // }\n    // this._rendition = null;\n  },\n\n  currentLocation: function() {\n    var cfi = this._locations[this.__currentIndex];\n    return {\n      start: { cfi: cfi, href: cfi },\n      end: { cfi: cfi, href: cfi }\n    }\n  },\n\n  _bindEvents: function() {\n    var self = this;\n\n  },\n\n  _updateTheme: function() {\n\n  },\n\n  EOT: true\n\n})\n\nObject.defineProperty(Reader.Mock.prototype, 'metadata', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    return this._metadata;\n  },\n\n  set: function(data) {\n    this._metadata = Util.extend({}, data, this.options.metadata);\n  }\n});\n\nObject.defineProperty(Reader.Mock.prototype, 'locations', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    var self = this;\n    return {\n      total: self._locations.length,\n      locationFromCfi: function(cfi) {\n        return self._locations.indexOf(cfi);\n      },\n      percentageFromCfi: function(cfi) {\n        var index = self.locations.locationFromCfi(cfi);\n        return ( index / self.locations.total );\n      },\n      cfiFromPercentage: function(percentage) {\n        var index = Math.ceil(percentage * 10);\n        return self._locations[index];\n      }\n    }\n  }\n});\n\nObject.defineProperty(Reader.Mock.prototype, 'annotations', {\n  get: function() {\n    return {\n      reset: function() {},\n      highlight: function() {}\n    }\n  }\n})\n\nexport function createReader(id, options) {\n  return new Reader.Mock(id, options);\n}\n","import {Reader} from './Reader';\nimport * as EpubJS from './Reader.EpubJS';\nimport * as Mock from './Reader.Mock';\n\nvar engines = {\n  epubjs: EpubJS.createReader,\n  mock: Mock.createReader\n}\n\nexport var reader = function(id, options) {\n  options = options || {};\n  var engine = options.engine || window.COZY_EPUB_ENGINE || 'epubjs';\n  var engine_href = options.engine_href || window.COZY_EPUB_ENGINE_HREF;\n  var _this = this;\n  var _arguments = arguments;\n\n  options.engine = engine;\n  options.engine_href = engine_href;\n\n  return engines[engine].apply(_this, [id, options]);\n}"],"names":["global","this","extend","dest","i","j","len","src","arguments","length","create","Object","F","proto","prototype","bind","fn","obj","slice","Array","apply","call","args","concat","lastId","stamp","_cozy_id","throttle","time","context","lock","wrapperFn","later","wrapNum","x","range","includeMax","max","min","d","falseFn","formatNum","num","digits","pow","Math","round","isNumeric","isNaN","parseFloat","isFinite","trim","str","replace","splitWords","split","setOptions","options","hasOwnProperty","getParamString","existingUrl","uppercase","params","push","encodeURIComponent","toUpperCase","indexOf","join","templateRe","template","data","key","value","undefined","Error","isArray","toString","array","el","emptyImageUrl","getPrefixed","name","window","lastTime","timeoutDefer","Date","timeToCall","setTimeout","requestFn","requestAnimationFrame","cancelFn","cancelAnimationFrame","id","clearTimeout","requestAnimFrame","immediate","cancelAnimFrame","loader","url","handler","_resolved","callbacks","error","then","cb","resolve","catch","reject","_argv","shift","retval","e","log","trace","element","document","createElement","onload","onerror","async","parent","attr","appendChild","Class","props","NewClass","initialize","callInitHooks","parentProto","__super__","Util","constructor","statics","includes","_initHooks","_initHooksCalled","include","mergeOptions","addInitHook","init","checkDeprecatedMixinEvents","cozy","Mixin","Evented","types","type","_on","_events","_off","typeListeners","newListener","ctx","listeners","l","_firingCount","splice","propagate","listens","event","target","_propagateEvent","_eventParents","once","off","on","fire","layer","addEventListener","removeEventListener","clearAllEventListeners","addOneTimeEventListener","fireEvent","hasEventListeners","style","documentElement","ie","ielt9","edge","navigator","webkit","userAgentContains","android","android23","opera","chrome","gecko","safari","phantom","opera12","win","platform","ie3d","webkit3d","WebKitCSSMatrix","gecko3d","any3d","L_DISABLE_3D","mobile","orientation","mobileWebkit","mobileWebkit3d","msPointer","PointerEvent","MSPointerEvent","pointer","touch","L_NO_TOUCH","DocumentTouch","mobileOpera","mobileGecko","retina","devicePixelRatio","screen","deviceXDPI","logicalXDPI","canvas","getContext","svg","vml","div","innerHTML","shape","firstChild","behavior","babelHelpers.typeof","adj","columnCount","classList","userAgent","toLowerCase","Point","y","point","clone","_add","toPoint","_subtract","_divideBy","_multiplyBy","_round","_floor","floor","_ceil","ceil","sqrt","abs","POINTER_DOWN","Browser","POINTER_MOVE","POINTER_UP","POINTER_CANCEL","TAG_WHITE_LIST","_pointers","_pointerDocListener","_pointersCount","addPointerListener","removePointerListener","_addPointerStart","onDown","pointerType","MSPOINTER_TYPE_MOUSE","tagName","_globalPointerDown","_globalPointerMove","_globalPointerUp","pointerId","_handlePointer","touches","changedTouches","_addPointerMove","onMove","buttons","_addPointerEnd","onUp","_touchstart","_touchend","_pre","addDoubleTapListener","last","doubleTap","delay","onTouchStart","count","now","delta","onTouchEnd","cancelBubble","newTouch","prop","removeDoubleTapListener","touchstart","touchend","dblclick","eventsKey","addOne","originalHandler","isExternalTarget","attachEvent","removeOne","detachEvent","stopPropagation","originalEvent","_stopped","disableScrollPropagation","disableClickPropagation","fakeStop","preventDefault","returnValue","stop","getMousePosition","container","clientX","clientY","rect","getBoundingClientRect","left","clientLeft","top","clientTop","wheelPxFactor","getWheelDelta","wheelDeltaY","deltaY","deltaMode","deltaX","deltaZ","wheelDelta","detail","skipEvents","skipped","events","related","relatedTarget","parentNode","err","lastClick","filterClick","timeStamp","elapsed","_simulatedClick","_simulated","Element","matches","ep","webkitMatchesSelector","msMatchesSelector","mozMatchesSelector","TRANSFORM","testProp","TRANSITION","TRANSITION_END","get","getElementById","getStyle","currentStyle","defaultView","css","getComputedStyle","className","remove","removeChild","empty","toFront","toBack","insertBefore","hasClass","contains","getClass","RegExp","test","addClass","classes","add","removeClass","setClass","baseVal","setOpacity","opacity","_setOpacityIE","filter","filterName","filters","item","Enabled","Opacity","isPropertySupported","setTransform","offset","scale","pos","setPosition","_leaflet_pos","getPosition","disableTextSelection","enableTextSelection","_userSelect","DomEvent","userSelectProperty","disableImageDrag","enableImageDrag","_outlineElement","_outlineStyle","preventOutline","tabIndex","outline","restoreOutline","freeGlobal","Symbol","root","symToStringTag","objectProto","nativeObjectToString","getRawTag","objectToString","isObject","baseGetTag","coreJsData","funcProto","funcToString","isMasked","isFunction","toSource","getValue","baseIsNative","defineProperty","getNative","eq","baseAssignValue","assignValue","nativeMax","identity","constant","shortOut","baseSetToString","setToString","overRest","isLength","MAX_SAFE_INTEGER","isArrayLike","isIndex","baseRest","isIterateeCall","isObjectLike","baseIsArguments","stubFalse","argsTag","funcTag","nodeUtil","baseUnary","baseIsTypedArray","isArguments","isBuffer","isTypedArray","baseTimes","overArg","isPrototype","nativeKeys","arrayLikeKeys","baseKeys","createAssigner","copyObject","keys","keyboardAllowed","val","fnMap","ret","eventNameMap","fullscreenchange","fullscreenerror","screenfull","elem","request","requestFullscreen","ALLOW_KEYBOARD_INPUT","exitFullscreen","isFullscreen","exit","callback","eventName","defineProperties","Boolean","fullscreenElement","fullscreenEnabled","Reader","self","_original_document_title","title","localStorage","getItem","assign","JSON","parse","_checkFeatureCompatibility","metadata","_initContainer","_initLayout","themes","forEach","theme","href","klass","rules","rule","new_rule","_updateTheme","_initEvents","_mode","mode","js","engine_href","_start","_loaded","open","saved_options","flow","setItem","stringify","_container","dataset","index","back","forward","enabled","toggle","DomUtil","_onScroll","_containerId","_fadeAnimated","fadeAnimation","engine","position","_initPanes","panes","_panes","prefix","_initBookLoader","_targets","tracking","reader","_action","_last_location_start","_reader","v","pop","action","location","start","cfi","onOff","transform3DLimit","_onMoveEnd","location_href","_ignoreHistory","pageview","tmp_href","substr","pushState","percentage","p","isTrusted","state","gotoPage","keyName","check","activeElement","localName","parentElement","IGNORE_TARGETS","shiftKey","next","prev","_scroll","scrollTop","scrollLeft","keyCode","srcElement","_fireDOMEvent","targets","synth","_findEventTargets","isMarker","containerPoint","latLngToContainerPoint","getLatLng","mouseEventToContainerPoint","layerPoint","containerPointToLayerPoint","latlng","layerPointToLatLng","nonBubblingEvents","h","clientHeight","paddingTop","paddingBottom","w","clientWidth","paddingRight","paddingLeft","height","width","_drawn","_resizeRequest","_checkMobileDevice","text_size","_isMobile","mobileMediaQuery","matchMedia","_clearBookLoaderTimeout","_force_progress","_loader_timeout","display","force","loader_template","loaderTemplate","body","DOMParser","parseFromString","children","Control","_locked","_id","getTime","parseInt","random","region","removeControl","addControl","onAdd","getRegion","area","getControlRegion","onRemove","screenX","screenY","getContainer","focus","widget","direction","control","addTo","_controlContainer","parts","tmp","slug","panel","slot","childElement","_classify","_controlRegions","PageControl","_control","querySelector","_className","_createButton","_fill","html","label","_bindEvents","link","setAttribute","s","unit","_unit","PagePrevious","PageNext","PageFirst","first","PageLast","pageNext","pagePrevious","pageFirst","pageLast","activeModal","FOCUSABLE_ELEMENTS","ACTIONABLE_ELEMENTS","Modal","onShow","onClose","_initializedEvents","actions","handlers","panelHTML","main","button_cls","modal","onClick","onKeydown","onModalTransition","button_id","button","close","closeModal","removeEventListeners","_resize","setFocusToFirstNode","addEventListeners","showModal","offsetHeight","offsetWidth","fraction","header","footer","nodes","querySelectorAll","map","focusableNodes","getFocusableNodes","maintainFocus","closeAfterAction","hasAttribute","actionableNodes","getActionableNodes","click","did_match","selector","getAttribute","focusedItemIndex","Contents","defaultTemplate","_modal","activate","_setupSkipLink","_process","items","tabindex","option","_createOption","subitems","toc","chapter","anchor","textContent","span","skipLink","ul","contents","Title","h1","_title","_divider","_section","bookTitle","PublicationMetadata","_publisher","_rights","publisher","rights","publicationMetadata","Preferences","_activated","updatePreferences","initializeForm","possible_fieldsets","layout","rootfiles","hasThemes","_fieldsets","cls","fieldset","fields","hasFields","field","inputs","input","checked","hint","_form","_createPanel","doUpdate","new_options","saveable_options","updateForm","deactivate","saveOptions","reopen","Fieldset","_current","TextSize","form","_input","_output","_preview","_actionReset","_updatePreview","saveable","fontSize","Display","scrolled_help","Theme","Rendition","rootfilePath","expr","rootfile","accessMode","Scale","transform","preferences","Widget","_onAddExtra","_updateTemplate","_updateClass","node","Button","Panel","Toggle","states","stateName","_resetState","_state","Citation","designMode","formatted","createRange","selectNode","sel","getSelection","removeAllRanges","addRange","flag","execCommand","_message","detach","citations","citation","format","text","createTextNode","_formatted","_initializeForm","_formatCitation","selected","Search","_data","_canceled","_processing","_article","searchString","openModalResults","openModalWaiting","submitQuery","_emptyArticle","_buildResults","searchUrl","XMLHttpRequest","status","response","send","hasChildNodes","lastChild","content","annotations","reset","highlight","highlight_off","search_results","result","cfiRange","snippet","chapterTitle","search","BibliographicInformation","dl","metadata_fields","metadata_fields_seen","idx","_formatDate","dt","dd","match","bibliographicInformation","Download","_configureDownloadForm","submit","download_links","size","download","Navigator","_setup","locations","_initializeNavigator","_createControl","_background","_status","_spanCurrentPercentage","_spanCurrentLocation","_spanTotalLocations","_update","_mouseDown","_initiated","percentageFromCfi","currentLocation","cfiFromPercentage","current","rangeBg","current_location","locationFromCfi","_last_delta","_last_value","_total","total","Bus","instance","bus","Events","ePub","require","EpubJS","_epubjs_ready","xpath","path","responseType","containerDoc","responseXML","sessionStorage","book_href","book_options","packagePath","useArchive","openAs","_book","epubjs","removeItem","loaded","navigation","_contents","package","ready","draw","spine","each","cfiBase","_locations","t","f","_rendition","manager","stage","generate","hooks","clear","destroy","settings","forceScrolledDocHeight","overflow","spread","_drawRendition","renderTo","_updateFontSize","status_index","_enableBookLoader","_disableBookLoader","register","inner","hash","_initializeReaderStyles","_queueTimeout","rootFilePath","newScrollTop","scrollBy","scrollHeight","promise","_navigate","section","guessed","path1","directory","navPath","path2","dirname","canonical","navigating","changed","_updateScale","reload","_selectTheme","_cached_location","add_max_img_styles","custom_stylesheet_rules","addStylesheetRules","_layout","columnWidth","view","box","book","mod","xyz","override","refresh","select","end","_metadata","_annotations","decodeURI","_annotationsBySectionIndex","createReader","Mock","__currentIndex","engines","COZY_EPUB_ENGINE","COZY_EPUB_ENGINE_HREF","_this","_arguments"],"mappings":"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"}
>>>>>>> 760e7fe... center justify pre-paginated+default
=======
{"version":3,"file":"cozy-sun-bear.js","sources":["../node_modules/url-polyfill/url-polyfill.js","../node_modules/classlist-polyfill/src/index.js","../src/core/Util.js","../src/core/Class.js","../src/core/Events.js","../src/core/Browser.js","../src/geometry/Point.js","../src/dom/DomEvent.Pointer.js","../src/dom/DomEvent.DoubleTap.js","../src/dom/DomEvent.js","../src/dom/DomUtil.js","../node_modules/lodash/isObject.js","../node_modules/lodash/_freeGlobal.js","../node_modules/lodash/_root.js","../node_modules/lodash/_Symbol.js","../node_modules/lodash/_getRawTag.js","../node_modules/lodash/_objectToString.js","../node_modules/lodash/_baseGetTag.js","../node_modules/lodash/isObjectLike.js","../node_modules/lodash/isFunction.js","../node_modules/lodash/_coreJsData.js","../node_modules/lodash/_isMasked.js","../node_modules/lodash/_toSource.js","../node_modules/lodash/_baseIsNative.js","../node_modules/lodash/_getValue.js","../node_modules/lodash/_getNative.js","../node_modules/lodash/_defineProperty.js","../node_modules/lodash/_baseAssignValue.js","../node_modules/lodash/eq.js","../node_modules/lodash/_assignValue.js","../node_modules/lodash/_copyObject.js","../node_modules/lodash/identity.js","../node_modules/lodash/_apply.js","../node_modules/lodash/_overRest.js","../node_modules/lodash/constant.js","../node_modules/lodash/_baseSetToString.js","../node_modules/lodash/_shortOut.js","../node_modules/lodash/_setToString.js","../node_modules/lodash/_baseRest.js","../node_modules/lodash/isLength.js","../node_modules/lodash/isArrayLike.js","../node_modules/lodash/_isIndex.js","../node_modules/lodash/_isIterateeCall.js","../node_modules/lodash/_createAssigner.js","../node_modules/lodash/_isPrototype.js","../node_modules/lodash/_baseTimes.js","../node_modules/lodash/_baseIsArguments.js","../node_modules/lodash/isArguments.js","../node_modules/lodash/isArray.js","../node_modules/lodash/stubFalse.js","../node_modules/lodash/isBuffer.js","../node_modules/lodash/_baseIsTypedArray.js","../node_modules/lodash/_baseUnary.js","../node_modules/lodash/_nodeUtil.js","../node_modules/lodash/isTypedArray.js","../node_modules/lodash/_arrayLikeKeys.js","../node_modules/lodash/_overArg.js","../node_modules/lodash/_nativeKeys.js","../node_modules/lodash/_baseKeys.js","../node_modules/lodash/keys.js","../node_modules/lodash/assign.js","../src/screenfull.js","../src/reader/Reader.js","../src/control/Control.js","../src/control/Control.Paging.js","../src/control/Modal.js","../src/control/Control.Contents.js","../src/control/Control.Title.js","../src/control/Control.PublicationMetadata.js","../src/control/Control.Preferences.js","../src/control/Control.Widget.js","../src/control/Control.Citation.js","../src/control/Control.Search.js","../src/control/Control.BibliographicInformation.js","../src/control/Control.Download.js","../src/control/Control.Navigator.js","../src/control/index.js","../src/core/Bus.js","../src/core/index.js","../src/epubjs.js","../node_modules/path-webpack/path.js","../src/reader/Reader.EpubJS.js","../src/reader/Reader.Mock.js","../src/reader/index.js"],"sourcesContent":["(function(global) {\r\n  /**\r\n   * Polyfill URLSearchParams\r\n   *\r\n   * Inspired from : https://github.com/WebReflection/url-search-params/blob/master/src/url-search-params.js\r\n   */\r\n\r\n  var checkIfIteratorIsSupported = function() {\r\n    try {\r\n      return !!Symbol.iterator;\r\n    } catch(error) {\r\n      return false;\r\n    }\r\n  };\r\n\r\n\r\n  var iteratorSupported = checkIfIteratorIsSupported();\r\n\r\n  var createIterator = function(items) {\r\n    var iterator = {\r\n      next: function() {\r\n        var value = items.shift();\r\n        return { done: value === void 0, value: value };\r\n      }\r\n    };\r\n\r\n    if(iteratorSupported) {\r\n      iterator[Symbol.iterator] = function() {\r\n        return iterator;\r\n      };\r\n    }\r\n\r\n    return iterator;\r\n  };\r\n\r\n  /**\r\n   * Search param name and values should be encoded according to https://url.spec.whatwg.org/#urlencoded-serializing\r\n   * encodeURIComponent() produces the same result except encoding spaces as `%20` instead of `+`.\r\n   */\r\n  var serializeParam = function(value) {\r\n    return encodeURIComponent(value).replace(/%20/g, '+');\r\n  };\r\n\r\n  var deserializeParam = function(value) {\r\n    return decodeURIComponent(value).replace(/\\+/g, ' ');\r\n  };\r\n\r\n  var polyfillURLSearchParams= function() {\r\n\r\n    var URLSearchParams = function(searchString) {\r\n      Object.defineProperty(this, '_entries', { value: {} });\r\n\r\n      if(typeof searchString === 'string') {\r\n        if(searchString !== '') {\r\n          searchString = searchString.replace(/^\\?/, '');\r\n          var attributes = searchString.split('&');\r\n          var attribute;\r\n          for(var i = 0; i < attributes.length; i++) {\r\n            attribute = attributes[i].split('=');\r\n            this.append(\r\n              deserializeParam(attribute[0]),\r\n              (attribute.length > 1) ? deserializeParam(attribute[1]) : ''\r\n            );\r\n          }\r\n        }\r\n      } else if(searchString instanceof URLSearchParams) {\r\n        var _this = this;\r\n        searchString.forEach(function(value, name) {\r\n          _this.append(value, name);\r\n        });\r\n      }\r\n    };\r\n\r\n    var proto = URLSearchParams.prototype;\r\n\r\n    proto.append = function(name, value) {\r\n      if(name in this._entries) {\r\n        this._entries[name].push(value.toString());\r\n      } else {\r\n        this._entries[name] = [value.toString()];\r\n      }\r\n    };\r\n\r\n    proto.delete = function(name) {\r\n      delete this._entries[name];\r\n    };\r\n\r\n    proto.get = function(name) {\r\n      return (name in this._entries) ? this._entries[name][0] : null;\r\n    };\r\n\r\n    proto.getAll = function(name) {\r\n      return (name in this._entries) ? this._entries[name].slice(0) : [];\r\n    };\r\n\r\n    proto.has = function(name) {\r\n      return (name in this._entries);\r\n    };\r\n\r\n    proto.set = function(name, value) {\r\n      this._entries[name] = [value.toString()];\r\n    };\r\n\r\n    proto.forEach = function(callback, thisArg) {\r\n      var entries;\r\n      for(var name in this._entries) {\r\n        if(this._entries.hasOwnProperty(name)) {\r\n          entries = this._entries[name];\r\n          for(var i = 0; i < entries.length; i++) {\r\n            callback.call(thisArg, entries[i], name, this);\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    proto.keys = function() {\r\n      var items = [];\r\n      this.forEach(function(value, name) { items.push(name); });\r\n      return createIterator(items);\r\n    };\r\n\r\n    proto.values = function() {\r\n      var items = [];\r\n      this.forEach(function(value) { items.push(value); });\r\n      return createIterator(items);\r\n    };\r\n\r\n    proto.entries = function() {\r\n      var items = [];\r\n      this.forEach(function(value, name) { items.push([name, value]); });\r\n      return createIterator(items);\r\n    };\r\n\r\n    if(iteratorSupported) {\r\n      proto[Symbol.iterator] = proto.entries;\r\n    }\r\n\r\n    proto.toString = function() {\r\n      var searchString = '';\r\n      this.forEach(function(value, name) {\r\n        if(searchString.length > 0) searchString+= '&';\r\n        searchString += serializeParam(name) + '=' + serializeParam(value);\r\n      });\r\n      return searchString;\r\n    };\r\n\r\n    global.URLSearchParams = URLSearchParams;\r\n  };\r\n\r\n  if(!('URLSearchParams' in global) || (new URLSearchParams('?a=1').toString() !== 'a=1')) {\r\n    polyfillURLSearchParams();\r\n  }\r\n\r\n  // HTMLAnchorElement\r\n\r\n})(\r\n  (typeof global !== 'undefined') ? global\r\n    : ((typeof window !== 'undefined') ? window\r\n    : ((typeof self !== 'undefined') ? self : this))\r\n);\r\n\r\n(function(global) {\r\n  /**\r\n   * Polyfill URL\r\n   *\r\n   * Inspired from : https://github.com/arv/DOM-URL-Polyfill/blob/master/src/url.js\r\n   */\r\n\r\n  var checkIfURLIsSupported = function() {\r\n    try {\r\n      var u = new URL('b', 'http://a');\r\n      u.pathname = 'c%20d';\r\n      return (u.href === 'http://a/c%20d') && u.searchParams;\r\n    } catch(e) {\r\n      return false;\r\n    }\r\n  };\r\n\r\n\r\n  var polyfillURL = function() {\r\n    var _URL = global.URL;\r\n\r\n    var URL = function(url, base) {\r\n      if(typeof url !== 'string') url = String(url);\r\n\r\n      var doc = document.implementation.createHTMLDocument('');\r\n      window.doc = doc;\r\n      if(base) {\r\n        var baseElement = doc.createElement('base');\r\n        baseElement.href = base;\r\n        doc.head.appendChild(baseElement);\r\n      }\r\n\r\n      var anchorElement = doc.createElement('a');\r\n      anchorElement.href = url;\r\n      doc.body.appendChild(anchorElement);\r\n      anchorElement.href = anchorElement.href; // force href to refresh\r\n\r\n      if(anchorElement.protocol === ':' || !/:/.test(anchorElement.href)) {\r\n        throw new TypeError('Invalid URL');\r\n      }\r\n\r\n      Object.defineProperty(this, '_anchorElement', {\r\n        value: anchorElement\r\n      });\r\n    };\r\n\r\n    var proto = URL.prototype;\r\n\r\n    var linkURLWithAnchorAttribute = function(attributeName) {\r\n      Object.defineProperty(proto, attributeName, {\r\n        get: function() {\r\n          return this._anchorElement[attributeName];\r\n        },\r\n        set: function(value) {\r\n          this._anchorElement[attributeName] = value;\r\n        },\r\n        enumerable: true\r\n      });\r\n    };\r\n\r\n    ['hash', 'host', 'hostname', 'port', 'protocol', 'search']\r\n    .forEach(function(attributeName) {\r\n      linkURLWithAnchorAttribute(attributeName);\r\n    });\r\n\r\n    Object.defineProperties(proto, {\r\n\r\n      'toString': {\r\n        get: function() {\r\n          var _this = this;\r\n          return function() {\r\n            return _this.href;\r\n          };\r\n        }\r\n      },\r\n\r\n      'href' : {\r\n        get: function() {\r\n          return this._anchorElement.href.replace(/\\?$/,'');\r\n        },\r\n        set: function(value) {\r\n          this._anchorElement.href = value;\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'pathname' : {\r\n        get: function() {\r\n          return this._anchorElement.pathname.replace(/(^\\/?)/,'/');\r\n        },\r\n        set: function(value) {\r\n          this._anchorElement.pathname = value;\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'origin': {\r\n        get: function() {\r\n          // get expected port from protocol\r\n          var expectedPort = {'http:': 80, 'https:': 443, 'ftp:': 21}[this._anchorElement.protocol];\r\n          // add port to origin if, expected port is different than actual port\r\n          // and it is not empty f.e http://foo:8080\r\n          // 8080 != 80 && 8080 != ''\r\n          var addPortToOrigin = this._anchorElement.port != expectedPort &&\r\n            this._anchorElement.port !== ''\r\n\r\n          return this._anchorElement.protocol +\r\n            '//' +\r\n            this._anchorElement.hostname +\r\n            (addPortToOrigin ? (':' + this._anchorElement.port) : '');\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'password': { // TODO\r\n        get: function() {\r\n          return '';\r\n        },\r\n        set: function(value) {\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'username': { // TODO\r\n        get: function() {\r\n          return '';\r\n        },\r\n        set: function(value) {\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'searchParams': {\r\n        get: function() {\r\n          var searchParams = new URLSearchParams(this.search);\r\n          var _this = this;\r\n          ['append', 'delete', 'set'].forEach(function(methodName) {\r\n            var method = searchParams[methodName];\r\n            searchParams[methodName] = function() {\r\n              method.apply(searchParams, arguments);\r\n              _this.search = searchParams.toString();\r\n            };\r\n          });\r\n          return searchParams;\r\n        },\r\n        enumerable: true\r\n      }\r\n    });\r\n\r\n    URL.createObjectURL = function(blob) {\r\n      return _URL.createObjectURL.apply(_URL, arguments);\r\n    };\r\n\r\n    URL.revokeObjectURL = function(url) {\r\n      return _URL.revokeObjectURL.apply(_URL, arguments);\r\n    };\r\n\r\n    global.URL = URL;\r\n\r\n  };\r\n\r\n  if(!checkIfURLIsSupported()) {\r\n    polyfillURL();\r\n  }\r\n\r\n  if((global.location !== void 0) && !('origin' in global.location)) {\r\n    var getOrigin = function() {\r\n      return global.location.protocol + '//' + global.location.hostname + (global.location.port ? (':' + global.location.port) : '');\r\n    };\r\n\r\n    try {\r\n      Object.defineProperty(global.location, 'origin', {\r\n        get: getOrigin,\r\n        enumerable: true\r\n      });\r\n    } catch(e) {\r\n      setInterval(function() {\r\n        global.location.origin = getOrigin();\r\n      }, 100);\r\n    }\r\n  }\r\n\r\n})(\r\n  (typeof global !== 'undefined') ? global\r\n    : ((typeof window !== 'undefined') ? window\r\n    : ((typeof self !== 'undefined') ? self : this))\r\n);\r\n","/*\n * classList.js: Cross-browser full element.classList implementation.\n * 1.1.20170427\n *\n * By Eli Grey, http://eligrey.com\n * License: Dedicated to the public domain.\n *   See https://github.com/eligrey/classList.js/blob/master/LICENSE.md\n */\n\n/*global self, document, DOMException */\n\n/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js */\n\nif (\"document\" in window.self) {\n\n// Full polyfill for browsers with no classList support\n// Including IE < Edge missing SVGElement.classList\nif (!(\"classList\" in document.createElement(\"_\")) \n\t|| document.createElementNS && !(\"classList\" in document.createElementNS(\"http://www.w3.org/2000/svg\",\"g\"))) {\n\n(function (view) {\n\n\"use strict\";\n\nif (!('Element' in view)) return;\n\nvar\n\t  classListProp = \"classList\"\n\t, protoProp = \"prototype\"\n\t, elemCtrProto = view.Element[protoProp]\n\t, objCtr = Object\n\t, strTrim = String[protoProp].trim || function () {\n\t\treturn this.replace(/^\\s+|\\s+$/g, \"\");\n\t}\n\t, arrIndexOf = Array[protoProp].indexOf || function (item) {\n\t\tvar\n\t\t\t  i = 0\n\t\t\t, len = this.length\n\t\t;\n\t\tfor (; i < len; i++) {\n\t\t\tif (i in this && this[i] === item) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t}\n\t// Vendors: please allow content code to instantiate DOMExceptions\n\t, DOMEx = function (type, message) {\n\t\tthis.name = type;\n\t\tthis.code = DOMException[type];\n\t\tthis.message = message;\n\t}\n\t, checkTokenAndGetIndex = function (classList, token) {\n\t\tif (token === \"\") {\n\t\t\tthrow new DOMEx(\n\t\t\t\t  \"SYNTAX_ERR\"\n\t\t\t\t, \"An invalid or illegal string was specified\"\n\t\t\t);\n\t\t}\n\t\tif (/\\s/.test(token)) {\n\t\t\tthrow new DOMEx(\n\t\t\t\t  \"INVALID_CHARACTER_ERR\"\n\t\t\t\t, \"String contains an invalid character\"\n\t\t\t);\n\t\t}\n\t\treturn arrIndexOf.call(classList, token);\n\t}\n\t, ClassList = function (elem) {\n\t\tvar\n\t\t\t  trimmedClasses = strTrim.call(elem.getAttribute(\"class\") || \"\")\n\t\t\t, classes = trimmedClasses ? trimmedClasses.split(/\\s+/) : []\n\t\t\t, i = 0\n\t\t\t, len = classes.length\n\t\t;\n\t\tfor (; i < len; i++) {\n\t\t\tthis.push(classes[i]);\n\t\t}\n\t\tthis._updateClassName = function () {\n\t\t\telem.setAttribute(\"class\", this.toString());\n\t\t};\n\t}\n\t, classListProto = ClassList[protoProp] = []\n\t, classListGetter = function () {\n\t\treturn new ClassList(this);\n\t}\n;\n// Most DOMException implementations don't allow calling DOMException's toString()\n// on non-DOMExceptions. Error's toString() is sufficient here.\nDOMEx[protoProp] = Error[protoProp];\nclassListProto.item = function (i) {\n\treturn this[i] || null;\n};\nclassListProto.contains = function (token) {\n\ttoken += \"\";\n\treturn checkTokenAndGetIndex(this, token) !== -1;\n};\nclassListProto.add = function () {\n\tvar\n\t\t  tokens = arguments\n\t\t, i = 0\n\t\t, l = tokens.length\n\t\t, token\n\t\t, updated = false\n\t;\n\tdo {\n\t\ttoken = tokens[i] + \"\";\n\t\tif (checkTokenAndGetIndex(this, token) === -1) {\n\t\t\tthis.push(token);\n\t\t\tupdated = true;\n\t\t}\n\t}\n\twhile (++i < l);\n\n\tif (updated) {\n\t\tthis._updateClassName();\n\t}\n};\nclassListProto.remove = function () {\n\tvar\n\t\t  tokens = arguments\n\t\t, i = 0\n\t\t, l = tokens.length\n\t\t, token\n\t\t, updated = false\n\t\t, index\n\t;\n\tdo {\n\t\ttoken = tokens[i] + \"\";\n\t\tindex = checkTokenAndGetIndex(this, token);\n\t\twhile (index !== -1) {\n\t\t\tthis.splice(index, 1);\n\t\t\tupdated = true;\n\t\t\tindex = checkTokenAndGetIndex(this, token);\n\t\t}\n\t}\n\twhile (++i < l);\n\n\tif (updated) {\n\t\tthis._updateClassName();\n\t}\n};\nclassListProto.toggle = function (token, force) {\n\ttoken += \"\";\n\n\tvar\n\t\t  result = this.contains(token)\n\t\t, method = result ?\n\t\t\tforce !== true && \"remove\"\n\t\t:\n\t\t\tforce !== false && \"add\"\n\t;\n\n\tif (method) {\n\t\tthis[method](token);\n\t}\n\n\tif (force === true || force === false) {\n\t\treturn force;\n\t} else {\n\t\treturn !result;\n\t}\n};\nclassListProto.toString = function () {\n\treturn this.join(\" \");\n};\n\nif (objCtr.defineProperty) {\n\tvar classListPropDesc = {\n\t\t  get: classListGetter\n\t\t, enumerable: true\n\t\t, configurable: true\n\t};\n\ttry {\n\t\tobjCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\n\t} catch (ex) { // IE 8 doesn't support enumerable:true\n\t\t// adding undefined to fight this issue https://github.com/eligrey/classList.js/issues/36\n\t\t// modernie IE8-MSW7 machine has IE8 8.0.6001.18702 and is affected\n\t\tif (ex.number === undefined || ex.number === -0x7FF5EC54) {\n\t\t\tclassListPropDesc.enumerable = false;\n\t\t\tobjCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\n\t\t}\n\t}\n} else if (objCtr[protoProp].__defineGetter__) {\n\telemCtrProto.__defineGetter__(classListProp, classListGetter);\n}\n\n}(window.self));\n\n}\n\n// There is full or partial native classList support, so just check if we need\n// to normalize the add/remove and toggle APIs.\n\n(function () {\n\t\"use strict\";\n\n\tvar testElement = document.createElement(\"_\");\n\n\ttestElement.classList.add(\"c1\", \"c2\");\n\n\t// Polyfill for IE 10/11 and Firefox <26, where classList.add and\n\t// classList.remove exist but support only one argument at a time.\n\tif (!testElement.classList.contains(\"c2\")) {\n\t\tvar createMethod = function(method) {\n\t\t\tvar original = DOMTokenList.prototype[method];\n\n\t\t\tDOMTokenList.prototype[method] = function(token) {\n\t\t\t\tvar i, len = arguments.length;\n\n\t\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t\ttoken = arguments[i];\n\t\t\t\t\toriginal.call(this, token);\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t\tcreateMethod('add');\n\t\tcreateMethod('remove');\n\t}\n\n\ttestElement.classList.toggle(\"c3\", false);\n\n\t// Polyfill for IE 10 and Firefox <24, where classList.toggle does not\n\t// support the second argument.\n\tif (testElement.classList.contains(\"c3\")) {\n\t\tvar _toggle = DOMTokenList.prototype.toggle;\n\n\t\tDOMTokenList.prototype.toggle = function(token, force) {\n\t\t\tif (1 in arguments && !this.contains(token) === !force) {\n\t\t\t\treturn force;\n\t\t\t} else {\n\t\t\t\treturn _toggle.call(this, token);\n\t\t\t}\n\t\t};\n\n\t}\n\n\ttestElement = null;\n}());\n\n}\n","/*\n * @namespace Util\n *\n * Various utility functions, used by Leaflet internally.\n */\n\n// @function extend(dest: Object, src?: Object): Object\n// Merges the properties of the `src` object (or multiple objects) into `dest` object and returns the latter. Has an `L.extend` shortcut.\nexport function extend(dest) {\n    var i, j, len, src;\n\n    for (j = 1, len = arguments.length; j < len; j++) {\n        src = arguments[j];\n        for (i in src) {\n            dest[i] = src[i];\n        }\n    }\n    return dest;\n}\n\n// @function create(proto: Object, properties?: Object): Object\n// Compatibility polyfill for [Object.create](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/create)\nexport var create = Object.create || (function () {\n    function F() {}\n    return function (proto) {\n        F.prototype = proto;\n        return new F();\n    };\n})();\n\n// @function bind(fn: Function, …): Function\n// Returns a new function bound to the arguments passed, like [Function.prototype.bind](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Function/bind).\n// Has a `L.bind()` shortcut.\nexport function bind(fn, obj) {\n    var slice = Array.prototype.slice;\n\n    if (fn.bind) {\n        return fn.bind.apply(fn, slice.call(arguments, 1));\n    }\n\n    var args = slice.call(arguments, 2);\n\n    return function () {\n        return fn.apply(obj, args.length ? args.concat(slice.call(arguments)) : arguments);\n    };\n}\n\n// @property lastId: Number\n// Last unique ID used by [`stamp()`](#util-stamp)\nexport var lastId = 0;\n\n// @function stamp(obj: Object): Number\n// Returns the unique ID of an object, assiging it one if it doesn't have it.\nexport function stamp(obj) {\n    /*eslint-disable */\n    obj._cozy_id = obj._cozy_id || ++lastId;\n    return obj._cozy_id; /* not leaflet */\n    /*eslint-enable */\n}\n\n// @function throttle(fn: Function, time: Number, context: Object): Function\n// Returns a function which executes function `fn` with the given scope `context`\n// (so that the `this` keyword refers to `context` inside `fn`'s code). The function\n// `fn` will be called no more than one time per given amount of `time`. The arguments\n// received by the bound function will be any arguments passed when binding the\n// function, followed by any arguments passed when invoking the bound function.\n// Has an `L.throttle` shortcut.\nexport function throttle(fn, time, context) {\n    var lock, args, wrapperFn, later;\n\n    later = function () {\n        // reset lock and call if queued\n        lock = false;\n        if (args) {\n            wrapperFn.apply(context, args);\n            args = false;\n        }\n    };\n\n    wrapperFn = function () {\n        if (lock) {\n            // called too soon, queue to call later\n            args = arguments;\n\n        } else {\n            // call and lock until later\n            fn.apply(context, arguments);\n            setTimeout(later, time);\n            lock = true;\n        }\n    };\n\n    return wrapperFn;\n}\n\n// @function wrapNum(num: Number, range: Number[], includeMax?: Boolean): Number\n// Returns the number `num` modulo `range` in such a way so it lies within\n// `range[0]` and `range[1]`. The returned value will be always smaller than\n// `range[1]` unless `includeMax` is set to `true`.\nexport function wrapNum(x, range, includeMax) {\n    var max = range[1],\n        min = range[0],\n        d = max - min;\n    return x === max && includeMax ? x : ((x - min) % d + d) % d + min;\n}\n\n// @function falseFn(): Function\n// Returns a function which always returns `false`.\nexport function falseFn() { return false; }\n\n// @function formatNum(num: Number, digits?: Number): Number\n// Returns the number `num` rounded to `digits` decimals, or to 5 decimals by default.\nexport function formatNum(num, digits) {\n    var pow = Math.pow(10, digits || 5);\n    return Math.round(num * pow) / pow;\n}\n\n// @function isNumeric(num: Number): Boolean\n// Returns whether num is actually numeric\nexport function isNumeric(num) {\n  return !isNaN(parseFloat(num)) && isFinite(num);\n}\n\n// @function trim(str: String): String\n// Compatibility polyfill for [String.prototype.trim](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String/Trim)\nexport function trim(str) {\n    return str.trim ? str.trim() : str.replace(/^\\s+|\\s+$/g, '');\n}\n\n// @function splitWords(str: String): String[]\n// Trims and splits the string on whitespace and returns the array of parts.\nexport function splitWords(str) {\n    return trim(str).split(/\\s+/);\n}\n\n// @function setOptions(obj: Object, options: Object): Object\n// Merges the given properties to the `options` of the `obj` object, returning the resulting options. See `Class options`. Has an `L.setOptions` shortcut.\nexport function setOptions(obj, options) {\n    if (!obj.hasOwnProperty('options')) {\n        obj.options = obj.options ? create(obj.options) : {};\n    }\n    for (var i in options) {\n        obj.options[i] = options[i];\n    }\n    return obj.options;\n}\n\n// @function getParamString(obj: Object, existingUrl?: String, uppercase?: Boolean): String\n// Converts an object into a parameter URL string, e.g. `{a: \"foo\", b: \"bar\"}`\n// translates to `'?a=foo&b=bar'`. If `existingUrl` is set, the parameters will\n// be appended at the end. If `uppercase` is `true`, the parameter names will\n// be uppercased (e.g. `'?A=foo&B=bar'`)\nexport function getParamString(obj, existingUrl, uppercase) {\n    var params = [];\n    for (var i in obj) {\n        params.push(encodeURIComponent(uppercase ? i.toUpperCase() : i) + '=' + encodeURIComponent(obj[i]));\n    }\n    return ((!existingUrl || existingUrl.indexOf('?') === -1) ? '?' : '&') + params.join('&');\n}\n\nvar templateRe = /\\{ *([\\w_\\-]+) *\\}/g;\n\n// @function template(str: String, data: Object): String\n// Simple templating facility, accepts a template string of the form `'Hello {a}, {b}'`\n// and a data object like `{a: 'foo', b: 'bar'}`, returns evaluated string\n// `('Hello foo, bar')`. You can also specify functions instead of strings for\n// data values — they will be evaluated passing `data` as an argument.\nexport function template(str, data) {\n    return str.replace(templateRe, function (str, key) {\n        var value = data[key];\n\n        if (value === undefined) {\n            throw new Error('No value provided for variable ' + str);\n\n        } else if (typeof value === 'function') {\n            value = value(data);\n        }\n        return value;\n    });\n}\n\n// @function isArray(obj): Boolean\n// Compatibility polyfill for [Array.isArray](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array/isArray)\nexport var isArray = Array.isArray || function (obj) {\n    return (Object.prototype.toString.call(obj) === '[object Array]');\n};\n\n// @function indexOf(array: Array, el: Object): Number\n// Compatibility polyfill for [Array.prototype.indexOf](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf)\nexport function indexOf(array, el) {\n    for (var i = 0; i < array.length; i++) {\n        if (array[i] === el) { return i; }\n    }\n    return -1;\n}\n\n// @property emptyImageUrl: String\n// Data URI string containing a base64-encoded empty GIF image.\n// Used as a hack to free memory from unused images on WebKit-powered\n// mobile devices (by setting image `src` to this string).\nexport var emptyImageUrl = 'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=';\n\n// inspired by http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n\nfunction getPrefixed(name) {\n    return window['webkit' + name] || window['moz' + name] || window['ms' + name];\n}\n\nvar lastTime = 0;\n\n// fallback for IE 7-8\nfunction timeoutDefer(fn) {\n    var time = +new Date(),\n        timeToCall = Math.max(0, 16 - (time - lastTime));\n\n    lastTime = time + timeToCall;\n    return window.setTimeout(fn, timeToCall);\n}\n\nexport var requestFn = window.requestAnimationFrame || getPrefixed('RequestAnimationFrame') || timeoutDefer;\nexport var cancelFn = window.cancelAnimationFrame || getPrefixed('CancelAnimationFrame') ||\n        getPrefixed('CancelRequestAnimationFrame') || function (id) { window.clearTimeout(id); };\n\n// @function requestAnimFrame(fn: Function, context?: Object, immediate?: Boolean): Number\n// Schedules `fn` to be executed when the browser repaints. `fn` is bound to\n// `context` if given. When `immediate` is set, `fn` is called immediately if\n// the browser doesn't have native support for\n// [`window.requestAnimationFrame`](https://developer.mozilla.org/docs/Web/API/window/requestAnimationFrame),\n// otherwise it's delayed. Returns a request ID that can be used to cancel the request.\nexport function requestAnimFrame(fn, context, immediate) {\n    if (immediate && requestFn === timeoutDefer) {\n        fn.call(context);\n    } else {\n        return requestFn.call(window, bind(fn, context));\n    }\n}\n\n// @function cancelAnimFrame(id: Number): undefined\n// Cancels a previous `requestAnimFrame`. See also [window.cancelAnimationFrame](https://developer.mozilla.org/docs/Web/API/window/cancelAnimationFrame).\nexport function cancelAnimFrame(id) {\n    if (id) {\n        cancelFn.call(window, id);\n    }\n}\n\nexport var loader = {\n    js: function(url) {\n        var handler = { _resolved: false };\n        handler.callbacks = [];\n        handler.error = [];\n        handler.then = function(cb) {\n            handler.callbacks.push(cb);\n            if ( handler._resolved ) { return handler.resolve(); }\n            return handler;\n        }\n        handler.catch = function(cb) {\n            handler.error.push(cb);\n            if ( handler._resolved ) { return handler.reject(); }\n            return handler;\n        }\n        handler.resolve = function(_argv) {\n            // var _argv;\n            handler._resolved = true;\n            while ( handler.callbacks.length ) {\n                var cb = handler.callbacks.shift();\n                var retval;\n                try {\n                    _argv = cb(_argv);\n                } catch(e) {\n                    console.log(e);\n                    handler.reject(e);\n                    break;\n                }\n            }\n            return handler;\n        }\n\n        handler.reject = function(e) {\n            while ( handler.error.length ) {\n                var cb = handler.error.shift();\n                cb(e);\n            }\n            console.log(e);\n            console.trace();\n            return handler;\n        }\n\n        if ( url == undefined ) {\n            handler._resolved = true;\n            return handler;\n        }\n\n        var element = document.createElement('script');\n\n        element.onload = function() {\n          handler.resolve(url);\n        };\n        element.onerror = function() {\n          handler.catch.apply(arguments);\n        };\n\n        element.async = true;\n        var parent = 'body';\n        var attr = 'src';\n        element[attr] = url;\n        document[parent].appendChild(element);\n\n        console.log(\"AHOY APPENDED\", url);\n\n        return handler;\n    }\n}","import * as Util from './Util';\r\n\r\n// @class Class\r\n// @aka L.Class\r\n\r\n// @section\r\n// @uninheritable\r\n\r\n// Thanks to John Resig and Dean Edwards for inspiration!\r\n\r\nexport function Class() {}\r\n\r\nClass.extend = function (props) {\r\n\r\n\t// @function extend(props: Object): Function\r\n\t// [Extends the current class](#class-inheritance) given the properties to be included.\r\n\t// Returns a Javascript function that is a class constructor (to be called with `new`).\r\n\tvar NewClass = function () {\r\n\r\n\t\t// call the constructor\r\n\t\tif (this.initialize) {\r\n\t\t\tthis.initialize.apply(this, arguments);\r\n\t\t}\r\n\r\n\t\t// call all constructor hooks\r\n\t\tthis.callInitHooks();\r\n\t};\r\n\r\n\tvar parentProto = NewClass.__super__ = this.prototype;\r\n\r\n\tvar proto = Util.create(parentProto);\r\n\tproto.constructor = NewClass;\r\n\r\n\tNewClass.prototype = proto;\r\n\r\n\t// inherit parent's statics\r\n\tfor (var i in this) {\r\n\t\tif (this.hasOwnProperty(i) && i !== 'prototype') {\r\n\t\t\tNewClass[i] = this[i];\r\n\t\t}\r\n\t}\r\n\r\n\t// mix static properties into the class\r\n\tif (props.statics) {\r\n\t\tUtil.extend(NewClass, props.statics);\r\n\t\tdelete props.statics;\r\n\t}\r\n\r\n\t// mix includes into the prototype\r\n\tif (props.includes) {\r\n\t\tcheckDeprecatedMixinEvents(props.includes);\r\n\t\tUtil.extend.apply(null, [proto].concat(props.includes));\r\n\t\tdelete props.includes;\r\n\t}\r\n\r\n\t// merge options\r\n\tif (proto.options) {\r\n\t\tprops.options = Util.extend(Util.create(proto.options), props.options);\r\n\t}\r\n\r\n\t// mix given properties into the prototype\r\n\tUtil.extend(proto, props);\r\n\t\r\n\tproto._initHooks = [];\r\n\r\n\t// add method for calling all hooks\r\n\tproto.callInitHooks = function () {\r\n\r\n\t\tif (this._initHooksCalled) { return; }\r\n\r\n\t\tif (parentProto.callInitHooks) {\r\n\t\t\tparentProto.callInitHooks.call(this);\r\n\t\t}\r\n\r\n\t\tthis._initHooksCalled = true;\r\n\r\n\t\tfor (var i = 0, len = proto._initHooks.length; i < len; i++) {\r\n\t\t\tproto._initHooks[i].call(this);\r\n\t\t}\r\n\t};\r\n\r\n\treturn NewClass;\r\n};\r\n\r\n\r\n// @function include(properties: Object): this\r\n// [Includes a mixin](#class-includes) into the current class.\r\nClass.include = function (props) {\r\n\tUtil.extend(this.prototype, props);\r\n\treturn this;\r\n};\r\n\r\n// @function mergeOptions(options: Object): this\r\n// [Merges `options`](#class-options) into the defaults of the class.\r\nClass.mergeOptions = function (options) {\r\n\tUtil.extend(this.prototype.options, options);\r\n\treturn this;\r\n};\r\n\r\n// @function addInitHook(fn: Function): this\r\n// Adds a [constructor hook](#class-constructor-hooks) to the class.\r\nClass.addInitHook = function (fn) { // (Function) || (String, args...)\r\n\tvar args = Array.prototype.slice.call(arguments, 1);\r\n\r\n\tvar init = typeof fn === 'function' ? fn : function () {\r\n\t\tthis[fn].apply(this, args);\r\n\t};\r\n\r\n\tthis.prototype._initHooks = this.prototype._initHooks || [];\r\n\tthis.prototype._initHooks.push(init);\r\n\treturn this;\r\n};\r\n\r\nfunction checkDeprecatedMixinEvents(includes) {\r\n\tif (!cozy || !cozy.Mixin) { return; }\r\n\r\n\tincludes = cozy.Util.isArray(includes) ? includes : [includes];\r\n\r\n\t// for (var i = 0; i < includes.length; i++) {\r\n\t// \tif (includes[i] === cozy.Mixin.Events) {\r\n\t// \t\tconsole.warn('Deprecated include of cozy.Mixin.Events: ' +\r\n\t// \t\t\t'this property will be removed in future releases, ' +\r\n\t// \t\t\t'please inherit from cozy.Evented instead.', new Error().stack);\r\n\t// \t}\r\n\t// }\r\n}\r\n","import {Class} from './Class';\r\nimport * as Util from './Util';\r\n\r\n/*\r\n * @class Evented\r\n * @aka L.Evented\r\n * @inherits Class\r\n *\r\n * A set of methods shared between event-powered classes (like `Map` and `Marker`). Generally, events allow you to execute some function when something happens with an object (e.g. the user clicks on the map, causing the map to fire `'click'` event).\r\n *\r\n * @example\r\n *\r\n * ```js\r\n * map.on('click', function(e) {\r\n * \talert(e.latlng);\r\n * } );\r\n * ```\r\n *\r\n * Leaflet deals with event listeners by reference, so if you want to add a listener and then remove it, define it as a function:\r\n *\r\n * ```js\r\n * function onClick(e) { ... }\r\n *\r\n * map.on('click', onClick);\r\n * map.off('click', onClick);\r\n * ```\r\n */\r\n\r\nexport var Evented = Class.extend({\r\n\r\n\t/* @method on(type: String, fn: Function, context?: Object): this\r\n\t * Adds a listener function (`fn`) to a particular event type of the object. You can optionally specify the context of the listener (object the this keyword will point to). You can also pass several space-separated types (e.g. `'click dblclick'`).\r\n\t *\r\n\t * @alternative\r\n\t * @method on(eventMap: Object): this\r\n\t * Adds a set of type/listener pairs, e.g. `{click: onClick, mousemove: onMouseMove}`\r\n\t */\r\n\ton: function (types, fn, context) {\r\n\r\n\t\t// types can be a map of types/handlers\r\n\t\tif (typeof types === 'object') {\r\n\t\t\tfor (var type in types) {\r\n\t\t\t\t// we don't process space-separated events here for performance;\r\n\t\t\t\t// it's a hot path since Layer uses the on(obj) syntax\r\n\t\t\t\tthis._on(type, types[type], fn);\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\t// types can be a string of space-separated words\r\n\t\t\ttypes = Util.splitWords(types);\r\n\r\n\t\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\t\tthis._on(types[i], fn, context);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t/* @method off(type: String, fn?: Function, context?: Object): this\r\n\t * Removes a previously added listener function. If no function is specified, it will remove all the listeners of that particular event from the object. Note that if you passed a custom context to `on`, you must pass the same context to `off` in order to remove the listener.\r\n\t *\r\n\t * @alternative\r\n\t * @method off(eventMap: Object): this\r\n\t * Removes a set of type/listener pairs.\r\n\t *\r\n\t * @alternative\r\n\t * @method off: this\r\n\t * Removes all listeners to all events on the object.\r\n\t */\r\n\toff: function (types, fn, context) {\r\n\r\n\t\tif (!types) {\r\n\t\t\t// clear all listeners if called without arguments\r\n\t\t\tdelete this._events;\r\n\r\n\t\t} else if (typeof types === 'object') {\r\n\t\t\tfor (var type in types) {\r\n\t\t\t\tthis._off(type, types[type], fn);\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\ttypes = Util.splitWords(types);\r\n\r\n\t\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\t\tthis._off(types[i], fn, context);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// attach listener (without syntactic sugar now)\r\n\t_on: function (type, fn, context) {\r\n\t\tthis._events = this._events || {};\r\n\r\n\t\t/* get/init listeners for type */\r\n\t\tvar typeListeners = this._events[type];\r\n\t\tif (!typeListeners) {\r\n\t\t\ttypeListeners = [];\r\n\t\t\tthis._events[type] = typeListeners;\r\n\t\t}\r\n\r\n\t\tif (context === this) {\r\n\t\t\t// Less memory footprint.\r\n\t\t\tcontext = undefined;\r\n\t\t}\r\n\t\tvar newListener = {fn: fn, ctx: context},\r\n\t\t    listeners = typeListeners;\r\n\r\n\t\t// check if fn already there\r\n\t\tfor (var i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\tif (listeners[i].fn === fn && listeners[i].ctx === context) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlisteners.push(newListener);\r\n\t},\r\n\r\n\t_off: function (type, fn, context) {\r\n\t\tvar listeners,\r\n\t\t    i,\r\n\t\t    len;\r\n\r\n\t\tif (!this._events) { return; }\r\n\r\n\t\tlisteners = this._events[type];\r\n\r\n\t\tif (!listeners) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!fn) {\r\n\t\t\t// Set all removed listeners to noop so they are not called if remove happens in fire\r\n\t\t\tfor (i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\t\tlisteners[i].fn = Util.falseFn;\r\n\t\t\t}\r\n\t\t\t// clear all listeners for a type if function isn't specified\r\n\t\t\tdelete this._events[type];\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (context === this) {\r\n\t\t\tcontext = undefined;\r\n\t\t}\r\n\r\n\t\tif (listeners) {\r\n\r\n\t\t\t// find fn and remove it\r\n\t\t\tfor (i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\t\tvar l = listeners[i];\r\n\t\t\t\tif (l.ctx !== context) { continue; }\r\n\t\t\t\tif (l.fn === fn) {\r\n\r\n\t\t\t\t\t// set the removed listener to noop so that's not called if remove happens in fire\r\n\t\t\t\t\tl.fn = Util.falseFn;\r\n\r\n\t\t\t\t\tif (this._firingCount) {\r\n\t\t\t\t\t\t/* copy array in case events are being fired */\r\n\t\t\t\t\t\tthis._events[type] = listeners = listeners.slice();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlisteners.splice(i, 1);\r\n\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t// @method fire(type: String, data?: Object, propagate?: Boolean): this\r\n\t// Fires an event of the specified type. You can optionally provide an data\r\n\t// object — the first argument of the listener function will contain its\r\n\t// properties. The event can optionally be propagated to event parents.\r\n\tfire: function (type, data, propagate) {\r\n\t\tif (!this.listens(type, propagate)) { return this; }\r\n\r\n\t\tvar event = Util.extend({}, data, {type: type, target: this});\r\n\r\n\t\tif (this._events) {\r\n\t\t\tvar listeners = this._events[type];\r\n\r\n\t\t\tif (listeners) {\r\n\t\t\t\tthis._firingCount = (this._firingCount + 1) || 1;\r\n\t\t\t\tfor (var i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\t\t\tvar l = listeners[i];\r\n\t\t\t\t\tl.fn.call(l.ctx || this, event);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._firingCount--;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (propagate) {\r\n\t\t\t// propagate the event to parents (set with addEventParent)\r\n\t\t\tthis._propagateEvent(event);\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method listens(type: String): Boolean\r\n\t// Returns `true` if a particular event type has any listeners attached to it.\r\n\tlistens: function (type, propagate) {\r\n\t\tvar listeners = this._events && this._events[type];\r\n\t\tif (listeners && listeners.length) { return true; }\r\n\r\n\t\tif (propagate) {\r\n\t\t\t// also check parents for listeners if event propagates\r\n\t\t\tfor (var id in this._eventParents) {\r\n\t\t\t\tif (this._eventParents[id].listens(type, propagate)) { return true; }\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\r\n\t// @method once(…): this\r\n\t// Behaves as [`on(…)`](#evented-on), except the listener will only get fired once and then removed.\r\n\tonce: function (types, fn, context) {\r\n\r\n\t\tif (typeof types === 'object') {\r\n\t\t\tfor (var type in types) {\r\n\t\t\t\tthis.once(type, types[type], fn);\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tvar handler = Util.bind(function () {\r\n\t\t\tthis\r\n\t\t\t    .off(types, fn, context)\r\n\t\t\t    .off(types, handler, context);\r\n\t\t}, this);\r\n\r\n\t\t// add a listener that's executed once and removed after that\r\n\t\treturn this\r\n\t\t    .on(types, fn, context)\r\n\t\t    .on(types, handler, context);\r\n\t},\r\n\r\n\t// @method addEventParent(obj: Evented): this\r\n\t// Adds an event parent - an `Evented` that will receive propagated events\r\n\taddEventParent: function (obj) {\r\n\t\tthis._eventParents = this._eventParents || {};\r\n\t\tthis._eventParents[Util.stamp(obj)] = obj;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method removeEventParent(obj: Evented): this\r\n\t// Removes an event parent, so it will stop receiving propagated events\r\n\tremoveEventParent: function (obj) {\r\n\t\tif (this._eventParents) {\r\n\t\t\tdelete this._eventParents[Util.stamp(obj)];\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\t_propagateEvent: function (e) {\r\n\t\tfor (var id in this._eventParents) {\r\n\t\t\tthis._eventParents[id].fire(e.type, Util.extend({layer: e.target}, e), true);\r\n\t\t}\r\n\t}\r\n});\r\n\r\nvar proto = Evented.prototype;\r\n\r\n// aliases; we should ditch those eventually\r\n\r\n// @method addEventListener(…): this\r\n// Alias to [`on(…)`](#evented-on)\r\nproto.addEventListener = proto.on;\r\n\r\n// @method removeEventListener(…): this\r\n// Alias to [`off(…)`](#evented-off)\r\n\r\n// @method clearAllEventListeners(…): this\r\n// Alias to [`off()`](#evented-off)\r\nproto.removeEventListener = proto.clearAllEventListeners = proto.off;\r\n\r\n// @method addOneTimeEventListener(…): this\r\n// Alias to [`once(…)`](#evented-once)\r\nproto.addOneTimeEventListener = proto.once;\r\n\r\n// @method fireEvent(…): this\r\n// Alias to [`fire(…)`](#evented-fire)\r\nproto.fireEvent = proto.fire;\r\n\r\n// @method hasEventListeners(…): Boolean\r\n// Alias to [`listens(…)`](#evented-listens)\r\nproto.hasEventListeners = proto.listens;\r\n","\n/*\n * @namespace Browser\n * @aka L.Browser\n *\n * A namespace with static properties for browser/feature detection used by Leaflet internally.\n *\n * @example\n *\n * ```js\n * if (L.Browser.ielt9) {\n *   alert('Upgrade your browser, dude!');\n * }\n * ```\n */\n\nvar style = document.documentElement.style;\n\n// @property ie: Boolean; `true` for all Internet Explorer versions (not Edge).\nexport var ie = 'ActiveXObject' in window;\n\n// @property ielt9: Boolean; `true` for Internet Explorer versions less than 9.\nexport var ielt9 = ie && !document.addEventListener;\n\n// @property edge: Boolean; `true` for the Edge web browser.\nexport var edge = 'msLaunchUri' in navigator && !('documentMode' in document);\n\n// @property webkit: Boolean;\n// `true` for webkit-based browsers like Chrome and Safari (including mobile versions).\nexport var webkit = userAgentContains('webkit');\n\n// @property android: Boolean\n// `true` for any browser running on an Android platform.\nexport var android = userAgentContains('android');\n\n// @property android23: Boolean; `true` for browsers running on Android 2 or Android 3.\nexport var android23 = userAgentContains('android 2') || userAgentContains('android 3');\n\n// @property opera: Boolean; `true` for the Opera browser\nexport var opera = !!window.opera;\n\n// @property chrome: Boolean; `true` for the Chrome browser.\nexport var chrome = userAgentContains('chrome');\n\n// @property gecko: Boolean; `true` for gecko-based browsers like Firefox.\nexport var gecko = userAgentContains('gecko') && !webkit && !opera && !ie;\n\n// @property safari: Boolean; `true` for the Safari browser.\nexport var safari = !chrome && userAgentContains('safari');\n\nexport var phantom = userAgentContains('phantom');\n\n// @property opera12: Boolean\n// `true` for the Opera browser supporting CSS transforms (version 12 or later).\nexport var opera12 = 'OTransition' in style;\n\n// @property win: Boolean; `true` when the browser is running in a Windows platform\nexport var win = navigator.platform.indexOf('Win') === 0;\n\n// @property ie3d: Boolean; `true` for all Internet Explorer versions supporting CSS transforms.\nexport var ie3d = ie && ('transition' in style);\n\n// @property webkit3d: Boolean; `true` for webkit-based browsers supporting CSS transforms.\nexport var webkit3d = ('WebKitCSSMatrix' in window) && ('m11' in new window.WebKitCSSMatrix()) && !android23;\n\n// @property gecko3d: Boolean; `true` for gecko-based browsers supporting CSS transforms.\nexport var gecko3d = 'MozPerspective' in style;\n\n// @property any3d: Boolean\n// `true` for all browsers supporting CSS transforms.\nexport var any3d = !window.L_DISABLE_3D && (ie3d || webkit3d || gecko3d) && !opera12 && !phantom;\n\n// @property mobile: Boolean; `true` for all browsers running in a mobile device.\nexport var mobile = typeof orientation !== 'undefined' || userAgentContains('mobile');\n\n// @property mobileWebkit: Boolean; `true` for all webkit-based browsers in a mobile device.\nexport var mobileWebkit = mobile && webkit;\n\n// @property mobileWebkit3d: Boolean\n// `true` for all webkit-based browsers in a mobile device supporting CSS transforms.\nexport var mobileWebkit3d = mobile && webkit3d;\n\n// @property msPointer: Boolean\n// `true` for browsers implementing the Microsoft touch events model (notably IE10).\nexport var msPointer = !window.PointerEvent && window.MSPointerEvent;\n\n// @property pointer: Boolean\n// `true` for all browsers supporting [pointer events](https://msdn.microsoft.com/en-us/library/dn433244%28v=vs.85%29.aspx).\nexport var pointer = !!(window.PointerEvent || msPointer);\n\n// @property touch: Boolean\n// `true` for all browsers supporting [touch events](https://developer.mozilla.org/docs/Web/API/Touch_events).\n// This does not necessarily mean that the browser is running in a computer with\n// a touchscreen, it only means that the browser is capable of understanding\n// touch events.\nexport var touch = !window.L_NO_TOUCH && (pointer || 'ontouchstart' in window ||\n        (window.DocumentTouch && document instanceof window.DocumentTouch));\n\n// @property mobileOpera: Boolean; `true` for the Opera browser in a mobile device.\nexport var mobileOpera = mobile && opera;\n\n// @property mobileGecko: Boolean\n// `true` for gecko-based browsers running in a mobile device.\nexport var mobileGecko = mobile && gecko;\n\n// @property retina: Boolean\n// `true` for browsers on a high-resolution \"retina\" screen.\nexport var retina = (window.devicePixelRatio || (window.screen.deviceXDPI / window.screen.logicalXDPI)) > 1;\n\n\n// @property canvas: Boolean\n// `true` when the browser supports [`<canvas>`](https://developer.mozilla.org/docs/Web/API/Canvas_API).\nexport var canvas = (function () {\n    return !!document.createElement('canvas').getContext;\n}());\n\n// @property svg: Boolean\n// `true` when the browser supports [SVG](https://developer.mozilla.org/docs/Web/SVG).\n// export var svg = !!(document.createElementNS && svgCreate('svg').createSVGRect);\nexport var svg = true;\n\n// @property vml: Boolean\n// `true` if the browser supports [VML](https://en.wikipedia.org/wiki/Vector_Markup_Language).\nexport var vml = !svg && (function () {\n    try {\n        var div = document.createElement('div');\n        div.innerHTML = '<v:shape adj=\"1\"/>';\n\n        var shape = div.firstChild;\n        shape.style.behavior = 'url(#default#VML)';\n\n        return shape && (typeof shape.adj === 'object');\n\n    } catch (e) {\n        return false;\n    }\n}());\n\nexport var columnCount = ( 'columnCount' in style );\nexport var classList = ( document.documentElement.classList !== undefined );\n\nfunction userAgentContains(str) {\n    return navigator.userAgent.toLowerCase().indexOf(str) >= 0;\n}\n","import {isArray, formatNum} from '../core/Util';\r\n\r\n/*\r\n * @class Point\r\n * @aka L.Point\r\n *\r\n * Represents a point with `x` and `y` coordinates in pixels.\r\n *\r\n * @example\r\n *\r\n * ```js\r\n * var point = L.point(200, 300);\r\n * ```\r\n *\r\n * All Leaflet methods and options that accept `Point` objects also accept them in a simple Array form (unless noted otherwise), so these lines are equivalent:\r\n *\r\n * ```js\r\n * map.panBy([200, 300]);\r\n * map.panBy(L.point(200, 300));\r\n * ```\r\n */\r\n\r\nexport function Point(x, y, round) {\r\n\t// @property x: Number; The `x` coordinate of the point\r\n\tthis.x = (round ? Math.round(x) : x);\r\n\t// @property y: Number; The `y` coordinate of the point\r\n\tthis.y = (round ? Math.round(y) : y);\r\n}\r\n\r\nPoint.prototype = {\r\n\r\n\t// @method clone(): Point\r\n\t// Returns a copy of the current point.\r\n\tclone: function () {\r\n\t\treturn new Point(this.x, this.y);\r\n\t},\r\n\r\n\t// @method add(otherPoint: Point): Point\r\n\t// Returns the result of addition of the current and the given points.\r\n\tadd: function (point) {\r\n\t\t// non-destructive, returns a new point\r\n\t\treturn this.clone()._add(toPoint(point));\r\n\t},\r\n\r\n\t_add: function (point) {\r\n\t\t// destructive, used directly for performance in situations where it's safe to modify existing point\r\n\t\tthis.x += point.x;\r\n\t\tthis.y += point.y;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method subtract(otherPoint: Point): Point\r\n\t// Returns the result of subtraction of the given point from the current.\r\n\tsubtract: function (point) {\r\n\t\treturn this.clone()._subtract(toPoint(point));\r\n\t},\r\n\r\n\t_subtract: function (point) {\r\n\t\tthis.x -= point.x;\r\n\t\tthis.y -= point.y;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method divideBy(num: Number): Point\r\n\t// Returns the result of division of the current point by the given number.\r\n\tdivideBy: function (num) {\r\n\t\treturn this.clone()._divideBy(num);\r\n\t},\r\n\r\n\t_divideBy: function (num) {\r\n\t\tthis.x /= num;\r\n\t\tthis.y /= num;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method multiplyBy(num: Number): Point\r\n\t// Returns the result of multiplication of the current point by the given number.\r\n\tmultiplyBy: function (num) {\r\n\t\treturn this.clone()._multiplyBy(num);\r\n\t},\r\n\r\n\t_multiplyBy: function (num) {\r\n\t\tthis.x *= num;\r\n\t\tthis.y *= num;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method scaleBy(scale: Point): Point\r\n\t// Multiply each coordinate of the current point by each coordinate of\r\n\t// `scale`. In linear algebra terms, multiply the point by the\r\n\t// [scaling matrix](https://en.wikipedia.org/wiki/Scaling_%28geometry%29#Matrix_representation)\r\n\t// defined by `scale`.\r\n\tscaleBy: function (point) {\r\n\t\treturn new Point(this.x * point.x, this.y * point.y);\r\n\t},\r\n\r\n\t// @method unscaleBy(scale: Point): Point\r\n\t// Inverse of `scaleBy`. Divide each coordinate of the current point by\r\n\t// each coordinate of `scale`.\r\n\tunscaleBy: function (point) {\r\n\t\treturn new Point(this.x / point.x, this.y / point.y);\r\n\t},\r\n\r\n\t// @method round(): Point\r\n\t// Returns a copy of the current point with rounded coordinates.\r\n\tround: function () {\r\n\t\treturn this.clone()._round();\r\n\t},\r\n\r\n\t_round: function () {\r\n\t\tthis.x = Math.round(this.x);\r\n\t\tthis.y = Math.round(this.y);\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method floor(): Point\r\n\t// Returns a copy of the current point with floored coordinates (rounded down).\r\n\tfloor: function () {\r\n\t\treturn this.clone()._floor();\r\n\t},\r\n\r\n\t_floor: function () {\r\n\t\tthis.x = Math.floor(this.x);\r\n\t\tthis.y = Math.floor(this.y);\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method ceil(): Point\r\n\t// Returns a copy of the current point with ceiled coordinates (rounded up).\r\n\tceil: function () {\r\n\t\treturn this.clone()._ceil();\r\n\t},\r\n\r\n\t_ceil: function () {\r\n\t\tthis.x = Math.ceil(this.x);\r\n\t\tthis.y = Math.ceil(this.y);\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method distanceTo(otherPoint: Point): Number\r\n\t// Returns the cartesian distance between the current and the given points.\r\n\tdistanceTo: function (point) {\r\n\t\tpoint = toPoint(point);\r\n\r\n\t\tvar x = point.x - this.x,\r\n\t\t    y = point.y - this.y;\r\n\r\n\t\treturn Math.sqrt(x * x + y * y);\r\n\t},\r\n\r\n\t// @method equals(otherPoint: Point): Boolean\r\n\t// Returns `true` if the given point has the same coordinates.\r\n\tequals: function (point) {\r\n\t\tpoint = toPoint(point);\r\n\r\n\t\treturn point.x === this.x &&\r\n\t\t       point.y === this.y;\r\n\t},\r\n\r\n\t// @method contains(otherPoint: Point): Boolean\r\n\t// Returns `true` if both coordinates of the given point are less than the corresponding current point coordinates (in absolute values).\r\n\tcontains: function (point) {\r\n\t\tpoint = toPoint(point);\r\n\r\n\t\treturn Math.abs(point.x) <= Math.abs(this.x) &&\r\n\t\t       Math.abs(point.y) <= Math.abs(this.y);\r\n\t},\r\n\r\n\t// @method toString(): String\r\n\t// Returns a string representation of the point for debugging purposes.\r\n\ttoString: function () {\r\n\t\treturn 'Point(' +\r\n\t\t        formatNum(this.x) + ', ' +\r\n\t\t        formatNum(this.y) + ')';\r\n\t}\r\n};\r\n\r\n// @factory L.point(x: Number, y: Number, round?: Boolean)\r\n// Creates a Point object with the given `x` and `y` coordinates. If optional `round` is set to true, rounds the `x` and `y` values.\r\n\r\n// @alternative\r\n// @factory L.point(coords: Number[])\r\n// Expects an array of the form `[x, y]` instead.\r\n\r\n// @alternative\r\n// @factory L.point(coords: Object)\r\n// Expects a plain object of the form `{x: Number, y: Number}` instead.\r\nexport function toPoint(x, y, round) {\r\n\tif (x instanceof Point) {\r\n\t\treturn x;\r\n\t}\r\n\tif (isArray(x)) {\r\n\t\treturn new Point(x[0], x[1]);\r\n\t}\r\n\tif (x === undefined || x === null) {\r\n\t\treturn x;\r\n\t}\r\n\tif (typeof x === 'object' && 'x' in x && 'y' in x) {\r\n\t\treturn new Point(x.x, x.y);\r\n\t}\r\n\treturn new Point(x, y, round);\r\n}\r\n","import * as DomEvent from './DomEvent';\nimport * as Util from '../core/Util';\nimport * as Browser from '../core/Browser';\n\n/*\n * Extends L.DomEvent to provide touch support for Internet Explorer and Windows-based devices.\n */\n\n\nvar POINTER_DOWN =   Browser.msPointer ? 'MSPointerDown'   : 'pointerdown',\n    POINTER_MOVE =   Browser.msPointer ? 'MSPointerMove'   : 'pointermove',\n    POINTER_UP =     Browser.msPointer ? 'MSPointerUp'     : 'pointerup',\n    POINTER_CANCEL = Browser.msPointer ? 'MSPointerCancel' : 'pointercancel',\n    TAG_WHITE_LIST = ['INPUT', 'SELECT', 'OPTION'],\n\n    _pointers = {},\n    _pointerDocListener = false;\n\n// DomEvent.DoubleTap needs to know about this\nexport var _pointersCount = 0;\n\n// Provides a touch events wrapper for (ms)pointer events.\n// ref http://www.w3.org/TR/pointerevents/ https://www.w3.org/Bugs/Public/show_bug.cgi?id=22890\n\nexport function addPointerListener(obj, type, handler, id) {\n\tif (type === 'touchstart') {\n\t\t_addPointerStart(obj, handler, id);\n\n\t} else if (type === 'touchmove') {\n\t\t_addPointerMove(obj, handler, id);\n\n\t} else if (type === 'touchend') {\n\t\t_addPointerEnd(obj, handler, id);\n\t}\n\n\treturn this;\n}\n\nexport function removePointerListener(obj, type, id) {\n\tvar handler = obj['_leaflet_' + type + id];\n\n\tif (type === 'touchstart') {\n\t\tobj.removeEventListener(POINTER_DOWN, handler, false);\n\n\t} else if (type === 'touchmove') {\n\t\tobj.removeEventListener(POINTER_MOVE, handler, false);\n\n\t} else if (type === 'touchend') {\n\t\tobj.removeEventListener(POINTER_UP, handler, false);\n\t\tobj.removeEventListener(POINTER_CANCEL, handler, false);\n\t}\n\n\treturn this;\n}\n\nfunction _addPointerStart(obj, handler, id) {\n\tvar onDown = Util.bind(function (e) {\n\t\tif (e.pointerType !== 'mouse' && e.pointerType !== e.MSPOINTER_TYPE_MOUSE && e.pointerType !== e.MSPOINTER_TYPE_MOUSE) {\n\t\t\t// In IE11, some touch events needs to fire for form controls, or\n\t\t\t// the controls will stop working. We keep a whitelist of tag names that\n\t\t\t// need these events. For other target tags, we prevent default on the event.\n\t\t\tif (TAG_WHITE_LIST.indexOf(e.target.tagName) < 0) {\n\t\t\t\tDomEvent.preventDefault(e);\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t_handlePointer(e, handler);\n\t});\n\n\tobj['_leaflet_touchstart' + id] = onDown;\n\tobj.addEventListener(POINTER_DOWN, onDown, false);\n\n\t// need to keep track of what pointers and how many are active to provide e.touches emulation\n\tif (!_pointerDocListener) {\n\t\t// we listen documentElement as any drags that end by moving the touch off the screen get fired there\n\t\tdocument.documentElement.addEventListener(POINTER_DOWN, _globalPointerDown, true);\n\t\tdocument.documentElement.addEventListener(POINTER_MOVE, _globalPointerMove, true);\n\t\tdocument.documentElement.addEventListener(POINTER_UP, _globalPointerUp, true);\n\t\tdocument.documentElement.addEventListener(POINTER_CANCEL, _globalPointerUp, true);\n\n\t\t_pointerDocListener = true;\n\t}\n}\n\nfunction _globalPointerDown(e) {\n\t_pointers[e.pointerId] = e;\n\t_pointersCount++;\n}\n\nfunction _globalPointerMove(e) {\n\tif (_pointers[e.pointerId]) {\n\t\t_pointers[e.pointerId] = e;\n\t}\n}\n\nfunction _globalPointerUp(e) {\n\tdelete _pointers[e.pointerId];\n\t_pointersCount--;\n}\n\nfunction _handlePointer(e, handler) {\n\te.touches = [];\n\tfor (var i in _pointers) {\n\t\te.touches.push(_pointers[i]);\n\t}\n\te.changedTouches = [e];\n\n\thandler(e);\n}\n\nfunction _addPointerMove(obj, handler, id) {\n\tvar onMove = function (e) {\n\t\t// don't fire touch moves when mouse isn't down\n\t\tif ((e.pointerType === e.MSPOINTER_TYPE_MOUSE || e.pointerType === 'mouse') && e.buttons === 0) { return; }\n\n\t\t_handlePointer(e, handler);\n\t};\n\n\tobj['_leaflet_touchmove' + id] = onMove;\n\tobj.addEventListener(POINTER_MOVE, onMove, false);\n}\n\nfunction _addPointerEnd(obj, handler, id) {\n\tvar onUp = function (e) {\n\t\t_handlePointer(e, handler);\n\t};\n\n\tobj['_leaflet_touchend' + id] = onUp;\n\tobj.addEventListener(POINTER_UP, onUp, false);\n\tobj.addEventListener(POINTER_CANCEL, onUp, false);\n}\n\n","import * as Browser from '../core/Browser';\r\nimport {_pointersCount} from './DomEvent.Pointer';\r\n\r\n/*\r\n * Extends the event handling code with double tap support for mobile browsers.\r\n */\r\n\r\nvar _touchstart = Browser.msPointer ? 'MSPointerDown' : Browser.pointer ? 'pointerdown' : 'touchstart',\r\n    _touchend = Browser.msPointer ? 'MSPointerUp' : Browser.pointer ? 'pointerup' : 'touchend',\r\n    _pre = '_leaflet_';\r\n\r\n// inspired by Zepto touch code by Thomas Fuchs\r\nexport function addDoubleTapListener(obj, handler, id) {\r\n\tvar last, touch,\r\n\t    doubleTap = false,\r\n\t    delay = 250;\r\n\r\n\tfunction onTouchStart(e) {\r\n\t\tvar count;\r\n\r\n\t\tif (Browser.pointer) {\r\n\t\t\tif ((!Browser.edge) || e.pointerType === 'mouse') { return; }\r\n\t\t\tcount = _pointersCount;\r\n\t\t} else {\r\n\t\t\tcount = e.touches.length;\r\n\t\t}\r\n\r\n\t\tif (count > 1) { return; }\r\n\r\n\t\tvar now = Date.now(),\r\n\t\t    delta = now - (last || now);\r\n\r\n\t\ttouch = e.touches ? e.touches[0] : e;\r\n\t\tdoubleTap = (delta > 0 && delta <= delay);\r\n\t\tlast = now;\r\n\t}\r\n\r\n\tfunction onTouchEnd(e) {\r\n\t\tif (doubleTap && !touch.cancelBubble) {\r\n\t\t\tif (Browser.pointer) {\r\n\t\t\t\tif ((!Browser.edge) || e.pointerType === 'mouse') { return; }\r\n\t\t\t\t// work around .type being readonly with MSPointer* events\r\n\t\t\t\tvar newTouch = {},\r\n\t\t\t\t    prop, i;\r\n\r\n\t\t\t\tfor (i in touch) {\r\n\t\t\t\t\tprop = touch[i];\r\n\t\t\t\t\tnewTouch[i] = prop && prop.bind ? prop.bind(touch) : prop;\r\n\t\t\t\t}\r\n\t\t\t\ttouch = newTouch;\r\n\t\t\t}\r\n\t\t\ttouch.type = 'dblclick';\r\n\t\t\thandler(touch);\r\n\t\t\tlast = null;\r\n\t\t}\r\n\t}\r\n\r\n\tobj[_pre + _touchstart + id] = onTouchStart;\r\n\tobj[_pre + _touchend + id] = onTouchEnd;\r\n\tobj[_pre + 'dblclick' + id] = handler;\r\n\r\n\tobj.addEventListener(_touchstart, onTouchStart, false);\r\n\tobj.addEventListener(_touchend, onTouchEnd, false);\r\n\r\n\t// On some platforms (notably, chrome<55 on win10 + touchscreen + mouse),\r\n\t// the browser doesn't fire touchend/pointerup events but does fire\r\n\t// native dblclicks. See #4127.\r\n\t// Edge 14 also fires native dblclicks, but only for pointerType mouse, see #5180.\r\n\tobj.addEventListener('dblclick', handler, false);\r\n\r\n\treturn this;\r\n}\r\n\r\nexport function removeDoubleTapListener(obj, id) {\r\n\tvar touchstart = obj[_pre + _touchstart + id],\r\n\t    touchend = obj[_pre + _touchend + id],\r\n\t    dblclick = obj[_pre + 'dblclick' + id];\r\n\r\n\tobj.removeEventListener(_touchstart, touchstart, false);\r\n\tobj.removeEventListener(_touchend, touchend, false);\r\n\tif (!Browser.edge) {\r\n\t\tobj.removeEventListener('dblclick', dblclick, false);\r\n\t}\r\n\r\n\treturn this;\r\n}\r\n","import {Point} from '../geometry/Point';\r\nimport * as Util from '../core/Util';\r\nimport * as Browser from '../core/Browser';\r\nimport {addPointerListener, removePointerListener} from './DomEvent.Pointer';\r\nimport {addDoubleTapListener, removeDoubleTapListener} from './DomEvent.DoubleTap';\r\n\r\n/*\r\n * @namespace DomEvent\r\n * Utility functions to work with the [DOM events](https://developer.mozilla.org/docs/Web/API/Event), used by Leaflet internally.\r\n */\r\n\r\n// Inspired by John Resig, Dean Edwards and YUI addEvent implementations.\r\n\r\n// @function on(el: HTMLElement, types: String, fn: Function, context?: Object): this\r\n// Adds a listener function (`fn`) to a particular DOM event type of the\r\n// element `el`. You can optionally specify the context of the listener\r\n// (object the `this` keyword will point to). You can also pass several\r\n// space-separated types (e.g. `'click dblclick'`).\r\n\r\n// @alternative\r\n// @function on(el: HTMLElement, eventMap: Object, context?: Object): this\r\n// Adds a set of type/listener pairs, e.g. `{click: onClick, mousemove: onMouseMove}`\r\nexport function on(obj, types, fn, context) {\r\n\r\n\tif (typeof types === 'object') {\r\n\t\tfor (var type in types) {\r\n\t\t\taddOne(obj, type, types[type], fn);\r\n\t\t}\r\n\t} else {\r\n\t\ttypes = Util.splitWords(types);\r\n\r\n\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\taddOne(obj, types[i], fn, context);\r\n\t\t}\r\n\t}\r\n\r\n\treturn this;\r\n}\r\n\r\nvar eventsKey = '_leaflet_events';\r\n\r\n// @function off(el: HTMLElement, types: String, fn: Function, context?: Object): this\r\n// Removes a previously added listener function. If no function is specified,\r\n// it will remove all the listeners of that particular DOM event from the element.\r\n// Note that if you passed a custom context to on, you must pass the same\r\n// context to `off` in order to remove the listener.\r\n\r\n// @alternative\r\n// @function off(el: HTMLElement, eventMap: Object, context?: Object): this\r\n// Removes a set of type/listener pairs, e.g. `{click: onClick, mousemove: onMouseMove}`\r\n\r\n// @alternative\r\n// @function off(el: HTMLElement): this\r\n// Removes all known event listeners\r\nexport function off(obj, types, fn, context) {\r\n\r\n\tif (typeof types === 'object') {\r\n\t\tfor (var type in types) {\r\n\t\t\tremoveOne(obj, type, types[type], fn);\r\n\t\t}\r\n\t} else if (types) {\r\n\t\ttypes = Util.splitWords(types);\r\n\r\n\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\tremoveOne(obj, types[i], fn, context);\r\n\t\t}\r\n\t} else {\r\n\t\tfor (var j in obj[eventsKey]) {\r\n\t\t\tremoveOne(obj, j, obj[eventsKey][j]);\r\n\t\t}\r\n\t\tdelete obj[eventsKey];\r\n\t}\r\n}\r\n\r\nfunction addOne(obj, type, fn, context) {\r\n\tvar id = type + Util.stamp(fn) + (context ? '_' + Util.stamp(context) : '');\r\n\r\n\tif (obj[eventsKey] && obj[eventsKey][id]) { return this; }\r\n\r\n\tvar handler = function (e) {\r\n\t\treturn fn.call(context || obj, e || window.event);\r\n\t};\r\n\r\n\tvar originalHandler = handler;\r\n\r\n\tif (Browser.pointer && type.indexOf('touch') === 0) {\r\n\t\t// Needs DomEvent.Pointer.js\r\n\t\taddPointerListener(obj, type, handler, id);\r\n\r\n\t} else if (Browser.touch && (type === 'dblclick') && addDoubleTapListener &&\r\n\t           !(Browser.pointer && Browser.chrome)) {\r\n\t\t// Chrome >55 does not need the synthetic dblclicks from addDoubleTapListener\r\n\t\t// See #5180\r\n\t\taddDoubleTapListener(obj, handler, id);\r\n\r\n\t} else if ('addEventListener' in obj) {\r\n\r\n\t\tif (type === 'mousewheel') {\r\n\t\t\tobj.addEventListener('onwheel' in obj ? 'wheel' : 'mousewheel', handler, false);\r\n\r\n\t\t} else if ((type === 'mouseenter') || (type === 'mouseleave')) {\r\n\t\t\thandler = function (e) {\r\n\t\t\t\te = e || window.event;\r\n\t\t\t\tif (isExternalTarget(obj, e)) {\r\n\t\t\t\t\toriginalHandler(e);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tobj.addEventListener(type === 'mouseenter' ? 'mouseover' : 'mouseout', handler, false);\r\n\r\n\t\t} else {\r\n\t\t\tif (type === 'click' && Browser.android) {\r\n\t\t\t\thandler = function (e) {\r\n\t\t\t\t\tfilterClick(e, originalHandler);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tobj.addEventListener(type, handler, false);\r\n\t\t}\r\n\r\n\t} else if ('attachEvent' in obj) {\r\n\t\tobj.attachEvent('on' + type, handler);\r\n\t}\r\n\r\n\tobj[eventsKey] = obj[eventsKey] || {};\r\n\tobj[eventsKey][id] = handler;\r\n}\r\n\r\nfunction removeOne(obj, type, fn, context) {\r\n\r\n\tvar id = type + Util.stamp(fn) + (context ? '_' + Util.stamp(context) : ''),\r\n\t    handler = obj[eventsKey] && obj[eventsKey][id];\r\n\r\n\tif (!handler) { return this; }\r\n\r\n\tif (Browser.pointer && type.indexOf('touch') === 0) {\r\n\t\tremovePointerListener(obj, type, id);\r\n\r\n\t} else if (Browser.touch && (type === 'dblclick') && removeDoubleTapListener) {\r\n\t\tremoveDoubleTapListener(obj, id);\r\n\r\n\t} else if ('removeEventListener' in obj) {\r\n\r\n\t\tif (type === 'mousewheel') {\r\n\t\t\tobj.removeEventListener('onwheel' in obj ? 'wheel' : 'mousewheel', handler, false);\r\n\r\n\t\t} else {\r\n\t\t\tobj.removeEventListener(\r\n\t\t\t\ttype === 'mouseenter' ? 'mouseover' :\r\n\t\t\t\ttype === 'mouseleave' ? 'mouseout' : type, handler, false);\r\n\t\t}\r\n\r\n\t} else if ('detachEvent' in obj) {\r\n\t\tobj.detachEvent('on' + type, handler);\r\n\t}\r\n\r\n\tobj[eventsKey][id] = null;\r\n}\r\n\r\n// @function stopPropagation(ev: DOMEvent): this\r\n// Stop the given event from propagation to parent elements. Used inside the listener functions:\r\n// ```js\r\n// L.DomEvent.on(div, 'click', function (ev) {\r\n// \tL.DomEvent.stopPropagation(ev);\r\n// });\r\n// ```\r\nexport function stopPropagation(e) {\r\n\r\n\tif (e.stopPropagation) {\r\n\t\te.stopPropagation();\r\n\t} else if (e.originalEvent) {  // In case of Leaflet event.\r\n\t\te.originalEvent._stopped = true;\r\n\t} else {\r\n\t\te.cancelBubble = true;\r\n\t}\r\n\tskipped(e);\r\n\r\n\treturn this;\r\n}\r\n\r\n// @function disableScrollPropagation(el: HTMLElement): this\r\n// Adds `stopPropagation` to the element's `'mousewheel'` events (plus browser variants).\r\nexport function disableScrollPropagation(el) {\r\n\treturn addOne(el, 'mousewheel', stopPropagation);\r\n}\r\n\r\n// @function disableClickPropagation(el: HTMLElement): this\r\n// Adds `stopPropagation` to the element's `'click'`, `'doubleclick'`,\r\n// `'mousedown'` and `'touchstart'` events (plus browser variants).\r\nexport function disableClickPropagation(el) {\r\n\ton(el, 'mousedown touchstart dblclick', stopPropagation);\r\n\taddOne(el, 'click', fakeStop);\r\n\treturn this;\r\n}\r\n\r\n// @function preventDefault(ev: DOMEvent): this\r\n// Prevents the default action of the DOM Event `ev` from happening (such as\r\n// following a link in the href of the a element, or doing a POST request\r\n// with page reload when a `<form>` is submitted).\r\n// Use it inside listener functions.\r\nexport function preventDefault(e) {\r\n\tif (e.preventDefault) {\r\n\t\te.preventDefault();\r\n\t} else {\r\n\t\te.returnValue = false;\r\n\t}\r\n\treturn this;\r\n}\r\n\r\n// @function stop(ev): this\r\n// Does `stopPropagation` and `preventDefault` at the same time.\r\nexport function stop(e) {\r\n\tpreventDefault(e);\r\n\tstopPropagation(e);\r\n\treturn this;\r\n}\r\n\r\n// @function getMousePosition(ev: DOMEvent, container?: HTMLElement): Point\r\n// Gets normalized mouse position from a DOM event relative to the\r\n// `container` or to the whole page if not specified.\r\nexport function getMousePosition(e, container) {\r\n\tif (!container) {\r\n\t\treturn new Point(e.clientX, e.clientY);\r\n\t}\r\n\r\n\tvar rect = container.getBoundingClientRect();\r\n\r\n\treturn new Point(\r\n\t\te.clientX - rect.left - container.clientLeft,\r\n\t\te.clientY - rect.top - container.clientTop);\r\n}\r\n\r\n// Chrome on Win scrolls double the pixels as in other platforms (see #4538),\r\n// and Firefox scrolls device pixels, not CSS pixels\r\nvar wheelPxFactor =\r\n\t(Browser.win && Browser.chrome) ? 2 :\r\n\tBrowser.gecko ? window.devicePixelRatio : 1;\r\n\r\n// @function getWheelDelta(ev: DOMEvent): Number\r\n// Gets normalized wheel delta from a mousewheel DOM event, in vertical\r\n// pixels scrolled (negative if scrolling down).\r\n// Events from pointing devices without precise scrolling are mapped to\r\n// a best guess of 60 pixels.\r\nexport function getWheelDelta(e) {\r\n\treturn (Browser.edge) ? e.wheelDeltaY / 2 : // Don't trust window-geometry-based delta\r\n\t       (e.deltaY && e.deltaMode === 0) ? -e.deltaY / wheelPxFactor : // Pixels\r\n\t       (e.deltaY && e.deltaMode === 1) ? -e.deltaY * 20 : // Lines\r\n\t       (e.deltaY && e.deltaMode === 2) ? -e.deltaY * 60 : // Pages\r\n\t       (e.deltaX || e.deltaZ) ? 0 :\t// Skip horizontal/depth wheel events\r\n\t       e.wheelDelta ? (e.wheelDeltaY || e.wheelDelta) / 2 : // Legacy IE pixels\r\n\t       (e.detail && Math.abs(e.detail) < 32765) ? -e.detail * 20 : // Legacy Moz lines\r\n\t       e.detail ? e.detail / -32765 * 60 : // Legacy Moz pages\r\n\t       0;\r\n}\r\n\r\nvar skipEvents = {};\r\n\r\nexport function fakeStop(e) {\r\n\t// fakes stopPropagation by setting a special event flag, checked/reset with skipped(e)\r\n\tskipEvents[e.type] = true;\r\n}\r\n\r\nexport function skipped(e) {\r\n\tvar events = skipEvents[e.type];\r\n\t// reset when checking, as it's only used in map container and propagates outside of the map\r\n\tskipEvents[e.type] = false;\r\n\treturn events;\r\n}\r\n\r\n// check if element really left/entered the event target (for mouseenter/mouseleave)\r\nexport function isExternalTarget(el, e) {\r\n\r\n\tvar related = e.relatedTarget;\r\n\r\n\tif (!related) { return true; }\r\n\r\n\ttry {\r\n\t\twhile (related && (related !== el)) {\r\n\t\t\trelated = related.parentNode;\r\n\t\t}\r\n\t} catch (err) {\r\n\t\treturn false;\r\n\t}\r\n\treturn (related !== el);\r\n}\r\n\r\nvar lastClick;\r\n\r\n// this is a horrible workaround for a bug in Android where a single touch triggers two click events\r\nfunction filterClick(e, handler) {\r\n\tvar timeStamp = (e.timeStamp || (e.originalEvent && e.originalEvent.timeStamp)),\r\n\t    elapsed = lastClick && (timeStamp - lastClick);\r\n\r\n\t// are they closer together than 500ms yet more than 100ms?\r\n\t// Android typically triggers them ~300ms apart while multiple listeners\r\n\t// on the same event should be triggered far faster;\r\n\t// or check if click is simulated on the element, and if it is, reject any non-simulated events\r\n\r\n\tif ((elapsed && elapsed > 100 && elapsed < 500) || (e.target._simulatedClick && !e._simulated)) {\r\n\t\tstop(e);\r\n\t\treturn;\r\n\t}\r\n\tlastClick = timeStamp;\r\n\r\n\thandler(e);\r\n}\r\n\r\n// @function addListener(…): this\r\n// Alias to [`L.DomEvent.on`](#domevent-on)\r\nexport {on as addListener};\r\n\r\n// @function removeListener(…): this\r\n// Alias to [`L.DomEvent.off`](#domevent-off)\r\nexport {off as removeListener};\r\n","import * as DomEvent from './DomEvent';\nimport * as Util from '../core/Util';\nimport {Point} from '../geometry/Point';\nimport * as Browser from '../core/Browser';\n\n/*\n * @namespace DomUtil\n *\n * Utility functions to work with the [DOM](https://developer.mozilla.org/docs/Web/API/Document_Object_Model)\n * tree, used by Leaflet internally.\n *\n * Most functions expecting or returning a `HTMLElement` also work for\n * SVG elements. The only difference is that classes refer to CSS classes\n * in HTML and SVG classes in SVG.\n */\n\n if (!Element.prototype.matches) {\n    var ep = Element.prototype;\n \n    if (ep.webkitMatchesSelector) // Chrome <34, SF<7.1, iOS<8\n      ep.matches = ep.webkitMatchesSelector;\n \n    if (ep.msMatchesSelector) // IE9/10/11 & Edge\n      ep.matches = ep.msMatchesSelector;\n \n    if (ep.mozMatchesSelector) // FF<34\n      ep.matches = ep.mozMatchesSelector;\n }\n\n// @property TRANSFORM: String\n// Vendor-prefixed fransform style name (e.g. `'webkitTransform'` for WebKit).\nexport var TRANSFORM = testProp(\n    ['transform', 'WebkitTransform', 'OTransform', 'MozTransform', 'msTransform']);\n\n// webkitTransition comes first because some browser versions that drop vendor prefix don't do\n// the same for the transitionend event, in particular the Android 4.1 stock browser\n\n// @property TRANSITION: String\n// Vendor-prefixed transform style name.\nexport var TRANSITION = testProp(\n    ['webkitTransition', 'transition', 'OTransition', 'MozTransition', 'msTransition']);\n\nexport var TRANSITION_END =\n    TRANSITION === 'webkitTransition' || TRANSITION === 'OTransition' ? TRANSITION + 'End' : 'transitionend';\n\n\n// @function get(id: String|HTMLElement): HTMLElement\n// Returns an element given its DOM id, or returns the element itself\n// if it was passed directly.\nexport function get(id) {\n    return typeof id === 'string' ? document.getElementById(id) : id;\n}\n\n// @function getStyle(el: HTMLElement, styleAttrib: String): String\n// Returns the value for a certain style attribute on an element,\n// including computed values or values set through CSS.\nexport function getStyle(el, style) {\n    var value = el.style[style] || (el.currentStyle && el.currentStyle[style]);\n\n    if ((!value || value === 'auto') && document.defaultView) {\n        var css = document.defaultView.getComputedStyle(el, null);\n        value = css ? css[style] : null;\n    }\n    return value === 'auto' ? null : value;\n}\n\n// @function create(tagName: String, className?: String, container?: HTMLElement): HTMLElement\n// Creates an HTML element with `tagName`, sets its class to `className`, and optionally appends it to `container` element.\nexport function create(tagName, className, container) {\n    var el = document.createElement(tagName);\n    el.className = className || '';\n\n    if (container) {\n        container.appendChild(el);\n    }\n    return el;\n}\n\n// @function remove(el: HTMLElement)\n// Removes `el` from its parent element\nexport function remove(el) {\n    var parent = el.parentNode;\n    if (parent) {\n        parent.removeChild(el);\n    }\n}\n\n// @function empty(el: HTMLElement)\n// Removes all of `el`'s children elements from `el`\nexport function empty(el) {\n    while (el.firstChild) {\n        el.removeChild(el.firstChild);\n    }\n}\n\n// @function toFront(el: HTMLElement)\n// Makes `el` the last child of its parent, so it renders in front of the other children.\nexport function toFront(el) {\n    el.parentNode.appendChild(el);\n}\n\n// @function toBack(el: HTMLElement)\n// Makes `el` the first child of its parent, so it renders behind the other children.\nexport function toBack(el) {\n    var parent = el.parentNode;\n    parent.insertBefore(el, parent.firstChild);\n}\n\n// @function hasClass(el: HTMLElement, name: String): Boolean\n// Returns `true` if the element's class attribute contains `name`.\nexport function hasClass(el, name) {\n    if (el.classList !== undefined) {\n        return el.classList.contains(name);\n    }\n    var className = getClass(el);\n    return className.length > 0 && new RegExp('(^|\\\\s)' + name + '(\\\\s|$)').test(className);\n}\n\n// @function addClass(el: HTMLElement, name: String)\n// Adds `name` to the element's class attribute.\nexport function addClass(el, name) {\n    if (el.classList !== undefined) {\n        var classes = Util.splitWords(name);\n        for (var i = 0, len = classes.length; i < len; i++) {\n            el.classList.add(classes[i]);\n        }\n    } else if (!hasClass(el, name)) {\n        var className = getClass(el);\n        setClass(el, (className ? className + ' ' : '') + name);\n    }\n}\n\n// @function removeClass(el: HTMLElement, name: String)\n// Removes `name` from the element's class attribute.\nexport function removeClass(el, name) {\n    if (el.classList !== undefined) {\n        el.classList.remove(name);\n    } else {\n        setClass(el, Util.trim((' ' + getClass(el) + ' ').replace(' ' + name + ' ', ' ')));\n    }\n}\n\n// @function setClass(el: HTMLElement, name: String)\n// Sets the element's class.\nexport function setClass(el, name) {\n    if (el.className.baseVal === undefined) {\n        el.className = name;\n    } else {\n        // in case of SVG element\n        el.className.baseVal = name;\n    }\n}\n\n// @function getClass(el: HTMLElement): String\n// Returns the element's class.\nexport function getClass(el) {\n    return el.className.baseVal === undefined ? el.className : el.className.baseVal;\n}\n\n// @function setOpacity(el: HTMLElement, opacity: Number)\n// Set the opacity of an element (including old IE support).\n// `opacity` must be a number from `0` to `1`.\nexport function setOpacity(el, value) {\n    if ('opacity' in el.style) {\n        el.style.opacity = value;\n    } else if ('filter' in el.style) {\n        _setOpacityIE(el, value);\n    }\n}\n\nfunction _setOpacityIE(el, value) {\n    var filter = false,\n        filterName = 'DXImageTransform.Microsoft.Alpha';\n\n    // filters collection throws an error if we try to retrieve a filter that doesn't exist\n    try {\n        filter = el.filters.item(filterName);\n    } catch (e) {\n        // don't set opacity to 1 if we haven't already set an opacity,\n        // it isn't needed and breaks transparent pngs.\n        if (value === 1) { return; }\n    }\n\n    value = Math.round(value * 100);\n\n    if (filter) {\n        filter.Enabled = (value !== 100);\n        filter.Opacity = value;\n    } else {\n        el.style.filter += ' progid:' + filterName + '(opacity=' + value + ')';\n    }\n}\n\n// @function testProp(props: String[]): String|false\n// Goes through the array of style names and returns the first name\n// that is a valid style name for an element. If no such name is found,\n// it returns false. Useful for vendor-prefixed styles like `transform`.\nexport function testProp(props) {\n    var style = document.documentElement.style;\n\n    for (var i = 0; i < props.length; i++) {\n        if (props[i] in style) {\n            return props[i];\n        }\n    }\n    return false;\n}\n\nexport function isPropertySupported(prop) {\n    var style = document.documentElement.style;\n    return prop in style;\n}\n\n// @function setTransform(el: HTMLElement, offset: Point, scale?: Number)\n// Resets the 3D CSS transform of `el` so it is translated by `offset` pixels\n// and optionally scaled by `scale`. Does not have an effect if the\n// browser doesn't support 3D CSS transforms.\nexport function setTransform(el, offset, scale) {\n    var pos = offset || new Point(0, 0);\n\n    el.style[TRANSFORM] =\n        (Browser.ie3d ?\n            'translate(' + pos.x + 'px,' + pos.y + 'px)' :\n            'translate3d(' + pos.x + 'px,' + pos.y + 'px,0)') +\n        (scale ? ' scale(' + scale + ')' : '');\n}\n\n// @function setPosition(el: HTMLElement, position: Point)\n// Sets the position of `el` to coordinates specified by `position`,\n// using CSS translate or top/left positioning depending on the browser\n// (used by Leaflet internally to position its layers).\nexport function setPosition(el, point) {\n\n    /*eslint-disable */\n    el._leaflet_pos = point;\n    /*eslint-enable */\n\n    if (Browser.any3d) {\n        setTransform(el, point);\n    } else {\n        el.style.left = point.x + 'px';\n        el.style.top = point.y + 'px';\n    }\n}\n\n// @function getPosition(el: HTMLElement): Point\n// Returns the coordinates of an element previously positioned with setPosition.\nexport function getPosition(el) {\n    // this method is only used for elements previously positioned using setPosition,\n    // so it's safe to cache the position for performance\n\n    return el._leaflet_pos || new Point(0, 0);\n}\n\n// @function disableTextSelection()\n// Prevents the user from generating `selectstart` DOM events, usually generated\n// when the user drags the mouse through a page with text. Used internally\n// by Leaflet to override the behaviour of any click-and-drag interaction on\n// the map. Affects drag interactions on the whole document.\n\n// @function enableTextSelection()\n// Cancels the effects of a previous [`L.DomUtil.disableTextSelection`](#domutil-disabletextselection).\nexport var disableTextSelection;\nexport var enableTextSelection;\nvar _userSelect;\nif ('onselectstart' in document) {\n    disableTextSelection = function () {\n        DomEvent.on(window, 'selectstart', DomEvent.preventDefault);\n    };\n    enableTextSelection = function () {\n        DomEvent.off(window, 'selectstart', DomEvent.preventDefault);\n    };\n} else {\n    var userSelectProperty = testProp(\n        ['userSelect', 'WebkitUserSelect', 'OUserSelect', 'MozUserSelect', 'msUserSelect']);\n\n    disableTextSelection = function () {\n        if (userSelectProperty) {\n            var style = document.documentElement.style;\n            _userSelect = style[userSelectProperty];\n            style[userSelectProperty] = 'none';\n        }\n    };\n    enableTextSelection = function () {\n        if (userSelectProperty) {\n            document.documentElement.style[userSelectProperty] = _userSelect;\n            _userSelect = undefined;\n        }\n    };\n}\n\n// @function disableImageDrag()\n// As [`L.DomUtil.disableTextSelection`](#domutil-disabletextselection), but\n// for `dragstart` DOM events, usually generated when the user drags an image.\nexport function disableImageDrag() {\n    DomEvent.on(window, 'dragstart', DomEvent.preventDefault);\n}\n\n// @function enableImageDrag()\n// Cancels the effects of a previous [`L.DomUtil.disableImageDrag`](#domutil-disabletextselection).\nexport function enableImageDrag() {\n    DomEvent.off(window, 'dragstart', DomEvent.preventDefault);\n}\n\nvar _outlineElement, _outlineStyle;\n// @function preventOutline(el: HTMLElement)\n// Makes the [outline](https://developer.mozilla.org/docs/Web/CSS/outline)\n// of the element `el` invisible. Used internally by Leaflet to prevent\n// focusable elements from displaying an outline when the user performs a\n// drag interaction on them.\nexport function preventOutline(element) {\n    while (element.tabIndex === -1) {\n        element = element.parentNode;\n    }\n    if (!element || !element.style) { return; }\n    restoreOutline();\n    _outlineElement = element;\n    _outlineStyle = element.style.outline;\n    element.style.outline = 'none';\n    DomEvent.on(window, 'keydown', restoreOutline);\n}\n\n// @function restoreOutline()\n// Cancels the effects of a previous [`L.DomUtil.preventOutline`]().\nexport function restoreOutline() {\n    if (!_outlineElement) { return; }\n    _outlineElement.style.outline = _outlineStyle;\n    _outlineElement = undefined;\n    _outlineStyle = undefined;\n    DomEvent.off(window, 'keydown', restoreOutline);\n}\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var baseGetTag = require('./_baseGetTag'),\n    isObject = require('./isObject');\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nmodule.exports = isFunction;\n","var root = require('./_root');\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nmodule.exports = coreJsData;\n","var coreJsData = require('./_coreJsData');\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nmodule.exports = isMasked;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nmodule.exports = toSource;\n","var isFunction = require('./isFunction'),\n    isMasked = require('./_isMasked'),\n    isObject = require('./isObject'),\n    toSource = require('./_toSource');\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nmodule.exports = baseIsNative;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nmodule.exports = getValue;\n","var baseIsNative = require('./_baseIsNative'),\n    getValue = require('./_getValue');\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nmodule.exports = getNative;\n","var getNative = require('./_getNative');\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nmodule.exports = defineProperty;\n","var defineProperty = require('./_defineProperty');\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\nmodule.exports = baseAssignValue;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nmodule.exports = eq;\n","var baseAssignValue = require('./_baseAssignValue'),\n    eq = require('./eq');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nmodule.exports = assignValue;\n","var assignValue = require('./_assignValue'),\n    baseAssignValue = require('./_baseAssignValue');\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property identifiers to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @param {Function} [customizer] The function to customize copied values.\n * @returns {Object} Returns `object`.\n */\nfunction copyObject(source, props, object, customizer) {\n  var isNew = !object;\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n\n    var newValue = customizer\n      ? customizer(object[key], source[key], key, object, source)\n      : undefined;\n\n    if (newValue === undefined) {\n      newValue = source[key];\n    }\n    if (isNew) {\n      baseAssignValue(object, key, newValue);\n    } else {\n      assignValue(object, key, newValue);\n    }\n  }\n  return object;\n}\n\nmodule.exports = copyObject;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nmodule.exports = identity;\n","/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\nmodule.exports = apply;\n","var apply = require('./_apply');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * A specialized version of `baseRest` which transforms the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @param {Function} transform The rest array transform.\n * @returns {Function} Returns the new function.\n */\nfunction overRest(func, start, transform) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = transform(array);\n    return apply(func, this, otherArgs);\n  };\n}\n\nmodule.exports = overRest;\n","/**\n * Creates a function that returns `value`.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {*} value The value to return from the new function.\n * @returns {Function} Returns the new constant function.\n * @example\n *\n * var objects = _.times(2, _.constant({ 'a': 1 }));\n *\n * console.log(objects);\n * // => [{ 'a': 1 }, { 'a': 1 }]\n *\n * console.log(objects[0] === objects[1]);\n * // => true\n */\nfunction constant(value) {\n  return function() {\n    return value;\n  };\n}\n\nmodule.exports = constant;\n","var constant = require('./constant'),\n    defineProperty = require('./_defineProperty'),\n    identity = require('./identity');\n\n/**\n * The base implementation of `setToString` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar baseSetToString = !defineProperty ? identity : function(func, string) {\n  return defineProperty(func, 'toString', {\n    'configurable': true,\n    'enumerable': false,\n    'value': constant(string),\n    'writable': true\n  });\n};\n\nmodule.exports = baseSetToString;\n","/** Used to detect hot functions by number of calls within a span of milliseconds. */\nvar HOT_COUNT = 800,\n    HOT_SPAN = 16;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeNow = Date.now;\n\n/**\n * Creates a function that'll short out and invoke `identity` instead\n * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n * milliseconds.\n *\n * @private\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new shortable function.\n */\nfunction shortOut(func) {\n  var count = 0,\n      lastCalled = 0;\n\n  return function() {\n    var stamp = nativeNow(),\n        remaining = HOT_SPAN - (stamp - lastCalled);\n\n    lastCalled = stamp;\n    if (remaining > 0) {\n      if (++count >= HOT_COUNT) {\n        return arguments[0];\n      }\n    } else {\n      count = 0;\n    }\n    return func.apply(undefined, arguments);\n  };\n}\n\nmodule.exports = shortOut;\n","var baseSetToString = require('./_baseSetToString'),\n    shortOut = require('./_shortOut');\n\n/**\n * Sets the `toString` method of `func` to return `string`.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar setToString = shortOut(baseSetToString);\n\nmodule.exports = setToString;\n","var identity = require('./identity'),\n    overRest = require('./_overRest'),\n    setToString = require('./_setToString');\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  return setToString(overRest(func, start, identity), func + '');\n}\n\nmodule.exports = baseRest;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nmodule.exports = isLength;\n","var isFunction = require('./isFunction'),\n    isLength = require('./isLength');\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nmodule.exports = isArrayLike;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  length = length == null ? MAX_SAFE_INTEGER : length;\n  return !!length &&\n    (typeof value == 'number' || reIsUint.test(value)) &&\n    (value > -1 && value % 1 == 0 && value < length);\n}\n\nmodule.exports = isIndex;\n","var eq = require('./eq'),\n    isArrayLike = require('./isArrayLike'),\n    isIndex = require('./_isIndex'),\n    isObject = require('./isObject');\n\n/**\n * Checks if the given arguments are from an iteratee call.\n *\n * @private\n * @param {*} value The potential iteratee value argument.\n * @param {*} index The potential iteratee index or key argument.\n * @param {*} object The potential iteratee object argument.\n * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n *  else `false`.\n */\nfunction isIterateeCall(value, index, object) {\n  if (!isObject(object)) {\n    return false;\n  }\n  var type = typeof index;\n  if (type == 'number'\n        ? (isArrayLike(object) && isIndex(index, object.length))\n        : (type == 'string' && index in object)\n      ) {\n    return eq(object[index], value);\n  }\n  return false;\n}\n\nmodule.exports = isIterateeCall;\n","var baseRest = require('./_baseRest'),\n    isIterateeCall = require('./_isIterateeCall');\n\n/**\n * Creates a function like `_.assign`.\n *\n * @private\n * @param {Function} assigner The function to assign values.\n * @returns {Function} Returns the new assigner function.\n */\nfunction createAssigner(assigner) {\n  return baseRest(function(object, sources) {\n    var index = -1,\n        length = sources.length,\n        customizer = length > 1 ? sources[length - 1] : undefined,\n        guard = length > 2 ? sources[2] : undefined;\n\n    customizer = (assigner.length > 3 && typeof customizer == 'function')\n      ? (length--, customizer)\n      : undefined;\n\n    if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n      customizer = length < 3 ? undefined : customizer;\n      length = 1;\n    }\n    object = Object(object);\n    while (++index < length) {\n      var source = sources[index];\n      if (source) {\n        assigner(object, source, index, customizer);\n      }\n    }\n    return object;\n  });\n}\n\nmodule.exports = createAssigner;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nmodule.exports = isPrototype;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nmodule.exports = baseTimes;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nmodule.exports = baseIsArguments;\n","var baseIsArguments = require('./_baseIsArguments'),\n    isObjectLike = require('./isObjectLike');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nmodule.exports = isArguments;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nmodule.exports = isArray;\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = stubFalse;\n","var root = require('./_root'),\n    stubFalse = require('./stubFalse');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nmodule.exports = isBuffer;\n","var baseGetTag = require('./_baseGetTag'),\n    isLength = require('./isLength'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nmodule.exports = baseIsTypedArray;\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nmodule.exports = baseUnary;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nmodule.exports = nodeUtil;\n","var baseIsTypedArray = require('./_baseIsTypedArray'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nmodule.exports = isTypedArray;\n","var baseTimes = require('./_baseTimes'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isIndex = require('./_isIndex'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayLikeKeys;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nmodule.exports = overArg;\n","var overArg = require('./_overArg');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nmodule.exports = nativeKeys;\n","var isPrototype = require('./_isPrototype'),\n    nativeKeys = require('./_nativeKeys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseKeys;\n","var arrayLikeKeys = require('./_arrayLikeKeys'),\n    baseKeys = require('./_baseKeys'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nmodule.exports = keys;\n","var assignValue = require('./_assignValue'),\n    copyObject = require('./_copyObject'),\n    createAssigner = require('./_createAssigner'),\n    isArrayLike = require('./isArrayLike'),\n    isPrototype = require('./_isPrototype'),\n    keys = require('./keys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns own enumerable string keyed properties of source objects to the\n * destination object. Source objects are applied from left to right.\n * Subsequent sources overwrite property assignments of previous sources.\n *\n * **Note:** This method mutates `object` and is loosely based on\n * [`Object.assign`](https://mdn.io/Object/assign).\n *\n * @static\n * @memberOf _\n * @since 0.10.0\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} [sources] The source objects.\n * @returns {Object} Returns `object`.\n * @see _.assignIn\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * function Bar() {\n *   this.c = 3;\n * }\n *\n * Foo.prototype.b = 2;\n * Bar.prototype.d = 4;\n *\n * _.assign({ 'a': 0 }, new Foo, new Bar);\n * // => { 'a': 1, 'c': 3 }\n */\nvar assign = createAssigner(function(object, source) {\n  if (isPrototype(source) || isArrayLike(source)) {\n    copyObject(source, keys(source), object);\n    return;\n  }\n  for (var key in source) {\n    if (hasOwnProperty.call(source, key)) {\n      assignValue(object, key, source[key]);\n    }\n  }\n});\n\nmodule.exports = assign;\n","var document = typeof window !== 'undefined' && typeof window.document !== 'undefined' ? window.document : {};\nvar keyboardAllowed = typeof Element !== 'undefined' && 'ALLOW_KEYBOARD_INPUT' in Element;\n\nvar fn = (function () {\n  var val;\n\n  var fnMap = [\n    [\n      'requestFullscreen',\n      'exitFullscreen',\n      'fullscreenElement',\n      'fullscreenEnabled',\n      'fullscreenchange',\n      'fullscreenerror'\n    ],\n    // New WebKit\n    [\n      'webkitRequestFullscreen',\n      'webkitExitFullscreen',\n      'webkitFullscreenElement',\n      'webkitFullscreenEnabled',\n      'webkitfullscreenchange',\n      'webkitfullscreenerror'\n\n    ],\n    // Old WebKit (Safari 5.1)\n    [\n      'webkitRequestFullScreen',\n      'webkitCancelFullScreen',\n      'webkitCurrentFullScreenElement',\n      'webkitCancelFullScreen',\n      'webkitfullscreenchange',\n      'webkitfullscreenerror'\n\n    ],\n    [\n      'mozRequestFullScreen',\n      'mozCancelFullScreen',\n      'mozFullScreenElement',\n      'mozFullScreenEnabled',\n      'mozfullscreenchange',\n      'mozfullscreenerror'\n    ],\n    [\n      'msRequestFullscreen',\n      'msExitFullscreen',\n      'msFullscreenElement',\n      'msFullscreenEnabled',\n      'MSFullscreenChange',\n      'MSFullscreenError'\n    ]\n  ];\n\n  var i = 0;\n  var l = fnMap.length;\n  var ret = {};\n\n  for (; i < l; i++) {\n    val = fnMap[i];\n    if (val && val[1] in document) {\n      for (i = 0; i < val.length; i++) {\n        ret[fnMap[0][i]] = val[i];\n      }\n      return ret;\n    }\n  }\n\n  return false;\n})();\n\nvar eventNameMap = {\n  change: fn.fullscreenchange,\n  error: fn.fullscreenerror\n};\n\nvar screenfull = {\n  request: function (elem) {\n    var request = fn.requestFullscreen;\n\n    elem = elem || document.documentElement;\n\n    // Work around Safari 5.1 bug: reports support for\n    // keyboard in fullscreen even though it doesn't.\n    // Browser sniffing, since the alternative with\n    // setTimeout is even worse.\n    if (/5\\.1[.\\d]* Safari/.test(navigator.userAgent)) {\n      elem[request]();\n    } else {\n      elem[request](keyboardAllowed && Element.ALLOW_KEYBOARD_INPUT);\n    }\n  },\n  exit: function () {\n    document[fn.exitFullscreen]();\n  },\n  toggle: function (elem) {\n    if (this.isFullscreen) {\n      this.exit();\n    } else {\n      this.request(elem);\n    }\n  },\n  onchange: function (callback) {\n    this.on('change', callback);\n  },\n  onerror: function (callback) {\n    this.on('error', callback);\n  },\n  on: function (event, callback) {\n    var eventName = eventNameMap[event];\n    if (eventName) {\n      document.addEventListener(eventName, callback, false);\n    }\n  },\n  off: function (event, callback) {\n    var eventName = eventNameMap[event];\n    if (eventName) {\n      document.removeEventListener(eventName, callback, false);\n    }\n  },\n  raw: fn\n};\n\nObject.defineProperties(screenfull, {\n  isFullscreen: {\n    get: function () {\n      return Boolean(document[fn.fullscreenElement]);\n    }\n  },\n  element: {\n    enumerable: true,\n    get: function () {\n      return document[fn.fullscreenElement];\n    }\n  },\n  enabled: {\n    enumerable: true,\n    get: function () {\n      // Coerce to boolean in case of old WebKit\n      return Boolean(document[fn.fullscreenEnabled]);\n    }\n  }\n});\n\nexport {screenfull};","import * as Util from '../core/Util';\nimport {Evented} from '../core/Events';\n// import {Class} from '../core/Class';\nimport * as Browser from '../core/Browser';\nimport * as DomEvent from '../dom/DomEvent';\nimport * as DomUtil from '../dom/DomUtil';\n\nimport debounce from 'lodash/debounce';\nimport assign from 'lodash/assign';\n\nimport {screenfull} from '../screenfull';\n\n/*\n * @class Reader\n * @aka cozy.Map\n * @inherits Evented\n *\n * The central class of the API — it is used to create a book on a page and manipulate it.\n *\n * @example\n *\n * ```js\n * // initialize the map on the \"map\" div with a given center and zoom\n * var map = L.map('map', {\n *  center: [51.505, -0.09],\n *  zoom: 13\n * });\n * ```\n *\n */\n\nvar _padding = 1.0;\nexport var Reader = Evented.extend({\n  options: {\n    regions: [\n      'header',\n      'toolbar.top',\n      'toolbar.left',\n      'main',\n      'toolbar.right',\n      'toolbar.bottom',\n      'footer'\n    ],\n    metadata: {},\n    flow: 'auto',\n    engine: 'epubjs',\n    fontSizeLarge: '140%',\n    fontSizeSmall: '90%',\n    fontSizeDefault: '100%',\n    trackResize: true,\n    text_size: 100,\n    mobileMediaQuery: '(min-device-width : 300px) and (max-device-width : 600px)',\n    forceScrolledDocHeight: 1200,\n    theme: 'default',\n    rootfilePath: '',\n    themes: []\n  },\n\n  initialize: function(id, options) {\n    var self = this\n\n    self._original_document_title = document.title;\n\n    if ( localStorage.getItem('cozy.options') ) {\n      options = assign(options, JSON.parse(localStorage.getItem('cozy.options')));\n    }\n    options = Util.setOptions(this, options);\n\n    this._checkFeatureCompatibility();\n\n    this.metadata = this.options.metadata; // initial seed\n\n    this._initContainer(id);\n    this._initLayout();\n\n    if ( this.options.themes && this.options.themes.length > 0 ) {\n        this.options.themes.forEach(function(theme) {\n            if ( theme.href ) { return; }\n            var klass = theme.klass;\n            var rules = {};\n            for(var rule in theme.rules) {\n                var new_rule = '.' + klass;\n                if ( rule == 'body' ) { new_rule = 'body' + new_rule; }\n                else { new_rule += ' ' + rule ; }\n                rules[new_rule] = theme.rules[rule];\n            }\n            theme.rules = rules;\n        });\n    }\n\n    this._updateTheme();\n\n    // hack for https://github.com/Leaflet/Leaflet/issues/1980\n    // this._onResize = Util.bind(this._onResize, this);\n\n    this._initEvents();\n\n    this.callInitHooks();\n\n    this._mode = this.options.mode;\n  },\n\n  start: function(target, cb) {\n    var self = this;\n\n    if ( typeof(target) == 'function' && cb === undefined ) {\n      cb = target;\n      target = undefined;\n    }\n\n    Util.loader.js(this.options.engine_href).then(function() {\n      self._start(target, cb);\n      self._loaded = true;\n    })\n  },\n\n  _start: function(target, cb) {\n    var self = this;\n    target = target || 0;\n\n    // self.open(function() {\n    //   self.draw(target, cb);\n    // });\n\n    self.open(target, cb);\n  },\n\n  reopen: function(options, target) {\n    /* NOP */\n  },\n\n  saveOptions: function(options) {\n    var saved_options = {};\n    assign(saved_options, options);\n    if ( saved_options.flow == 'auto' ) {\n      // do not save\n      delete saved_options.flow;\n    }\n    localStorage.setItem('cozy.options', JSON.stringify(saved_options));\n  },\n\n  _updateTheme: function() {\n    DomUtil.removeClass(this._container, 'cozy-theme-' + ( this._container.dataset.theme || 'default' ));\n    DomUtil.addClass(this._container, 'cozy-theme-' + this.options.theme);\n    this._container.dataset.theme = this.options.theme;\n  },\n\n  draw: function(target) {\n    // NOOP\n  },\n\n  next: function() {\n    // NOOP\n  },\n\n  prev: function() {\n    // NOOP\n  },\n\n  display: function(index) {\n    // NOOP\n  },\n\n  gotoPage: function(target) {\n    // NOOP\n  },\n\n  goBack: function() {\n    history.back();\n  },\n\n  goForward: function() {\n    history.forward();\n  },\n\n  requestFullscreen: function() {\n    if ( screenfull.enabled ) {\n      // this._preResize();\n      screenfull.toggle(this._container);\n    }\n  },\n\n  _preResize: function() {\n\n  },\n\n  _initContainer: function (id) {\n    var container = this._container = DomUtil.get(id);\n\n    if (!container) {\n      throw new Error('Reader container not found.');\n    } else if (container._cozy_id) {\n      throw new Error('Reader container is already initialized.');\n    }\n\n    DomEvent.on(container, 'scroll', this._onScroll, this);\n    this._containerId = Util.stamp(container);\n  },\n\n  _initLayout: function () {\n    var container = this._container;\n\n    this._fadeAnimated = this.options.fadeAnimation && Browser.any3d;\n\n    DomUtil.addClass(container, 'cozy-container' +\n      (Browser.touch ? ' cozy-touch' : '') +\n      (Browser.retina ? ' cozy-retina' : '') +\n      (Browser.ielt9 ? ' cozy-oldie' : '') +\n      (Browser.safari ? ' cozy-safari' : '') +\n      (this._fadeAnimated ? ' cozy-fade-anim' : '') +\n      ' cozy-engine-' + this.options.engine +\n      ' cozy-theme-' + this.options.theme);\n\n    var position = DomUtil.getStyle(container, 'position');\n\n    this._initPanes();\n\n    if ( ! Browser.columnCount ) {\n      this.options.flow = 'scrolled-doc';\n    }\n  },\n\n  _initPanes: function () {\n    var self = this;\n\n    var panes = this._panes = {};\n\n    var l = 'cozy-';\n    var container = this._container;\n\n    var prefix = 'cozy-module-';\n\n    DomUtil.addClass(container, 'cozy-container');\n    panes['top'] = DomUtil.create('div', prefix + 'top', container);\n    panes['main'] = DomUtil.create('div', prefix + 'main', container);\n    panes['bottom'] = DomUtil.create('div', prefix + 'bottom', container);\n\n    panes['left'] = DomUtil.create('div', prefix + 'left', panes['main']);\n    panes['book-cover'] = DomUtil.create('div', prefix + 'book-cover', panes['main']);\n    panes['right'] = DomUtil.create('div', prefix + 'right', panes['main']);\n    panes['book'] = DomUtil.create('div', prefix + 'book', panes['book-cover']);\n    panes['loader'] = DomUtil.create('div', prefix + 'book-loading', panes['book']);\n    panes['epub'] = DomUtil.create('div', prefix + 'book-epub', panes['book']);\n    this._initBookLoader();\n  },\n\n  _checkIfLoaded: function () {\n    if (!this._loaded) {\n      throw new Error('Set map center and zoom first.');\n    }\n  },\n\n  // DOM event handling\n\n  // @section Interaction events\n  _initEvents: function (remove) {\n    this._targets = {};\n    this._targets[Util.stamp(this._container)] = this;\n\n    this.tracking = function(reader) {\n      var _action = [];\n      var _last_location_start;\n      var _reader = reader;\n      return {\n        action: function(v) {\n          if ( v ) {\n            _action = [v];\n            this.event(v);\n            // _reader.fire('trackAction', { action: v })\n          } else {\n            return _action.pop();\n          }\n        },\n\n        event: function(action, data) {\n          if ( data == null ) { data = {}; }\n          data.action = action;\n          _reader.fire(\"trackAction\", data);\n        },\n\n        pageview: function(location) {\n          if ( location.start != _last_location_start ) {\n            _last_location_start = location.start;\n            // console.log(\"AHOY RELOCATED\", location, location.start, location.href, location.location, this.action());\n            _reader.fire('trackPageview', { cfi: location.start, href: location.href, action: this.action()})\n            return true;\n          }\n          return false;\n        }\n      }\n    }(this);\n\n    var onOff = remove ? DomEvent.off : DomEvent.on;\n\n    // @event click: MouseEvent\n    // Fired when the user clicks (or taps) the map.\n    // @event dblclick: MouseEvent\n    // Fired when the user double-clicks (or double-taps) the map.\n    // @event mousedown: MouseEvent\n    // Fired when the user pushes the mouse button on the map.\n    // @event mouseup: MouseEvent\n    // Fired when the user releases the mouse button on the map.\n    // @event mouseover: MouseEvent\n    // Fired when the mouse enters the map.\n    // @event mouseout: MouseEvent\n    // Fired when the mouse leaves the map.\n    // @event mousemove: MouseEvent\n    // Fired while the mouse moves over the map.\n    // @event contextmenu: MouseEvent\n    // Fired when the user pushes the right mouse button on the map, prevents\n    // default browser context menu from showing if there are listeners on\n    // this event. Also fired on mobile when the user holds a single touch\n    // for a second (also called long press).\n    // @event keypress: KeyboardEvent\n    // Fired when the user presses a key from the keyboard while the map is focused.\n    // onOff(this._container, 'click dblclick mousedown mouseup ' +\n    //   'mouseover mouseout mousemove contextmenu keypress', this._handleDOMEvent, this);\n\n    // if (this.options.trackResize) {\n    //   var self = this;\n    //   var fn = debounce(function(){ self.invalidateSize({}); }, 150);\n    //   onOff(window, 'resize', fn, this);\n    // }\n\n    if (Browser.any3d && this.options.transform3DLimit) {\n      (remove ? this.off : this.on).call(this, 'moveend', this._onMoveEnd);\n    }\n\n    var self = this;\n    if (screenfull.enabled) {\n      screenfull.on('change', function() {\n        // setTimeout(function() {\n        //   self.invalidateSize({});\n        // }, 100);\n        console.log('AHOY: Am I fullscreen?', screenfull.isFullscreen ? 'YES' : 'NO');\n      });\n    }\n\n    self.on(\"updateLocation\", function(location) {\n      var location_href = location.start;\n\n      if ( self._ignoreHistory ) {\n        self._ignoreHistory = false;\n        return;\n      }\n\n      if ( self.tracking.pageview(location) ) {\n        var tmp_href = window.location.href.split(\"#\");\n        tmp_href[1] = location.start.substr(8, location.start.length - 8 - 1);\n        history.pushState({ cfi: location.start }, '', tmp_href.join('#'));\n\n        if ( location.percentage ) {\n          var p = Math.ceil(location.percentage * 100);\n          document.title = `${self._original_document_title} - ${p}%`;\n        }        \n      }\n    })\n\n    window.addEventListener('popstate', function(event) {\n      if ( event.isTrusted && event.state !== null ) {\n        self._ignoreHistory = true;\n        self.gotoPage(event.state.cfi);\n      }\n    })\n\n    document.addEventListener('keydown', function(event) {\n      var keyName = event.key;\n      var target = event.target;\n\n      // check if the activeElement is \".special-panel\"\n      var check = document.activeElement;\n      while ( check.localName != 'body' ) {\n        if ( check.classList.contains('special-panel') ) {\n          return;\n        }\n        check = check.parentElement;\n      }\n\n      var IGNORE_TARGETS = [ 'input', 'target' ];\n      if ( IGNORE_TARGETS.indexOf(target.localName) >= 0 ) {\n        return;\n      }\n\n      self.fire('keyDown', { keyName: keyName, shiftKey: event.shiftKey });\n    });\n\n    self.on('keyDown', function(data) {\n      switch(data.keyName) {\n        case 'ArrowRight':\n        case 'PageDown':\n          self.next();\n          break;\n        case 'ArrowLeft':\n        case 'PageUp':\n          self.prev();\n          break;\n        case 'Home':\n          self._scroll('HOME');\n          break;\n        case 'End':\n          self._scroll('END')\n          break;\n      }\n    });\n  },\n\n  // _onResize: function() {\n  //   if ( ! this._resizeRequest ) {\n  //     this._resizeRequest = Util.requestAnimFrame(function() {\n  //       this.invalidateSize({})\n  //     }, this);\n  //   }\n  // },\n\n  _onScroll: function () {\n    this._container.scrollTop  = 0;\n    this._container.scrollLeft = 0;\n  },\n\n  _handleDOMEvent: function (e) {\n    if (!this._loaded || DomEvent.skipped(e)) { return; }\n\n    var type = e.type === 'keypress' && e.keyCode === 13 ? 'click' : e.type;\n\n    if (type === 'mousedown') {\n      // prevents outline when clicking on keyboard-focusable element\n      DomUtil.preventOutline(e.target || e.srcElement);\n    }\n\n    this._fireDOMEvent(e, type);\n  },\n\n  _fireDOMEvent: function (e, type, targets) {\n\n    if (e.type === 'click') {\n      // Fire a synthetic 'preclick' event which propagates up (mainly for closing popups).\n      // @event preclick: MouseEvent\n      // Fired before mouse click on the map (sometimes useful when you\n      // want something to happen on click before any existing click\n      // handlers start running).\n      var synth = Util.extend({}, e);\n      synth.type = 'preclick';\n      this._fireDOMEvent(synth, synth.type, targets);\n    }\n\n    if (e._stopped) { return; }\n\n    // Find the layer the event is propagating from and its parents.\n    targets = (targets || []).concat(this._findEventTargets(e, type));\n\n    if (!targets.length) { return; }\n\n    var target = targets[0];\n    if (type === 'contextmenu' && target.listens(type, true)) {\n      DomEvent.preventDefault(e);\n    }\n\n    var data = {\n      originalEvent: e\n    };\n\n    if (e.type !== 'keypress') {\n      var isMarker = (target.options && 'icon' in target.options);\n      data.containerPoint = isMarker ?\n          this.latLngToContainerPoint(target.getLatLng()) : this.mouseEventToContainerPoint(e);\n      data.layerPoint = this.containerPointToLayerPoint(data.containerPoint);\n      data.latlng = isMarker ? target.getLatLng() : this.layerPointToLatLng(data.layerPoint);\n    }\n\n    for (var i = 0; i < targets.length; i++) {\n      targets[i].fire(type, data, true);\n      if (data.originalEvent._stopped ||\n        (targets[i].options.nonBubblingEvents && Util.indexOf(targets[i].options.nonBubblingEvents, type) !== -1)) { return; }\n    }\n  },\n\n  getFixedBookPanelSize: function() {\n    // have to make the book\n    var style = window.getComputedStyle(this._panes['book']);\n    var h = this._panes['book'].clientHeight - parseFloat(style.paddingTop) - parseFloat(style.paddingBottom);\n    var w = this._panes['book'].clientWidth - parseFloat(style.paddingRight) - parseFloat(style.paddingLeft);\n    return { height: Math.floor(h * 1.00), width: Math.floor(w * 1.00) };\n  },\n\n  invalidateSize: function(options) {\n    // TODO: IS THIS EVER USED?\n    var self = this;\n\n    if ( ! self._drawn ) { return; }\n\n    Util.cancelAnimFrame(this._resizeRequest);\n\n    if (! this._loaded) { return this; }\n\n    this.fire('resized');\n  },\n\n  _resizeBookPane: function() {\n\n  },\n\n  _setupHooks: function() {\n\n  },\n\n  _checkFeatureCompatibility: function() {\n    if ( ! DomUtil.isPropertySupported('columnCount') || this._checkMobileDevice() ) {\n      // force\n      this.options.flow = 'scrolled-doc';\n    }\n    if ( this._checkMobileDevice() ) {\n      // this.options.fontSizeLarge = '160%';\n      // this.options.fontSizeSmall ='100%';\n      // this.options.fontSizeDefault = '120%';\n      this.options.text_size = 120;\n    }\n  },\n\n  _checkMobileDevice: function() {\n    if ( this._isMobile === undefined ) {\n      this._isMobile = false;\n      if ( this.options.mobileMediaQuery ) {\n        this._isMobile = window.matchMedia(this.options.mobileMediaQuery).matches;\n      }\n    }\n    return this._isMobile;\n  },\n\n  _enableBookLoader: function(delay=0) {\n    var self = this;\n    self._clearBookLoaderTimeout();\n    if ( delay < 0 ) {\n      delay = 0;\n      self._force_progress = true;\n    }\n    self._loader_timeout = setTimeout(function() {\n      self._panes['loader'].style.display = 'block';\n    }, delay);\n  },\n\n  _disableBookLoader: function(force=false) {\n    var self = this;\n    self._clearBookLoaderTimeout();\n    if ( ! self._force_progress || force ) {\n      self._panes['loader'].style.display = 'none';\n      self._force_progress = false;\n      self._panes['loader-status'].innerHTML = '';\n    }\n  },\n\n  _clearBookLoaderTimeout: function() {\n    var self = this;\n    if ( self._loader_timeout ) {\n      clearTimeout(self._loader_timeout);\n      self._loader_timeout = null;\n    }\n  },\n\n  _initBookLoader: function() {\n    // is this not awesome?\n    var template = this.options.loader_template || this.loaderTemplate();\n\n    var body = new DOMParser().parseFromString(template, \"text/html\").body;\n    while ( body.children.length ) {\n      this._panes['loader'].appendChild(body.children[0]);\n    }\n    this._panes['loader-status'] = DomUtil.create('div', 'cozy-module-book-loading-status', this._panes['loader']);\n  },\n\n  loaderTemplate: function() {\n    return `<div class=\"cozy-loader-spinner\">\n    <div class=\"spinner-backdrop spinner-backdrop--1\"></div>\n    <div class=\"spinner-backdrop spinner-backdrop--2\"></div>\n    <div class=\"spinner-backdrop spinner-backdrop--3\"></div>\n    <div class=\"spinner-backdrop spinner-backdrop--4\"></div>\n    <div class=\"spinner-quarter spinner-quarter--1\"></div>\n    <div class=\"spinner-quarter spinner-quarter--2\"></div>\n    <div class=\"spinner-quarter spinner-quarter--3\"></div>\n    <div class=\"spinner-quarter spinner-quarter--4\"></div>\n  </div>`;\n  },\n\n  EOT: true\n});\n\nexport function createReader(id, options) {\n  return new Reader(id, options);\n}\n","import {Class} from '../core/Class';\nimport {Reader} from '../reader/Reader';\nimport * as Util from '../core/Util';\nimport * as DomUtil from '../dom/DomUtil';\n\n/*\n * @class Control\n * @aka L.Control\n * @inherits Class\n *\n * L.Control is a base class for implementing reader controls. Handles regioning.\n * All other controls extend from this class.\n */\n\nexport var Control = Class.extend({\n    // @section\n    // @aka Control options\n    options: {\n        // @option region: String = 'topright'\n        // The region of the control (one of the reader corners). Possible values are `'topleft'`,\n        // `'topright'`, `'bottomleft'` or `'bottomright'`\n    },\n\n    initialize: function (options) {\n        Util.setOptions(this, options);\n        if ( options.container ) {\n            this._container = options.container;\n            this._locked = true;\n        }\n        this._id = (new Date()).getTime() + '-' + parseInt(Math.random((new Date()).getTime()) * 1000, 10);\n    },\n\n    /* @section\n     * Classes extending L.Control will inherit the following methods:\n     *\n     * @method getRegion: string\n     * Returns the region of the control.\n     */\n    getRegion: function () {\n        return this.options.region;\n    },\n\n    // @method setRegion(region: string): this\n    // Sets the region of the control.\n    setRegion: function (region) {\n        var reader = this._reader;\n\n        if (reader) {\n            reader.removeControl(this);\n        }\n\n        this.options.region = region;\n\n        if (reader) {\n            reader.addControl(this);\n        }\n\n        return this;\n    },\n\n    // @method getContainer: HTMLElement\n    // Returns the HTMLElement that contains the control.\n    getContainer: function () {\n        return this._container;\n    },\n\n    // @method addTo(reader: Map): this\n    // Adds the control to the given reader.\n    addTo: function (reader) {\n        this.remove();\n        this._reader = reader;\n\n        var container = this._container = this.onAdd(reader);\n\n        DomUtil.addClass(container, 'cozy-control');\n\n        if ( ! this._locked ) {\n            var region = this.getRegion();\n            var area = reader.getControlRegion(region);\n            area.appendChild(container);\n        }\n\n        return this;\n    },\n\n    // @method remove: this\n    // Removes the control from the reader it is currently active on.\n    remove: function () {\n        if (!this._reader) {\n            return this;\n        }\n\n        if (! this._container) {\n            return this;\n        }\n\n        if ( ! this._locked ) {\n            DomUtil.remove(this._container);\n        }\n\n        if (this.onRemove) {\n            this.onRemove(this._reader);\n        }\n\n        this._reader = null;\n\n        return this;\n    },\n\n    _refocusOnMap: function (e) {\n        // if reader exists and event is not a keyboard event\n        if (this._reader && e && e.screenX > 0 && e.screenY > 0) {\n            this._reader.getContainer().focus();\n        }\n    },\n\n    _className: function(widget) {\n        var className = [ 'cozy-control' ];\n        if ( this.options.direction ) {\n            className.push('cozy-control-' + this.options.direction);\n        }\n        if ( widget ) {\n            className.push('cozy-control-' + widget);\n        }\n        return className.join(' ');\n    }\n});\n\nexport var control = function (options) {\n    return new Control(options);\n};\n\n/* @section Extension methods\n * @uninheritable\n *\n * Every control should extend from `L.Control` and (re-)implement the following methods.\n *\n * @method onAdd(reader: Map): HTMLElement\n * Should return the container DOM element for the control and add listeners on relevant reader events. Called on [`control.addTo(reader)`](#control-addTo).\n *\n * @method onRemove(reader: Map)\n * Optional method. Should contain all clean up code that removes the listeners previously added in [`onAdd`](#control-onadd). Called on [`control.remove()`](#control-remove).\n */\n\n/* @namespace Map\n * @section Methods for Layers and Controls\n */\nReader.include({\n    // @method addControl(control: Control): this\n    // Adds the given control to the reader\n    addControl: function (control) {\n        control.addTo(this);\n        return this;\n    },\n\n    // @method removeControl(control: Control): this\n    // Removes the given control from the reader\n    removeControl: function (control) {\n        control.remove();\n        return this;\n    },\n\n    getControlContainer: function() {\n        var l = 'cozy-';\n        if ( ! this._controlContainer ) {\n            this._controlContainer =\n                DomUtil.create('div', l + 'control-container', this._container);\n        }\n        return this._controlContainer;\n    },\n\n    getControlRegion: function (target) {\n\n        if ( ! this._panes[target] ) {\n            // target is dot-delimited string\n            // first dot is the panel\n            var parts = target.split('.');\n            var tmp = [];\n            var parent = this._container;\n            var x = 0;\n            while ( parts.length ) {\n                var slug = parts.shift();\n                tmp.push(slug);\n                var panel = tmp.join(\".\");\n                var className = 'cozy-panel-' + slug;\n                if ( ! this._panes[panel] ) {\n                    this._panes[panel] = DomUtil.create('div', className, parent);\n                }\n                parent = this._panes[panel];\n                x += 1;\n                if ( x > 100 ) { break; }\n            }\n        }\n        return this._panes[target];\n    },\n\n    getControlRegion_1: function (target) {\n\n        var tmp = target.split('.');\n        var region = tmp.shift();\n        var slot = tmp.pop() || '-slot';\n\n        var container = this._panes[region];\n        if ( ! this._panes[target] ) {\n            var className = 'cozy-' + region + '--item cozy-slot-' + slot\n            if ( ! this._panes[region + '.' + slot] ) {\n                var div = DomUtil.create('div', className);\n                if ( slot == 'left' || slot == 'bottom' ) {\n                    var childElement = this._panes[region].firstChild;\n                    this._panes[region].insertBefore(div, childElement);\n                } else {\n                    this._panes[region].appendChild(div);\n                }\n                this._panes[region + '.' + slot] = div;\n            }\n            className = this._classify(tmp);\n            this._panes[target] = DomUtil.create('div', className, this._panes[region + '.' + slot]);\n        }\n\n        return this._panes[target];\n    },\n\n    _classify: function(tmp) {\n        var l = 'cozy-';\n        var className = [];\n        for(var i in tmp) {\n            className.push(l + tmp[i]);\n        }\n        className = className.join(' ');\n        return className;\n    },\n\n    _clearControlRegion: function () {\n        for (var i in this._controlRegions) {\n            DomUtil.remove(this._controlRegions[i]);\n        }\n        DomUtil.remove(this._controlContainer);\n        delete this._controlRegions;\n        delete this._controlContainer;\n    }\n});\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nvar PageControl = Control.extend({\n  onAdd: function(reader) {\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n      container = DomUtil.create('div', className),\n\n      this._control  = this._createButton(this._fill(options.html || options.label), this._fill(options.label),\n              className, container);\n    }\n    this._bindEvents();\n\n    return container;\n  },\n\n  _createButton: function (html, title, className, container) {\n    var link = DomUtil.create('a', className, container);\n    link.innerHTML = html;\n    link.href = '#';\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    return link;\n  },\n\n  _bindEvents: function() {\n    var self = this;\n    DomEvent.disableClickPropagation(this._control);\n    DomEvent.on(this._control, 'click', DomEvent.stop);\n    DomEvent.on(this._control, 'click', this._action, this);\n\n    this._reader.on('reopen', function(data) {\n      // update the button text / titles\n      var html = self.options.html || self.options.label;\n      self._control.innerHTML = self._fill(html);\n      self._control.setAttribute('title', self._fill(self.options.label));\n      self._control.setAttribute('aria-label', self._fill(self.options.label));\n    });\n\n  },\n\n  _unit: function() {\n    return ( this._reader.options.flow == 'scrolled-doc' ) ? 'Section' : 'Page';\n  },\n\n  _fill: function(s) {\n    var unit = this._unit();\n    return s.replace(/\\$\\{unit\\}/g, unit);\n  },\n\n  _label: function() {\n    return this.options.label + \" \" + ( this._reader.options.flow == 'scrolled-doc' ) ? 'Section' : 'Page';\n  },\n\n  EOT: true\n});\n\nexport var PagePrevious = PageControl.extend({\n  options: {\n    region: 'edge.left',\n    direction: 'previous',\n    label: 'Previous ${unit}',\n    html: '<i class=\"icon-chevron-left oi\" data-glyph=\"chevron-left\" title=\"Previous ${unit}\" aria-hidden=\"true\"></i>'\n  },\n\n  _action: function(e) {\n    this._reader.prev();\n  }\n});\n\nexport var PageNext = PageControl.extend({\n  options: {\n    region: 'edge.right',\n    direction: 'next',\n    label: 'Next ${unit}',\n    html: '<i class=\"icon-chevron-right oi\" data-glyph=\"chevron-right\" title=\"Next ${unit}\" aria-hidden=\"true\"></i>'\n  },\n\n  _action: function(e) {\n    this._reader.next();\n  }\n});\n\nexport var PageFirst = PageControl.extend({\n  options: {\n    direction: 'first',\n    label: 'First ${unit}'\n  },\n  _action: function(e) {\n      this._reader.first();\n  }\n});\n\nexport var PageLast = PageControl.extend({\n  options: {\n    direction: 'last',\n    label: 'Last ${unit}'\n  },\n  _action: function(e) {\n      this._reader.last();\n  }\n});\n\nexport var pageNext = function(options) {\n  return new PageNext(options);\n}\n\nexport var pagePrevious = function(options) {\n  return new PagePrevious(options);\n}\n\nexport var pageFirst = function(options) {\n  return new PageFirst(options);\n}\n\nexport var pageLast = function(options) {\n  return new PageLast(options);\n}\n","import {Class} from '../core/Class';\nimport {Reader} from '../reader/Reader';\nimport * as Util from '../core/Util';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nimport assign from 'lodash/assign';\n\nvar activeModal;\nvar dismissModalListener = false;\n\n// from https://github.com/ghosh/micromodal/blob/master/src/index.js\nconst FOCUSABLE_ELEMENTS = [\n    'a[href]',\n    'area[href]',\n    'input:not([disabled]):not([type=\"hidden\"])',\n    'select:not([disabled])',\n    'textarea:not([disabled])',\n    'button:not([disabled])',\n    'iframe',\n    'object',\n    'embed',\n    '[contenteditable]',\n    '[tabindex]:not([tabindex^=\"-\"])'\n  ];\n\nconst ACTIONABLE_ELEMENTS = [\n    'a[href]',\n    'area[href]',\n    'input[type=\"submit\"]:not([disabled])',\n    'button:not([disabled])'\n  ];\n\nexport var Modal = Class.extend({\n  options: {\n    // @option region: String = 'topright'\n    // The region of the control (one of the reader edges). Possible values are `'left' ad 'right'`\n    region: 'left',\n    fraction: 0,\n    width: null,\n    className: {},\n    actions: null,\n    callbacks: { onShow: function() {}, onClose: function() {} },\n    handlers: {}\n  },\n\n  initialize: function (options) {\n    options = Util.setOptions(this, options);\n    this._id = (new Date()).getTime() + '-' + parseInt(Math.random((new Date()).getTime()) * 1000, 10);\n    this._initializedEvents = false;\n    this.callbacks = assign({}, this.options.callbacks);\n    this.actions = this.options.actions ? assign({}, this.options.actions) : null;\n    this.handlers = assign({}, this.options.handlers);\n    if ( typeof(this.options.className) == 'string' ) {\n      this.options.className = { container: this.options.className };\n    }\n  },\n\n  addTo: function(reader) {\n    var self = this;\n    this._reader = reader;\n    var template = this.options.template;\n\n    var panelHTML = `<div class=\"cozy-modal modal-slide ${this.options.region || 'left'}\" id=\"modal-${this._id}\" aria-labelledby=\"modal-${this._id}-title\" role=\"dialog\" aria-describedby=\"modal-${this._id}-content\" aria-hidden=\"true\">\n      <div class=\"modal__overlay\" tabindex=\"-1\" data-modal-close>\n        <div class=\"modal__container ${this.options.className.container ? this.options.className.container : ''}\" role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"modal-${this._id}-title\" aria-describedby=\"modal-${this._id}-content\" id=\"modal-${this._id}-container\">\n          <div role=\"document\">\n            <header class=\"modal__header\">\n              <h3 class=\"modal__title\" id=\"modal-${this._id}-title\">${this.options.title}</h3>\n              <button class=\"modal__close\" aria-label=\"Close modal\" aria-controls=\"modal-${this._id}-container\" data-modal-close></button>\n            </header>\n            <main class=\"modal__content ${this.options.className.main ? this.options.className.main : ''}\" id=\"modal-${this._id}-content\">\n              ${template}\n            </main>`;\n\n    if ( this.options.actions ) {\n      panelHTML += '<footer class=\"modal__footer\">'\n      for(var i in this.options.actions) {\n        var action = this.options.actions[i];\n        var button_cls = action.className || 'button--default';\n        panelHTML += `<button id=\"action-${this._id}-${i}\" class=\"button button--lg ${button_cls}\">${action.label}</button>`;\n      }\n      panelHTML += '</footer>';\n    }\n\n    panelHTML += '</div></div></div></div>';\n\n    var body = new DOMParser().parseFromString(panelHTML, \"text/html\").body;\n\n    this.modal = reader._container.appendChild(body.children[0]);\n    this._container = this.modal; // compatibility\n\n    this.container = this.modal.querySelector('.modal__container');\n    this._bindEvents();\n    return this;\n  },\n\n  _bindEvents: function() {\n    var self = this;\n    this.onClick = this.onClick.bind(this);\n    this.onKeydown = this.onKeydown.bind(this);\n    this.onModalTransition = this.onModalTransition.bind(this);\n\n    this.modal.addEventListener('transitionend', function() {\n    }.bind(this));\n\n    // bind any actions\n    if ( this.actions ) {\n      for(var i in this.actions) {\n        let action = this.actions[i];\n        let button_id = '#action-' + this._id + '-' + i;\n        let button = this.modal.querySelector(button_id);\n        if ( button ) {\n          DomEvent.on(button, 'click', function(event) {\n            event.preventDefault();\n            action.callback(event);\n            if ( action.close ) {\n              self.closeModal();\n            }\n          })\n        }\n      }\n    }\n  },\n\n  deactivate: function() {\n    this.closeModal();\n  },\n\n  closeModal: function() {\n    var self = this;\n    this.modal.setAttribute('aria-hidden', 'true');\n    this.removeEventListeners();\n    if ( this.activeElement ) {\n      this.activeElement.focus();\n    }\n    this.callbacks.onClose(this.modal);\n  },\n\n  showModal: function() {\n    this.activeElement = document.activeElement\n    this._resize();\n    this.modal.setAttribute('aria-hidden', 'false')\n    this.setFocusToFirstNode()\n    this.addEventListeners()\n    this.callbacks.onShow(this.modal)\n  },\n\n  activate: function() {\n    return this.showModal();\n    var self = this;\n    activeModal = this;\n    DomUtil.addClass(self._reader._container, 'st-modal-activating');\n    this._resize();\n    DomUtil.addClass(this._reader._container, 'st-modal-open');\n    setTimeout(function() {\n      DomUtil.addClass(self._container, 'active');\n      DomUtil.removeClass(self._reader._container, 'st-modal-activating');\n      self._container.setAttribute('aria-hidden', 'false');\n      self.setFocusToFirstNode();\n    }, 25);\n  },\n\n  addEventListeners: function () {\n    // --- do we need touch listeners?\n    // this.modal.addEventListener('touchstart', this.onClick)\n    // this.modal.addEventListener('touchend', this.onClick)\n    this.modal.addEventListener('click', this.onClick)\n    document.addEventListener('keydown', this.onKeydown)\n    'webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend'.split(' ').forEach(function(event) {\n      this.modal.addEventListener(event, this.onModalTransition);\n    }.bind(this))\n  },\n\n  removeEventListeners: function () {\n    this.modal.removeEventListener('touchstart', this.onClick)\n    this.modal.removeEventListener('click', this.onClick)\n    'webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend'.split(' ').forEach(function(event) {\n      this.modal.removeEventListener(event, this.onModalTransition);\n    }.bind(this))\n    document.removeEventListener('keydown', this.onKeydown)\n  },\n\n  _resize: function() {\n    var container = this._reader._container;\n    this.container.style.height = container.offsetHeight + 'px';\n    console.log(\"AHOY MODAL\", this.container.style.height);\n    if ( ! this.options.className.container  ) {\n      this.container.style.width = this.options.width || parseInt(container.offsetWidth * this.options.fraction) + 'px';\n    }\n\n    var header = this.container.querySelector('header');\n    var footer = this.container.querySelector('footer');\n    var main = this.container.querySelector('main');\n    var height = this.container.clientHeight - header.clientHeight;\n    if ( footer ) {\n      height -= footer.clientHeight;\n    }\n    main.style.height = height + 'px';\n  },\n\n  getFocusableNodes: function() {\n    const nodes = this.modal.querySelectorAll(FOCUSABLE_ELEMENTS);\n    return Object.keys(nodes).map((key) => nodes[key]);\n  },\n\n  setFocusToFirstNode: function() {\n    var focusableNodes = this.getFocusableNodes();\n    if ( focusableNodes.length ) {\n      focusableNodes[0].focus();\n    } else {\n      activeModal._container.focus();\n    }\n  },\n\n  getActionableNodes: function() {\n    const nodes = this.modal.querySelectorAll(ACTIONABLE_ELEMENTS);\n    return Object.keys(nodes).map((key) => nodes[key]);\n  },\n\n  onKeydown: function(event) {\n    if ( event.keyCode == 27 ) { this.closeModal(); }\n    if ( event.keyCode == 9 ) {\n      this.maintainFocus(event);\n    }\n  },\n\n  onClick: function(event) {\n\n    var closeAfterAction = false;\n    var target = event.target;\n\n    // As far as I can tell, the code below isn't catching direct clicks on\n    // items with class='data-modal-close' as they're not ACTIONABLE_ELEMENTS.\n    // Adding them to ACTIONABLE_ELEMENTS causes undesirable behavior where\n    // their child items also close the modal thanks to the loop below.\n    // Children of .modal__overlay include the modal header, border area and\n    // padding. We don't want clicks on these closing the modal.\n    // Just close the modal now for direct clicks on a '.data-modal-close'.\n    if (target.hasAttribute('data-modal-close')) {\n      this.fire('closed');\n      this.closeModal();\n      return;\n    }\n\n    // if the target isn't an actionable type, walk the DOM until\n    // one is found\n    var actionableNodes = this.getActionableNodes();\n    while ( actionableNodes.indexOf(target) < 0 && target != this.modal ) {\n      target = target.parentElement;\n    }\n\n    // no target found, punt\n    if ( actionableNodes.indexOf(target) < 0 ) {\n      return;\n    }\n\n    if (this.handlers.click) {\n      var did_match = false;\n      for(var selector in this.handlers.click) {\n        if ( target.matches(selector) ) {\n          closeAfterAction = this.handlers.click[selector](this, target);\n          break;\n        }\n      }\n    }\n\n    if (closeAfterAction || target.hasAttribute('data-modal-close')) this.closeModal();\n\n    event.preventDefault();\n  },\n\n  onModalTransition: function(event) {\n    if ( this.modal.getAttribute('aria-hidden') == 'true' ) {\n      this._reader.fire('modal-closed');\n    } else {\n      this._reader.fire('modal-opened');\n    }\n  },\n\n  on: function(event, selector, handler) {\n    if (! this.handlers[event] ) {\n      this.handlers[event] = {};\n    }\n    if (typeof(selector) == 'function') {\n      handler = selector;\n      selector = '*';\n    }\n    this.handlers[event][selector] = handler;\n  },\n\n  fire: function(event) {\n    if ( this.handlers[event] && this.handlers[event]['*'] ) {\n      this.handlers[event]['*'](this);\n    }\n  },\n\n  maintainFocus: function(event) {\n    var focusableNodes = this.getFocusableNodes();\n    var focusedItemIndex = focusableNodes.indexOf(document.activeElement);\n    if (event.shiftKey && focusedItemIndex === 0) {\n      focusableNodes[focusableNodes.length - 1].focus()\n      event.preventDefault()\n    }\n\n    if (!event.shiftKey && focusedItemIndex === focusableNodes.length - 1) {\n      focusableNodes[0].focus()\n      event.preventDefault()\n    }\n  },\n\n  EOT: true\n});\n\nReader.include({\n  modal: function (options) {\n    var modal = new Modal(options);\n    return modal.addTo(this);\n    // return this;\n  },\n\n  EOT: true\n});\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport {Modal} from './Modal';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Contents = Control.extend({\n\n  defaultTemplate: `<button class=\"button--sm\" data-toggle=\"open\" aria-label=\"Table of Contents\"><i class=\"icon-menu oi\" data-glyph=\"menu\" title=\"Table of Contents\" aria-hidden=\"true\"></i></button>`,\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    this._control.setAttribute('id', 'action-' + this._id);\n    container.style.position = 'relative';\n\n    this._reader.on('updateContents', function(data) {\n\n      DomEvent.on(this._control, 'click', function(event) {\n        event.preventDefault();\n        self._reader.tracking.action('contents/open');\n        self._modal.activate();\n      }, this)\n\n      this._modal = this._reader.modal({\n        template: '<ul></ul>',\n        title: 'Contents',\n        region: 'left',\n        className: 'cozy-modal-contents'\n      });\n\n      this._modal.on('click', 'a[href]', function(modal, target) {\n        target = target.getAttribute('data-href');\n        this._reader.tracking.action('contents/go');\n        this._reader.gotoPage(target);\n        return true;\n      }.bind(this))\n\n      this._modal.on('closed', function() {\n        self._reader.tracking.action('contents/close');\n      })\n\n      this._setupSkipLink();\n\n      var parent = self._modal._container.querySelector('ul');\n      // var s = data.toc.filter(function(value) { return value.parent == null }).map(function(value) { return [ value, 0, parent ] });\n      // while ( s.length ) {\n      //   var tuple = s.shift();\n      //   var chapter = tuple[0];\n      //   var tabindex = tuple[1];\n      //   var parent = tuple[2];\n\n      //   var option = self._createOption(chapter, tabindex, parent);\n      //   data.toc.filter(function(value) { return value.parent == chapter.id }).reverse().forEach(function(chapter_) {\n      //     s.unshift([chapter_, tabindex + 1, option]);\n      //   });\n      // }\n      var _process = function(items, tabindex, parent) {\n        items.forEach(function(item) {\n          var option = self._createOption(item, tabindex, parent);\n          if ( item.subitems.length ) {\n            _process(item.subitems, tabindex + 1, option);\n          }\n        })\n      }\n      _process(data.toc, 0, parent);\n    }.bind(this))\n\n    return container;\n  },\n\n  _createOption(chapter, tabindex, parent) {\n\n    function pad(value, length) {\n        return (value.toString().length < length) ? pad(\"-\"+value, length):value;\n    }\n    var option = DomUtil.create('li');\n    if ( chapter.href ) {\n      var anchor = DomUtil.create('a', null, option);\n      anchor.textContent = chapter.label;\n      // var tab = pad('', tabindex); tab = tab.length ? tab + ' ' : '';\n      // option.textContent = tab + chapter.label;\n      anchor.setAttribute('href', chapter.href);\n      anchor.setAttribute('data-href', chapter.href);\n    } else {\n      var span = DomUtil.create('span', null, option);\n      span.textContent = chapter.label;\n    }\n\n    if ( parent.tagName == 'LI' ) {\n      // need to nest\n      var tmp = parent.querySelector('ul');\n      if ( ! tmp ) {\n        tmp = DomUtil.create('ul', null, parent);\n      }\n      parent = tmp;\n    }\n\n    parent.appendChild(option);\n    return option;\n  },\n\n  _setupSkipLink: function() {\n    if ( ! this.options.skipLink ) { return; }\n      \n    var target = document.querySelector(this.options.skipLink);\n    if ( ! target ) { return; }\n\n    var link = document.createElement('a');\n    link.textContent = 'Skip to contents';\n    link.setAttribute('href', '#action-' + this._id);\n\n    var ul = target.querySelector('ul');\n    if ( ul ) {\n      // add to list\n      target = document.createElement('li');\n      ul.appendChild(target);\n    }\n    target.appendChild(link);\n    link.addEventListener('click', function(event) {\n      event.preventDefault();\n      event.stopPropagation();\n      this._control.click();\n    }.bind(this))\n\n  },\n\n  EOT: true\n});\n\nexport var contents = function(options) {\n  return new Contents(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\n// Title + Chapter\n\nexport var Title = Control.extend({\n  onAdd: function(reader) {\n    var self = this;\n    var className = this._className(),\n        container = DomUtil.create('div', className),\n        options = this.options;\n\n    // var template = '<h1><span class=\"cozy-title\">Contents: </span><select size=\"1\" name=\"contents\"></select></label>';\n    // var control = new DOMParser().parseFromString(template, \"text/html\").body.firstChild;\n\n    var h1 = DomUtil.create('h1', 'cozy-h1', container);\n    DomUtil.setOpacity(h1, 0);\n    this._title = DomUtil.create('span', 'cozy-title', h1);\n    this._divider = DomUtil.create('span', 'cozy-divider', h1);\n    this._divider.textContent = \" · \";\n    this._section = DomUtil.create('span', 'cozy-section', h1);\n\n    // --- TODO: disable until we can work out how to \n    // --- more reliably match the current section to the contents\n    // this._reader.on('updateSection', function(data) {\n    //   if ( data && data.label ) {\n    //     self._section.textContent = data.label;\n    //     DomUtil.setOpacity(self._section, 1.0);\n    //     DomUtil.setOpacity(self._divider, 1.0);\n    //   } else {\n    //     DomUtil.setOpacity(self._section, 0);\n    //     DomUtil.setOpacity(self._divider, 0);\n    //   }\n    // })\n\n    this._reader.on('updateTitle', function(data) {\n      if ( data ) {\n        self._title.textContent = data.title || data.bookTitle;\n        DomUtil.setOpacity(self._section, 0);\n        DomUtil.setOpacity(self._divider, 0);\n        DomUtil.setOpacity(h1, 1);\n      }\n    })\n\n    return container;\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('a', className, container);\n    link.innerHTML = html;\n    link.href = '#';\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n    // DomEvent.on(link, 'click', this._refocusOnMap, this);\n\n    return link;\n  },\n\n  EOT: true\n});\n\nexport var title = function(options) {\n  return new Title(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\n// Title + Chapter\n\nexport var PublicationMetadata = Control.extend({\n  onAdd: function(reader) {\n    var self = this;\n    var className = this._className(),\n        container = DomUtil.create('div', className),\n        options = this.options;\n\n    // var template = '<h1><span class=\"cozy-title\">Contents: </span><select size=\"1\" name=\"contents\"></select></label>';\n    // var control = new DOMParser().parseFromString(template, \"text/html\").body.firstChild;\n\n    this._publisher = DomUtil.create('div', 'cozy-publisher', container);\n    this._rights = DomUtil.create('div', 'cozy-rights', container);\n\n    this._reader.on('updateTitle', function(data) {\n      if ( data ) {\n        self._publisher.textContent = data.publisher;\n        self._rights.textContent = data.rights;\n      }\n    })\n\n    return container;\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('a', className, container);\n    link.innerHTML = html;\n    link.href = '#';\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n    // DomEvent.on(link, 'click', this._refocusOnMap, this);\n\n    return link;\n  },\n\n  EOT: true\n});\n\nexport var publicationMetadata = function(options) {\n  return new PublicationMetadata(options);\n}\n","import {Class} from '../core/Class';\nimport {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\nimport * as Util from '../core/Util';\n\nimport assign from 'lodash/assign';\nimport keys from 'lodash/keys';\n\nexport var Preferences = Control.extend({\n  options: {\n    label: 'Preferences',\n    hasThemes: false,\n    html: '<i class=\"icon-cog oi\" data-glyph=\"cog\" title=\"Preferences and Settings\" aria-hidden=\"true\"></i>'\n  },\n\n  onAdd: function(reader) {\n    var self = this;\n    var className = this._className('preferences'),\n        container = DomUtil.create('div', className),\n        options = this.options;\n\n    this._activated = false;\n    this._control = this._createButton(options.html || options.label, options.label,\n            className, container, this._action)\n\n    // self.initializeForm();\n    this._modal = this._reader.modal({\n      // template: '<form></form>',\n      title: 'Preferences',\n      className: 'cozy-modal-preferences',\n      actions: [\n        {\n          label: 'Save Changes',\n          callback: function(event) {\n            self.updatePreferences(event);\n          }\n        }\n      ],\n      region: 'right'\n    });\n\n\n    return container;\n  },\n\n  _action: function() {\n    var self = this;\n    self.initializeForm();\n    self._modal.activate();\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('button', className, container);\n    link.innerHTML = html;\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n\n    return link;\n  },\n\n  _createPanel: function() {\n    var self = this;\n    if ( this._modal._container.querySelector('form') ) { return; }\n\n    var template = '';\n\n    var possible_fieldsets = [];\n    if ( this._reader.metadata.layout == 'pre-paginated' ) {\n      // different panel\n      possible_fieldsets.push('Scale');\n    } else {\n      possible_fieldsets.push('TextSize');\n    }\n    possible_fieldsets.push('Display');\n\n    if ( this._reader.rootfiles && this._reader.rootfiles.length > 1 ) {\n      // this.options.hasPackagePaths = true;\n      possible_fieldsets.push('Rendition');\n    }\n\n    if ( this._reader.options.themes && this._reader.options.themes.length > 0 ) {\n      this.options.hasThemes = true;\n      possible_fieldsets.push('Theme');\n    }\n\n    this._fieldsets = [];\n    possible_fieldsets.forEach(function(cls) {\n      var fieldset = new Preferences.fieldset[cls](this);\n      template += fieldset.template();\n      this._fieldsets.push(fieldset);\n    }.bind(this))\n\n    if ( this.options.fields ) {\n      this.options.hasFields = true;\n      for(var i in this.options.fields) {\n        var field = this.options.fields[i];\n        var id = \"preferences-custom-\" + i;\n        template += `<fieldset class=\"custom-field\">\n          <legend>${field.label}</legend>\n        `;\n        for(var j in field.inputs) {\n          var input = field.inputs[j];\n          var checked = input.value == field.value ? ' checked=\"checked\"' : '';\n          template += `<label><input id=\"preferences-custom-${i}-${j}\" type=\"radio\" name=\"x${field.name}\" value=\"${input.value}\" ${checked}/>${input.label}</label>`;\n        }\n        if ( field.hint ) {\n          template += `<p class=\"hint\" style=\"font-size: 90%\">${field.hint}</p>`;\n        }\n      }\n    }\n\n    template = '<form>' + template + '</form>';\n\n    // this._modal = this._reader.modal({\n    //   template: template,\n    //   title: 'Preferences',\n    //   className: 'cozy-modal-preferences',\n    //   actions: [\n    //     {\n    //       label: 'Save Changes',\n    //       callback: function(event) {\n    //         self.updatePreferences(event);\n    //       }\n    //     }\n    //   ],\n    //   region: 'right'\n    // });\n\n    this._modal._container.querySelector('main').innerHTML = template;\n    this._form = this._modal._container.querySelector('form');\n  },\n\n  initializeForm: function() {\n    this._createPanel();\n    this._fieldsets.forEach(function(fieldset) {\n      fieldset.initializeForm(this._form);\n    }.bind(this));\n  },\n\n  updatePreferences: function(event) {\n    event.preventDefault();\n\n    var doUpdate = false;\n    var new_options = {};\n    var saveable_options = {};\n    this._fieldsets.forEach(function(fieldset) {\n      // doUpdate = doUpdate || fieldset.updateForm(this._form, new_options);\n      // assign(new_options, fieldset.updateForm(this._form));\n      fieldset.updateForm(this._form, new_options, saveable_options);\n    }.bind(this));\n\n    if ( this.options.hasFields ) {\n      for(var i in this.options.fields) {\n        var field = this.options.fields[i];\n        var id = \"preferences-custom-\" + i;\n        var input = this._form.querySelector(`input[name=\"x${field.name}\"]:checked`);\n        if ( input.value != field.value ) {\n          field.value = input.value;\n          field.callback(field.value);\n        }\n      }\n    }\n\n    this._modal.deactivate();\n\n    setTimeout(function() {\n      this._reader.saveOptions(saveable_options);\n      this._reader.reopen(new_options);\n    }.bind(this), 100);\n  },\n\n  EOT: true\n});\n\nPreferences.fieldset = {};\n\nvar Fieldset = Class.extend({\n\n  options: {},\n\n  initialize: function (control, options) {\n      Util.setOptions(this, options);\n      this._control = control;\n      this._current = {};\n      this._id = (new Date()).getTime() + '-' + parseInt(Math.random((new Date()).getTime()) * 1000, 10);\n  },\n\n  template: function() {\n\n  },\n\n  EOT: true\n\n\n});\n\nPreferences.fieldset.TextSize = Fieldset.extend({\n\n  initializeForm: function(form) {\n    if ( ! this._input ) {\n      this._input = form.querySelector(`#x${this._id}-input`);\n      this._output = form.querySelector(`#x${this._id}-output`);\n      this._preview = form.querySelector(`#x${this._id}-preview`);\n      this._actionReset = form.querySelector(`#x${this._id}-reset`);\n\n      this._input.addEventListener('input', this._updatePreview.bind(this));\n      this._input.addEventListener('change', this._updatePreview.bind(this));\n\n      this._actionReset.addEventListener('click', function(event) {\n        event.preventDefault();\n        this._input.value = 100;\n        this._updatePreview();\n      }.bind(this));\n    }\n\n    var text_size = this._control._reader.options.text_size || 100;\n    if ( text_size == 'auto' ) { text_size = 100; }\n    this._current.text_size = text_size;\n    this._input.value = text_size;\n    this._updatePreview();\n  },\n\n  updateForm: function(form, options, saveable) {\n    // return { text_size: this._input.value };\n    options.text_size = saveable.text_size = this._input.value;\n    // options.text_size = this._input.value;\n    // return ( this._input.value != this._current.text_size );\n  },\n\n  template: function() {\n    return `<fieldset class=\"cozy-fieldset-text_size\">\n        <legend>Text Size</legend>\n        <div class=\"preview--text_size\" id=\"x${this._id}-preview\">\n          ‘Yes, that’s it,’ said the Hatter with a sigh: ‘it’s always tea-time, and we’ve no time to wash the things between whiles.’\n        </div>\n        <p style=\"white-space: no-wrap\">\n          <span>T-</span>\n          <input name=\"text_size\" type=\"range\" id=\"x${this._id}-input\" value=\"100\" min=\"50\" max=\"400\" step=\"10\" style=\"width: 75%; display: inline-block\" />\n          <span>T+</span>\n        </p>\n        <p>\n          <span>Text Size: </span>\n          <output for=\"preferences-input-text_size\" id=\"x${this._id}-output\">100</output>\n          <button id=\"x${this._id}-reset\" class=\"reset button--inline\" style=\"margin-left: 8px\">Reset</button> \n        </p>\n      </fieldset>`;\n  },\n\n  _updatePreview: function() {\n    this._preview.style.fontSize = `${( parseInt(this._input.value, 10) / 100 )}em`;\n    this._output.value = `${this._input.value}%`;\n  },\n\n  EOT: true\n\n});\n\nPreferences.fieldset.Display = Fieldset.extend({\n\n  initializeForm: function(form) {\n    var flow = this._control._reader.options.flow || this._control._reader.metadata.flow || 'auto';\n    // if ( flow == 'auto' ) { flow = 'paginated'; }\n\n    var input = form.querySelector(`#x${this._id}-input-${flow}`);\n    input.checked = true;\n    this._current.flow = flow;\n\n  },\n\n  updateForm: function(form, options, saveable) {\n    var input = form.querySelector(`input[name=\"x${this._id}-flow\"]:checked`);\n    options.flow = input.value;\n    if ( options.flow != 'auto' ) {\n      saveable.flow = options.flow;\n    }\n    // if ( input.value == 'auto' ) {\n    //   // we do NOT want to save flow as a preference\n    //   return {};\n    // }\n    // return { flow: input.value };\n  },\n\n  template: function() {\n    var scrolled_help = '';\n    if ( this._control._reader.metadata.layout != 'pre-paginated' ) {\n      scrolled_help = \"<br /><small>This is an experimental feature that may cause display and loading issues for the book when enabled.</small>\";\n    }\n    return `<fieldset>\n            <legend>Display</legend>\n            <label><input name=\"x${this._id}-flow\" type=\"radio\" id=\"x${this._id}-input-auto\" value=\"auto\" /> Auto<br /><small>Let the reader determine display mode based on your browser dimensions and the type of content you're reading</small></label>\n            <label><input name=\"x${this._id}-flow\" type=\"radio\" id=\"x${this._id}-input-paginated\" value=\"paginated\" /> Page-by-Page</label>\n            <label><input name=\"x${this._id}-flow\" type=\"radio\" id=\"x${this._id}-input-scrolled-doc\" value=\"scrolled-doc\" /> Scroll${scrolled_help}</label>\n          </fieldset>`;\n  },\n\n  EOT: true\n\n});\n\nPreferences.fieldset.Theme = Fieldset.extend({\n\n  initializeForm: function(form) {\n    var theme = this._control._reader.options.theme || 'default';\n\n    var input = form.querySelector(`#x${this._id}-input-theme-${theme}`);\n    input.checked = true;\n    this._current.theme = theme;\n  },\n\n  updateForm: function(form, options, saveable) {\n    var input = form.querySelector(`input[name=\"x${this._id}-theme\"]:checked`);\n    options.theme = saveable.theme = input.value;\n    // return { theme: input.value };\n  },\n\n  template: function() {\n    var template = `<fieldset>\n            <legend>Theme</legend>\n            <label><input name=\"x${this._id}-theme\" type=\"radio\" id=\"x${this._id}-input-theme-default\" value=\"default\" />Default</label>`;\n\n    this._control._reader.options.themes.forEach(function(theme) {\n      template += `<label><input name=\"x${this._id}-theme\" type=\"radio\" id=\"x${this._id}-input-theme-${theme.klass}\" value=\"${theme.klass}\" />${theme.name}</label>`\n    }.bind(this));\n\n    template += '</fieldset>';\n\n    return template;\n\n  },\n\n  EOT: true\n\n});\n\nPreferences.fieldset.Rendition = Fieldset.extend({\n\n  initializeForm: function(form) {\n    var rootfiles = this._control._reader.rootfiles;\n    var rootfilePath = this._control._reader.options.rootfilePath;\n    var expr = rootfilePath ? `[value=\"${rootfilePath}\"]` : \":first-child\";\n    var input = form.querySelector(`input[name=\"x${this._id}-rootfilePath\"]${expr}`);\n    input.checked = true;\n    this._current.rootfilePath = rootfilePath || rootfiles[0].rootfilePath;\n  },\n\n  updateForm: function(form, options, saveable) {\n    var input = form.querySelector(`input[name=\"x${this._id}-rootfilePath\"]:checked`);\n    if ( input.value != this._current.rootfilePath ) {\n      options.rootfilePath = input.value;\n      this._current.rootfilePath = input.value;\n    }\n  },\n\n  template: function() {\n    var template = `<fieldset>\n            <legend>Rendition</legend>\n    `;\n\n    this._control._reader.rootfiles.forEach(function(rootfile, i) {\n      template += `<label><input name=\"x${this._id}-rootfilePath\" type=\"radio\" id=\"x${this._id}-input-rootfilePath-${i}\" value=\"${rootfile.rootfilePath}\" />${rootfile.label || rootfile.accessMode || rootfile.rootfilePath}</label>`;\n    }.bind(this))\n\n    template += '</fieldset>';\n\n    return template;\n\n  },\n\n  EOT: true\n\n});\n\nPreferences.fieldset.Scale = Fieldset.extend({\n\n  initializeForm: function(form) {\n    if ( ! this._input ) {\n      this._input = form.querySelector(`#x${this._id}-input`);\n      this._output = form.querySelector(`#x${this._id}-output`);\n      this._preview = form.querySelector(`#x${this._id}-preview > div`);\n      this._actionReset = form.querySelector(`#x${this._id}-reset`);\n\n      this._input.addEventListener('input', this._updatePreview.bind(this));\n      this._input.addEventListener('change', this._updatePreview.bind(this));\n\n      this._actionReset.addEventListener('click', function(event) {\n        event.preventDefault();\n        this._input.value = 100;\n        this._updatePreview();\n      }.bind(this));\n    }\n\n    var scale = this._control._reader.options.scale || 100;\n    if ( ! scale ) { scale = 100; }\n    this._current.scale = scale;\n    this._input.value = scale;\n    this._updatePreview();\n  },\n\n  updateForm: function(form, options, saveable) {\n    // return { text_size: this._input.value };\n    options.scale = saveable.scale = this._input.value;\n    // options.text_size = this._input.value;\n    // return ( this._input.value != this._current.text_size );\n  },\n\n  template: function() {\n    return `<fieldset class=\"cozy-fieldset-text_size\">\n        <legend>Zoom In/Out</legend>\n        <div class=\"preview--scale\" id=\"x${this._id}-preview\" style=\"overflow: hidden; height: 5rem\">\n          <div>\n            ‘Yes, that’s it,’ said the Hatter with a sigh: ‘it’s always tea-time, and we’ve no time to wash the things between whiles.’\n          </div>\n        </div>\n        <p style=\"white-space: no-wrap\">\n          <span style=\"font-size: 150%\">⊖<span class=\"u-screenreader\"> Zoom Out</span></span>\n          <input name=\"scale\" type=\"range\" id=\"x${this._id}-input\" value=\"100\" min=\"50\" max=\"400\" step=\"10\" style=\"width: 75%; display: inline-block\" />\n          <span style=\"font-size: 150%\">⊕<span class=\"u-screenreader\">Zoom In </span></span>\n        </p>\n        <p>\n          <span>Scale: </span>\n          <output for=\"preferences-input-text_size\" id=\"x${this._id}-output\">100</output>\n          <button id=\"x${this._id}-reset\" class=\"reset button--inline\" style=\"margin-left: 8px\">Reset</button> \n        </p>\n      </fieldset>`;\n  },\n\n  _updatePreview: function() {\n    this._preview.style.transform = `scale(${( parseInt(this._input.value, 10) / 100 )}) translate(0,0)`;\n    this._output.value = `${this._input.value}%`;\n  },\n\n  EOT: true\n\n});\n\nexport var preferences = function(options) {\n  return new Preferences(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Widget = Control.extend({\n\n\n  options: {\n      // @option region: String = 'topright'\n      // The region of the control (one of the reader corners). Possible values are `'topleft'`,\n      // `'topright'`, `'bottomleft'` or `'bottomright'`\n  },\n\n  onAdd: function(reader) {\n    var container = this._container;\n    if ( container ) {\n      // NOOP\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n\n    }\n\n    this._onAddExtra(container);\n    this._updateTemplate(container);\n    this._updateClass(container);\n    this._bindEvents(container);\n\n    return container;\n  },\n\n  _updateTemplate: function(container) {\n    var data = this.data();\n    for(var slot in data) {\n      if ( data.hasOwnProperty(slot) ) {\n        var value = data[slot];\n        if ( typeof(value) == \"function\" ) { value = value(); }\n        var node = container.querySelector(`[data-slot=${slot}]`);\n        if ( node ) {\n          if ( node.hasAttribute('value') ) {\n            node.setAttribute('value', value);\n          } else {\n            node.innerHTML = value;\n          }\n        }\n      }\n    }\n  },\n\n  _updateClass: function(container) {\n    if ( this.options.className ) {\n      DomUtil.addClass(container, this.options.className);\n    }\n  },\n\n  _onAddExtra: function() { },\n\n  _bindEvents: function(container) {\n    var control = container.querySelector(\"[data-toggle=button]\");\n    if ( ! control ) { return ; }\n    DomEvent.disableClickPropagation(control);\n    DomEvent.on(control, 'click', DomEvent.stop);\n    DomEvent.on(control, 'click', this._action, this);\n  },\n\n  _action: function() {\n  },\n\n  data: function() {\n    return this.options.data || {};\n  },\n\n  EOT: true\n});\n\nWidget.Button = Widget.extend({\n  defaultTemplate: `<button data-toggle=\"button\" data-slot=\"label\"></button>`,\n\n  _action: function() {\n    this.options.onClick(this, this._reader);\n  },\n\n  EOT: true\n});\n\nWidget.Panel = Widget.extend({\n  defaultTemplate: `<div><span data-slot=\"text\"></span></div>`,\n\n\n  EOT: true\n});\n\nWidget.Toggle = Widget.extend({\n  defaultTemplate: `<button data-toggle=\"button\" data-slot=\"label\"></button>`,\n\n  _onAddExtra: function(container) {\n    this.state(this.options.states[0].stateName, container);\n\n    return container;\n  },\n\n  state: function(stateName, container) {\n    container = container || this._container;\n    this._resetState(container);\n    this._state = this.options.states.filter(function(s) { return s.stateName == stateName })[0];\n    this._updateClass(container);\n    this._updateTemplate(container);\n  },\n\n  _resetState: function(container) {\n    if ( ! this._state ) { return; }\n    if ( this._state.className ) {\n      DomUtil.removeClass(container, this._state.className);\n    }\n  },\n\n  _updateClass: function(container) {\n    if ( this._state.className ) {\n      DomUtil.addClass(container, this._state.className);\n    }\n  },\n\n  _action: function() {\n    this._state.onClick(this, this._reader);\n  },\n\n  data: function() {\n    return this._state.data || {};\n  },\n\n  EOT: true\n});\n\n// export var widget = function(options) {\n//   return new Widget(options);\n// }\n\nexport var widget = {\n  button: function(options) { return new Widget.Button(options); },\n  panel: function(options) { return new Widget.Panel(options); },\n  toggle: function(options) { return new Widget.Toggle(options); }\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Citation = Control.extend({\n  options: {\n    label: 'Citation',\n    html: '<span>Get Citation</span>'\n  },\n\n  defaultTemplate: `<button class=\"button--sm cozy-citation\" data-toggle=\"open\">Get Citation</button>`,\n\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._reader.on('updateContents', function(data) {\n      self._createPanel();\n    });\n\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n      self._modal.activate();\n    }, this)\n\n    return container;\n  },\n\n  _action: function() {\n    var self = this;\n    self._modal.activate();\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('button', className, container);\n    link.innerHTML = html;\n    link.title = title;\n\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n\n    return link;\n  },\n\n  _createPanel: function() {\n    var self = this;\n\n    var template = `<form>\n      <fieldset>\n        <legend>Select Citation Format</legend>\n      </fieldset>\n    </form>\n    <blockquote id=\"formatted\" style=\"padding: 8px; border-left: 4px solid black; background-color: #fff\"></blockquote>\n    <div class=\"alert alert-info\" id=\"message\" style=\"display: none\"></div>`;\n\n    this._modal = this._reader.modal({\n      template: template,\n      title: 'Copy Citation to Clipboard',\n      className: 'cozy-modal-citatation',\n      actions: [\n        {\n          label: 'Copy Citation',\n          callback: function(event) {\n            document.designMode = \"on\";\n            var formatted = self._modal._container.querySelector(\"#formatted\");\n\n            var range = document.createRange();\n            range.selectNode(formatted);\n            var sel = window.getSelection();\n            sel.removeAllRanges();\n            sel.addRange(range);\n\n            // formatted.select();\n\n            try {\n              var flag = document.execCommand('copy');\n            } catch(err) {\n              console.log(\"AHOY COPY FAILED\", err);\n            }\n\n            self._message.innerHTML = 'Success! Citation copied to your clipboard.';\n            self._message.style.display = 'block';\n            sel.removeAllRanges();\n            range.detach();\n            document.designMode = \"off\";\n          }\n        }\n      ],\n      region: 'left',\n      fraction: 1.0\n    });\n\n    this._form = this._modal._container.querySelector('form');\n    var fieldset = this._form.querySelector('fieldset');\n\n    var citations = this.options.citations || this._reader.metadata.citations;\n\n    citations.forEach(function(citation, index) {\n      var label = DomUtil.create('label', null, fieldset);\n      var input = DomUtil.create('input', null, label);\n      input.setAttribute('name', 'format');\n      input.setAttribute('value', citation.format);\n      input.setAttribute('type', 'radio');\n      if ( index == 0 ) {\n        input.setAttribute('checked', 'checked');\n      }\n      var text = document.createTextNode(\" \" + citation.format);\n      label.appendChild(text);\n      input.setAttribute('data-text', citation.text);\n    });\n\n    this._formatted = this._modal._container.querySelector(\"#formatted\");\n    this._message = this._modal._container.querySelector(\"#message\");\n    DomEvent.on(this._form, 'change', function(event) {\n      var target = event.target;\n      if ( target.tagName == 'INPUT' ) {\n        this._initializeForm();\n      }\n    }, this);\n\n    this._initializeForm();\n  },\n\n  _initializeForm: function() {\n    var formatted = this._formatCitation();\n    this._formatted.innerHTML = formatted;\n    this._message.style.display = 'none';\n    this._message.innerHTML = '';\n  },\n\n  _formatCitation: function(format) {\n    if ( format == null ) {\n      var selected = this._form.querySelector(\"input:checked\");\n      format = selected.value;\n    }\n    var selected = this._form.querySelector(\"input[value=\" + format + \"]\");\n    return selected.getAttribute('data-text');\n    // return selected.dataset.text;\n  },\n\n  EOT: true\n});\n\nexport var citation = function(options) {\n  return new Citation(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Search = Control.extend({\n  options: {\n    label: 'Search',\n    html: '<span>Search</span>'\n  },\n\n  defaultTemplate: `<form class=\"search\">\n    <label class=\"u-screenreader\" for=\"cozy-search-string\">Search in this text</label>\n    <input id=\"cozy-search-string\" name=\"search\" type=\"text\" placeholder=\"Search in this text...\"/>\n    <button class=\"button--sm\" data-toggle=\"open\" aria-label=\"Search\"><i class=\"icon-magnifying-glass oi\" data-glyph=\"magnifying-glass\" title=\"Search\" aria-hidden=\"true\"></i></button>\n  </form>`,\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    container.style.position = 'relative';\n\n    this._data = null;\n    this._canceled = false;\n    this._processing = false;\n\n    this._reader.on('ready', function() {\n\n      this._modal = this._reader.modal({\n        template: '<article></article>',\n        title: 'Search Results',\n        className: { container: 'cozy-modal-search' },\n        region: 'left',\n      });\n\n      this._modal.callbacks.onClose = function() {\n        if ( self._processing ) {\n          self._canceled = true;\n        }\n      };\n\n      this._article = this._modal._container.querySelector('article');\n\n      this._modal.on('click', 'a[href]', function(modal, target) {\n        target = target.getAttribute('href');\n        this._reader.tracking.action('search/go');\n        this._reader.gotoPage(target);\n        return true;\n      }.bind(this));\n\n      this._modal.on('closed', function() {\n        this._reader.tracking.action('contents/close');\n      }.bind(this))\n\n    }.bind(this));\n\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n\n      var searchString = this._container.querySelector(\"#cozy-search-string\").value;\n      searchString = searchString.replace(/^\\s*/, '').replace(/\\s*$/, '');\n\n      if ( ! searchString ) {\n        // just punt\n        return;\n      }\n\n      if ( searchString == this.searchString ) {\n        // cached results\n        self.openModalResults();\n      } else {\n        this.searchString = searchString;\n        self.openModalWaiting();\n        self.submitQuery();\n      }\n    }, this);\n\n    return container;\n  },\n\n  openModalWaiting: function() {\n    this._processing = true;\n    this._emptyArticle();\n    var value = this.searchString;\n    this._article.innerHTML = '<p>Submitting query for <em>' + value + '</em>...</p>' + this._reader.loaderTemplate();\n    this._modal.activate();\n  },\n\n  openModalResults: function() {\n    if ( this._canceled ) {\n      this._canceled = false;\n      return;\n    }\n    this._buildResults();\n    this._modal.activate();\n    this._reader.tracking.action(\"search/open\");\n  },\n\n  submitQuery: function() {\n    var self = this;\n\n    var url = this.options.searchUrl + this.searchString;\n\n    var request = new XMLHttpRequest();\n    request.open('GET', url, true);\n\n    request.onload = function() {\n      if (this.status >= 200 && this.status < 400) {\n        // Success!\n        var data = JSON.parse(this.response);\n        console.log(\"SEARCH DATA\", data);\n\n        self._data = data;\n\n      } else {\n        // We reached our target server, but it returned an error\n\n        self._data = null;\n        console.log(this.response);\n      }\n\n      self._reader.tracking.action(\"search/submitQuery\");\n      self.openModalResults();\n\n    };\n\n    request.onerror = function() {\n      // There was a connection error of some sort\n      self._data = null;\n      self.openModalResults();\n    };\n\n    request.send();\n\n  },\n\n  _emptyArticle: function() {\n    while (this._article && this._article.hasChildNodes()) {\n      this._article.removeChild(this._article.lastChild);\n    }\n  },\n\n  _buildResults: function() {\n    var self = this;\n    var content;\n\n    this._processing = false;\n\n    self._emptyArticle();\n\n    var reader = this._reader;\n    reader.annotations.reset();\n\n    if ( this._data ) {\n      var highlight = true\n      if (this._data.highlight_off == \"yes\") {\n        highlight = false;\n      }\n      if ( this._data.search_results.length ) {\n        content = DomUtil.create('ul');\n\n        this._data.search_results.forEach(function(result) {\n          var option = DomUtil.create('li');\n          var anchor = DomUtil.create('a', null, option);\n          var cfiRange = \"epubcfi(\" + result.cfi + \")\";\n\n          if (result.snippet) {\n            if (result.title) {\n              var chapterTitle = DomUtil.create('i');\n              chapterTitle.textContent = result.title + \": \";\n              anchor.appendChild(chapterTitle);\n            }\n            anchor.appendChild(document.createTextNode(result.snippet));\n\n            anchor.setAttribute(\"href\", cfiRange);\n            content.appendChild(option);\n          }\n          if (highlight) {\n            reader.annotations.highlight(cfiRange);\n          }\n        });\n      } else {\n        content = DomUtil.create(\"p\")\n        content.textContent = 'No results found for \"' + self.searchString + '\"';\n      }\n    } else {\n      content = DomUtil.create(\"p\")\n      content.textContent = 'There was a problem processing this query.';\n    }\n\n    self._article.appendChild(content);\n  },\n\n  EOT: true\n});\n\nexport var search = function(options) {\n  return new Search(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\n// Title + Chapter\n\nexport var BibliographicInformation = Control.extend({\n  options: {\n    label: 'Info',\n    direction: 'left',\n    html: '<span class=\"oi\" data-glyph=\"info\">Info</span>'\n  },\n\n  defaultTemplate: `<button class=\"button--sm cozy-bib-info oi\" data-glyph=\"info\" data-toggle=\"open\" aria-label=\"Bibliographic Information\"> Info</button>`,\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._reader.on('updateContents', function(data) {\n      self._createPanel();\n    });\n\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n      self._modal.activate();\n    }, this)\n\n    return container;\n  },\n\n  _createPanel: function() {\n    var self = this;\n\n    var template = `<dl>\n    </dl>`;\n\n    this._modal = this._reader.modal({\n      template: template,\n      title: 'Info',\n      region: 'left',\n      fraction: 1.0\n    });\n\n    var dl = this._modal._container.querySelector('dl');\n\n    var metadata_fields = [\n      [ 'title', 'Title' ],\n      [ 'creator', 'Author' ],\n      [ 'pubdate', 'Publication Date' ],\n      [ 'modified_date', 'Modified Date' ],\n      [ 'publisher', 'Publisher' ],\n      [ 'rights', 'Rights' ],\n      [ 'doi', 'DOI' ],\n      [ 'description', 'Description' ],\n    ];\n\n    var metadata_fields_seen = {};\n\n    var metadata = this._reader.metadata;\n\n    for(var idx in metadata_fields) {\n      var key = metadata_fields[idx][0];\n      var label = metadata_fields[idx][1];\n      if ( metadata[key] ) {\n        var value = metadata[key];\n        if ( key == 'pubdate' || key == 'modified_date' ) {\n          value = this._formatDate(value);\n          if ( ! value ) { continue; }\n          // value = d.toISOString().slice(0,10); // for YYYY-MM-DD\n        }\n        metadata_fields_seen[key] = true;\n        var dt = DomUtil.create('dt', 'cozy-bib-info-label', dl);\n        dt.innerHTML = label;\n        var dd = DomUtil.create('dd', 'cozy-bib-info-value cozy-bib-info-value-' + key, dl);\n        dd.innerHTML = value;\n      }\n    }\n\n  },\n\n  _formatDate: function(value) {\n    var match = value.match(/\\d{4}/);\n    if ( match ) {\n      return match[0];\n    }\n    return null;\n  },\n\n  EOT: true\n});\n\nexport var bibliographicInformation = function(options) {\n  return new BibliographicInformation(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Download = Control.extend({\n  options: {\n    label: 'Download Book',\n    html: '<span>Download Book</span>'\n  },\n\n  defaultTemplate: `<button class=\"button--sm cozy-download oi\" data-toggle=\"open\" data-glyph=\"data-transfer-download\"> Download Book</button>`,\n\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._reader.on('updateContents', function(data) {\n      self._createPanel();\n    });\n\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n      self._modal.activate();\n    }, this)\n\n    return container;\n  },\n\n  _createPanel: function() {\n    var self = this;\n\n    var template = `<form>\n      <fieldset>\n        <legend>Choose File Format</legend>\n      </fieldset>\n    </form>`;\n\n    this._modal = this._reader.modal({\n      template: template,\n      title: 'Download Book',\n      className: 'cozy-modal-download',\n      actions: [\n        {\n          label: 'Download',\n          callback: function(event) {\n            var selected = self._form.querySelector(\"input:checked\");\n            var href = selected.getAttribute('data-href');\n            self._configureDownloadForm(href);\n            self._form.submit();\n          }\n        }\n      ],\n      region: 'left',\n      fraction: 1.0\n    });\n\n    this._form = this._modal._container.querySelector('form');    \n    var fieldset = this._form.querySelector('fieldset');\n    this._reader.options.download_links.forEach(function(link, index) {\n      var label = DomUtil.create('label', null, fieldset);\n      var input = DomUtil.create('input', null, label);\n      input.setAttribute('name', 'format');\n      input.setAttribute('value', link.format);\n      input.setAttribute('data-href', link.href);\n      input.setAttribute('type', 'radio');\n      if ( index == 0 ) {\n        input.setAttribute('checked', 'checked');\n      }\n      var text = link.format;\n      if ( link.size ) {\n        text += \" (\" + link.size + \")\";\n      }\n      var text = document.createTextNode(\" \" + text);\n      label.appendChild(text);\n    });\n\n  },\n\n  _configureDownloadForm: function(href) {\n    var self = this;\n    self._form.setAttribute('method', 'GET');\n    self._form.setAttribute('action', href);\n    self._form.setAttribute('target', '_blank');\n  },\n\n\n  EOT: true\n});\n\nexport var download = function(options) {\n  return new Download(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Navigator = Control.extend({\n  onAdd: function(reader) {\n    var container = this._container;\n    if ( container ) {\n    } else {\n\n      var className = this._className('navigator'),\n          options = this.options;\n      \n      container = DomUtil.create('div', className);\n    }\n    this._setup(container);\n\n    this._reader.on('updateLocations', function(locations) {      \n      // if ( ! this._reader.currentLocation() || ! this._reader.currentLocation().start ) {\n      //   console.log(\"AHOY updateLocations NO START\", this._reader.currentLocation().then);\n      //   setTimeout(function() {\n      //     this._initializeNavigator(locations);\n      //   }.bind(this), 100);\n      //   return;\n      // }\n      this._initializeNavigator(locations);\n    }.bind(this));\n\n    return container;\n  },\n\n  _setup: function(container) {\n    this._control = container.querySelector(\"input[type=range]\");\n    if ( ! this._control ) {\n      this._createControl(container);\n    }\n    this._background = container.querySelector(\".cozy-navigator-range__background\");\n    this._status = container.querySelector(\".cozy-navigator-range__status\");\n    this._spanCurrentPercentage = container.querySelector(\".currentPercentage\");\n    this._spanCurrentLocation = container.querySelector(\".currentLocation\");\n    this._spanTotalLocations = container.querySelector(\".totalLocations\");\n\n    this._bindEvents();\n  },\n\n  _createControl: function (container) {\n    var template = `<div class=\"cozy-navigator-range\">\n        <label class=\"u-screenreader\" for=\"cozy-navigator-range-input\">Location: </label>\n        <input class=\"cozy-navigator-range__input\" id=\"cozy-navigator-range-input\" type=\"range\" name=\"locations-range-value\" min=\"0\" max=\"100\" aria-valuemin=\"0\" aria-valuemax=\"100\" aria-valuenow=\"0\" aria-valuetext=\"0% • Location 0 of ?\" value=\"0\" data-background-position=\"0\" />\n        <div class=\"cozy-navigator-range__background\"></div>\n      </div>\n      <div class=\"cozy-navigator-range__status\"><span class=\"currentPercentage\">0%</span> • Location <span class=\"currentLocation\">0</span> of <span class=\"totalLocations\">?</span></div>\n    `;\n\n    var body = new DOMParser().parseFromString(template, \"text/html\").body;\n    while ( body.children.length ) {\n      container.appendChild(body.children[0]);\n    }\n\n    this._control = container.querySelector(\"input[type=range]\");\n  },\n\n  _bindEvents: function() {\n    var self = this;\n\n    this._control.addEventListener(\"input\", function() {\n      self._update();\n    }, false);\n    this._control.addEventListener(\"change\", function() { self._action(); }, false);\n    this._control.addEventListener(\"mousedown\", function(){\n        self._mouseDown = true;\n    }, false);\n    this._control.addEventListener(\"mouseup\", function(){\n        self._mouseDown = false;\n    }, false);\n    this._control.addEventListener(\"keydown\", function(){\n      self._mouseDown = true;\n    }, false);\n    this._control.addEventListener(\"keyup\", function(){\n      self._mouseDown = false;\n    }, false);\n\n    this._reader.on('relocated', function(location) {\n      if ( ! self._initiated ) { return; }\n      if ( ! self._mouseDown ) {\n        self._control.value = Math.ceil(self._reader.locations.percentageFromCfi(self._reader.currentLocation().start.cfi) * 100);\n        self._update();\n      }\n    })\n\n  },\n\n  _action: function() {\n    var value = this._control.value;\n    var locations = this._reader.locations;\n    var cfi = locations.cfiFromPercentage(value / 100);\n    this._reader.tracking.action(\"navigator/go\");\n    this._reader.gotoPage(cfi);\n  },\n\n  _update: function() {\n    var self = this;\n\n    var current = this._reader.currentLocation();\n    if ( ! current || ! current.start ) {\n      setTimeout(function() {\n        this._update();\n      }.bind(this), 100);\n    }\n\n    var rangeBg = this._background;\n    var range = self._control;\n\n    var value = parseInt(range.value, 10);\n    var percentage = value;\n\n    rangeBg.setAttribute('style', 'background-position: ' + (-percentage) + '% 0%, left top;');\n    self._control.setAttribute('data-background-position', Math.ceil(percentage));\n\n    this._spanCurrentPercentage.innerHTML = percentage + '%';\n    if ( current && current.start ) {\n      var current_location = this._reader.locations.locationFromCfi(current.start.cfi);\n      this._spanCurrentLocation.innerHTML = ( current_location );\n    }\n    self._last_delta = self._last_value > value; self._last_value = value;\n  },\n\n  _initializeNavigator: function(locations) {\n    console.log(\"AHOY updateLocations PROCESSING LOCATION\");\n    this._initiated = true;\n    this._total = this._reader.locations.total;\n    if ( this._reader.currentLocation().start ) {\n      this._control.value = Math.ceil(this._reader.locations.percentageFromCfi(this._reader.currentLocation().start.cfi) * 100);\n      this._last_value = this._control.value;\n    } else {\n      this._last_value = this._control.value;\n    }\n\n    this._spanTotalLocations.innerHTML = this._total;\n\n    this._update();\n    setTimeout(function() {\n      DomUtil.addClass(this._container, 'initialized');\n    }.bind(this), 0);\n  },\n\n  EOT: true\n});\n\nexport var navigator = function(options) {\n  return new Navigator(options);\n}\n","import {Control, control} from './Control';\nimport {PageNext, PagePrevious, pageNext, pagePrevious, PageFirst, pageFirst, PageLast, pageLast} from './Control.Paging';\nimport {Contents, contents} from './Control.Contents';\nimport {Title, title} from './Control.Title';\nimport {PublicationMetadata, publicationMetadata} from './Control.PublicationMetadata';\nimport {Preferences, preferences} from './Control.Preferences';\nimport {Widget, widget} from './Control.Widget';\nimport {Citation, citation} from './Control.Citation';\nimport {Search, search} from './Control.Search';\nimport {BibliographicInformation, bibliographicInformation} from './Control.BibliographicInformation';\nimport {Download, download} from './Control.Download';\nimport {Navigator, navigator} from './Control.Navigator';\n\n// import {Zoom, zoom} from './Control.Zoom';\n// import {Attribution, attribution} from './Control.Attribution';\n\nControl.PageNext = PageNext;\nControl.PagePrevious = PagePrevious;\nControl.PageFirst = PageFirst;\nControl.PageLast = PageLast;\ncontrol.pagePrevious = pagePrevious;\ncontrol.pageNext = pageNext;\ncontrol.pageFirst = pageFirst;\ncontrol.pageLast = pageLast;\n\nControl.Contents = Contents;\ncontrol.contents = contents;\n\nControl.Title = Title;\ncontrol.title = title;\n\nControl.PublicationMetadata = PublicationMetadata;\ncontrol.publicationMetadata = publicationMetadata;\n\nControl.Preferences = Preferences;\ncontrol.preferences = preferences;\n\nControl.Widget = Widget;\ncontrol.widget = widget;\n\nControl.Citation = Citation;\ncontrol.citation = citation;\n\nControl.Search = Search;\ncontrol.search = search;\n\nControl.BibliographicInformation = BibliographicInformation;\ncontrol.bibliographicInformation = bibliographicInformation;\n\nControl.Download = Download;\ncontrol.download = download;\n\nControl.Navigator = Navigator;\ncontrol.navigator = navigator;\n\nexport {Control, control};\n","import {Evented} from './Events';\n\nvar Bus = Evented.extend({\n});\n\nvar instance;\nexport var bus = function() {\n  return instance || ( instance = new Bus() );\n}\n","import * as Browser from './Browser';\nexport {Browser};\n\nexport {Class} from './Class';\n\nimport {Evented} from './Events';\nexport {Evented};\nexport var Mixin = {Events: Evented.prototype};\n\nimport * as Util from './Util';\nexport {Util};\nexport {extend, bind, stamp, setOptions} from './Util';\nexport {bus} from './Bus';\n","\n// var ePub = window.ePub;\n// export {ePub};\n\nexport function ePub(href, options) {\n\tif ( window.require !== undefined ) {\n\t\twindow.ePub = require(\"ePub\");\n\t}\n  return window.ePub(href, options);\n}\n","'use strict';\n\nif (!process) {\n  var process = {\n    \"cwd\" : function () { return '/' }\n  };\n}\n\nfunction assertPath(path) {\n  if (typeof path !== 'string') {\n    throw new TypeError('Path must be a string. Received ' + path);\n  }\n}\n\n// Resolves . and .. elements in a path with directory names\nfunction normalizeStringPosix(path, allowAboveRoot) {\n  var res = '';\n  var lastSlash = -1;\n  var dots = 0;\n  var code;\n  for (var i = 0; i <= path.length; ++i) {\n    if (i < path.length)\n      code = path.charCodeAt(i);\n    else if (code === 47/*/*/)\n      break;\n    else\n      code = 47/*/*/;\n    if (code === 47/*/*/) {\n      if (lastSlash === i - 1 || dots === 1) {\n        // NOOP\n      } else if (lastSlash !== i - 1 && dots === 2) {\n        if (res.length < 2 ||\n            res.charCodeAt(res.length - 1) !== 46/*.*/ ||\n            res.charCodeAt(res.length - 2) !== 46/*.*/) {\n          if (res.length > 2) {\n            var start = res.length - 1;\n            var j = start;\n            for (; j >= 0; --j) {\n              if (res.charCodeAt(j) === 47/*/*/)\n                break;\n            }\n            if (j !== start) {\n              if (j === -1)\n                res = '';\n              else\n                res = res.slice(0, j);\n              lastSlash = i;\n              dots = 0;\n              continue;\n            }\n          } else if (res.length === 2 || res.length === 1) {\n            res = '';\n            lastSlash = i;\n            dots = 0;\n            continue;\n          }\n        }\n        if (allowAboveRoot) {\n          if (res.length > 0)\n            res += '/..';\n          else\n            res = '..';\n        }\n      } else {\n        if (res.length > 0)\n          res += '/' + path.slice(lastSlash + 1, i);\n        else\n          res = path.slice(lastSlash + 1, i);\n      }\n      lastSlash = i;\n      dots = 0;\n    } else if (code === 46/*.*/ && dots !== -1) {\n      ++dots;\n    } else {\n      dots = -1;\n    }\n  }\n  return res;\n}\n\nfunction _format(sep, pathObject) {\n  var dir = pathObject.dir || pathObject.root;\n  var base = pathObject.base ||\n    ((pathObject.name || '') + (pathObject.ext || ''));\n  if (!dir) {\n    return base;\n  }\n  if (dir === pathObject.root) {\n    return dir + base;\n  }\n  return dir + sep + base;\n}\n\nvar posix = {\n  // path.resolve([from ...], to)\n  resolve: function resolve() {\n    var resolvedPath = '';\n    var resolvedAbsolute = false;\n    var cwd;\n\n    for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n      var path;\n      if (i >= 0)\n        path = arguments[i];\n      else {\n        if (cwd === undefined)\n          cwd = process.cwd();\n        path = cwd;\n      }\n\n      assertPath(path);\n\n      // Skip empty entries\n      if (path.length === 0) {\n        continue;\n      }\n\n      resolvedPath = path + '/' + resolvedPath;\n      resolvedAbsolute = path.charCodeAt(0) === 47/*/*/;\n    }\n\n    // At this point the path should be resolved to a full absolute path, but\n    // handle relative paths to be safe (might happen when process.cwd() fails)\n\n    // Normalize the path\n    resolvedPath = normalizeStringPosix(resolvedPath, !resolvedAbsolute);\n\n    if (resolvedAbsolute) {\n      if (resolvedPath.length > 0)\n        return '/' + resolvedPath;\n      else\n        return '/';\n    } else if (resolvedPath.length > 0) {\n      return resolvedPath;\n    } else {\n      return '.';\n    }\n  },\n\n\n  normalize: function normalize(path) {\n    assertPath(path);\n\n    if (path.length === 0)\n      return '.';\n\n    var isAbsolute = path.charCodeAt(0) === 47/*/*/;\n    var trailingSeparator = path.charCodeAt(path.length - 1) === 47/*/*/;\n\n    // Normalize the path\n    path = normalizeStringPosix(path, !isAbsolute);\n\n    if (path.length === 0 && !isAbsolute)\n      path = '.';\n    if (path.length > 0 && trailingSeparator)\n      path += '/';\n\n    if (isAbsolute)\n      return '/' + path;\n    return path;\n  },\n\n\n  isAbsolute: function isAbsolute(path) {\n    assertPath(path);\n    return path.length > 0 && path.charCodeAt(0) === 47/*/*/;\n  },\n\n\n  join: function join() {\n    if (arguments.length === 0)\n      return '.';\n    var joined;\n    for (var i = 0; i < arguments.length; ++i) {\n      var arg = arguments[i];\n      assertPath(arg);\n      if (arg.length > 0) {\n        if (joined === undefined)\n          joined = arg;\n        else\n          joined += '/' + arg;\n      }\n    }\n    if (joined === undefined)\n      return '.';\n    return posix.normalize(joined);\n  },\n\n\n  relative: function relative(from, to) {\n    assertPath(from);\n    assertPath(to);\n\n    if (from === to)\n      return '';\n\n    from = posix.resolve(from);\n    to = posix.resolve(to);\n\n    if (from === to)\n      return '';\n\n    // Trim any leading backslashes\n    var fromStart = 1;\n    for (; fromStart < from.length; ++fromStart) {\n      if (from.charCodeAt(fromStart) !== 47/*/*/)\n        break;\n    }\n    var fromEnd = from.length;\n    var fromLen = (fromEnd - fromStart);\n\n    // Trim any leading backslashes\n    var toStart = 1;\n    for (; toStart < to.length; ++toStart) {\n      if (to.charCodeAt(toStart) !== 47/*/*/)\n        break;\n    }\n    var toEnd = to.length;\n    var toLen = (toEnd - toStart);\n\n    // Compare paths to find the longest common path from root\n    var length = (fromLen < toLen ? fromLen : toLen);\n    var lastCommonSep = -1;\n    var i = 0;\n    for (; i <= length; ++i) {\n      if (i === length) {\n        if (toLen > length) {\n          if (to.charCodeAt(toStart + i) === 47/*/*/) {\n            // We get here if `from` is the exact base path for `to`.\n            // For example: from='/foo/bar'; to='/foo/bar/baz'\n            return to.slice(toStart + i + 1);\n          } else if (i === 0) {\n            // We get here if `from` is the root\n            // For example: from='/'; to='/foo'\n            return to.slice(toStart + i);\n          }\n        } else if (fromLen > length) {\n          if (from.charCodeAt(fromStart + i) === 47/*/*/) {\n            // We get here if `to` is the exact base path for `from`.\n            // For example: from='/foo/bar/baz'; to='/foo/bar'\n            lastCommonSep = i;\n          } else if (i === 0) {\n            // We get here if `to` is the root.\n            // For example: from='/foo'; to='/'\n            lastCommonSep = 0;\n          }\n        }\n        break;\n      }\n      var fromCode = from.charCodeAt(fromStart + i);\n      var toCode = to.charCodeAt(toStart + i);\n      if (fromCode !== toCode)\n        break;\n      else if (fromCode === 47/*/*/)\n        lastCommonSep = i;\n    }\n\n    var out = '';\n    // Generate the relative path based on the path difference between `to`\n    // and `from`\n    for (i = fromStart + lastCommonSep + 1; i <= fromEnd; ++i) {\n      if (i === fromEnd || from.charCodeAt(i) === 47/*/*/) {\n        if (out.length === 0)\n          out += '..';\n        else\n          out += '/..';\n      }\n    }\n\n    // Lastly, append the rest of the destination (`to`) path that comes after\n    // the common path parts\n    if (out.length > 0)\n      return out + to.slice(toStart + lastCommonSep);\n    else {\n      toStart += lastCommonSep;\n      if (to.charCodeAt(toStart) === 47/*/*/)\n        ++toStart;\n      return to.slice(toStart);\n    }\n  },\n\n\n  _makeLong: function _makeLong(path) {\n    return path;\n  },\n\n\n  dirname: function dirname(path) {\n    assertPath(path);\n    if (path.length === 0)\n      return '.';\n    var code = path.charCodeAt(0);\n    var hasRoot = (code === 47/*/*/);\n    var end = -1;\n    var matchedSlash = true;\n    for (var i = path.length - 1; i >= 1; --i) {\n      code = path.charCodeAt(i);\n      if (code === 47/*/*/) {\n        if (!matchedSlash) {\n          end = i;\n          break;\n        }\n      } else {\n        // We saw the first non-path separator\n        matchedSlash = false;\n      }\n    }\n\n    if (end === -1)\n      return hasRoot ? '/' : '.';\n    if (hasRoot && end === 1)\n      return '//';\n    return path.slice(0, end);\n  },\n\n\n  basename: function basename(path, ext) {\n    if (ext !== undefined && typeof ext !== 'string')\n      throw new TypeError('\"ext\" argument must be a string');\n    assertPath(path);\n\n    var start = 0;\n    var end = -1;\n    var matchedSlash = true;\n    var i;\n\n    if (ext !== undefined && ext.length > 0 && ext.length <= path.length) {\n      if (ext.length === path.length && ext === path)\n        return '';\n      var extIdx = ext.length - 1;\n      var firstNonSlashEnd = -1;\n      for (i = path.length - 1; i >= 0; --i) {\n        var code = path.charCodeAt(i);\n        if (code === 47/*/*/) {\n          // If we reached a path separator that was not part of a set of path\n          // separators at the end of the string, stop now\n          if (!matchedSlash) {\n            start = i + 1;\n            break;\n          }\n        } else {\n          if (firstNonSlashEnd === -1) {\n            // We saw the first non-path separator, remember this index in case\n            // we need it if the extension ends up not matching\n            matchedSlash = false;\n            firstNonSlashEnd = i + 1;\n          }\n          if (extIdx >= 0) {\n            // Try to match the explicit extension\n            if (code === ext.charCodeAt(extIdx)) {\n              if (--extIdx === -1) {\n                // We matched the extension, so mark this as the end of our path\n                // component\n                end = i;\n              }\n            } else {\n              // Extension does not match, so our result is the entire path\n              // component\n              extIdx = -1;\n              end = firstNonSlashEnd;\n            }\n          }\n        }\n      }\n\n      if (start === end)\n        end = firstNonSlashEnd;\n      else if (end === -1)\n        end = path.length;\n      return path.slice(start, end);\n    } else {\n      for (i = path.length - 1; i >= 0; --i) {\n        if (path.charCodeAt(i) === 47/*/*/) {\n          // If we reached a path separator that was not part of a set of path\n          // separators at the end of the string, stop now\n          if (!matchedSlash) {\n            start = i + 1;\n            break;\n          }\n        } else if (end === -1) {\n          // We saw the first non-path separator, mark this as the end of our\n          // path component\n          matchedSlash = false;\n          end = i + 1;\n        }\n      }\n\n      if (end === -1)\n        return '';\n      return path.slice(start, end);\n    }\n  },\n\n\n  extname: function extname(path) {\n    assertPath(path);\n    var startDot = -1;\n    var startPart = 0;\n    var end = -1;\n    var matchedSlash = true;\n    // Track the state of characters (if any) we see before our first dot and\n    // after any path separator we find\n    var preDotState = 0;\n    for (var i = path.length - 1; i >= 0; --i) {\n      var code = path.charCodeAt(i);\n      if (code === 47/*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          startPart = i + 1;\n          break;\n        }\n        continue;\n      }\n      if (end === -1) {\n        // We saw the first non-path separator, mark this as the end of our\n        // extension\n        matchedSlash = false;\n        end = i + 1;\n      }\n      if (code === 46/*.*/) {\n        // If this is our first dot, mark it as the start of our extension\n        if (startDot === -1)\n          startDot = i;\n        else if (preDotState !== 1)\n          preDotState = 1;\n      } else if (startDot !== -1) {\n        // We saw a non-dot and non-path separator before our dot, so we should\n        // have a good chance at having a non-empty extension\n        preDotState = -1;\n      }\n    }\n\n    if (startDot === -1 ||\n        end === -1 ||\n        // We saw a non-dot character immediately before the dot\n        preDotState === 0 ||\n        // The (right-most) trimmed path component is exactly '..'\n        (preDotState === 1 &&\n         startDot === end - 1 &&\n         startDot === startPart + 1)) {\n      return '';\n    }\n    return path.slice(startDot, end);\n  },\n\n\n  format: function format(pathObject) {\n    if (pathObject === null || typeof pathObject !== 'object') {\n      throw new TypeError(\n        'Parameter \"pathObject\" must be an object, not ' + typeof(pathObject)\n      );\n    }\n    return _format('/', pathObject);\n  },\n\n\n  parse: function parse(path) {\n    assertPath(path);\n\n    var ret = { root: '', dir: '', base: '', ext: '', name: '' };\n    if (path.length === 0)\n      return ret;\n    var code = path.charCodeAt(0);\n    var isAbsolute = (code === 47/*/*/);\n    var start;\n    if (isAbsolute) {\n      ret.root = '/';\n      start = 1;\n    } else {\n      start = 0;\n    }\n    var startDot = -1;\n    var startPart = 0;\n    var end = -1;\n    var matchedSlash = true;\n    var i = path.length - 1;\n\n    // Track the state of characters (if any) we see before our first dot and\n    // after any path separator we find\n    var preDotState = 0;\n\n    // Get non-dir info\n    for (; i >= start; --i) {\n      code = path.charCodeAt(i);\n      if (code === 47/*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          startPart = i + 1;\n          break;\n        }\n        continue;\n      }\n      if (end === -1) {\n        // We saw the first non-path separator, mark this as the end of our\n        // extension\n        matchedSlash = false;\n        end = i + 1;\n      }\n      if (code === 46/*.*/) {\n        // If this is our first dot, mark it as the start of our extension\n        if (startDot === -1)\n          startDot = i;\n        else if (preDotState !== 1)\n          preDotState = 1;\n      } else if (startDot !== -1) {\n        // We saw a non-dot and non-path separator before our dot, so we should\n        // have a good chance at having a non-empty extension\n        preDotState = -1;\n      }\n    }\n\n    if (startDot === -1 ||\n        end === -1 ||\n        // We saw a non-dot character immediately before the dot\n        preDotState === 0 ||\n        // The (right-most) trimmed path component is exactly '..'\n        (preDotState === 1 &&\n         startDot === end - 1 &&\n         startDot === startPart + 1)) {\n      if (end !== -1) {\n        if (startPart === 0 && isAbsolute)\n          ret.base = ret.name = path.slice(1, end);\n        else\n          ret.base = ret.name = path.slice(startPart, end);\n      }\n    } else {\n      if (startPart === 0 && isAbsolute) {\n        ret.name = path.slice(1, startDot);\n        ret.base = path.slice(1, end);\n      } else {\n        ret.name = path.slice(startPart, startDot);\n        ret.base = path.slice(startPart, end);\n      }\n      ret.ext = path.slice(startDot, end);\n    }\n\n    if (startPart > 0)\n      ret.dir = path.slice(0, startPart - 1);\n    else if (isAbsolute)\n      ret.dir = '/';\n\n    return ret;\n  },\n\n\n  sep: '/',\n  delimiter: ':',\n  posix: null\n};\n\n\nmodule.exports = posix;\n","import * as Util from '../core/Util';\nimport {Reader} from './Reader';\nimport * as epubjs from '../epubjs';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as Browser from '../core/Browser';\n\nimport path from \"path-webpack\";\n\nReader.EpubJS = Reader.extend({\n\n  initialize: function(id, options) {\n    Reader.prototype.initialize.apply(this, arguments);\n    this._epubjs_ready = false;\n    window.xpath = path;\n  },\n\n  open: function(target, callback) {\n    var self = this;\n    if ( typeof(target) == 'function' ) {\n      callback = target;\n      target = undefined;\n    }\n    if ( callback == null ) {\n      callback = function() { };\n    }\n\n    // okay, we need to do some hacking to fetch the dang files\n    // but this isn't going to be done async\n    self.rootfiles = [];\n    var request = new XMLHttpRequest();\n    request.open('GET', this.options.href + \"/META-INF/container.xml\");\n    request.responseType = 'document';\n    request.onload = function() {\n      var containerDoc = request.responseXML;\n      var rootfiles = containerDoc.querySelectorAll(\"rootfile\");\n      if ( rootfiles.length > 1 ) {\n        console.log(\"AHOY ROOTFILES MULTIPLE RENDITIONS\", rootfiles.length);\n        for(var i = 0; i < rootfiles.length; i++) {\n          var rootfile = rootfiles[i];\n          var rootfilePath = rootfile.getAttribute('full-path');\n          var label = rootfile.getAttribute('rendition:label');\n          var layout = rootfile.getAttribute('rendition:layout');\n          self.rootfiles.push({\n            rootfilePath: rootfilePath,\n            label: label,\n            layout: layout\n          })\n        }\n      }\n    }\n    request.send();\n\n    this.options.rootfilePath = this.options.rootfilePath || sessionStorage.getItem('rootfilePath');\n\n    var book_href = this.options.href;\n    var book_options = { packagePath: this.options.rootfilePath };\n    if ( this.options.useArchive ) {\n      book_href = book_href.replace(/\\/(\\w+)\\/$/, '/$1/$1.sm.epub');\n      book_options.openAs = 'epub';\n    }\n    this._book = epubjs.ePub(book_href, book_options);\n    sessionStorage.removeItem('rootfilePath');\n    // this._book = epubjs.ePub(this.options.href);\n    this._book.loaded.navigation.then(function(toc) {\n      self._contents = toc;\n      self.metadata = self._book.package.metadata;\n      self.fire('updateContents', toc);\n      self.fire('updateTitle', self._book.package.metadata);\n    })\n    this._book.ready.then(function() {\n      self.draw(target, callback);\n      if ( self.metadata.layout == 'pre-paginated' ) {\n        // fake it with the spine\n        var locations = [];\n        self._book.spine.each(function(item) {\n          locations.push(`epubcfi(${item.cfiBase}!/4/2)`);\n          self.locations._locations.push(`epubcfi(${item.cfiBase}!/4/2)`);\n        });\n        self.locations.total = locations.length;\n        var t;\n        var f = function() {\n          if ( self._rendition && self._rendition.manager && self._rendition.manager.stage ) {\n            var location = self._rendition.currentLocation();\n            if ( location && location.start) {\n              self.fire('updateLocations', locations);\n              clearTimeout(t);\n              return;\n            }\n          }\n          t = setTimeout(f, 100);\n        }\n\n        t = setTimeout(f, 100);\n      } else {\n        self._book.locations.generate(1600).then(function(locations) {\n          // console.log(\"AHOY WUT\", locations);\n          self.fire('updateLocations', locations);\n        })\n      }\n    })\n    // .then(callback);\n  },\n\n  draw: function(target, callback) {\n    var self = this;\n\n    if ( self._rendition ) {\n      // self._unbindEvents();\n      var container = self._rendition.manager.container;\n      Object.keys(self._rendition.hooks).forEach(function(key) {\n        console.log(\"AHOY draw clearing\", key);\n        self._rendition.hooks[key].clear();\n      })\n      self._rendition.destroy();\n      self._rendition = null;\n    }\n\n    this.settings = { flow: this.options.flow };\n    this.settings.manager = this.options.manager || 'default';\n\n    if ( this.settings.flow == 'auto' && this.metadata.layout == 'pre-paginated' ) {\n      // dumb check to see if the window is _tall_ enough to put\n      // two pages side by side\n      if ( this._container.offsetHeight <= this.options.forceScrolledDocHeight ) {\n        this.settings.flow = 'scrolled-doc';\n        this.settings.manager = 'prepaginated';\n      }\n    }\n\n    if ( this.settings.flow == 'auto' || this.settings.flow == 'paginated' ) {\n      this._panes['epub'].style.overflow = this.metadata.layout == 'pre-paginated' ? 'auto' : 'hidden';\n      this.settings.manager = 'default';\n    } else {\n      this._panes['epub'].style.overflow = 'auto';\n      if ( this.settings.manager == 'default' ) {\n        this.settings.manager = 'continuous';\n      }\n    }\n\n    if ( ! callback ) {\n      callback = function() { };\n    }\n\n    if ( this.metadata.layout == 'pre-paginated' && this.settings.manager == 'continuous' ) {\n        this.settings.manager = 'prepaginated';\n    }\n\n    if ( this.settings.manager == 'prepaginated' ) {\n      this.settings.spread = 'none';\n    }\n\n    // would pre-paginated work better if we scaled the default view from the start? maybe?\n    if ( false && this.metadata.layout == 'pre-paginated' && this.settings.manager == 'default' ) {\n      this.settings.spread = 'none';\n      this._panes['epub'].style.overflow = 'auto';\n    }\n\n    self.settings.height = '100%';\n    self.settings.width = '100%';\n    self.settings['ignoreClass'] = 'annotator-hl';\n\n    if ( self.options.scale != '100' ) {\n      self.settings.scale = parseInt(self.options.scale, 10) / 100;\n    }\n\n    self._panes['book'].dataset.manager = this.settings.manager + ( this.settings.spread ? `-${this.settings.spread}` : '');\n    self._panes['book'].dataset.layout = this.metadata.layout || 'reflowable';\n\n    self._drawRendition(target, callback);\n  },\n\n  _drawRendition: function(target, callback) {\n    var self = this;\n\n    self._rendition = self._book.renderTo(self._panes['epub'], self.settings);\n    self._updateFontSize();\n    self._bindEvents();\n    self._drawn = true;\n\n    if ( target && target.start ) { target = target.start; }\n    if ( ! target && window.location.hash ) {\n      if ( window.location.hash.substr(1, 3) == '/6/' ) {\n        target = \"epubcfi(\" + window.location.hash.substr(1) + \")\";\n      } else {\n        target = window.location.hash.substr(2);\n        target = self._book.url.path().resolve(target);\n      }\n    }\n\n    var status_index = 0;\n    self._rendition.on('started', function() {\n\n      self._rendition.manager.on(\"building\", function(status) {\n        if ( status ) {\n          status_index += 1;\n          self._panes['loader-status'].innerHTML = `<span>${Math.round((status_index / status.total) * 100.0)}%</span>`;\n        } else {\n          self._enableBookLoader(-1);\n        }\n      })\n      self._rendition.manager.on(\"built\", function() {\n        console.log(\"AHOY manager built\");\n        self._disableBookLoader(true);\n      })\n    })\n\n    self._rendition.hooks.content.register(function(contents) {\n      self.fire('ready:contents', contents);\n      self.fire('readyContents', contents);\n      contents.document.addEventListener('keydown', (event) => {\n        const keyName = event.key;\n        self.fire('keyDown', { keyName: keyName, shiftKey: event.shiftKey, inner: true });\n        console.log('inner keydown event: ', keyName);\n      });\n    })\n\n    self.gotoPage(target, function() {\n      window._loaded = true;\n      self._initializeReaderStyles();\n\n      if ( callback ) { callback(); }\n\n      self._epubjs_ready = true;\n\n      setTimeout(function() {\n        self.fire('opened');\n        self.fire('ready');\n        clearTimeout(self._queueTimeout);\n        self.tracking.event(\"openBook\", {\n          rootFilePath: self.options.rootFilePath,\n          flow: self.settings.flow,\n          manager: self.settings.manager\n        });\n      }, 100);\n    })\n  },\n\n  _scroll: function(delta) {\n    var self = this;\n    if ( self.options.flow == 'XXscrolled-doc' ) {\n      var container = self._rendition.manager.container;\n      var rect = container.getBoundingClientRect();\n      var scrollTop = container.scrollTop;\n      var newScrollTop = scrollTop;\n      var scrollBy = ( rect.height * 0.98 );\n      switch(delta) {\n        case 'PREV':\n          newScrollTop = -( scrollTop + scrollBy );\n          break;\n        case 'NEXT':\n          newScrollTop = ( scrollTop + scrollBy );\n          break;\n        case 'HOME':\n          newScrollTop = 0;\n          break;\n        case 'END':\n          newScrollTop = container.scrollHeight - scrollBy;\n          break;\n      }\n      container.scrollTop = newScrollTop;\n      return ( Math.floor(container.scrollTop) != Math.floor(scrollTop) );\n    }\n    return false;\n  },\n\n  _navigate: function(promise, callback) {\n    var self = this;\n    self._enableBookLoader(100);\n    promise.then(function() {\n      console.log(\"AHOY NAVIGATE FIN\");\n      self._disableBookLoader();\n      if ( callback ) { callback(); }\n    }).catch(function(e) {\n      self._disableBookLoader();\n      if ( callback ) { callback(); }\n      console.log(\"AHOY NAVIGATE ERROR\", e);\n      throw(e);\n    })\n  },\n\n  next: function() {\n    var self = this;\n    this.tracking.action('reader/go/next');\n    self._scroll('NEXT') || self._navigate(this._rendition.next());\n  },\n\n  prev: function() {\n    this.tracking.action('reader/go/previous');\n    this._scroll('PREV') || this._navigate(this._rendition.prev());\n  },\n\n  first: function() {\n    this.tracking.action('reader/go/first');\n    this._navigate(this._rendition.display(0), undefined);\n  },\n\n  last: function() {\n    var self = this;\n    this.tracking.action('reader/go/last');\n    var target = this._book.spine.length - 1;\n    this._navigate(this._rendition.display(target), undefined);\n  },\n\n  gotoPage: function(target, callback) {\n    if ( target != null ) {\n      var section = this._book.spine.get(target);\n      if ( ! section) {\n        // maybe it needs to be resolved\n        var guessed = target;\n        if ( guessed.indexOf(\"://\") < 0 ) {\n          var path1 = path.resolve(this._book.path.directory, this._book.package.navPath);\n          var path2 = path.resolve(path.dirname(path1), target);\n          guessed = this._book.canonical(path2);\n        }\n        if ( guessed.indexOf(\"#\") !== 0 ) {\n          guessed = guessed.split('#')[0];\n        }\n\n        this._book.spine.each(function(item) {\n          if ( item.canonical == guessed ) {\n            section = item;\n            target = section.href;\n            return;\n          }\n        })\n\n        console.log(\"AHOY GUESSED\", target);\n      } else if ( target.toString().match(/^\\d+$/) ) {\n        console.log(\"AHOY USING\", section.href);\n        target = section.href;\n      }\n\n      if ( ! section ) {\n        if ( ! this._epubjs_ready ) {\n          target = 0;\n        } else {\n          return;\n        }\n      }\n    }\n\n    console.log(\"AHOY gotoPage\", target);\n\n    var navigating = this._rendition.display(target).then(function() {\n      this._rendition.display(target);\n    }.bind(this));\n    this._navigate(navigating, callback);\n  },\n\n  percentageFromCfi: function(cfi) {\n    return this._book.percentageFromCfi(cfi);\n  },\n\n  destroy: function() {\n    if ( this._rendition ) {\n      try {\n        this._rendition.destroy();\n      } catch(e) {}\n    }\n    this._rendition = null;\n    this._drawn = false;\n  },\n\n  reopen: function(options, target) {\n    // different per reader?\n    var target = target || this.currentLocation();\n    if( target.start ) { target = target.start ; }\n    if ( target.cfi ) { target = target.cfi ; }\n\n    var doUpdate = false;\n    if ( options === true ) { doUpdate = true; options = {}; }\n    var changed = {};\n    Object.keys(options).forEach(function(key) {\n      if ( options[key] != this.options[key] ) {\n        doUpdate = true;\n        changed[key] = true;\n      }\n      // doUpdate = doUpdate || ( options[key] != this.options[key] );\n    }.bind(this));\n\n    if ( ! doUpdate ) {\n      return;\n    }\n\n    // performance hack\n    if ( Object.keys(changed).length == 1 && changed.scale ) {\n      reader.options.scale = options.scale;\n      this._updateScale();\n      return;\n    }\n\n    if ( options.rootfilePath && options.rootfilePath != this.options.rootfilePath ) {\n      // we need to REOPEN THE DANG BOOK\n      sessionStorage.setItem('rootfilePath', options.rootfilePath);\n      location.reload();\n      return;\n    }\n\n    Util.extend(this.options, options);\n\n    this.draw(target, function() {\n      this._updateFontSize();\n      this._updateScale();\n      this._updateTheme();\n      this._selectTheme(true);\n    }.bind(this))\n  },\n\n  currentLocation: function() {\n    if ( this._rendition && this._rendition.manager ) {\n      this._cached_location = this._rendition.currentLocation();\n    }\n    return this._cached_location;\n  },\n\n  _bindEvents: function() {\n    var self = this;\n\n    // add a stylesheet to stop images from breaking their columns\n    var add_max_img_styles = false;\n    if ( this._book.package.metadata.layout == 'pre-paginated' ) {\n      // NOOP\n    } else if ( this.options.flow == 'auto' || this.options.flow == 'paginated' ) {\n      add_max_img_styles = true;\n    }\n\n    var custom_stylesheet_rules = [];\n\n    // force 90% height instead of default 60%\n    if ( this.metadata.layout != 'pre-paginated' ) {\n      this._rendition.hooks.content.register(function(contents) {\n        contents.addStylesheetRules({\n          \"img\" : {\n            \"max-width\": (this._layout.columnWidth ? this._layout.columnWidth + \"px\" : \"100%\") + \"!important\",\n            \"max-height\": (this._layout.height ? (this._layout.height * 0.9) + \"px\" : \"90%\") + \"!important\",\n            \"object-fit\": \"contain\",\n            \"page-break-inside\": \"avoid\"\n          },\n          \"svg\" : {\n            \"max-width\": (this._layout.columnWidth ? this._layout.columnWidth + \"px\" : \"100%\") + \"!important\",\n            \"max-height\": (this._layout.height ? (this._layout.height * 0.9) + \"px\" : \"90%\") + \"!important\",\n            \"page-break-inside\": \"avoid\"\n          }\n        });\n      }.bind(this._rendition))\n    } else {\n      this._rendition.hooks.content.register(function(contents) {\n        contents.addStylesheetRules({\n          \"img\" : {\n            // \"border\": \"64px solid black !important\",\n            \"box-sizing\": \"border-box !important\"\n          },\n          \"figure\": {\n            \"box-sizing\": \"border-box !important\",\n            \"margin\": \"0 !important\"\n          }\n        });\n      }.bind(this._rendition));\n    }\n\n    this._updateFontSize();\n\n    if ( custom_stylesheet_rules.length ) {\n      this._rendition.hooks.content.register(function(view) {\n        view.addStylesheetRules(custom_stylesheet_rules);\n      })\n    }\n\n    this._rendition.on('resized', function(box) {\n      self.fire('resized', box);\n    })\n\n    this._rendition.on('relocated', function(location) {\n      self.fire('relocated', location);\n    })\n\n    this._rendition.on('displayerror', function(err) {\n      console.log(\"AHOY RENDITION DISPLAY ERROR\", err);\n    })\n\n    this._rendition.on(\"locationChanged\", function(location) {\n      var view = this.manager.current();\n      var section = view.section;\n      var current = this.book.navigation.get(section.href);\n\n      self.fire(\"updateSection\", current);\n      self.fire(\"updateLocation\", location);\n      // self.fire(\"relocated\", location);\n    });\n\n    this._rendition.on(\"rendered\", function(section, view) {\n\n      if ( view.contents ) {\n        // view.contents.on(\"xxlinkClicked\", function(href) {\n        //   console.log(\"AHOY CLICKED\", href);\n        //   var tmp = href.split(\"#\");\n        //   href = tmp[0];\n        //   var hash = tmp[1]\n        //   // var current = self.currentLocation().start.href;\n        //   // var section = self._book.spine.get(current.href);\n        //   console.log(\"AHOY CLICKED CHECK\", section.canonical, href);\n        //   if ( section.canonical.indexOf(href) < 0 ) {\n        //     self.gotoPage(href);\n        //     // self._rendition.display(href);\n\n        //   } else if ( hash ) {\n        //     // we're already on this page, so we need to scroll to this location\n        //     var node = view.contents.content.querySelector('#' + hash);\n        //     console.log(\"AHOY INTERNAL\", hash, view.contents, node);\n        //   }\n        //   // self._rendition.display(href);\n        // })\n      }\n\n      if(false) {\n        if ( ! self._rendition.manager.container.dataset.__scroll ) {\n          var ticking;\n          self._rendition.manager.container.addEventListener(\"scroll\", function(event) {\n            if ( self._rendition && self._rendition.manager ) {\n              var container = self._rendition.manager.container;\n              var mod = container.scrollLeft % parseInt(self._rendition.manager.layout.delta, 10);\n              console.log(\"AHOY DETECTED SCROLL\", mod, mod / self._rendition.manager.layout.delta);\n            }\n          });\n          self._rendition.manager.container.dataset.__scroll = true;\n        }\n      }\n\n      self.on('keyDown', function(data) {\n        if ( data.keyName == 'Tab' && data.inner ) {\n          var container = self._rendition.manager.container;\n          var mod;\n          var delta;\n          var x; var xyz;\n          setTimeout(function() {\n            var scrollLeft = container.scrollLeft;\n            mod = scrollLeft % parseInt(self._rendition.manager.layout.delta, 10);\n            if ( mod > 0 && ( mod / self._rendition.manager.layout.delta ) < 0.99 ) {\n              // var x = Math.floor(event.target.scrollLeft / parseInt(self._rendition.manager.layout.delta, 10)) + 1;\n              // var delta = ( x * self._rendition.manager.layout.delta) - event.target.scrollLeft;\n              x = Math.floor(container.scrollLeft / parseInt(self._rendition.manager.layout.delta, 10));\n              if ( data.shiftKey ) { x -= 0 ; }\n              else { x += 1; }\n              var y = container.scrollLeft;\n              delta = ( x * self._rendition.manager.layout.delta ) - y;\n              xyz = ( x * self._rendition.manager.layout.delta );\n              // if ( data.shiftKey ) { delta *= -1 ; }\n              if ( true || ! data.shiftKey ) {\n                self._rendition.manager.scrollBy(delta);\n              }\n            }\n            console.log(\"AHOY DOING THE SCROLLING\", data.shiftKey, scrollLeft, mod, x, xyz, delta);\n          }, 0);\n        }\n      })\n\n\n    })\n  },\n\n  _initializeReaderStyles: function() {\n    var self = this;\n    var themes = this.options.themes;\n    if ( themes ) {\n      themes.forEach(function(theme) {\n        self._rendition.themes.register(theme['klass'], theme.href ? theme.href : theme.rules);\n      })\n    }\n\n    // base for highlights\n    this._rendition.themes.override('.epubjs-hl', \"fill: yellow; fill-opacity: 0.3; mix-blend-mode: multiply;\");\n  },\n\n  _selectTheme: function(refresh) {\n    var theme = this.options.theme || 'default';\n    this._rendition.themes.select(theme);\n    if ( 0 && refresh ) {\n      var cfi = this.currentLocation().end.cfi;\n      this._rendition.manager.clear();\n      console.log(\"AHOY\", cfi);\n      this._rendition.display(cfi);\n    }\n  },\n\n  _updateFontSize: function() {\n    if ( this.metadata.layout == 'pre-paginated') {\n      // we're not doing font changes for pre-paginted\n      return;\n    }\n\n    var text_size = this.options.text_size == 'auto' ? 100 : this.options.text_size;\n    this._rendition.themes.fontSize(`${text_size}%`);\n  },\n\n  _updateScale: function() {\n    if ( this.metadata.layout != 'pre-paginated') {\n      // we're not scaling for reflowable\n      return;\n    }\n    var scale = this.options.scale;\n    if ( scale ) {\n      this.settings.scale = parseInt(scale, 10) / 100.0;\n      this._queueScale();\n    }\n  },\n\n  _queueScale: function(scale) {\n    this._queueTimeout = setTimeout(function() {\n      if ( this._rendition.manager && this._rendition.manager.stage ) {\n        console.log(\"AHOY SCALING\", this.settings.scale);\n        this._rendition.scale(this.settings.scale);\n      } else {\n        this._queueScale();\n      }\n    }.bind(this), 100);\n  },\n\n  EOT: true\n\n})\n\nObject.defineProperty(Reader.EpubJS.prototype, 'metadata', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    return this._metadata;\n  },\n\n  set: function(data) {\n    this._metadata = Util.extend({}, data, this.options.metadata);\n  }\n});\n\nObject.defineProperty(Reader.EpubJS.prototype, 'annotations', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    if ( Browser.ie ) {\n      return {\n        reset: function() { /* NOOP */ },\n        highlight: function(cfiRange) { /* NOOP */ }\n      }\n    }\n    if ( ! this._rendition.annotations.reset ) {\n      this._rendition.annotations.reset = function(){\n        for(var hash in this._annotations) {\n            var cfiRange = decodeURI(hash);\n            this.remove(cfiRange);\n        }\n        this._annotationsBySectionIndex = {};\n      }.bind(this._rendition.annotations);\n    }\n    return this._rendition.annotations;\n  }\n});\n\nObject.defineProperty(Reader.EpubJS.prototype, 'locations', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    return this._book.locations;\n  }\n});\n\nwindow.Reader = Reader;\n\nexport function createReader(id, options) {\n  return new Reader.EpubJS(id, options);\n}\n","import * as Util from '../core/Util';\nimport {Reader} from './Reader';\nimport * as DomUtil from '../dom/DomUtil';\n\nReader.Mock = Reader.extend({\n\n  initialize: function(id, options) {\n    Reader.prototype.initialize.apply(this, arguments);\n  },\n\n  open: function(target, callback) {\n    var self = this;\n    this._book = {\n      metadata: {\n        title: 'The Mock Life',\n        creator: 'Alex Mock',\n        publisher: 'University Press',\n        location: 'Ann Arbor, MI',\n        pubdate: '2017-05-23'\n      },\n      contents: {\n        toc: [\n          {id: 1, href: \"/epubs/mock/ops/xhtml/TitlePage.xhtml\", label: \"Title\", parent: null},\n          {id: 2, href: \"/epubs/mock/ops/xhtml/Chapter01.xhtml\", label: \"Chapter 1\", parent: null},\n          {id: 3, href: \"/epubs/mock/ops/xhtml/Chapter02.xhtml\", label: \"Chapter 2\", parent: null},\n          {id: 4, href: \"/epubs/mock/ops/xhtml/Chapter03.xhtml\", label: \"Chapter 3\", parent: null},\n          {id: 5, href: \"/epubs/mock/ops/xhtml/Chapter04.xhtml\", label: \"Chapter 4\", parent: null},\n          {id: 6, href: \"/epubs/mock/ops/xhtml/Chapter05.xhtml\", label: \"Chapter 5\", parent: null},\n          {id: 7, href: \"/epubs/mock/ops/xhtml/Chapter06.xhtml\", label: \"Chapter 6\", parent: null},\n          {id: 8, href: \"/epubs/mock/ops/xhtml/Chapter07.xhtml\", label: \"Chapter 7\", parent: null},\n          {id: 9, href: \"/epubs/mock/ops/xhtml/Index.xhtml\", label: \"Index\", parent: null},\n        ]\n      }\n    };\n\n    this._locations = [\n      'epubcfi(/6/4[TitlePage.xhtml])',\n      'epubcfi(/6/4[Chapter01.xhtml])',\n      'epubcfi(/6/4[Chapter02.xhtml])',\n      'epubcfi(/6/4[Chapter03.xhtml])',\n      'epubcfi(/6/4[Chapter04.xhtml])',\n      'epubcfi(/6/4[Chapter05.xhtml])',\n      'epubcfi(/6/4[Chapter06.xhtml])',\n      'epubcfi(/6/4[Chapter07.xhtml])',\n      'epubcfi(/6/4[Chapter08.xhtml])',\n      'epubcfi(/6/4[Index.xhtml])',\n    ];\n\n    this.__currentIndex = 0;\n\n    this.metadata = this._book.metadata;\n    this.fire('updateContents', this._book.contents);\n    this.fire('updateTitle', this._metadata);\n    this.fire('updateLocations', this._locations);\n    this.draw(target, callback);\n  },\n\n  draw: function(target, callback) {\n    var self = this;\n    this.settings = { flow: this.options.flow };\n    this.settings.height = '100%';\n    this.settings.width = '99%';\n    // this.settings.width = '100%';\n    if ( this.options.flow == 'auto' ) {\n      this._panes['book'].style.overflow = 'hidden';\n    } else {\n      this._panes['book'].style.overflow = 'auto';\n    }\n    if ( typeof(target) == 'function' && cb === undefined ) {\n      callback = target;\n      target = undefined;\n    }\n    callback();\n    self.fire('ready');\n  },\n\n  next: function() {\n    // this._rendition.next();\n  },\n\n  prev: function() {\n    // this._rendition.prev();\n  },\n\n  first: function() {\n    // this._rendition.display(0);\n  },\n\n  last: function() {\n  },\n\n  gotoPage: function(target) {\n    if ( typeof(target) == \"string\" ) {\n      this.__currentIndex = this._locations.indexOf(target);\n    } else {\n      this.__currentIndex = target;\n    }\n    this.fire(\"relocated\", this.currentLocation());\n  },\n\n  destroy: function() {\n    // if ( this._rendition ) {\n    //   this._rendition.destroy();\n    // }\n    // this._rendition = null;\n  },\n\n  currentLocation: function() {\n    var cfi = this._locations[this.__currentIndex];\n    return {\n      start: { cfi: cfi, href: cfi },\n      end: { cfi: cfi, href: cfi }\n    }\n  },\n\n  _bindEvents: function() {\n    var self = this;\n\n  },\n\n  _updateTheme: function() {\n\n  },\n\n  EOT: true\n\n})\n\nObject.defineProperty(Reader.Mock.prototype, 'metadata', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    return this._metadata;\n  },\n\n  set: function(data) {\n    this._metadata = Util.extend({}, data, this.options.metadata);\n  }\n});\n\nObject.defineProperty(Reader.Mock.prototype, 'locations', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    var self = this;\n    return {\n      total: self._locations.length,\n      locationFromCfi: function(cfi) {\n        return self._locations.indexOf(cfi);\n      },\n      percentageFromCfi: function(cfi) {\n        var index = self.locations.locationFromCfi(cfi);\n        return ( index / self.locations.total );\n      },\n      cfiFromPercentage: function(percentage) {\n        var index = Math.ceil(percentage * 10);\n        return self._locations[index];\n      }\n    }\n  }\n});\n\nObject.defineProperty(Reader.Mock.prototype, 'annotations', {\n  get: function() {\n    return {\n      reset: function() {},\n      highlight: function() {}\n    }\n  }\n})\n\nexport function createReader(id, options) {\n  return new Reader.Mock(id, options);\n}\n","import {Reader} from './Reader';\nimport * as EpubJS from './Reader.EpubJS';\nimport * as Mock from './Reader.Mock';\n\nvar engines = {\n  epubjs: EpubJS.createReader,\n  mock: Mock.createReader\n}\n\nexport var reader = function(id, options) {\n  options = options || {};\n  var engine = options.engine || window.COZY_EPUB_ENGINE || 'epubjs';\n  var engine_href = options.engine_href || window.COZY_EPUB_ENGINE_HREF;\n  var _this = this;\n  var _arguments = arguments;\n\n  options.engine = engine;\n  options.engine_href = engine_href;\n\n  return engines[engine].apply(_this, [id, options]);\n}"],"names":["global","this","extend","dest","i","j","len","src","arguments","length","create","Object","F","proto","prototype","bind","fn","obj","slice","Array","apply","call","args","concat","lastId","stamp","_cozy_id","throttle","time","context","lock","wrapperFn","later","wrapNum","x","range","includeMax","max","min","d","falseFn","formatNum","num","digits","pow","Math","round","isNumeric","isNaN","parseFloat","isFinite","trim","str","replace","splitWords","split","setOptions","options","hasOwnProperty","getParamString","existingUrl","uppercase","params","push","encodeURIComponent","toUpperCase","indexOf","join","templateRe","template","data","key","value","undefined","Error","isArray","toString","array","el","emptyImageUrl","getPrefixed","name","window","lastTime","timeoutDefer","Date","timeToCall","setTimeout","requestFn","requestAnimationFrame","cancelFn","cancelAnimationFrame","id","clearTimeout","requestAnimFrame","immediate","cancelAnimFrame","loader","url","handler","_resolved","callbacks","error","then","cb","resolve","catch","reject","_argv","shift","retval","e","log","trace","element","document","createElement","onload","onerror","async","parent","attr","appendChild","Class","props","NewClass","initialize","callInitHooks","parentProto","__super__","Util","constructor","statics","includes","_initHooks","_initHooksCalled","include","mergeOptions","addInitHook","init","checkDeprecatedMixinEvents","cozy","Mixin","Evented","types","type","_on","_events","_off","typeListeners","newListener","ctx","listeners","l","_firingCount","splice","propagate","listens","event","target","_propagateEvent","_eventParents","once","off","on","fire","layer","addEventListener","removeEventListener","clearAllEventListeners","addOneTimeEventListener","fireEvent","hasEventListeners","style","documentElement","ie","ielt9","edge","navigator","webkit","userAgentContains","android","android23","opera","chrome","gecko","safari","phantom","opera12","win","platform","ie3d","webkit3d","WebKitCSSMatrix","gecko3d","any3d","L_DISABLE_3D","mobile","orientation","mobileWebkit","mobileWebkit3d","msPointer","PointerEvent","MSPointerEvent","pointer","touch","L_NO_TOUCH","DocumentTouch","mobileOpera","mobileGecko","retina","devicePixelRatio","screen","deviceXDPI","logicalXDPI","canvas","getContext","svg","vml","div","innerHTML","shape","firstChild","behavior","babelHelpers.typeof","adj","columnCount","classList","userAgent","toLowerCase","Point","y","point","clone","_add","toPoint","_subtract","_divideBy","_multiplyBy","_round","_floor","floor","_ceil","ceil","sqrt","abs","POINTER_DOWN","Browser","POINTER_MOVE","POINTER_UP","POINTER_CANCEL","TAG_WHITE_LIST","_pointers","_pointerDocListener","_pointersCount","addPointerListener","removePointerListener","_addPointerStart","onDown","pointerType","MSPOINTER_TYPE_MOUSE","tagName","_globalPointerDown","_globalPointerMove","_globalPointerUp","pointerId","_handlePointer","touches","changedTouches","_addPointerMove","onMove","buttons","_addPointerEnd","onUp","_touchstart","_touchend","_pre","addDoubleTapListener","last","doubleTap","delay","onTouchStart","count","now","delta","onTouchEnd","cancelBubble","newTouch","prop","removeDoubleTapListener","touchstart","touchend","dblclick","eventsKey","addOne","originalHandler","isExternalTarget","attachEvent","removeOne","detachEvent","stopPropagation","originalEvent","_stopped","disableScrollPropagation","disableClickPropagation","fakeStop","preventDefault","returnValue","stop","getMousePosition","container","clientX","clientY","rect","getBoundingClientRect","left","clientLeft","top","clientTop","wheelPxFactor","getWheelDelta","wheelDeltaY","deltaY","deltaMode","deltaX","deltaZ","wheelDelta","detail","skipEvents","skipped","events","related","relatedTarget","parentNode","err","lastClick","filterClick","timeStamp","elapsed","_simulatedClick","_simulated","Element","matches","ep","webkitMatchesSelector","msMatchesSelector","mozMatchesSelector","TRANSFORM","testProp","TRANSITION","TRANSITION_END","get","getElementById","getStyle","currentStyle","defaultView","css","getComputedStyle","className","remove","removeChild","empty","toFront","toBack","insertBefore","hasClass","contains","getClass","RegExp","test","addClass","classes","add","removeClass","setClass","baseVal","setOpacity","opacity","_setOpacityIE","filter","filterName","filters","item","Enabled","Opacity","isPropertySupported","setTransform","offset","scale","pos","setPosition","_leaflet_pos","getPosition","disableTextSelection","enableTextSelection","_userSelect","DomEvent","userSelectProperty","disableImageDrag","enableImageDrag","_outlineElement","_outlineStyle","preventOutline","tabIndex","outline","restoreOutline","freeGlobal","Symbol","root","symToStringTag","objectProto","nativeObjectToString","getRawTag","objectToString","isObject","baseGetTag","coreJsData","funcProto","funcToString","isMasked","isFunction","toSource","getValue","baseIsNative","defineProperty","getNative","eq","baseAssignValue","assignValue","nativeMax","identity","constant","shortOut","baseSetToString","setToString","overRest","isLength","MAX_SAFE_INTEGER","isArrayLike","isIndex","baseRest","isIterateeCall","isObjectLike","baseIsArguments","stubFalse","argsTag","funcTag","nodeUtil","baseUnary","baseIsTypedArray","isArguments","isBuffer","isTypedArray","baseTimes","overArg","isPrototype","nativeKeys","arrayLikeKeys","baseKeys","createAssigner","copyObject","keys","keyboardAllowed","val","fnMap","ret","eventNameMap","fullscreenchange","fullscreenerror","screenfull","elem","request","requestFullscreen","ALLOW_KEYBOARD_INPUT","exitFullscreen","isFullscreen","exit","callback","eventName","defineProperties","Boolean","fullscreenElement","fullscreenEnabled","Reader","self","_original_document_title","title","localStorage","getItem","assign","JSON","parse","_checkFeatureCompatibility","metadata","_initContainer","_initLayout","themes","forEach","theme","href","klass","rules","rule","new_rule","_updateTheme","_initEvents","_mode","mode","js","engine_href","_start","_loaded","open","saved_options","flow","setItem","stringify","_container","dataset","index","back","forward","enabled","toggle","DomUtil","_onScroll","_containerId","_fadeAnimated","fadeAnimation","engine","position","_initPanes","panes","_panes","prefix","_initBookLoader","_targets","tracking","reader","_action","_last_location_start","_reader","v","pop","action","location","start","cfi","onOff","transform3DLimit","_onMoveEnd","location_href","_ignoreHistory","pageview","tmp_href","substr","pushState","percentage","p","isTrusted","state","gotoPage","keyName","check","activeElement","localName","parentElement","IGNORE_TARGETS","shiftKey","next","prev","_scroll","scrollTop","scrollLeft","keyCode","srcElement","_fireDOMEvent","targets","synth","_findEventTargets","isMarker","containerPoint","latLngToContainerPoint","getLatLng","mouseEventToContainerPoint","layerPoint","containerPointToLayerPoint","latlng","layerPointToLatLng","nonBubblingEvents","h","clientHeight","paddingTop","paddingBottom","w","clientWidth","paddingRight","paddingLeft","height","width","_drawn","_resizeRequest","_checkMobileDevice","text_size","_isMobile","mobileMediaQuery","matchMedia","_clearBookLoaderTimeout","_force_progress","_loader_timeout","display","force","loader_template","loaderTemplate","body","DOMParser","parseFromString","children","Control","_locked","_id","getTime","parseInt","random","region","removeControl","addControl","onAdd","getRegion","area","getControlRegion","onRemove","screenX","screenY","getContainer","focus","widget","direction","control","addTo","_controlContainer","parts","tmp","slug","panel","slot","childElement","_classify","_controlRegions","PageControl","_control","querySelector","_className","_createButton","_fill","html","label","_bindEvents","link","setAttribute","s","unit","_unit","PagePrevious","PageNext","PageFirst","first","PageLast","pageNext","pagePrevious","pageFirst","pageLast","activeModal","FOCUSABLE_ELEMENTS","ACTIONABLE_ELEMENTS","Modal","onShow","onClose","_initializedEvents","actions","handlers","panelHTML","main","button_cls","modal","onClick","onKeydown","onModalTransition","button_id","button","close","closeModal","removeEventListeners","_resize","setFocusToFirstNode","addEventListeners","showModal","offsetHeight","offsetWidth","fraction","header","footer","nodes","querySelectorAll","map","focusableNodes","getFocusableNodes","maintainFocus","closeAfterAction","hasAttribute","actionableNodes","getActionableNodes","click","did_match","selector","getAttribute","focusedItemIndex","Contents","defaultTemplate","_modal","activate","_setupSkipLink","_process","items","tabindex","option","_createOption","subitems","toc","chapter","anchor","textContent","span","skipLink","ul","contents","Title","h1","_title","_divider","_section","bookTitle","PublicationMetadata","_publisher","_rights","publisher","rights","publicationMetadata","Preferences","_activated","updatePreferences","initializeForm","possible_fieldsets","layout","rootfiles","hasThemes","_fieldsets","cls","fieldset","fields","hasFields","field","inputs","input","checked","hint","_form","_createPanel","doUpdate","new_options","saveable_options","updateForm","deactivate","saveOptions","reopen","Fieldset","_current","TextSize","form","_input","_output","_preview","_actionReset","_updatePreview","saveable","fontSize","Display","scrolled_help","Theme","Rendition","rootfilePath","expr","rootfile","accessMode","Scale","transform","preferences","Widget","_onAddExtra","_updateTemplate","_updateClass","node","Button","Panel","Toggle","states","stateName","_resetState","_state","Citation","designMode","formatted","createRange","selectNode","sel","getSelection","removeAllRanges","addRange","flag","execCommand","_message","detach","citations","citation","format","text","createTextNode","_formatted","_initializeForm","_formatCitation","selected","Search","_data","_canceled","_processing","_article","searchString","openModalResults","openModalWaiting","submitQuery","_emptyArticle","_buildResults","searchUrl","XMLHttpRequest","status","response","send","hasChildNodes","lastChild","content","annotations","reset","highlight","highlight_off","search_results","result","cfiRange","snippet","chapterTitle","search","BibliographicInformation","dl","metadata_fields","metadata_fields_seen","idx","_formatDate","dt","dd","match","bibliographicInformation","Download","_configureDownloadForm","submit","download_links","size","download","Navigator","_setup","locations","_initializeNavigator","_createControl","_background","_status","_spanCurrentPercentage","_spanCurrentLocation","_spanTotalLocations","_update","_mouseDown","_initiated","percentageFromCfi","currentLocation","cfiFromPercentage","current","rangeBg","current_location","locationFromCfi","_last_delta","_last_value","_total","total","Bus","instance","bus","Events","ePub","require","EpubJS","_epubjs_ready","xpath","path","responseType","containerDoc","responseXML","sessionStorage","book_href","book_options","packagePath","useArchive","openAs","_book","epubjs","removeItem","loaded","navigation","_contents","package","ready","draw","spine","each","cfiBase","_locations","t","f","_rendition","manager","stage","generate","hooks","clear","destroy","settings","forceScrolledDocHeight","overflow","spread","_drawRendition","renderTo","_updateFontSize","hash","status_index","_enableBookLoader","_disableBookLoader","register","inner","_initializeReaderStyles","_queueTimeout","rootFilePath","newScrollTop","scrollBy","scrollHeight","promise","_navigate","section","guessed","path1","directory","navPath","path2","dirname","canonical","navigating","changed","_updateScale","reload","_selectTheme","_cached_location","add_max_img_styles","custom_stylesheet_rules","addStylesheetRules","_layout","columnWidth","view","box","book","mod","xyz","override","refresh","select","end","_queueScale","_metadata","_annotations","decodeURI","_annotationsBySectionIndex","createReader","Mock","__currentIndex","engines","COZY_EPUB_ENGINE","COZY_EPUB_ENGINE_HREF","_this","_arguments"],"mappings":"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"}
>>>>>>> 2d3f15c... better resizing tracking for scaling
=======
{"version":3,"file":"cozy-sun-bear.js","sources":["../node_modules/url-polyfill/url-polyfill.js","../node_modules/classlist-polyfill/src/index.js","../src/core/Util.js","../src/core/Class.js","../src/core/Events.js","../src/core/Browser.js","../src/geometry/Point.js","../src/dom/DomEvent.Pointer.js","../src/dom/DomEvent.DoubleTap.js","../src/dom/DomEvent.js","../src/dom/DomUtil.js","../node_modules/lodash/isObject.js","../node_modules/lodash/_freeGlobal.js","../node_modules/lodash/_root.js","../node_modules/lodash/_Symbol.js","../node_modules/lodash/_getRawTag.js","../node_modules/lodash/_objectToString.js","../node_modules/lodash/_baseGetTag.js","../node_modules/lodash/isObjectLike.js","../node_modules/lodash/isFunction.js","../node_modules/lodash/_coreJsData.js","../node_modules/lodash/_isMasked.js","../node_modules/lodash/_toSource.js","../node_modules/lodash/_baseIsNative.js","../node_modules/lodash/_getValue.js","../node_modules/lodash/_getNative.js","../node_modules/lodash/_defineProperty.js","../node_modules/lodash/_baseAssignValue.js","../node_modules/lodash/eq.js","../node_modules/lodash/_assignValue.js","../node_modules/lodash/_copyObject.js","../node_modules/lodash/identity.js","../node_modules/lodash/_apply.js","../node_modules/lodash/_overRest.js","../node_modules/lodash/constant.js","../node_modules/lodash/_baseSetToString.js","../node_modules/lodash/_shortOut.js","../node_modules/lodash/_setToString.js","../node_modules/lodash/_baseRest.js","../node_modules/lodash/isLength.js","../node_modules/lodash/isArrayLike.js","../node_modules/lodash/_isIndex.js","../node_modules/lodash/_isIterateeCall.js","../node_modules/lodash/_createAssigner.js","../node_modules/lodash/_isPrototype.js","../node_modules/lodash/_baseTimes.js","../node_modules/lodash/_baseIsArguments.js","../node_modules/lodash/isArguments.js","../node_modules/lodash/isArray.js","../node_modules/lodash/stubFalse.js","../node_modules/lodash/isBuffer.js","../node_modules/lodash/_baseIsTypedArray.js","../node_modules/lodash/_baseUnary.js","../node_modules/lodash/_nodeUtil.js","../node_modules/lodash/isTypedArray.js","../node_modules/lodash/_arrayLikeKeys.js","../node_modules/lodash/_overArg.js","../node_modules/lodash/_nativeKeys.js","../node_modules/lodash/_baseKeys.js","../node_modules/lodash/keys.js","../node_modules/lodash/assign.js","../src/screenfull.js","../src/reader/Reader.js","../src/control/Control.js","../src/control/Control.Paging.js","../src/control/Modal.js","../src/control/Control.Contents.js","../src/control/Control.Title.js","../src/control/Control.PublicationMetadata.js","../src/control/Control.Preferences.js","../src/control/Control.Widget.js","../src/control/Control.Citation.js","../src/control/Control.Search.js","../src/control/Control.BibliographicInformation.js","../src/control/Control.Download.js","../src/control/Control.Navigator.js","../src/control/index.js","../src/core/Bus.js","../src/core/index.js","../src/epubjs.js","../node_modules/path-webpack/path.js","../src/reader/Reader.EpubJS.js","../src/reader/Reader.Mock.js","../src/reader/index.js"],"sourcesContent":["(function(global) {\r\n  /**\r\n   * Polyfill URLSearchParams\r\n   *\r\n   * Inspired from : https://github.com/WebReflection/url-search-params/blob/master/src/url-search-params.js\r\n   */\r\n\r\n  var checkIfIteratorIsSupported = function() {\r\n    try {\r\n      return !!Symbol.iterator;\r\n    } catch(error) {\r\n      return false;\r\n    }\r\n  };\r\n\r\n\r\n  var iteratorSupported = checkIfIteratorIsSupported();\r\n\r\n  var createIterator = function(items) {\r\n    var iterator = {\r\n      next: function() {\r\n        var value = items.shift();\r\n        return { done: value === void 0, value: value };\r\n      }\r\n    };\r\n\r\n    if(iteratorSupported) {\r\n      iterator[Symbol.iterator] = function() {\r\n        return iterator;\r\n      };\r\n    }\r\n\r\n    return iterator;\r\n  };\r\n\r\n  /**\r\n   * Search param name and values should be encoded according to https://url.spec.whatwg.org/#urlencoded-serializing\r\n   * encodeURIComponent() produces the same result except encoding spaces as `%20` instead of `+`.\r\n   */\r\n  var serializeParam = function(value) {\r\n    return encodeURIComponent(value).replace(/%20/g, '+');\r\n  };\r\n\r\n  var deserializeParam = function(value) {\r\n    return decodeURIComponent(value).replace(/\\+/g, ' ');\r\n  };\r\n\r\n  var polyfillURLSearchParams= function() {\r\n\r\n    var URLSearchParams = function(searchString) {\r\n      Object.defineProperty(this, '_entries', { value: {} });\r\n\r\n      if(typeof searchString === 'string') {\r\n        if(searchString !== '') {\r\n          searchString = searchString.replace(/^\\?/, '');\r\n          var attributes = searchString.split('&');\r\n          var attribute;\r\n          for(var i = 0; i < attributes.length; i++) {\r\n            attribute = attributes[i].split('=');\r\n            this.append(\r\n              deserializeParam(attribute[0]),\r\n              (attribute.length > 1) ? deserializeParam(attribute[1]) : ''\r\n            );\r\n          }\r\n        }\r\n      } else if(searchString instanceof URLSearchParams) {\r\n        var _this = this;\r\n        searchString.forEach(function(value, name) {\r\n          _this.append(value, name);\r\n        });\r\n      }\r\n    };\r\n\r\n    var proto = URLSearchParams.prototype;\r\n\r\n    proto.append = function(name, value) {\r\n      if(name in this._entries) {\r\n        this._entries[name].push(value.toString());\r\n      } else {\r\n        this._entries[name] = [value.toString()];\r\n      }\r\n    };\r\n\r\n    proto.delete = function(name) {\r\n      delete this._entries[name];\r\n    };\r\n\r\n    proto.get = function(name) {\r\n      return (name in this._entries) ? this._entries[name][0] : null;\r\n    };\r\n\r\n    proto.getAll = function(name) {\r\n      return (name in this._entries) ? this._entries[name].slice(0) : [];\r\n    };\r\n\r\n    proto.has = function(name) {\r\n      return (name in this._entries);\r\n    };\r\n\r\n    proto.set = function(name, value) {\r\n      this._entries[name] = [value.toString()];\r\n    };\r\n\r\n    proto.forEach = function(callback, thisArg) {\r\n      var entries;\r\n      for(var name in this._entries) {\r\n        if(this._entries.hasOwnProperty(name)) {\r\n          entries = this._entries[name];\r\n          for(var i = 0; i < entries.length; i++) {\r\n            callback.call(thisArg, entries[i], name, this);\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    proto.keys = function() {\r\n      var items = [];\r\n      this.forEach(function(value, name) { items.push(name); });\r\n      return createIterator(items);\r\n    };\r\n\r\n    proto.values = function() {\r\n      var items = [];\r\n      this.forEach(function(value) { items.push(value); });\r\n      return createIterator(items);\r\n    };\r\n\r\n    proto.entries = function() {\r\n      var items = [];\r\n      this.forEach(function(value, name) { items.push([name, value]); });\r\n      return createIterator(items);\r\n    };\r\n\r\n    if(iteratorSupported) {\r\n      proto[Symbol.iterator] = proto.entries;\r\n    }\r\n\r\n    proto.toString = function() {\r\n      var searchString = '';\r\n      this.forEach(function(value, name) {\r\n        if(searchString.length > 0) searchString+= '&';\r\n        searchString += serializeParam(name) + '=' + serializeParam(value);\r\n      });\r\n      return searchString;\r\n    };\r\n\r\n    global.URLSearchParams = URLSearchParams;\r\n  };\r\n\r\n  if(!('URLSearchParams' in global) || (new URLSearchParams('?a=1').toString() !== 'a=1')) {\r\n    polyfillURLSearchParams();\r\n  }\r\n\r\n  // HTMLAnchorElement\r\n\r\n})(\r\n  (typeof global !== 'undefined') ? global\r\n    : ((typeof window !== 'undefined') ? window\r\n    : ((typeof self !== 'undefined') ? self : this))\r\n);\r\n\r\n(function(global) {\r\n  /**\r\n   * Polyfill URL\r\n   *\r\n   * Inspired from : https://github.com/arv/DOM-URL-Polyfill/blob/master/src/url.js\r\n   */\r\n\r\n  var checkIfURLIsSupported = function() {\r\n    try {\r\n      var u = new URL('b', 'http://a');\r\n      u.pathname = 'c%20d';\r\n      return (u.href === 'http://a/c%20d') && u.searchParams;\r\n    } catch(e) {\r\n      return false;\r\n    }\r\n  };\r\n\r\n\r\n  var polyfillURL = function() {\r\n    var _URL = global.URL;\r\n\r\n    var URL = function(url, base) {\r\n      if(typeof url !== 'string') url = String(url);\r\n\r\n      var doc = document.implementation.createHTMLDocument('');\r\n      window.doc = doc;\r\n      if(base) {\r\n        var baseElement = doc.createElement('base');\r\n        baseElement.href = base;\r\n        doc.head.appendChild(baseElement);\r\n      }\r\n\r\n      var anchorElement = doc.createElement('a');\r\n      anchorElement.href = url;\r\n      doc.body.appendChild(anchorElement);\r\n      anchorElement.href = anchorElement.href; // force href to refresh\r\n\r\n      if(anchorElement.protocol === ':' || !/:/.test(anchorElement.href)) {\r\n        throw new TypeError('Invalid URL');\r\n      }\r\n\r\n      Object.defineProperty(this, '_anchorElement', {\r\n        value: anchorElement\r\n      });\r\n    };\r\n\r\n    var proto = URL.prototype;\r\n\r\n    var linkURLWithAnchorAttribute = function(attributeName) {\r\n      Object.defineProperty(proto, attributeName, {\r\n        get: function() {\r\n          return this._anchorElement[attributeName];\r\n        },\r\n        set: function(value) {\r\n          this._anchorElement[attributeName] = value;\r\n        },\r\n        enumerable: true\r\n      });\r\n    };\r\n\r\n    ['hash', 'host', 'hostname', 'port', 'protocol', 'search']\r\n    .forEach(function(attributeName) {\r\n      linkURLWithAnchorAttribute(attributeName);\r\n    });\r\n\r\n    Object.defineProperties(proto, {\r\n\r\n      'toString': {\r\n        get: function() {\r\n          var _this = this;\r\n          return function() {\r\n            return _this.href;\r\n          };\r\n        }\r\n      },\r\n\r\n      'href' : {\r\n        get: function() {\r\n          return this._anchorElement.href.replace(/\\?$/,'');\r\n        },\r\n        set: function(value) {\r\n          this._anchorElement.href = value;\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'pathname' : {\r\n        get: function() {\r\n          return this._anchorElement.pathname.replace(/(^\\/?)/,'/');\r\n        },\r\n        set: function(value) {\r\n          this._anchorElement.pathname = value;\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'origin': {\r\n        get: function() {\r\n          // get expected port from protocol\r\n          var expectedPort = {'http:': 80, 'https:': 443, 'ftp:': 21}[this._anchorElement.protocol];\r\n          // add port to origin if, expected port is different than actual port\r\n          // and it is not empty f.e http://foo:8080\r\n          // 8080 != 80 && 8080 != ''\r\n          var addPortToOrigin = this._anchorElement.port != expectedPort &&\r\n            this._anchorElement.port !== ''\r\n\r\n          return this._anchorElement.protocol +\r\n            '//' +\r\n            this._anchorElement.hostname +\r\n            (addPortToOrigin ? (':' + this._anchorElement.port) : '');\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'password': { // TODO\r\n        get: function() {\r\n          return '';\r\n        },\r\n        set: function(value) {\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'username': { // TODO\r\n        get: function() {\r\n          return '';\r\n        },\r\n        set: function(value) {\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'searchParams': {\r\n        get: function() {\r\n          var searchParams = new URLSearchParams(this.search);\r\n          var _this = this;\r\n          ['append', 'delete', 'set'].forEach(function(methodName) {\r\n            var method = searchParams[methodName];\r\n            searchParams[methodName] = function() {\r\n              method.apply(searchParams, arguments);\r\n              _this.search = searchParams.toString();\r\n            };\r\n          });\r\n          return searchParams;\r\n        },\r\n        enumerable: true\r\n      }\r\n    });\r\n\r\n    URL.createObjectURL = function(blob) {\r\n      return _URL.createObjectURL.apply(_URL, arguments);\r\n    };\r\n\r\n    URL.revokeObjectURL = function(url) {\r\n      return _URL.revokeObjectURL.apply(_URL, arguments);\r\n    };\r\n\r\n    global.URL = URL;\r\n\r\n  };\r\n\r\n  if(!checkIfURLIsSupported()) {\r\n    polyfillURL();\r\n  }\r\n\r\n  if((global.location !== void 0) && !('origin' in global.location)) {\r\n    var getOrigin = function() {\r\n      return global.location.protocol + '//' + global.location.hostname + (global.location.port ? (':' + global.location.port) : '');\r\n    };\r\n\r\n    try {\r\n      Object.defineProperty(global.location, 'origin', {\r\n        get: getOrigin,\r\n        enumerable: true\r\n      });\r\n    } catch(e) {\r\n      setInterval(function() {\r\n        global.location.origin = getOrigin();\r\n      }, 100);\r\n    }\r\n  }\r\n\r\n})(\r\n  (typeof global !== 'undefined') ? global\r\n    : ((typeof window !== 'undefined') ? window\r\n    : ((typeof self !== 'undefined') ? self : this))\r\n);\r\n","/*\n * classList.js: Cross-browser full element.classList implementation.\n * 1.1.20170427\n *\n * By Eli Grey, http://eligrey.com\n * License: Dedicated to the public domain.\n *   See https://github.com/eligrey/classList.js/blob/master/LICENSE.md\n */\n\n/*global self, document, DOMException */\n\n/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js */\n\nif (\"document\" in window.self) {\n\n// Full polyfill for browsers with no classList support\n// Including IE < Edge missing SVGElement.classList\nif (!(\"classList\" in document.createElement(\"_\")) \n\t|| document.createElementNS && !(\"classList\" in document.createElementNS(\"http://www.w3.org/2000/svg\",\"g\"))) {\n\n(function (view) {\n\n\"use strict\";\n\nif (!('Element' in view)) return;\n\nvar\n\t  classListProp = \"classList\"\n\t, protoProp = \"prototype\"\n\t, elemCtrProto = view.Element[protoProp]\n\t, objCtr = Object\n\t, strTrim = String[protoProp].trim || function () {\n\t\treturn this.replace(/^\\s+|\\s+$/g, \"\");\n\t}\n\t, arrIndexOf = Array[protoProp].indexOf || function (item) {\n\t\tvar\n\t\t\t  i = 0\n\t\t\t, len = this.length\n\t\t;\n\t\tfor (; i < len; i++) {\n\t\t\tif (i in this && this[i] === item) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t}\n\t// Vendors: please allow content code to instantiate DOMExceptions\n\t, DOMEx = function (type, message) {\n\t\tthis.name = type;\n\t\tthis.code = DOMException[type];\n\t\tthis.message = message;\n\t}\n\t, checkTokenAndGetIndex = function (classList, token) {\n\t\tif (token === \"\") {\n\t\t\tthrow new DOMEx(\n\t\t\t\t  \"SYNTAX_ERR\"\n\t\t\t\t, \"An invalid or illegal string was specified\"\n\t\t\t);\n\t\t}\n\t\tif (/\\s/.test(token)) {\n\t\t\tthrow new DOMEx(\n\t\t\t\t  \"INVALID_CHARACTER_ERR\"\n\t\t\t\t, \"String contains an invalid character\"\n\t\t\t);\n\t\t}\n\t\treturn arrIndexOf.call(classList, token);\n\t}\n\t, ClassList = function (elem) {\n\t\tvar\n\t\t\t  trimmedClasses = strTrim.call(elem.getAttribute(\"class\") || \"\")\n\t\t\t, classes = trimmedClasses ? trimmedClasses.split(/\\s+/) : []\n\t\t\t, i = 0\n\t\t\t, len = classes.length\n\t\t;\n\t\tfor (; i < len; i++) {\n\t\t\tthis.push(classes[i]);\n\t\t}\n\t\tthis._updateClassName = function () {\n\t\t\telem.setAttribute(\"class\", this.toString());\n\t\t};\n\t}\n\t, classListProto = ClassList[protoProp] = []\n\t, classListGetter = function () {\n\t\treturn new ClassList(this);\n\t}\n;\n// Most DOMException implementations don't allow calling DOMException's toString()\n// on non-DOMExceptions. Error's toString() is sufficient here.\nDOMEx[protoProp] = Error[protoProp];\nclassListProto.item = function (i) {\n\treturn this[i] || null;\n};\nclassListProto.contains = function (token) {\n\ttoken += \"\";\n\treturn checkTokenAndGetIndex(this, token) !== -1;\n};\nclassListProto.add = function () {\n\tvar\n\t\t  tokens = arguments\n\t\t, i = 0\n\t\t, l = tokens.length\n\t\t, token\n\t\t, updated = false\n\t;\n\tdo {\n\t\ttoken = tokens[i] + \"\";\n\t\tif (checkTokenAndGetIndex(this, token) === -1) {\n\t\t\tthis.push(token);\n\t\t\tupdated = true;\n\t\t}\n\t}\n\twhile (++i < l);\n\n\tif (updated) {\n\t\tthis._updateClassName();\n\t}\n};\nclassListProto.remove = function () {\n\tvar\n\t\t  tokens = arguments\n\t\t, i = 0\n\t\t, l = tokens.length\n\t\t, token\n\t\t, updated = false\n\t\t, index\n\t;\n\tdo {\n\t\ttoken = tokens[i] + \"\";\n\t\tindex = checkTokenAndGetIndex(this, token);\n\t\twhile (index !== -1) {\n\t\t\tthis.splice(index, 1);\n\t\t\tupdated = true;\n\t\t\tindex = checkTokenAndGetIndex(this, token);\n\t\t}\n\t}\n\twhile (++i < l);\n\n\tif (updated) {\n\t\tthis._updateClassName();\n\t}\n};\nclassListProto.toggle = function (token, force) {\n\ttoken += \"\";\n\n\tvar\n\t\t  result = this.contains(token)\n\t\t, method = result ?\n\t\t\tforce !== true && \"remove\"\n\t\t:\n\t\t\tforce !== false && \"add\"\n\t;\n\n\tif (method) {\n\t\tthis[method](token);\n\t}\n\n\tif (force === true || force === false) {\n\t\treturn force;\n\t} else {\n\t\treturn !result;\n\t}\n};\nclassListProto.toString = function () {\n\treturn this.join(\" \");\n};\n\nif (objCtr.defineProperty) {\n\tvar classListPropDesc = {\n\t\t  get: classListGetter\n\t\t, enumerable: true\n\t\t, configurable: true\n\t};\n\ttry {\n\t\tobjCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\n\t} catch (ex) { // IE 8 doesn't support enumerable:true\n\t\t// adding undefined to fight this issue https://github.com/eligrey/classList.js/issues/36\n\t\t// modernie IE8-MSW7 machine has IE8 8.0.6001.18702 and is affected\n\t\tif (ex.number === undefined || ex.number === -0x7FF5EC54) {\n\t\t\tclassListPropDesc.enumerable = false;\n\t\t\tobjCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\n\t\t}\n\t}\n} else if (objCtr[protoProp].__defineGetter__) {\n\telemCtrProto.__defineGetter__(classListProp, classListGetter);\n}\n\n}(window.self));\n\n}\n\n// There is full or partial native classList support, so just check if we need\n// to normalize the add/remove and toggle APIs.\n\n(function () {\n\t\"use strict\";\n\n\tvar testElement = document.createElement(\"_\");\n\n\ttestElement.classList.add(\"c1\", \"c2\");\n\n\t// Polyfill for IE 10/11 and Firefox <26, where classList.add and\n\t// classList.remove exist but support only one argument at a time.\n\tif (!testElement.classList.contains(\"c2\")) {\n\t\tvar createMethod = function(method) {\n\t\t\tvar original = DOMTokenList.prototype[method];\n\n\t\t\tDOMTokenList.prototype[method] = function(token) {\n\t\t\t\tvar i, len = arguments.length;\n\n\t\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t\ttoken = arguments[i];\n\t\t\t\t\toriginal.call(this, token);\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t\tcreateMethod('add');\n\t\tcreateMethod('remove');\n\t}\n\n\ttestElement.classList.toggle(\"c3\", false);\n\n\t// Polyfill for IE 10 and Firefox <24, where classList.toggle does not\n\t// support the second argument.\n\tif (testElement.classList.contains(\"c3\")) {\n\t\tvar _toggle = DOMTokenList.prototype.toggle;\n\n\t\tDOMTokenList.prototype.toggle = function(token, force) {\n\t\t\tif (1 in arguments && !this.contains(token) === !force) {\n\t\t\t\treturn force;\n\t\t\t} else {\n\t\t\t\treturn _toggle.call(this, token);\n\t\t\t}\n\t\t};\n\n\t}\n\n\ttestElement = null;\n}());\n\n}\n","/*\n * @namespace Util\n *\n * Various utility functions, used by Leaflet internally.\n */\n\n// @function extend(dest: Object, src?: Object): Object\n// Merges the properties of the `src` object (or multiple objects) into `dest` object and returns the latter. Has an `L.extend` shortcut.\nexport function extend(dest) {\n    var i, j, len, src;\n\n    for (j = 1, len = arguments.length; j < len; j++) {\n        src = arguments[j];\n        for (i in src) {\n            dest[i] = src[i];\n        }\n    }\n    return dest;\n}\n\n// @function create(proto: Object, properties?: Object): Object\n// Compatibility polyfill for [Object.create](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/create)\nexport var create = Object.create || (function () {\n    function F() {}\n    return function (proto) {\n        F.prototype = proto;\n        return new F();\n    };\n})();\n\n// @function bind(fn: Function, …): Function\n// Returns a new function bound to the arguments passed, like [Function.prototype.bind](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Function/bind).\n// Has a `L.bind()` shortcut.\nexport function bind(fn, obj) {\n    var slice = Array.prototype.slice;\n\n    if (fn.bind) {\n        return fn.bind.apply(fn, slice.call(arguments, 1));\n    }\n\n    var args = slice.call(arguments, 2);\n\n    return function () {\n        return fn.apply(obj, args.length ? args.concat(slice.call(arguments)) : arguments);\n    };\n}\n\n// @property lastId: Number\n// Last unique ID used by [`stamp()`](#util-stamp)\nexport var lastId = 0;\n\n// @function stamp(obj: Object): Number\n// Returns the unique ID of an object, assiging it one if it doesn't have it.\nexport function stamp(obj) {\n    /*eslint-disable */\n    obj._cozy_id = obj._cozy_id || ++lastId;\n    return obj._cozy_id; /* not leaflet */\n    /*eslint-enable */\n}\n\n// @function throttle(fn: Function, time: Number, context: Object): Function\n// Returns a function which executes function `fn` with the given scope `context`\n// (so that the `this` keyword refers to `context` inside `fn`'s code). The function\n// `fn` will be called no more than one time per given amount of `time`. The arguments\n// received by the bound function will be any arguments passed when binding the\n// function, followed by any arguments passed when invoking the bound function.\n// Has an `L.throttle` shortcut.\nexport function throttle(fn, time, context) {\n    var lock, args, wrapperFn, later;\n\n    later = function () {\n        // reset lock and call if queued\n        lock = false;\n        if (args) {\n            wrapperFn.apply(context, args);\n            args = false;\n        }\n    };\n\n    wrapperFn = function () {\n        if (lock) {\n            // called too soon, queue to call later\n            args = arguments;\n\n        } else {\n            // call and lock until later\n            fn.apply(context, arguments);\n            setTimeout(later, time);\n            lock = true;\n        }\n    };\n\n    return wrapperFn;\n}\n\n// @function wrapNum(num: Number, range: Number[], includeMax?: Boolean): Number\n// Returns the number `num` modulo `range` in such a way so it lies within\n// `range[0]` and `range[1]`. The returned value will be always smaller than\n// `range[1]` unless `includeMax` is set to `true`.\nexport function wrapNum(x, range, includeMax) {\n    var max = range[1],\n        min = range[0],\n        d = max - min;\n    return x === max && includeMax ? x : ((x - min) % d + d) % d + min;\n}\n\n// @function falseFn(): Function\n// Returns a function which always returns `false`.\nexport function falseFn() { return false; }\n\n// @function formatNum(num: Number, digits?: Number): Number\n// Returns the number `num` rounded to `digits` decimals, or to 5 decimals by default.\nexport function formatNum(num, digits) {\n    var pow = Math.pow(10, digits || 5);\n    return Math.round(num * pow) / pow;\n}\n\n// @function isNumeric(num: Number): Boolean\n// Returns whether num is actually numeric\nexport function isNumeric(num) {\n  return !isNaN(parseFloat(num)) && isFinite(num);\n}\n\n// @function trim(str: String): String\n// Compatibility polyfill for [String.prototype.trim](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String/Trim)\nexport function trim(str) {\n    return str.trim ? str.trim() : str.replace(/^\\s+|\\s+$/g, '');\n}\n\n// @function splitWords(str: String): String[]\n// Trims and splits the string on whitespace and returns the array of parts.\nexport function splitWords(str) {\n    return trim(str).split(/\\s+/);\n}\n\n// @function setOptions(obj: Object, options: Object): Object\n// Merges the given properties to the `options` of the `obj` object, returning the resulting options. See `Class options`. Has an `L.setOptions` shortcut.\nexport function setOptions(obj, options) {\n    if (!obj.hasOwnProperty('options')) {\n        obj.options = obj.options ? create(obj.options) : {};\n    }\n    for (var i in options) {\n        obj.options[i] = options[i];\n    }\n    return obj.options;\n}\n\n// @function getParamString(obj: Object, existingUrl?: String, uppercase?: Boolean): String\n// Converts an object into a parameter URL string, e.g. `{a: \"foo\", b: \"bar\"}`\n// translates to `'?a=foo&b=bar'`. If `existingUrl` is set, the parameters will\n// be appended at the end. If `uppercase` is `true`, the parameter names will\n// be uppercased (e.g. `'?A=foo&B=bar'`)\nexport function getParamString(obj, existingUrl, uppercase) {\n    var params = [];\n    for (var i in obj) {\n        params.push(encodeURIComponent(uppercase ? i.toUpperCase() : i) + '=' + encodeURIComponent(obj[i]));\n    }\n    return ((!existingUrl || existingUrl.indexOf('?') === -1) ? '?' : '&') + params.join('&');\n}\n\nvar templateRe = /\\{ *([\\w_\\-]+) *\\}/g;\n\n// @function template(str: String, data: Object): String\n// Simple templating facility, accepts a template string of the form `'Hello {a}, {b}'`\n// and a data object like `{a: 'foo', b: 'bar'}`, returns evaluated string\n// `('Hello foo, bar')`. You can also specify functions instead of strings for\n// data values — they will be evaluated passing `data` as an argument.\nexport function template(str, data) {\n    return str.replace(templateRe, function (str, key) {\n        var value = data[key];\n\n        if (value === undefined) {\n            throw new Error('No value provided for variable ' + str);\n\n        } else if (typeof value === 'function') {\n            value = value(data);\n        }\n        return value;\n    });\n}\n\n// @function isArray(obj): Boolean\n// Compatibility polyfill for [Array.isArray](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array/isArray)\nexport var isArray = Array.isArray || function (obj) {\n    return (Object.prototype.toString.call(obj) === '[object Array]');\n};\n\n// @function indexOf(array: Array, el: Object): Number\n// Compatibility polyfill for [Array.prototype.indexOf](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf)\nexport function indexOf(array, el) {\n    for (var i = 0; i < array.length; i++) {\n        if (array[i] === el) { return i; }\n    }\n    return -1;\n}\n\n// @property emptyImageUrl: String\n// Data URI string containing a base64-encoded empty GIF image.\n// Used as a hack to free memory from unused images on WebKit-powered\n// mobile devices (by setting image `src` to this string).\nexport var emptyImageUrl = 'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=';\n\n// inspired by http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n\nfunction getPrefixed(name) {\n    return window['webkit' + name] || window['moz' + name] || window['ms' + name];\n}\n\nvar lastTime = 0;\n\n// fallback for IE 7-8\nfunction timeoutDefer(fn) {\n    var time = +new Date(),\n        timeToCall = Math.max(0, 16 - (time - lastTime));\n\n    lastTime = time + timeToCall;\n    return window.setTimeout(fn, timeToCall);\n}\n\nexport var requestFn = window.requestAnimationFrame || getPrefixed('RequestAnimationFrame') || timeoutDefer;\nexport var cancelFn = window.cancelAnimationFrame || getPrefixed('CancelAnimationFrame') ||\n        getPrefixed('CancelRequestAnimationFrame') || function (id) { window.clearTimeout(id); };\n\n// @function requestAnimFrame(fn: Function, context?: Object, immediate?: Boolean): Number\n// Schedules `fn` to be executed when the browser repaints. `fn` is bound to\n// `context` if given. When `immediate` is set, `fn` is called immediately if\n// the browser doesn't have native support for\n// [`window.requestAnimationFrame`](https://developer.mozilla.org/docs/Web/API/window/requestAnimationFrame),\n// otherwise it's delayed. Returns a request ID that can be used to cancel the request.\nexport function requestAnimFrame(fn, context, immediate) {\n    if (immediate && requestFn === timeoutDefer) {\n        fn.call(context);\n    } else {\n        return requestFn.call(window, bind(fn, context));\n    }\n}\n\n// @function cancelAnimFrame(id: Number): undefined\n// Cancels a previous `requestAnimFrame`. See also [window.cancelAnimationFrame](https://developer.mozilla.org/docs/Web/API/window/cancelAnimationFrame).\nexport function cancelAnimFrame(id) {\n    if (id) {\n        cancelFn.call(window, id);\n    }\n}\n\nexport var loader = {\n    js: function(url) {\n        var handler = { _resolved: false };\n        handler.callbacks = [];\n        handler.error = [];\n        handler.then = function(cb) {\n            handler.callbacks.push(cb);\n            if ( handler._resolved ) { return handler.resolve(); }\n            return handler;\n        }\n        handler.catch = function(cb) {\n            handler.error.push(cb);\n            if ( handler._resolved ) { return handler.reject(); }\n            return handler;\n        }\n        handler.resolve = function(_argv) {\n            // var _argv;\n            handler._resolved = true;\n            while ( handler.callbacks.length ) {\n                var cb = handler.callbacks.shift();\n                var retval;\n                try {\n                    _argv = cb(_argv);\n                } catch(e) {\n                    console.log(e);\n                    handler.reject(e);\n                    break;\n                }\n            }\n            return handler;\n        }\n\n        handler.reject = function(e) {\n            while ( handler.error.length ) {\n                var cb = handler.error.shift();\n                cb(e);\n            }\n            console.log(e);\n            console.trace();\n            return handler;\n        }\n\n        if ( url == undefined ) {\n            handler._resolved = true;\n            return handler;\n        }\n\n        var element = document.createElement('script');\n\n        element.onload = function() {\n          handler.resolve(url);\n        };\n        element.onerror = function() {\n          handler.catch.apply(arguments);\n        };\n\n        element.async = true;\n        var parent = 'body';\n        var attr = 'src';\n        element[attr] = url;\n        document[parent].appendChild(element);\n\n        console.log(\"AHOY APPENDED\", url);\n\n        return handler;\n    }\n}","import * as Util from './Util';\r\n\r\n// @class Class\r\n// @aka L.Class\r\n\r\n// @section\r\n// @uninheritable\r\n\r\n// Thanks to John Resig and Dean Edwards for inspiration!\r\n\r\nexport function Class() {}\r\n\r\nClass.extend = function (props) {\r\n\r\n\t// @function extend(props: Object): Function\r\n\t// [Extends the current class](#class-inheritance) given the properties to be included.\r\n\t// Returns a Javascript function that is a class constructor (to be called with `new`).\r\n\tvar NewClass = function () {\r\n\r\n\t\t// call the constructor\r\n\t\tif (this.initialize) {\r\n\t\t\tthis.initialize.apply(this, arguments);\r\n\t\t}\r\n\r\n\t\t// call all constructor hooks\r\n\t\tthis.callInitHooks();\r\n\t};\r\n\r\n\tvar parentProto = NewClass.__super__ = this.prototype;\r\n\r\n\tvar proto = Util.create(parentProto);\r\n\tproto.constructor = NewClass;\r\n\r\n\tNewClass.prototype = proto;\r\n\r\n\t// inherit parent's statics\r\n\tfor (var i in this) {\r\n\t\tif (this.hasOwnProperty(i) && i !== 'prototype') {\r\n\t\t\tNewClass[i] = this[i];\r\n\t\t}\r\n\t}\r\n\r\n\t// mix static properties into the class\r\n\tif (props.statics) {\r\n\t\tUtil.extend(NewClass, props.statics);\r\n\t\tdelete props.statics;\r\n\t}\r\n\r\n\t// mix includes into the prototype\r\n\tif (props.includes) {\r\n\t\tcheckDeprecatedMixinEvents(props.includes);\r\n\t\tUtil.extend.apply(null, [proto].concat(props.includes));\r\n\t\tdelete props.includes;\r\n\t}\r\n\r\n\t// merge options\r\n\tif (proto.options) {\r\n\t\tprops.options = Util.extend(Util.create(proto.options), props.options);\r\n\t}\r\n\r\n\t// mix given properties into the prototype\r\n\tUtil.extend(proto, props);\r\n\t\r\n\tproto._initHooks = [];\r\n\r\n\t// add method for calling all hooks\r\n\tproto.callInitHooks = function () {\r\n\r\n\t\tif (this._initHooksCalled) { return; }\r\n\r\n\t\tif (parentProto.callInitHooks) {\r\n\t\t\tparentProto.callInitHooks.call(this);\r\n\t\t}\r\n\r\n\t\tthis._initHooksCalled = true;\r\n\r\n\t\tfor (var i = 0, len = proto._initHooks.length; i < len; i++) {\r\n\t\t\tproto._initHooks[i].call(this);\r\n\t\t}\r\n\t};\r\n\r\n\treturn NewClass;\r\n};\r\n\r\n\r\n// @function include(properties: Object): this\r\n// [Includes a mixin](#class-includes) into the current class.\r\nClass.include = function (props) {\r\n\tUtil.extend(this.prototype, props);\r\n\treturn this;\r\n};\r\n\r\n// @function mergeOptions(options: Object): this\r\n// [Merges `options`](#class-options) into the defaults of the class.\r\nClass.mergeOptions = function (options) {\r\n\tUtil.extend(this.prototype.options, options);\r\n\treturn this;\r\n};\r\n\r\n// @function addInitHook(fn: Function): this\r\n// Adds a [constructor hook](#class-constructor-hooks) to the class.\r\nClass.addInitHook = function (fn) { // (Function) || (String, args...)\r\n\tvar args = Array.prototype.slice.call(arguments, 1);\r\n\r\n\tvar init = typeof fn === 'function' ? fn : function () {\r\n\t\tthis[fn].apply(this, args);\r\n\t};\r\n\r\n\tthis.prototype._initHooks = this.prototype._initHooks || [];\r\n\tthis.prototype._initHooks.push(init);\r\n\treturn this;\r\n};\r\n\r\nfunction checkDeprecatedMixinEvents(includes) {\r\n\tif (!cozy || !cozy.Mixin) { return; }\r\n\r\n\tincludes = cozy.Util.isArray(includes) ? includes : [includes];\r\n\r\n\t// for (var i = 0; i < includes.length; i++) {\r\n\t// \tif (includes[i] === cozy.Mixin.Events) {\r\n\t// \t\tconsole.warn('Deprecated include of cozy.Mixin.Events: ' +\r\n\t// \t\t\t'this property will be removed in future releases, ' +\r\n\t// \t\t\t'please inherit from cozy.Evented instead.', new Error().stack);\r\n\t// \t}\r\n\t// }\r\n}\r\n","import {Class} from './Class';\r\nimport * as Util from './Util';\r\n\r\n/*\r\n * @class Evented\r\n * @aka L.Evented\r\n * @inherits Class\r\n *\r\n * A set of methods shared between event-powered classes (like `Map` and `Marker`). Generally, events allow you to execute some function when something happens with an object (e.g. the user clicks on the map, causing the map to fire `'click'` event).\r\n *\r\n * @example\r\n *\r\n * ```js\r\n * map.on('click', function(e) {\r\n * \talert(e.latlng);\r\n * } );\r\n * ```\r\n *\r\n * Leaflet deals with event listeners by reference, so if you want to add a listener and then remove it, define it as a function:\r\n *\r\n * ```js\r\n * function onClick(e) { ... }\r\n *\r\n * map.on('click', onClick);\r\n * map.off('click', onClick);\r\n * ```\r\n */\r\n\r\nexport var Evented = Class.extend({\r\n\r\n\t/* @method on(type: String, fn: Function, context?: Object): this\r\n\t * Adds a listener function (`fn`) to a particular event type of the object. You can optionally specify the context of the listener (object the this keyword will point to). You can also pass several space-separated types (e.g. `'click dblclick'`).\r\n\t *\r\n\t * @alternative\r\n\t * @method on(eventMap: Object): this\r\n\t * Adds a set of type/listener pairs, e.g. `{click: onClick, mousemove: onMouseMove}`\r\n\t */\r\n\ton: function (types, fn, context) {\r\n\r\n\t\t// types can be a map of types/handlers\r\n\t\tif (typeof types === 'object') {\r\n\t\t\tfor (var type in types) {\r\n\t\t\t\t// we don't process space-separated events here for performance;\r\n\t\t\t\t// it's a hot path since Layer uses the on(obj) syntax\r\n\t\t\t\tthis._on(type, types[type], fn);\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\t// types can be a string of space-separated words\r\n\t\t\ttypes = Util.splitWords(types);\r\n\r\n\t\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\t\tthis._on(types[i], fn, context);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t/* @method off(type: String, fn?: Function, context?: Object): this\r\n\t * Removes a previously added listener function. If no function is specified, it will remove all the listeners of that particular event from the object. Note that if you passed a custom context to `on`, you must pass the same context to `off` in order to remove the listener.\r\n\t *\r\n\t * @alternative\r\n\t * @method off(eventMap: Object): this\r\n\t * Removes a set of type/listener pairs.\r\n\t *\r\n\t * @alternative\r\n\t * @method off: this\r\n\t * Removes all listeners to all events on the object.\r\n\t */\r\n\toff: function (types, fn, context) {\r\n\r\n\t\tif (!types) {\r\n\t\t\t// clear all listeners if called without arguments\r\n\t\t\tdelete this._events;\r\n\r\n\t\t} else if (typeof types === 'object') {\r\n\t\t\tfor (var type in types) {\r\n\t\t\t\tthis._off(type, types[type], fn);\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\ttypes = Util.splitWords(types);\r\n\r\n\t\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\t\tthis._off(types[i], fn, context);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// attach listener (without syntactic sugar now)\r\n\t_on: function (type, fn, context) {\r\n\t\tthis._events = this._events || {};\r\n\r\n\t\t/* get/init listeners for type */\r\n\t\tvar typeListeners = this._events[type];\r\n\t\tif (!typeListeners) {\r\n\t\t\ttypeListeners = [];\r\n\t\t\tthis._events[type] = typeListeners;\r\n\t\t}\r\n\r\n\t\tif (context === this) {\r\n\t\t\t// Less memory footprint.\r\n\t\t\tcontext = undefined;\r\n\t\t}\r\n\t\tvar newListener = {fn: fn, ctx: context},\r\n\t\t    listeners = typeListeners;\r\n\r\n\t\t// check if fn already there\r\n\t\tfor (var i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\tif (listeners[i].fn === fn && listeners[i].ctx === context) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlisteners.push(newListener);\r\n\t},\r\n\r\n\t_off: function (type, fn, context) {\r\n\t\tvar listeners,\r\n\t\t    i,\r\n\t\t    len;\r\n\r\n\t\tif (!this._events) { return; }\r\n\r\n\t\tlisteners = this._events[type];\r\n\r\n\t\tif (!listeners) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!fn) {\r\n\t\t\t// Set all removed listeners to noop so they are not called if remove happens in fire\r\n\t\t\tfor (i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\t\tlisteners[i].fn = Util.falseFn;\r\n\t\t\t}\r\n\t\t\t// clear all listeners for a type if function isn't specified\r\n\t\t\tdelete this._events[type];\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (context === this) {\r\n\t\t\tcontext = undefined;\r\n\t\t}\r\n\r\n\t\tif (listeners) {\r\n\r\n\t\t\t// find fn and remove it\r\n\t\t\tfor (i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\t\tvar l = listeners[i];\r\n\t\t\t\tif (l.ctx !== context) { continue; }\r\n\t\t\t\tif (l.fn === fn) {\r\n\r\n\t\t\t\t\t// set the removed listener to noop so that's not called if remove happens in fire\r\n\t\t\t\t\tl.fn = Util.falseFn;\r\n\r\n\t\t\t\t\tif (this._firingCount) {\r\n\t\t\t\t\t\t/* copy array in case events are being fired */\r\n\t\t\t\t\t\tthis._events[type] = listeners = listeners.slice();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlisteners.splice(i, 1);\r\n\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t// @method fire(type: String, data?: Object, propagate?: Boolean): this\r\n\t// Fires an event of the specified type. You can optionally provide an data\r\n\t// object — the first argument of the listener function will contain its\r\n\t// properties. The event can optionally be propagated to event parents.\r\n\tfire: function (type, data, propagate) {\r\n\t\tif (!this.listens(type, propagate)) { return this; }\r\n\r\n\t\tvar event = Util.extend({}, data, {type: type, target: this});\r\n\r\n\t\tif (this._events) {\r\n\t\t\tvar listeners = this._events[type];\r\n\r\n\t\t\tif (listeners) {\r\n\t\t\t\tthis._firingCount = (this._firingCount + 1) || 1;\r\n\t\t\t\tfor (var i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\t\t\tvar l = listeners[i];\r\n\t\t\t\t\tl.fn.call(l.ctx || this, event);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._firingCount--;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (propagate) {\r\n\t\t\t// propagate the event to parents (set with addEventParent)\r\n\t\t\tthis._propagateEvent(event);\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method listens(type: String): Boolean\r\n\t// Returns `true` if a particular event type has any listeners attached to it.\r\n\tlistens: function (type, propagate) {\r\n\t\tvar listeners = this._events && this._events[type];\r\n\t\tif (listeners && listeners.length) { return true; }\r\n\r\n\t\tif (propagate) {\r\n\t\t\t// also check parents for listeners if event propagates\r\n\t\t\tfor (var id in this._eventParents) {\r\n\t\t\t\tif (this._eventParents[id].listens(type, propagate)) { return true; }\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\r\n\t// @method once(…): this\r\n\t// Behaves as [`on(…)`](#evented-on), except the listener will only get fired once and then removed.\r\n\tonce: function (types, fn, context) {\r\n\r\n\t\tif (typeof types === 'object') {\r\n\t\t\tfor (var type in types) {\r\n\t\t\t\tthis.once(type, types[type], fn);\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tvar handler = Util.bind(function () {\r\n\t\t\tthis\r\n\t\t\t    .off(types, fn, context)\r\n\t\t\t    .off(types, handler, context);\r\n\t\t}, this);\r\n\r\n\t\t// add a listener that's executed once and removed after that\r\n\t\treturn this\r\n\t\t    .on(types, fn, context)\r\n\t\t    .on(types, handler, context);\r\n\t},\r\n\r\n\t// @method addEventParent(obj: Evented): this\r\n\t// Adds an event parent - an `Evented` that will receive propagated events\r\n\taddEventParent: function (obj) {\r\n\t\tthis._eventParents = this._eventParents || {};\r\n\t\tthis._eventParents[Util.stamp(obj)] = obj;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method removeEventParent(obj: Evented): this\r\n\t// Removes an event parent, so it will stop receiving propagated events\r\n\tremoveEventParent: function (obj) {\r\n\t\tif (this._eventParents) {\r\n\t\t\tdelete this._eventParents[Util.stamp(obj)];\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\t_propagateEvent: function (e) {\r\n\t\tfor (var id in this._eventParents) {\r\n\t\t\tthis._eventParents[id].fire(e.type, Util.extend({layer: e.target}, e), true);\r\n\t\t}\r\n\t}\r\n});\r\n\r\nvar proto = Evented.prototype;\r\n\r\n// aliases; we should ditch those eventually\r\n\r\n// @method addEventListener(…): this\r\n// Alias to [`on(…)`](#evented-on)\r\nproto.addEventListener = proto.on;\r\n\r\n// @method removeEventListener(…): this\r\n// Alias to [`off(…)`](#evented-off)\r\n\r\n// @method clearAllEventListeners(…): this\r\n// Alias to [`off()`](#evented-off)\r\nproto.removeEventListener = proto.clearAllEventListeners = proto.off;\r\n\r\n// @method addOneTimeEventListener(…): this\r\n// Alias to [`once(…)`](#evented-once)\r\nproto.addOneTimeEventListener = proto.once;\r\n\r\n// @method fireEvent(…): this\r\n// Alias to [`fire(…)`](#evented-fire)\r\nproto.fireEvent = proto.fire;\r\n\r\n// @method hasEventListeners(…): Boolean\r\n// Alias to [`listens(…)`](#evented-listens)\r\nproto.hasEventListeners = proto.listens;\r\n","\n/*\n * @namespace Browser\n * @aka L.Browser\n *\n * A namespace with static properties for browser/feature detection used by Leaflet internally.\n *\n * @example\n *\n * ```js\n * if (L.Browser.ielt9) {\n *   alert('Upgrade your browser, dude!');\n * }\n * ```\n */\n\nvar style = document.documentElement.style;\n\n// @property ie: Boolean; `true` for all Internet Explorer versions (not Edge).\nexport var ie = 'ActiveXObject' in window;\n\n// @property ielt9: Boolean; `true` for Internet Explorer versions less than 9.\nexport var ielt9 = ie && !document.addEventListener;\n\n// @property edge: Boolean; `true` for the Edge web browser.\nexport var edge = 'msLaunchUri' in navigator && !('documentMode' in document);\n\n// @property webkit: Boolean;\n// `true` for webkit-based browsers like Chrome and Safari (including mobile versions).\nexport var webkit = userAgentContains('webkit');\n\n// @property android: Boolean\n// `true` for any browser running on an Android platform.\nexport var android = userAgentContains('android');\n\n// @property android23: Boolean; `true` for browsers running on Android 2 or Android 3.\nexport var android23 = userAgentContains('android 2') || userAgentContains('android 3');\n\n// @property opera: Boolean; `true` for the Opera browser\nexport var opera = !!window.opera;\n\n// @property chrome: Boolean; `true` for the Chrome browser.\nexport var chrome = userAgentContains('chrome');\n\n// @property gecko: Boolean; `true` for gecko-based browsers like Firefox.\nexport var gecko = userAgentContains('gecko') && !webkit && !opera && !ie;\n\n// @property safari: Boolean; `true` for the Safari browser.\nexport var safari = !chrome && userAgentContains('safari');\n\nexport var phantom = userAgentContains('phantom');\n\n// @property opera12: Boolean\n// `true` for the Opera browser supporting CSS transforms (version 12 or later).\nexport var opera12 = 'OTransition' in style;\n\n// @property win: Boolean; `true` when the browser is running in a Windows platform\nexport var win = navigator.platform.indexOf('Win') === 0;\n\n// @property ie3d: Boolean; `true` for all Internet Explorer versions supporting CSS transforms.\nexport var ie3d = ie && ('transition' in style);\n\n// @property webkit3d: Boolean; `true` for webkit-based browsers supporting CSS transforms.\nexport var webkit3d = ('WebKitCSSMatrix' in window) && ('m11' in new window.WebKitCSSMatrix()) && !android23;\n\n// @property gecko3d: Boolean; `true` for gecko-based browsers supporting CSS transforms.\nexport var gecko3d = 'MozPerspective' in style;\n\n// @property any3d: Boolean\n// `true` for all browsers supporting CSS transforms.\nexport var any3d = !window.L_DISABLE_3D && (ie3d || webkit3d || gecko3d) && !opera12 && !phantom;\n\n// @property mobile: Boolean; `true` for all browsers running in a mobile device.\nexport var mobile = typeof orientation !== 'undefined' || userAgentContains('mobile');\n\n// @property mobileWebkit: Boolean; `true` for all webkit-based browsers in a mobile device.\nexport var mobileWebkit = mobile && webkit;\n\n// @property mobileWebkit3d: Boolean\n// `true` for all webkit-based browsers in a mobile device supporting CSS transforms.\nexport var mobileWebkit3d = mobile && webkit3d;\n\n// @property msPointer: Boolean\n// `true` for browsers implementing the Microsoft touch events model (notably IE10).\nexport var msPointer = !window.PointerEvent && window.MSPointerEvent;\n\n// @property pointer: Boolean\n// `true` for all browsers supporting [pointer events](https://msdn.microsoft.com/en-us/library/dn433244%28v=vs.85%29.aspx).\nexport var pointer = !!(window.PointerEvent || msPointer);\n\n// @property touch: Boolean\n// `true` for all browsers supporting [touch events](https://developer.mozilla.org/docs/Web/API/Touch_events).\n// This does not necessarily mean that the browser is running in a computer with\n// a touchscreen, it only means that the browser is capable of understanding\n// touch events.\nexport var touch = !window.L_NO_TOUCH && (pointer || 'ontouchstart' in window ||\n        (window.DocumentTouch && document instanceof window.DocumentTouch));\n\n// @property mobileOpera: Boolean; `true` for the Opera browser in a mobile device.\nexport var mobileOpera = mobile && opera;\n\n// @property mobileGecko: Boolean\n// `true` for gecko-based browsers running in a mobile device.\nexport var mobileGecko = mobile && gecko;\n\n// @property retina: Boolean\n// `true` for browsers on a high-resolution \"retina\" screen.\nexport var retina = (window.devicePixelRatio || (window.screen.deviceXDPI / window.screen.logicalXDPI)) > 1;\n\n\n// @property canvas: Boolean\n// `true` when the browser supports [`<canvas>`](https://developer.mozilla.org/docs/Web/API/Canvas_API).\nexport var canvas = (function () {\n    return !!document.createElement('canvas').getContext;\n}());\n\n// @property svg: Boolean\n// `true` when the browser supports [SVG](https://developer.mozilla.org/docs/Web/SVG).\n// export var svg = !!(document.createElementNS && svgCreate('svg').createSVGRect);\nexport var svg = true;\n\n// @property vml: Boolean\n// `true` if the browser supports [VML](https://en.wikipedia.org/wiki/Vector_Markup_Language).\nexport var vml = !svg && (function () {\n    try {\n        var div = document.createElement('div');\n        div.innerHTML = '<v:shape adj=\"1\"/>';\n\n        var shape = div.firstChild;\n        shape.style.behavior = 'url(#default#VML)';\n\n        return shape && (typeof shape.adj === 'object');\n\n    } catch (e) {\n        return false;\n    }\n}());\n\nexport var columnCount = ( 'columnCount' in style );\nexport var classList = ( document.documentElement.classList !== undefined );\n\nfunction userAgentContains(str) {\n    return navigator.userAgent.toLowerCase().indexOf(str) >= 0;\n}\n","import {isArray, formatNum} from '../core/Util';\r\n\r\n/*\r\n * @class Point\r\n * @aka L.Point\r\n *\r\n * Represents a point with `x` and `y` coordinates in pixels.\r\n *\r\n * @example\r\n *\r\n * ```js\r\n * var point = L.point(200, 300);\r\n * ```\r\n *\r\n * All Leaflet methods and options that accept `Point` objects also accept them in a simple Array form (unless noted otherwise), so these lines are equivalent:\r\n *\r\n * ```js\r\n * map.panBy([200, 300]);\r\n * map.panBy(L.point(200, 300));\r\n * ```\r\n */\r\n\r\nexport function Point(x, y, round) {\r\n\t// @property x: Number; The `x` coordinate of the point\r\n\tthis.x = (round ? Math.round(x) : x);\r\n\t// @property y: Number; The `y` coordinate of the point\r\n\tthis.y = (round ? Math.round(y) : y);\r\n}\r\n\r\nPoint.prototype = {\r\n\r\n\t// @method clone(): Point\r\n\t// Returns a copy of the current point.\r\n\tclone: function () {\r\n\t\treturn new Point(this.x, this.y);\r\n\t},\r\n\r\n\t// @method add(otherPoint: Point): Point\r\n\t// Returns the result of addition of the current and the given points.\r\n\tadd: function (point) {\r\n\t\t// non-destructive, returns a new point\r\n\t\treturn this.clone()._add(toPoint(point));\r\n\t},\r\n\r\n\t_add: function (point) {\r\n\t\t// destructive, used directly for performance in situations where it's safe to modify existing point\r\n\t\tthis.x += point.x;\r\n\t\tthis.y += point.y;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method subtract(otherPoint: Point): Point\r\n\t// Returns the result of subtraction of the given point from the current.\r\n\tsubtract: function (point) {\r\n\t\treturn this.clone()._subtract(toPoint(point));\r\n\t},\r\n\r\n\t_subtract: function (point) {\r\n\t\tthis.x -= point.x;\r\n\t\tthis.y -= point.y;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method divideBy(num: Number): Point\r\n\t// Returns the result of division of the current point by the given number.\r\n\tdivideBy: function (num) {\r\n\t\treturn this.clone()._divideBy(num);\r\n\t},\r\n\r\n\t_divideBy: function (num) {\r\n\t\tthis.x /= num;\r\n\t\tthis.y /= num;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method multiplyBy(num: Number): Point\r\n\t// Returns the result of multiplication of the current point by the given number.\r\n\tmultiplyBy: function (num) {\r\n\t\treturn this.clone()._multiplyBy(num);\r\n\t},\r\n\r\n\t_multiplyBy: function (num) {\r\n\t\tthis.x *= num;\r\n\t\tthis.y *= num;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method scaleBy(scale: Point): Point\r\n\t// Multiply each coordinate of the current point by each coordinate of\r\n\t// `scale`. In linear algebra terms, multiply the point by the\r\n\t// [scaling matrix](https://en.wikipedia.org/wiki/Scaling_%28geometry%29#Matrix_representation)\r\n\t// defined by `scale`.\r\n\tscaleBy: function (point) {\r\n\t\treturn new Point(this.x * point.x, this.y * point.y);\r\n\t},\r\n\r\n\t// @method unscaleBy(scale: Point): Point\r\n\t// Inverse of `scaleBy`. Divide each coordinate of the current point by\r\n\t// each coordinate of `scale`.\r\n\tunscaleBy: function (point) {\r\n\t\treturn new Point(this.x / point.x, this.y / point.y);\r\n\t},\r\n\r\n\t// @method round(): Point\r\n\t// Returns a copy of the current point with rounded coordinates.\r\n\tround: function () {\r\n\t\treturn this.clone()._round();\r\n\t},\r\n\r\n\t_round: function () {\r\n\t\tthis.x = Math.round(this.x);\r\n\t\tthis.y = Math.round(this.y);\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method floor(): Point\r\n\t// Returns a copy of the current point with floored coordinates (rounded down).\r\n\tfloor: function () {\r\n\t\treturn this.clone()._floor();\r\n\t},\r\n\r\n\t_floor: function () {\r\n\t\tthis.x = Math.floor(this.x);\r\n\t\tthis.y = Math.floor(this.y);\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method ceil(): Point\r\n\t// Returns a copy of the current point with ceiled coordinates (rounded up).\r\n\tceil: function () {\r\n\t\treturn this.clone()._ceil();\r\n\t},\r\n\r\n\t_ceil: function () {\r\n\t\tthis.x = Math.ceil(this.x);\r\n\t\tthis.y = Math.ceil(this.y);\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method distanceTo(otherPoint: Point): Number\r\n\t// Returns the cartesian distance between the current and the given points.\r\n\tdistanceTo: function (point) {\r\n\t\tpoint = toPoint(point);\r\n\r\n\t\tvar x = point.x - this.x,\r\n\t\t    y = point.y - this.y;\r\n\r\n\t\treturn Math.sqrt(x * x + y * y);\r\n\t},\r\n\r\n\t// @method equals(otherPoint: Point): Boolean\r\n\t// Returns `true` if the given point has the same coordinates.\r\n\tequals: function (point) {\r\n\t\tpoint = toPoint(point);\r\n\r\n\t\treturn point.x === this.x &&\r\n\t\t       point.y === this.y;\r\n\t},\r\n\r\n\t// @method contains(otherPoint: Point): Boolean\r\n\t// Returns `true` if both coordinates of the given point are less than the corresponding current point coordinates (in absolute values).\r\n\tcontains: function (point) {\r\n\t\tpoint = toPoint(point);\r\n\r\n\t\treturn Math.abs(point.x) <= Math.abs(this.x) &&\r\n\t\t       Math.abs(point.y) <= Math.abs(this.y);\r\n\t},\r\n\r\n\t// @method toString(): String\r\n\t// Returns a string representation of the point for debugging purposes.\r\n\ttoString: function () {\r\n\t\treturn 'Point(' +\r\n\t\t        formatNum(this.x) + ', ' +\r\n\t\t        formatNum(this.y) + ')';\r\n\t}\r\n};\r\n\r\n// @factory L.point(x: Number, y: Number, round?: Boolean)\r\n// Creates a Point object with the given `x` and `y` coordinates. If optional `round` is set to true, rounds the `x` and `y` values.\r\n\r\n// @alternative\r\n// @factory L.point(coords: Number[])\r\n// Expects an array of the form `[x, y]` instead.\r\n\r\n// @alternative\r\n// @factory L.point(coords: Object)\r\n// Expects a plain object of the form `{x: Number, y: Number}` instead.\r\nexport function toPoint(x, y, round) {\r\n\tif (x instanceof Point) {\r\n\t\treturn x;\r\n\t}\r\n\tif (isArray(x)) {\r\n\t\treturn new Point(x[0], x[1]);\r\n\t}\r\n\tif (x === undefined || x === null) {\r\n\t\treturn x;\r\n\t}\r\n\tif (typeof x === 'object' && 'x' in x && 'y' in x) {\r\n\t\treturn new Point(x.x, x.y);\r\n\t}\r\n\treturn new Point(x, y, round);\r\n}\r\n","import * as DomEvent from './DomEvent';\nimport * as Util from '../core/Util';\nimport * as Browser from '../core/Browser';\n\n/*\n * Extends L.DomEvent to provide touch support for Internet Explorer and Windows-based devices.\n */\n\n\nvar POINTER_DOWN =   Browser.msPointer ? 'MSPointerDown'   : 'pointerdown',\n    POINTER_MOVE =   Browser.msPointer ? 'MSPointerMove'   : 'pointermove',\n    POINTER_UP =     Browser.msPointer ? 'MSPointerUp'     : 'pointerup',\n    POINTER_CANCEL = Browser.msPointer ? 'MSPointerCancel' : 'pointercancel',\n    TAG_WHITE_LIST = ['INPUT', 'SELECT', 'OPTION'],\n\n    _pointers = {},\n    _pointerDocListener = false;\n\n// DomEvent.DoubleTap needs to know about this\nexport var _pointersCount = 0;\n\n// Provides a touch events wrapper for (ms)pointer events.\n// ref http://www.w3.org/TR/pointerevents/ https://www.w3.org/Bugs/Public/show_bug.cgi?id=22890\n\nexport function addPointerListener(obj, type, handler, id) {\n\tif (type === 'touchstart') {\n\t\t_addPointerStart(obj, handler, id);\n\n\t} else if (type === 'touchmove') {\n\t\t_addPointerMove(obj, handler, id);\n\n\t} else if (type === 'touchend') {\n\t\t_addPointerEnd(obj, handler, id);\n\t}\n\n\treturn this;\n}\n\nexport function removePointerListener(obj, type, id) {\n\tvar handler = obj['_leaflet_' + type + id];\n\n\tif (type === 'touchstart') {\n\t\tobj.removeEventListener(POINTER_DOWN, handler, false);\n\n\t} else if (type === 'touchmove') {\n\t\tobj.removeEventListener(POINTER_MOVE, handler, false);\n\n\t} else if (type === 'touchend') {\n\t\tobj.removeEventListener(POINTER_UP, handler, false);\n\t\tobj.removeEventListener(POINTER_CANCEL, handler, false);\n\t}\n\n\treturn this;\n}\n\nfunction _addPointerStart(obj, handler, id) {\n\tvar onDown = Util.bind(function (e) {\n\t\tif (e.pointerType !== 'mouse' && e.pointerType !== e.MSPOINTER_TYPE_MOUSE && e.pointerType !== e.MSPOINTER_TYPE_MOUSE) {\n\t\t\t// In IE11, some touch events needs to fire for form controls, or\n\t\t\t// the controls will stop working. We keep a whitelist of tag names that\n\t\t\t// need these events. For other target tags, we prevent default on the event.\n\t\t\tif (TAG_WHITE_LIST.indexOf(e.target.tagName) < 0) {\n\t\t\t\tDomEvent.preventDefault(e);\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t_handlePointer(e, handler);\n\t});\n\n\tobj['_leaflet_touchstart' + id] = onDown;\n\tobj.addEventListener(POINTER_DOWN, onDown, false);\n\n\t// need to keep track of what pointers and how many are active to provide e.touches emulation\n\tif (!_pointerDocListener) {\n\t\t// we listen documentElement as any drags that end by moving the touch off the screen get fired there\n\t\tdocument.documentElement.addEventListener(POINTER_DOWN, _globalPointerDown, true);\n\t\tdocument.documentElement.addEventListener(POINTER_MOVE, _globalPointerMove, true);\n\t\tdocument.documentElement.addEventListener(POINTER_UP, _globalPointerUp, true);\n\t\tdocument.documentElement.addEventListener(POINTER_CANCEL, _globalPointerUp, true);\n\n\t\t_pointerDocListener = true;\n\t}\n}\n\nfunction _globalPointerDown(e) {\n\t_pointers[e.pointerId] = e;\n\t_pointersCount++;\n}\n\nfunction _globalPointerMove(e) {\n\tif (_pointers[e.pointerId]) {\n\t\t_pointers[e.pointerId] = e;\n\t}\n}\n\nfunction _globalPointerUp(e) {\n\tdelete _pointers[e.pointerId];\n\t_pointersCount--;\n}\n\nfunction _handlePointer(e, handler) {\n\te.touches = [];\n\tfor (var i in _pointers) {\n\t\te.touches.push(_pointers[i]);\n\t}\n\te.changedTouches = [e];\n\n\thandler(e);\n}\n\nfunction _addPointerMove(obj, handler, id) {\n\tvar onMove = function (e) {\n\t\t// don't fire touch moves when mouse isn't down\n\t\tif ((e.pointerType === e.MSPOINTER_TYPE_MOUSE || e.pointerType === 'mouse') && e.buttons === 0) { return; }\n\n\t\t_handlePointer(e, handler);\n\t};\n\n\tobj['_leaflet_touchmove' + id] = onMove;\n\tobj.addEventListener(POINTER_MOVE, onMove, false);\n}\n\nfunction _addPointerEnd(obj, handler, id) {\n\tvar onUp = function (e) {\n\t\t_handlePointer(e, handler);\n\t};\n\n\tobj['_leaflet_touchend' + id] = onUp;\n\tobj.addEventListener(POINTER_UP, onUp, false);\n\tobj.addEventListener(POINTER_CANCEL, onUp, false);\n}\n\n","import * as Browser from '../core/Browser';\r\nimport {_pointersCount} from './DomEvent.Pointer';\r\n\r\n/*\r\n * Extends the event handling code with double tap support for mobile browsers.\r\n */\r\n\r\nvar _touchstart = Browser.msPointer ? 'MSPointerDown' : Browser.pointer ? 'pointerdown' : 'touchstart',\r\n    _touchend = Browser.msPointer ? 'MSPointerUp' : Browser.pointer ? 'pointerup' : 'touchend',\r\n    _pre = '_leaflet_';\r\n\r\n// inspired by Zepto touch code by Thomas Fuchs\r\nexport function addDoubleTapListener(obj, handler, id) {\r\n\tvar last, touch,\r\n\t    doubleTap = false,\r\n\t    delay = 250;\r\n\r\n\tfunction onTouchStart(e) {\r\n\t\tvar count;\r\n\r\n\t\tif (Browser.pointer) {\r\n\t\t\tif ((!Browser.edge) || e.pointerType === 'mouse') { return; }\r\n\t\t\tcount = _pointersCount;\r\n\t\t} else {\r\n\t\t\tcount = e.touches.length;\r\n\t\t}\r\n\r\n\t\tif (count > 1) { return; }\r\n\r\n\t\tvar now = Date.now(),\r\n\t\t    delta = now - (last || now);\r\n\r\n\t\ttouch = e.touches ? e.touches[0] : e;\r\n\t\tdoubleTap = (delta > 0 && delta <= delay);\r\n\t\tlast = now;\r\n\t}\r\n\r\n\tfunction onTouchEnd(e) {\r\n\t\tif (doubleTap && !touch.cancelBubble) {\r\n\t\t\tif (Browser.pointer) {\r\n\t\t\t\tif ((!Browser.edge) || e.pointerType === 'mouse') { return; }\r\n\t\t\t\t// work around .type being readonly with MSPointer* events\r\n\t\t\t\tvar newTouch = {},\r\n\t\t\t\t    prop, i;\r\n\r\n\t\t\t\tfor (i in touch) {\r\n\t\t\t\t\tprop = touch[i];\r\n\t\t\t\t\tnewTouch[i] = prop && prop.bind ? prop.bind(touch) : prop;\r\n\t\t\t\t}\r\n\t\t\t\ttouch = newTouch;\r\n\t\t\t}\r\n\t\t\ttouch.type = 'dblclick';\r\n\t\t\thandler(touch);\r\n\t\t\tlast = null;\r\n\t\t}\r\n\t}\r\n\r\n\tobj[_pre + _touchstart + id] = onTouchStart;\r\n\tobj[_pre + _touchend + id] = onTouchEnd;\r\n\tobj[_pre + 'dblclick' + id] = handler;\r\n\r\n\tobj.addEventListener(_touchstart, onTouchStart, false);\r\n\tobj.addEventListener(_touchend, onTouchEnd, false);\r\n\r\n\t// On some platforms (notably, chrome<55 on win10 + touchscreen + mouse),\r\n\t// the browser doesn't fire touchend/pointerup events but does fire\r\n\t// native dblclicks. See #4127.\r\n\t// Edge 14 also fires native dblclicks, but only for pointerType mouse, see #5180.\r\n\tobj.addEventListener('dblclick', handler, false);\r\n\r\n\treturn this;\r\n}\r\n\r\nexport function removeDoubleTapListener(obj, id) {\r\n\tvar touchstart = obj[_pre + _touchstart + id],\r\n\t    touchend = obj[_pre + _touchend + id],\r\n\t    dblclick = obj[_pre + 'dblclick' + id];\r\n\r\n\tobj.removeEventListener(_touchstart, touchstart, false);\r\n\tobj.removeEventListener(_touchend, touchend, false);\r\n\tif (!Browser.edge) {\r\n\t\tobj.removeEventListener('dblclick', dblclick, false);\r\n\t}\r\n\r\n\treturn this;\r\n}\r\n","import {Point} from '../geometry/Point';\r\nimport * as Util from '../core/Util';\r\nimport * as Browser from '../core/Browser';\r\nimport {addPointerListener, removePointerListener} from './DomEvent.Pointer';\r\nimport {addDoubleTapListener, removeDoubleTapListener} from './DomEvent.DoubleTap';\r\n\r\n/*\r\n * @namespace DomEvent\r\n * Utility functions to work with the [DOM events](https://developer.mozilla.org/docs/Web/API/Event), used by Leaflet internally.\r\n */\r\n\r\n// Inspired by John Resig, Dean Edwards and YUI addEvent implementations.\r\n\r\n// @function on(el: HTMLElement, types: String, fn: Function, context?: Object): this\r\n// Adds a listener function (`fn`) to a particular DOM event type of the\r\n// element `el`. You can optionally specify the context of the listener\r\n// (object the `this` keyword will point to). You can also pass several\r\n// space-separated types (e.g. `'click dblclick'`).\r\n\r\n// @alternative\r\n// @function on(el: HTMLElement, eventMap: Object, context?: Object): this\r\n// Adds a set of type/listener pairs, e.g. `{click: onClick, mousemove: onMouseMove}`\r\nexport function on(obj, types, fn, context) {\r\n\r\n\tif (typeof types === 'object') {\r\n\t\tfor (var type in types) {\r\n\t\t\taddOne(obj, type, types[type], fn);\r\n\t\t}\r\n\t} else {\r\n\t\ttypes = Util.splitWords(types);\r\n\r\n\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\taddOne(obj, types[i], fn, context);\r\n\t\t}\r\n\t}\r\n\r\n\treturn this;\r\n}\r\n\r\nvar eventsKey = '_leaflet_events';\r\n\r\n// @function off(el: HTMLElement, types: String, fn: Function, context?: Object): this\r\n// Removes a previously added listener function. If no function is specified,\r\n// it will remove all the listeners of that particular DOM event from the element.\r\n// Note that if you passed a custom context to on, you must pass the same\r\n// context to `off` in order to remove the listener.\r\n\r\n// @alternative\r\n// @function off(el: HTMLElement, eventMap: Object, context?: Object): this\r\n// Removes a set of type/listener pairs, e.g. `{click: onClick, mousemove: onMouseMove}`\r\n\r\n// @alternative\r\n// @function off(el: HTMLElement): this\r\n// Removes all known event listeners\r\nexport function off(obj, types, fn, context) {\r\n\r\n\tif (typeof types === 'object') {\r\n\t\tfor (var type in types) {\r\n\t\t\tremoveOne(obj, type, types[type], fn);\r\n\t\t}\r\n\t} else if (types) {\r\n\t\ttypes = Util.splitWords(types);\r\n\r\n\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\tremoveOne(obj, types[i], fn, context);\r\n\t\t}\r\n\t} else {\r\n\t\tfor (var j in obj[eventsKey]) {\r\n\t\t\tremoveOne(obj, j, obj[eventsKey][j]);\r\n\t\t}\r\n\t\tdelete obj[eventsKey];\r\n\t}\r\n}\r\n\r\nfunction addOne(obj, type, fn, context) {\r\n\tvar id = type + Util.stamp(fn) + (context ? '_' + Util.stamp(context) : '');\r\n\r\n\tif (obj[eventsKey] && obj[eventsKey][id]) { return this; }\r\n\r\n\tvar handler = function (e) {\r\n\t\treturn fn.call(context || obj, e || window.event);\r\n\t};\r\n\r\n\tvar originalHandler = handler;\r\n\r\n\tif (Browser.pointer && type.indexOf('touch') === 0) {\r\n\t\t// Needs DomEvent.Pointer.js\r\n\t\taddPointerListener(obj, type, handler, id);\r\n\r\n\t} else if (Browser.touch && (type === 'dblclick') && addDoubleTapListener &&\r\n\t           !(Browser.pointer && Browser.chrome)) {\r\n\t\t// Chrome >55 does not need the synthetic dblclicks from addDoubleTapListener\r\n\t\t// See #5180\r\n\t\taddDoubleTapListener(obj, handler, id);\r\n\r\n\t} else if ('addEventListener' in obj) {\r\n\r\n\t\tif (type === 'mousewheel') {\r\n\t\t\tobj.addEventListener('onwheel' in obj ? 'wheel' : 'mousewheel', handler, false);\r\n\r\n\t\t} else if ((type === 'mouseenter') || (type === 'mouseleave')) {\r\n\t\t\thandler = function (e) {\r\n\t\t\t\te = e || window.event;\r\n\t\t\t\tif (isExternalTarget(obj, e)) {\r\n\t\t\t\t\toriginalHandler(e);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tobj.addEventListener(type === 'mouseenter' ? 'mouseover' : 'mouseout', handler, false);\r\n\r\n\t\t} else {\r\n\t\t\tif (type === 'click' && Browser.android) {\r\n\t\t\t\thandler = function (e) {\r\n\t\t\t\t\tfilterClick(e, originalHandler);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tobj.addEventListener(type, handler, false);\r\n\t\t}\r\n\r\n\t} else if ('attachEvent' in obj) {\r\n\t\tobj.attachEvent('on' + type, handler);\r\n\t}\r\n\r\n\tobj[eventsKey] = obj[eventsKey] || {};\r\n\tobj[eventsKey][id] = handler;\r\n}\r\n\r\nfunction removeOne(obj, type, fn, context) {\r\n\r\n\tvar id = type + Util.stamp(fn) + (context ? '_' + Util.stamp(context) : ''),\r\n\t    handler = obj[eventsKey] && obj[eventsKey][id];\r\n\r\n\tif (!handler) { return this; }\r\n\r\n\tif (Browser.pointer && type.indexOf('touch') === 0) {\r\n\t\tremovePointerListener(obj, type, id);\r\n\r\n\t} else if (Browser.touch && (type === 'dblclick') && removeDoubleTapListener) {\r\n\t\tremoveDoubleTapListener(obj, id);\r\n\r\n\t} else if ('removeEventListener' in obj) {\r\n\r\n\t\tif (type === 'mousewheel') {\r\n\t\t\tobj.removeEventListener('onwheel' in obj ? 'wheel' : 'mousewheel', handler, false);\r\n\r\n\t\t} else {\r\n\t\t\tobj.removeEventListener(\r\n\t\t\t\ttype === 'mouseenter' ? 'mouseover' :\r\n\t\t\t\ttype === 'mouseleave' ? 'mouseout' : type, handler, false);\r\n\t\t}\r\n\r\n\t} else if ('detachEvent' in obj) {\r\n\t\tobj.detachEvent('on' + type, handler);\r\n\t}\r\n\r\n\tobj[eventsKey][id] = null;\r\n}\r\n\r\n// @function stopPropagation(ev: DOMEvent): this\r\n// Stop the given event from propagation to parent elements. Used inside the listener functions:\r\n// ```js\r\n// L.DomEvent.on(div, 'click', function (ev) {\r\n// \tL.DomEvent.stopPropagation(ev);\r\n// });\r\n// ```\r\nexport function stopPropagation(e) {\r\n\r\n\tif (e.stopPropagation) {\r\n\t\te.stopPropagation();\r\n\t} else if (e.originalEvent) {  // In case of Leaflet event.\r\n\t\te.originalEvent._stopped = true;\r\n\t} else {\r\n\t\te.cancelBubble = true;\r\n\t}\r\n\tskipped(e);\r\n\r\n\treturn this;\r\n}\r\n\r\n// @function disableScrollPropagation(el: HTMLElement): this\r\n// Adds `stopPropagation` to the element's `'mousewheel'` events (plus browser variants).\r\nexport function disableScrollPropagation(el) {\r\n\treturn addOne(el, 'mousewheel', stopPropagation);\r\n}\r\n\r\n// @function disableClickPropagation(el: HTMLElement): this\r\n// Adds `stopPropagation` to the element's `'click'`, `'doubleclick'`,\r\n// `'mousedown'` and `'touchstart'` events (plus browser variants).\r\nexport function disableClickPropagation(el) {\r\n\ton(el, 'mousedown touchstart dblclick', stopPropagation);\r\n\taddOne(el, 'click', fakeStop);\r\n\treturn this;\r\n}\r\n\r\n// @function preventDefault(ev: DOMEvent): this\r\n// Prevents the default action of the DOM Event `ev` from happening (such as\r\n// following a link in the href of the a element, or doing a POST request\r\n// with page reload when a `<form>` is submitted).\r\n// Use it inside listener functions.\r\nexport function preventDefault(e) {\r\n\tif (e.preventDefault) {\r\n\t\te.preventDefault();\r\n\t} else {\r\n\t\te.returnValue = false;\r\n\t}\r\n\treturn this;\r\n}\r\n\r\n// @function stop(ev): this\r\n// Does `stopPropagation` and `preventDefault` at the same time.\r\nexport function stop(e) {\r\n\tpreventDefault(e);\r\n\tstopPropagation(e);\r\n\treturn this;\r\n}\r\n\r\n// @function getMousePosition(ev: DOMEvent, container?: HTMLElement): Point\r\n// Gets normalized mouse position from a DOM event relative to the\r\n// `container` or to the whole page if not specified.\r\nexport function getMousePosition(e, container) {\r\n\tif (!container) {\r\n\t\treturn new Point(e.clientX, e.clientY);\r\n\t}\r\n\r\n\tvar rect = container.getBoundingClientRect();\r\n\r\n\treturn new Point(\r\n\t\te.clientX - rect.left - container.clientLeft,\r\n\t\te.clientY - rect.top - container.clientTop);\r\n}\r\n\r\n// Chrome on Win scrolls double the pixels as in other platforms (see #4538),\r\n// and Firefox scrolls device pixels, not CSS pixels\r\nvar wheelPxFactor =\r\n\t(Browser.win && Browser.chrome) ? 2 :\r\n\tBrowser.gecko ? window.devicePixelRatio : 1;\r\n\r\n// @function getWheelDelta(ev: DOMEvent): Number\r\n// Gets normalized wheel delta from a mousewheel DOM event, in vertical\r\n// pixels scrolled (negative if scrolling down).\r\n// Events from pointing devices without precise scrolling are mapped to\r\n// a best guess of 60 pixels.\r\nexport function getWheelDelta(e) {\r\n\treturn (Browser.edge) ? e.wheelDeltaY / 2 : // Don't trust window-geometry-based delta\r\n\t       (e.deltaY && e.deltaMode === 0) ? -e.deltaY / wheelPxFactor : // Pixels\r\n\t       (e.deltaY && e.deltaMode === 1) ? -e.deltaY * 20 : // Lines\r\n\t       (e.deltaY && e.deltaMode === 2) ? -e.deltaY * 60 : // Pages\r\n\t       (e.deltaX || e.deltaZ) ? 0 :\t// Skip horizontal/depth wheel events\r\n\t       e.wheelDelta ? (e.wheelDeltaY || e.wheelDelta) / 2 : // Legacy IE pixels\r\n\t       (e.detail && Math.abs(e.detail) < 32765) ? -e.detail * 20 : // Legacy Moz lines\r\n\t       e.detail ? e.detail / -32765 * 60 : // Legacy Moz pages\r\n\t       0;\r\n}\r\n\r\nvar skipEvents = {};\r\n\r\nexport function fakeStop(e) {\r\n\t// fakes stopPropagation by setting a special event flag, checked/reset with skipped(e)\r\n\tskipEvents[e.type] = true;\r\n}\r\n\r\nexport function skipped(e) {\r\n\tvar events = skipEvents[e.type];\r\n\t// reset when checking, as it's only used in map container and propagates outside of the map\r\n\tskipEvents[e.type] = false;\r\n\treturn events;\r\n}\r\n\r\n// check if element really left/entered the event target (for mouseenter/mouseleave)\r\nexport function isExternalTarget(el, e) {\r\n\r\n\tvar related = e.relatedTarget;\r\n\r\n\tif (!related) { return true; }\r\n\r\n\ttry {\r\n\t\twhile (related && (related !== el)) {\r\n\t\t\trelated = related.parentNode;\r\n\t\t}\r\n\t} catch (err) {\r\n\t\treturn false;\r\n\t}\r\n\treturn (related !== el);\r\n}\r\n\r\nvar lastClick;\r\n\r\n// this is a horrible workaround for a bug in Android where a single touch triggers two click events\r\nfunction filterClick(e, handler) {\r\n\tvar timeStamp = (e.timeStamp || (e.originalEvent && e.originalEvent.timeStamp)),\r\n\t    elapsed = lastClick && (timeStamp - lastClick);\r\n\r\n\t// are they closer together than 500ms yet more than 100ms?\r\n\t// Android typically triggers them ~300ms apart while multiple listeners\r\n\t// on the same event should be triggered far faster;\r\n\t// or check if click is simulated on the element, and if it is, reject any non-simulated events\r\n\r\n\tif ((elapsed && elapsed > 100 && elapsed < 500) || (e.target._simulatedClick && !e._simulated)) {\r\n\t\tstop(e);\r\n\t\treturn;\r\n\t}\r\n\tlastClick = timeStamp;\r\n\r\n\thandler(e);\r\n}\r\n\r\n// @function addListener(…): this\r\n// Alias to [`L.DomEvent.on`](#domevent-on)\r\nexport {on as addListener};\r\n\r\n// @function removeListener(…): this\r\n// Alias to [`L.DomEvent.off`](#domevent-off)\r\nexport {off as removeListener};\r\n","import * as DomEvent from './DomEvent';\nimport * as Util from '../core/Util';\nimport {Point} from '../geometry/Point';\nimport * as Browser from '../core/Browser';\n\n/*\n * @namespace DomUtil\n *\n * Utility functions to work with the [DOM](https://developer.mozilla.org/docs/Web/API/Document_Object_Model)\n * tree, used by Leaflet internally.\n *\n * Most functions expecting or returning a `HTMLElement` also work for\n * SVG elements. The only difference is that classes refer to CSS classes\n * in HTML and SVG classes in SVG.\n */\n\n if (!Element.prototype.matches) {\n    var ep = Element.prototype;\n \n    if (ep.webkitMatchesSelector) // Chrome <34, SF<7.1, iOS<8\n      ep.matches = ep.webkitMatchesSelector;\n \n    if (ep.msMatchesSelector) // IE9/10/11 & Edge\n      ep.matches = ep.msMatchesSelector;\n \n    if (ep.mozMatchesSelector) // FF<34\n      ep.matches = ep.mozMatchesSelector;\n }\n\n// @property TRANSFORM: String\n// Vendor-prefixed fransform style name (e.g. `'webkitTransform'` for WebKit).\nexport var TRANSFORM = testProp(\n    ['transform', 'WebkitTransform', 'OTransform', 'MozTransform', 'msTransform']);\n\n// webkitTransition comes first because some browser versions that drop vendor prefix don't do\n// the same for the transitionend event, in particular the Android 4.1 stock browser\n\n// @property TRANSITION: String\n// Vendor-prefixed transform style name.\nexport var TRANSITION = testProp(\n    ['webkitTransition', 'transition', 'OTransition', 'MozTransition', 'msTransition']);\n\nexport var TRANSITION_END =\n    TRANSITION === 'webkitTransition' || TRANSITION === 'OTransition' ? TRANSITION + 'End' : 'transitionend';\n\n\n// @function get(id: String|HTMLElement): HTMLElement\n// Returns an element given its DOM id, or returns the element itself\n// if it was passed directly.\nexport function get(id) {\n    return typeof id === 'string' ? document.getElementById(id) : id;\n}\n\n// @function getStyle(el: HTMLElement, styleAttrib: String): String\n// Returns the value for a certain style attribute on an element,\n// including computed values or values set through CSS.\nexport function getStyle(el, style) {\n    var value = el.style[style] || (el.currentStyle && el.currentStyle[style]);\n\n    if ((!value || value === 'auto') && document.defaultView) {\n        var css = document.defaultView.getComputedStyle(el, null);\n        value = css ? css[style] : null;\n    }\n    return value === 'auto' ? null : value;\n}\n\n// @function create(tagName: String, className?: String, container?: HTMLElement): HTMLElement\n// Creates an HTML element with `tagName`, sets its class to `className`, and optionally appends it to `container` element.\nexport function create(tagName, className, container) {\n    var el = document.createElement(tagName);\n    el.className = className || '';\n\n    if (container) {\n        container.appendChild(el);\n    }\n    return el;\n}\n\n// @function remove(el: HTMLElement)\n// Removes `el` from its parent element\nexport function remove(el) {\n    var parent = el.parentNode;\n    if (parent) {\n        parent.removeChild(el);\n    }\n}\n\n// @function empty(el: HTMLElement)\n// Removes all of `el`'s children elements from `el`\nexport function empty(el) {\n    while (el.firstChild) {\n        el.removeChild(el.firstChild);\n    }\n}\n\n// @function toFront(el: HTMLElement)\n// Makes `el` the last child of its parent, so it renders in front of the other children.\nexport function toFront(el) {\n    el.parentNode.appendChild(el);\n}\n\n// @function toBack(el: HTMLElement)\n// Makes `el` the first child of its parent, so it renders behind the other children.\nexport function toBack(el) {\n    var parent = el.parentNode;\n    parent.insertBefore(el, parent.firstChild);\n}\n\n// @function hasClass(el: HTMLElement, name: String): Boolean\n// Returns `true` if the element's class attribute contains `name`.\nexport function hasClass(el, name) {\n    if (el.classList !== undefined) {\n        return el.classList.contains(name);\n    }\n    var className = getClass(el);\n    return className.length > 0 && new RegExp('(^|\\\\s)' + name + '(\\\\s|$)').test(className);\n}\n\n// @function addClass(el: HTMLElement, name: String)\n// Adds `name` to the element's class attribute.\nexport function addClass(el, name) {\n    if (el.classList !== undefined) {\n        var classes = Util.splitWords(name);\n        for (var i = 0, len = classes.length; i < len; i++) {\n            el.classList.add(classes[i]);\n        }\n    } else if (!hasClass(el, name)) {\n        var className = getClass(el);\n        setClass(el, (className ? className + ' ' : '') + name);\n    }\n}\n\n// @function removeClass(el: HTMLElement, name: String)\n// Removes `name` from the element's class attribute.\nexport function removeClass(el, name) {\n    if (el.classList !== undefined) {\n        el.classList.remove(name);\n    } else {\n        setClass(el, Util.trim((' ' + getClass(el) + ' ').replace(' ' + name + ' ', ' ')));\n    }\n}\n\n// @function setClass(el: HTMLElement, name: String)\n// Sets the element's class.\nexport function setClass(el, name) {\n    if (el.className.baseVal === undefined) {\n        el.className = name;\n    } else {\n        // in case of SVG element\n        el.className.baseVal = name;\n    }\n}\n\n// @function getClass(el: HTMLElement): String\n// Returns the element's class.\nexport function getClass(el) {\n    return el.className.baseVal === undefined ? el.className : el.className.baseVal;\n}\n\n// @function setOpacity(el: HTMLElement, opacity: Number)\n// Set the opacity of an element (including old IE support).\n// `opacity` must be a number from `0` to `1`.\nexport function setOpacity(el, value) {\n    if ('opacity' in el.style) {\n        el.style.opacity = value;\n    } else if ('filter' in el.style) {\n        _setOpacityIE(el, value);\n    }\n}\n\nfunction _setOpacityIE(el, value) {\n    var filter = false,\n        filterName = 'DXImageTransform.Microsoft.Alpha';\n\n    // filters collection throws an error if we try to retrieve a filter that doesn't exist\n    try {\n        filter = el.filters.item(filterName);\n    } catch (e) {\n        // don't set opacity to 1 if we haven't already set an opacity,\n        // it isn't needed and breaks transparent pngs.\n        if (value === 1) { return; }\n    }\n\n    value = Math.round(value * 100);\n\n    if (filter) {\n        filter.Enabled = (value !== 100);\n        filter.Opacity = value;\n    } else {\n        el.style.filter += ' progid:' + filterName + '(opacity=' + value + ')';\n    }\n}\n\n// @function testProp(props: String[]): String|false\n// Goes through the array of style names and returns the first name\n// that is a valid style name for an element. If no such name is found,\n// it returns false. Useful for vendor-prefixed styles like `transform`.\nexport function testProp(props) {\n    var style = document.documentElement.style;\n\n    for (var i = 0; i < props.length; i++) {\n        if (props[i] in style) {\n            return props[i];\n        }\n    }\n    return false;\n}\n\nexport function isPropertySupported(prop) {\n    var style = document.documentElement.style;\n    return prop in style;\n}\n\n// @function setTransform(el: HTMLElement, offset: Point, scale?: Number)\n// Resets the 3D CSS transform of `el` so it is translated by `offset` pixels\n// and optionally scaled by `scale`. Does not have an effect if the\n// browser doesn't support 3D CSS transforms.\nexport function setTransform(el, offset, scale) {\n    var pos = offset || new Point(0, 0);\n\n    el.style[TRANSFORM] =\n        (Browser.ie3d ?\n            'translate(' + pos.x + 'px,' + pos.y + 'px)' :\n            'translate3d(' + pos.x + 'px,' + pos.y + 'px,0)') +\n        (scale ? ' scale(' + scale + ')' : '');\n}\n\n// @function setPosition(el: HTMLElement, position: Point)\n// Sets the position of `el` to coordinates specified by `position`,\n// using CSS translate or top/left positioning depending on the browser\n// (used by Leaflet internally to position its layers).\nexport function setPosition(el, point) {\n\n    /*eslint-disable */\n    el._leaflet_pos = point;\n    /*eslint-enable */\n\n    if (Browser.any3d) {\n        setTransform(el, point);\n    } else {\n        el.style.left = point.x + 'px';\n        el.style.top = point.y + 'px';\n    }\n}\n\n// @function getPosition(el: HTMLElement): Point\n// Returns the coordinates of an element previously positioned with setPosition.\nexport function getPosition(el) {\n    // this method is only used for elements previously positioned using setPosition,\n    // so it's safe to cache the position for performance\n\n    return el._leaflet_pos || new Point(0, 0);\n}\n\n// @function disableTextSelection()\n// Prevents the user from generating `selectstart` DOM events, usually generated\n// when the user drags the mouse through a page with text. Used internally\n// by Leaflet to override the behaviour of any click-and-drag interaction on\n// the map. Affects drag interactions on the whole document.\n\n// @function enableTextSelection()\n// Cancels the effects of a previous [`L.DomUtil.disableTextSelection`](#domutil-disabletextselection).\nexport var disableTextSelection;\nexport var enableTextSelection;\nvar _userSelect;\nif ('onselectstart' in document) {\n    disableTextSelection = function () {\n        DomEvent.on(window, 'selectstart', DomEvent.preventDefault);\n    };\n    enableTextSelection = function () {\n        DomEvent.off(window, 'selectstart', DomEvent.preventDefault);\n    };\n} else {\n    var userSelectProperty = testProp(\n        ['userSelect', 'WebkitUserSelect', 'OUserSelect', 'MozUserSelect', 'msUserSelect']);\n\n    disableTextSelection = function () {\n        if (userSelectProperty) {\n            var style = document.documentElement.style;\n            _userSelect = style[userSelectProperty];\n            style[userSelectProperty] = 'none';\n        }\n    };\n    enableTextSelection = function () {\n        if (userSelectProperty) {\n            document.documentElement.style[userSelectProperty] = _userSelect;\n            _userSelect = undefined;\n        }\n    };\n}\n\n// @function disableImageDrag()\n// As [`L.DomUtil.disableTextSelection`](#domutil-disabletextselection), but\n// for `dragstart` DOM events, usually generated when the user drags an image.\nexport function disableImageDrag() {\n    DomEvent.on(window, 'dragstart', DomEvent.preventDefault);\n}\n\n// @function enableImageDrag()\n// Cancels the effects of a previous [`L.DomUtil.disableImageDrag`](#domutil-disabletextselection).\nexport function enableImageDrag() {\n    DomEvent.off(window, 'dragstart', DomEvent.preventDefault);\n}\n\nvar _outlineElement, _outlineStyle;\n// @function preventOutline(el: HTMLElement)\n// Makes the [outline](https://developer.mozilla.org/docs/Web/CSS/outline)\n// of the element `el` invisible. Used internally by Leaflet to prevent\n// focusable elements from displaying an outline when the user performs a\n// drag interaction on them.\nexport function preventOutline(element) {\n    while (element.tabIndex === -1) {\n        element = element.parentNode;\n    }\n    if (!element || !element.style) { return; }\n    restoreOutline();\n    _outlineElement = element;\n    _outlineStyle = element.style.outline;\n    element.style.outline = 'none';\n    DomEvent.on(window, 'keydown', restoreOutline);\n}\n\n// @function restoreOutline()\n// Cancels the effects of a previous [`L.DomUtil.preventOutline`]().\nexport function restoreOutline() {\n    if (!_outlineElement) { return; }\n    _outlineElement.style.outline = _outlineStyle;\n    _outlineElement = undefined;\n    _outlineStyle = undefined;\n    DomEvent.off(window, 'keydown', restoreOutline);\n}\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var baseGetTag = require('./_baseGetTag'),\n    isObject = require('./isObject');\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nmodule.exports = isFunction;\n","var root = require('./_root');\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nmodule.exports = coreJsData;\n","var coreJsData = require('./_coreJsData');\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nmodule.exports = isMasked;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nmodule.exports = toSource;\n","var isFunction = require('./isFunction'),\n    isMasked = require('./_isMasked'),\n    isObject = require('./isObject'),\n    toSource = require('./_toSource');\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nmodule.exports = baseIsNative;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nmodule.exports = getValue;\n","var baseIsNative = require('./_baseIsNative'),\n    getValue = require('./_getValue');\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nmodule.exports = getNative;\n","var getNative = require('./_getNative');\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nmodule.exports = defineProperty;\n","var defineProperty = require('./_defineProperty');\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\nmodule.exports = baseAssignValue;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nmodule.exports = eq;\n","var baseAssignValue = require('./_baseAssignValue'),\n    eq = require('./eq');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nmodule.exports = assignValue;\n","var assignValue = require('./_assignValue'),\n    baseAssignValue = require('./_baseAssignValue');\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property identifiers to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @param {Function} [customizer] The function to customize copied values.\n * @returns {Object} Returns `object`.\n */\nfunction copyObject(source, props, object, customizer) {\n  var isNew = !object;\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n\n    var newValue = customizer\n      ? customizer(object[key], source[key], key, object, source)\n      : undefined;\n\n    if (newValue === undefined) {\n      newValue = source[key];\n    }\n    if (isNew) {\n      baseAssignValue(object, key, newValue);\n    } else {\n      assignValue(object, key, newValue);\n    }\n  }\n  return object;\n}\n\nmodule.exports = copyObject;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nmodule.exports = identity;\n","/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\nmodule.exports = apply;\n","var apply = require('./_apply');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * A specialized version of `baseRest` which transforms the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @param {Function} transform The rest array transform.\n * @returns {Function} Returns the new function.\n */\nfunction overRest(func, start, transform) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = transform(array);\n    return apply(func, this, otherArgs);\n  };\n}\n\nmodule.exports = overRest;\n","/**\n * Creates a function that returns `value`.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {*} value The value to return from the new function.\n * @returns {Function} Returns the new constant function.\n * @example\n *\n * var objects = _.times(2, _.constant({ 'a': 1 }));\n *\n * console.log(objects);\n * // => [{ 'a': 1 }, { 'a': 1 }]\n *\n * console.log(objects[0] === objects[1]);\n * // => true\n */\nfunction constant(value) {\n  return function() {\n    return value;\n  };\n}\n\nmodule.exports = constant;\n","var constant = require('./constant'),\n    defineProperty = require('./_defineProperty'),\n    identity = require('./identity');\n\n/**\n * The base implementation of `setToString` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar baseSetToString = !defineProperty ? identity : function(func, string) {\n  return defineProperty(func, 'toString', {\n    'configurable': true,\n    'enumerable': false,\n    'value': constant(string),\n    'writable': true\n  });\n};\n\nmodule.exports = baseSetToString;\n","/** Used to detect hot functions by number of calls within a span of milliseconds. */\nvar HOT_COUNT = 800,\n    HOT_SPAN = 16;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeNow = Date.now;\n\n/**\n * Creates a function that'll short out and invoke `identity` instead\n * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n * milliseconds.\n *\n * @private\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new shortable function.\n */\nfunction shortOut(func) {\n  var count = 0,\n      lastCalled = 0;\n\n  return function() {\n    var stamp = nativeNow(),\n        remaining = HOT_SPAN - (stamp - lastCalled);\n\n    lastCalled = stamp;\n    if (remaining > 0) {\n      if (++count >= HOT_COUNT) {\n        return arguments[0];\n      }\n    } else {\n      count = 0;\n    }\n    return func.apply(undefined, arguments);\n  };\n}\n\nmodule.exports = shortOut;\n","var baseSetToString = require('./_baseSetToString'),\n    shortOut = require('./_shortOut');\n\n/**\n * Sets the `toString` method of `func` to return `string`.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar setToString = shortOut(baseSetToString);\n\nmodule.exports = setToString;\n","var identity = require('./identity'),\n    overRest = require('./_overRest'),\n    setToString = require('./_setToString');\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  return setToString(overRest(func, start, identity), func + '');\n}\n\nmodule.exports = baseRest;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nmodule.exports = isLength;\n","var isFunction = require('./isFunction'),\n    isLength = require('./isLength');\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nmodule.exports = isArrayLike;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  length = length == null ? MAX_SAFE_INTEGER : length;\n  return !!length &&\n    (typeof value == 'number' || reIsUint.test(value)) &&\n    (value > -1 && value % 1 == 0 && value < length);\n}\n\nmodule.exports = isIndex;\n","var eq = require('./eq'),\n    isArrayLike = require('./isArrayLike'),\n    isIndex = require('./_isIndex'),\n    isObject = require('./isObject');\n\n/**\n * Checks if the given arguments are from an iteratee call.\n *\n * @private\n * @param {*} value The potential iteratee value argument.\n * @param {*} index The potential iteratee index or key argument.\n * @param {*} object The potential iteratee object argument.\n * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n *  else `false`.\n */\nfunction isIterateeCall(value, index, object) {\n  if (!isObject(object)) {\n    return false;\n  }\n  var type = typeof index;\n  if (type == 'number'\n        ? (isArrayLike(object) && isIndex(index, object.length))\n        : (type == 'string' && index in object)\n      ) {\n    return eq(object[index], value);\n  }\n  return false;\n}\n\nmodule.exports = isIterateeCall;\n","var baseRest = require('./_baseRest'),\n    isIterateeCall = require('./_isIterateeCall');\n\n/**\n * Creates a function like `_.assign`.\n *\n * @private\n * @param {Function} assigner The function to assign values.\n * @returns {Function} Returns the new assigner function.\n */\nfunction createAssigner(assigner) {\n  return baseRest(function(object, sources) {\n    var index = -1,\n        length = sources.length,\n        customizer = length > 1 ? sources[length - 1] : undefined,\n        guard = length > 2 ? sources[2] : undefined;\n\n    customizer = (assigner.length > 3 && typeof customizer == 'function')\n      ? (length--, customizer)\n      : undefined;\n\n    if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n      customizer = length < 3 ? undefined : customizer;\n      length = 1;\n    }\n    object = Object(object);\n    while (++index < length) {\n      var source = sources[index];\n      if (source) {\n        assigner(object, source, index, customizer);\n      }\n    }\n    return object;\n  });\n}\n\nmodule.exports = createAssigner;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nmodule.exports = isPrototype;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nmodule.exports = baseTimes;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nmodule.exports = baseIsArguments;\n","var baseIsArguments = require('./_baseIsArguments'),\n    isObjectLike = require('./isObjectLike');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nmodule.exports = isArguments;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nmodule.exports = isArray;\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = stubFalse;\n","var root = require('./_root'),\n    stubFalse = require('./stubFalse');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nmodule.exports = isBuffer;\n","var baseGetTag = require('./_baseGetTag'),\n    isLength = require('./isLength'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nmodule.exports = baseIsTypedArray;\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nmodule.exports = baseUnary;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nmodule.exports = nodeUtil;\n","var baseIsTypedArray = require('./_baseIsTypedArray'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nmodule.exports = isTypedArray;\n","var baseTimes = require('./_baseTimes'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isIndex = require('./_isIndex'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayLikeKeys;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nmodule.exports = overArg;\n","var overArg = require('./_overArg');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nmodule.exports = nativeKeys;\n","var isPrototype = require('./_isPrototype'),\n    nativeKeys = require('./_nativeKeys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseKeys;\n","var arrayLikeKeys = require('./_arrayLikeKeys'),\n    baseKeys = require('./_baseKeys'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nmodule.exports = keys;\n","var assignValue = require('./_assignValue'),\n    copyObject = require('./_copyObject'),\n    createAssigner = require('./_createAssigner'),\n    isArrayLike = require('./isArrayLike'),\n    isPrototype = require('./_isPrototype'),\n    keys = require('./keys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns own enumerable string keyed properties of source objects to the\n * destination object. Source objects are applied from left to right.\n * Subsequent sources overwrite property assignments of previous sources.\n *\n * **Note:** This method mutates `object` and is loosely based on\n * [`Object.assign`](https://mdn.io/Object/assign).\n *\n * @static\n * @memberOf _\n * @since 0.10.0\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} [sources] The source objects.\n * @returns {Object} Returns `object`.\n * @see _.assignIn\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * function Bar() {\n *   this.c = 3;\n * }\n *\n * Foo.prototype.b = 2;\n * Bar.prototype.d = 4;\n *\n * _.assign({ 'a': 0 }, new Foo, new Bar);\n * // => { 'a': 1, 'c': 3 }\n */\nvar assign = createAssigner(function(object, source) {\n  if (isPrototype(source) || isArrayLike(source)) {\n    copyObject(source, keys(source), object);\n    return;\n  }\n  for (var key in source) {\n    if (hasOwnProperty.call(source, key)) {\n      assignValue(object, key, source[key]);\n    }\n  }\n});\n\nmodule.exports = assign;\n","var document = typeof window !== 'undefined' && typeof window.document !== 'undefined' ? window.document : {};\nvar keyboardAllowed = typeof Element !== 'undefined' && 'ALLOW_KEYBOARD_INPUT' in Element;\n\nvar fn = (function () {\n  var val;\n\n  var fnMap = [\n    [\n      'requestFullscreen',\n      'exitFullscreen',\n      'fullscreenElement',\n      'fullscreenEnabled',\n      'fullscreenchange',\n      'fullscreenerror'\n    ],\n    // New WebKit\n    [\n      'webkitRequestFullscreen',\n      'webkitExitFullscreen',\n      'webkitFullscreenElement',\n      'webkitFullscreenEnabled',\n      'webkitfullscreenchange',\n      'webkitfullscreenerror'\n\n    ],\n    // Old WebKit (Safari 5.1)\n    [\n      'webkitRequestFullScreen',\n      'webkitCancelFullScreen',\n      'webkitCurrentFullScreenElement',\n      'webkitCancelFullScreen',\n      'webkitfullscreenchange',\n      'webkitfullscreenerror'\n\n    ],\n    [\n      'mozRequestFullScreen',\n      'mozCancelFullScreen',\n      'mozFullScreenElement',\n      'mozFullScreenEnabled',\n      'mozfullscreenchange',\n      'mozfullscreenerror'\n    ],\n    [\n      'msRequestFullscreen',\n      'msExitFullscreen',\n      'msFullscreenElement',\n      'msFullscreenEnabled',\n      'MSFullscreenChange',\n      'MSFullscreenError'\n    ]\n  ];\n\n  var i = 0;\n  var l = fnMap.length;\n  var ret = {};\n\n  for (; i < l; i++) {\n    val = fnMap[i];\n    if (val && val[1] in document) {\n      for (i = 0; i < val.length; i++) {\n        ret[fnMap[0][i]] = val[i];\n      }\n      return ret;\n    }\n  }\n\n  return false;\n})();\n\nvar eventNameMap = {\n  change: fn.fullscreenchange,\n  error: fn.fullscreenerror\n};\n\nvar screenfull = {\n  request: function (elem) {\n    var request = fn.requestFullscreen;\n\n    elem = elem || document.documentElement;\n\n    // Work around Safari 5.1 bug: reports support for\n    // keyboard in fullscreen even though it doesn't.\n    // Browser sniffing, since the alternative with\n    // setTimeout is even worse.\n    if (/5\\.1[.\\d]* Safari/.test(navigator.userAgent)) {\n      elem[request]();\n    } else {\n      elem[request](keyboardAllowed && Element.ALLOW_KEYBOARD_INPUT);\n    }\n  },\n  exit: function () {\n    document[fn.exitFullscreen]();\n  },\n  toggle: function (elem) {\n    if (this.isFullscreen) {\n      this.exit();\n    } else {\n      this.request(elem);\n    }\n  },\n  onchange: function (callback) {\n    this.on('change', callback);\n  },\n  onerror: function (callback) {\n    this.on('error', callback);\n  },\n  on: function (event, callback) {\n    var eventName = eventNameMap[event];\n    if (eventName) {\n      document.addEventListener(eventName, callback, false);\n    }\n  },\n  off: function (event, callback) {\n    var eventName = eventNameMap[event];\n    if (eventName) {\n      document.removeEventListener(eventName, callback, false);\n    }\n  },\n  raw: fn\n};\n\nObject.defineProperties(screenfull, {\n  isFullscreen: {\n    get: function () {\n      return Boolean(document[fn.fullscreenElement]);\n    }\n  },\n  element: {\n    enumerable: true,\n    get: function () {\n      return document[fn.fullscreenElement];\n    }\n  },\n  enabled: {\n    enumerable: true,\n    get: function () {\n      // Coerce to boolean in case of old WebKit\n      return Boolean(document[fn.fullscreenEnabled]);\n    }\n  }\n});\n\nexport {screenfull};","import * as Util from '../core/Util';\nimport {Evented} from '../core/Events';\n// import {Class} from '../core/Class';\nimport * as Browser from '../core/Browser';\nimport * as DomEvent from '../dom/DomEvent';\nimport * as DomUtil from '../dom/DomUtil';\n\nimport debounce from 'lodash/debounce';\nimport assign from 'lodash/assign';\n\nimport {screenfull} from '../screenfull';\n\n/*\n * @class Reader\n * @aka cozy.Map\n * @inherits Evented\n *\n * The central class of the API — it is used to create a book on a page and manipulate it.\n *\n * @example\n *\n * ```js\n * // initialize the map on the \"map\" div with a given center and zoom\n * var map = L.map('map', {\n *  center: [51.505, -0.09],\n *  zoom: 13\n * });\n * ```\n *\n */\n\nvar _padding = 1.0;\nexport var Reader = Evented.extend({\n  options: {\n    regions: [\n      'header',\n      'toolbar.top',\n      'toolbar.left',\n      'main',\n      'toolbar.right',\n      'toolbar.bottom',\n      'footer'\n    ],\n    metadata: {},\n    flow: 'auto',\n    engine: 'epubjs',\n    fontSizeLarge: '140%',\n    fontSizeSmall: '90%',\n    fontSizeDefault: '100%',\n    trackResize: true,\n    text_size: 100,\n    mobileMediaQuery: '(min-device-width : 300px) and (max-device-width : 600px)',\n    forceScrolledDocHeight: 1200,\n    theme: 'default',\n    rootfilePath: '',\n    themes: []\n  },\n\n  initialize: function(id, options) {\n    var self = this\n\n    self._original_document_title = document.title;\n\n    if ( localStorage.getItem('cozy.options') ) {\n      options = assign(options, JSON.parse(localStorage.getItem('cozy.options')));\n    }\n    options = Util.setOptions(this, options);\n\n    this._checkFeatureCompatibility();\n\n    this.metadata = this.options.metadata; // initial seed\n\n    this._initContainer(id);\n    this._initLayout();\n\n    if ( this.options.themes && this.options.themes.length > 0 ) {\n        this.options.themes.forEach(function(theme) {\n            if ( theme.href ) { return; }\n            var klass = theme.klass;\n            var rules = {};\n            for(var rule in theme.rules) {\n                var new_rule = '.' + klass;\n                if ( rule == 'body' ) { new_rule = 'body' + new_rule; }\n                else { new_rule += ' ' + rule ; }\n                rules[new_rule] = theme.rules[rule];\n            }\n            theme.rules = rules;\n        });\n    }\n\n    this._updateTheme();\n\n    // hack for https://github.com/Leaflet/Leaflet/issues/1980\n    // this._onResize = Util.bind(this._onResize, this);\n\n    this._initEvents();\n\n    this.callInitHooks();\n\n    this._mode = this.options.mode;\n  },\n\n  start: function(target, cb) {\n    var self = this;\n\n    if ( typeof(target) == 'function' && cb === undefined ) {\n      cb = target;\n      target = undefined;\n    }\n\n    Util.loader.js(this.options.engine_href).then(function() {\n      self._start(target, cb);\n      self._loaded = true;\n    })\n  },\n\n  _start: function(target, cb) {\n    var self = this;\n    target = target || 0;\n\n    // self.open(function() {\n    //   self.draw(target, cb);\n    // });\n\n    self.open(target, cb);\n  },\n\n  reopen: function(options, target) {\n    /* NOP */\n  },\n\n  saveOptions: function(options) {\n    var saved_options = {};\n    assign(saved_options, options);\n    if ( saved_options.flow == 'auto' ) {\n      // do not save\n      delete saved_options.flow;\n    }\n    localStorage.setItem('cozy.options', JSON.stringify(saved_options));\n  },\n\n  _updateTheme: function() {\n    DomUtil.removeClass(this._container, 'cozy-theme-' + ( this._container.dataset.theme || 'default' ));\n    DomUtil.addClass(this._container, 'cozy-theme-' + this.options.theme);\n    this._container.dataset.theme = this.options.theme;\n  },\n\n  draw: function(target) {\n    // NOOP\n  },\n\n  next: function() {\n    // NOOP\n  },\n\n  prev: function() {\n    // NOOP\n  },\n\n  display: function(index) {\n    // NOOP\n  },\n\n  gotoPage: function(target) {\n    // NOOP\n  },\n\n  goBack: function() {\n    history.back();\n  },\n\n  goForward: function() {\n    history.forward();\n  },\n\n  requestFullscreen: function() {\n    if ( screenfull.enabled ) {\n      // this._preResize();\n      screenfull.toggle(this._container);\n    }\n  },\n\n  _preResize: function() {\n\n  },\n\n  _initContainer: function (id) {\n    var container = this._container = DomUtil.get(id);\n\n    if (!container) {\n      throw new Error('Reader container not found.');\n    } else if (container._cozy_id) {\n      throw new Error('Reader container is already initialized.');\n    }\n\n    DomEvent.on(container, 'scroll', this._onScroll, this);\n    this._containerId = Util.stamp(container);\n  },\n\n  _initLayout: function () {\n    var container = this._container;\n\n    this._fadeAnimated = this.options.fadeAnimation && Browser.any3d;\n\n    DomUtil.addClass(container, 'cozy-container' +\n      (Browser.touch ? ' cozy-touch' : '') +\n      (Browser.retina ? ' cozy-retina' : '') +\n      (Browser.ielt9 ? ' cozy-oldie' : '') +\n      (Browser.safari ? ' cozy-safari' : '') +\n      (this._fadeAnimated ? ' cozy-fade-anim' : '') +\n      ' cozy-engine-' + this.options.engine +\n      ' cozy-theme-' + this.options.theme);\n\n    var position = DomUtil.getStyle(container, 'position');\n\n    this._initPanes();\n\n    if ( ! Browser.columnCount ) {\n      this.options.flow = 'scrolled-doc';\n    }\n  },\n\n  _initPanes: function () {\n    var self = this;\n\n    var panes = this._panes = {};\n\n    var l = 'cozy-';\n    var container = this._container;\n\n    var prefix = 'cozy-module-';\n\n    DomUtil.addClass(container, 'cozy-container');\n    panes['top'] = DomUtil.create('div', prefix + 'top', container);\n    panes['main'] = DomUtil.create('div', prefix + 'main', container);\n    panes['bottom'] = DomUtil.create('div', prefix + 'bottom', container);\n\n    panes['left'] = DomUtil.create('div', prefix + 'left', panes['main']);\n    panes['book-cover'] = DomUtil.create('div', prefix + 'book-cover', panes['main']);\n    panes['right'] = DomUtil.create('div', prefix + 'right', panes['main']);\n    panes['book'] = DomUtil.create('div', prefix + 'book', panes['book-cover']);\n    panes['loader'] = DomUtil.create('div', prefix + 'book-loading', panes['book']);\n    panes['epub'] = DomUtil.create('div', prefix + 'book-epub', panes['book']);\n    this._initBookLoader();\n  },\n\n  _checkIfLoaded: function () {\n    if (!this._loaded) {\n      throw new Error('Set map center and zoom first.');\n    }\n  },\n\n  // DOM event handling\n\n  // @section Interaction events\n  _initEvents: function (remove) {\n    this._targets = {};\n    this._targets[Util.stamp(this._container)] = this;\n\n    this.tracking = function(reader) {\n      var _action = [];\n      var _last_location_start;\n      var _reader = reader;\n      return {\n        action: function(v) {\n          if ( v ) {\n            _action = [v];\n            this.event(v);\n            // _reader.fire('trackAction', { action: v })\n          } else {\n            return _action.pop();\n          }\n        },\n\n        event: function(action, data) {\n          if ( data == null ) { data = {}; }\n          data.action = action;\n          _reader.fire(\"trackAction\", data);\n        },\n\n        pageview: function(location) {\n          if ( location.start != _last_location_start ) {\n            _last_location_start = location.start;\n            // console.log(\"AHOY RELOCATED\", location, location.start, location.href, location.location, this.action());\n            _reader.fire('trackPageview', { cfi: location.start, href: location.href, action: this.action()})\n            return true;\n          }\n          return false;\n        }\n      }\n    }(this);\n\n    var onOff = remove ? DomEvent.off : DomEvent.on;\n\n    // @event click: MouseEvent\n    // Fired when the user clicks (or taps) the map.\n    // @event dblclick: MouseEvent\n    // Fired when the user double-clicks (or double-taps) the map.\n    // @event mousedown: MouseEvent\n    // Fired when the user pushes the mouse button on the map.\n    // @event mouseup: MouseEvent\n    // Fired when the user releases the mouse button on the map.\n    // @event mouseover: MouseEvent\n    // Fired when the mouse enters the map.\n    // @event mouseout: MouseEvent\n    // Fired when the mouse leaves the map.\n    // @event mousemove: MouseEvent\n    // Fired while the mouse moves over the map.\n    // @event contextmenu: MouseEvent\n    // Fired when the user pushes the right mouse button on the map, prevents\n    // default browser context menu from showing if there are listeners on\n    // this event. Also fired on mobile when the user holds a single touch\n    // for a second (also called long press).\n    // @event keypress: KeyboardEvent\n    // Fired when the user presses a key from the keyboard while the map is focused.\n    // onOff(this._container, 'click dblclick mousedown mouseup ' +\n    //   'mouseover mouseout mousemove contextmenu keypress', this._handleDOMEvent, this);\n\n    // if (this.options.trackResize) {\n    //   var self = this;\n    //   var fn = debounce(function(){ self.invalidateSize({}); }, 150);\n    //   onOff(window, 'resize', fn, this);\n    // }\n\n    if (Browser.any3d && this.options.transform3DLimit) {\n      (remove ? this.off : this.on).call(this, 'moveend', this._onMoveEnd);\n    }\n\n    var self = this;\n    if (screenfull.enabled) {\n      screenfull.on('change', function() {\n        // setTimeout(function() {\n        //   self.invalidateSize({});\n        // }, 100);\n        console.log('AHOY: Am I fullscreen?', screenfull.isFullscreen ? 'YES' : 'NO');\n      });\n    }\n\n    self.on(\"updateLocation\", function(location) {\n      var location_href = location.start;\n\n      if ( self._ignoreHistory ) {\n        self._ignoreHistory = false;\n        return;\n      }\n\n      if ( self.tracking.pageview(location) ) {\n        var tmp_href = window.location.href.split(\"#\");\n        tmp_href[1] = location.start.substr(8, location.start.length - 8 - 1);\n        history.pushState({ cfi: location.start }, '', tmp_href.join('#'));\n\n        if ( location.percentage ) {\n          var p = Math.ceil(location.percentage * 100);\n          document.title = `${self._original_document_title} - ${p}%`;\n        }        \n      }\n    })\n\n    window.addEventListener('popstate', function(event) {\n      if ( event.isTrusted && event.state !== null ) {\n        self._ignoreHistory = true;\n        self.gotoPage(event.state.cfi);\n      }\n    })\n\n    document.addEventListener('keydown', function(event) {\n      var keyName = event.key;\n      var target = event.target;\n\n      // check if the activeElement is \".special-panel\"\n      var check = document.activeElement;\n      while ( check.localName != 'body' ) {\n        if ( check.classList.contains('special-panel') ) {\n          return;\n        }\n        check = check.parentElement;\n      }\n\n      var IGNORE_TARGETS = [ 'input', 'target' ];\n      if ( IGNORE_TARGETS.indexOf(target.localName) >= 0 ) {\n        return;\n      }\n\n      self.fire('keyDown', { keyName: keyName, shiftKey: event.shiftKey });\n    });\n\n    self.on('keyDown', function(data) {\n      switch(data.keyName) {\n        case 'ArrowRight':\n        case 'PageDown':\n          self.next();\n          break;\n        case 'ArrowLeft':\n        case 'PageUp':\n          self.prev();\n          break;\n        case 'Home':\n          self._scroll('HOME');\n          break;\n        case 'End':\n          self._scroll('END')\n          break;\n      }\n    });\n  },\n\n  // _onResize: function() {\n  //   if ( ! this._resizeRequest ) {\n  //     this._resizeRequest = Util.requestAnimFrame(function() {\n  //       this.invalidateSize({})\n  //     }, this);\n  //   }\n  // },\n\n  _onScroll: function () {\n    this._container.scrollTop  = 0;\n    this._container.scrollLeft = 0;\n  },\n\n  _handleDOMEvent: function (e) {\n    if (!this._loaded || DomEvent.skipped(e)) { return; }\n\n    var type = e.type === 'keypress' && e.keyCode === 13 ? 'click' : e.type;\n\n    if (type === 'mousedown') {\n      // prevents outline when clicking on keyboard-focusable element\n      DomUtil.preventOutline(e.target || e.srcElement);\n    }\n\n    this._fireDOMEvent(e, type);\n  },\n\n  _fireDOMEvent: function (e, type, targets) {\n\n    if (e.type === 'click') {\n      // Fire a synthetic 'preclick' event which propagates up (mainly for closing popups).\n      // @event preclick: MouseEvent\n      // Fired before mouse click on the map (sometimes useful when you\n      // want something to happen on click before any existing click\n      // handlers start running).\n      var synth = Util.extend({}, e);\n      synth.type = 'preclick';\n      this._fireDOMEvent(synth, synth.type, targets);\n    }\n\n    if (e._stopped) { return; }\n\n    // Find the layer the event is propagating from and its parents.\n    targets = (targets || []).concat(this._findEventTargets(e, type));\n\n    if (!targets.length) { return; }\n\n    var target = targets[0];\n    if (type === 'contextmenu' && target.listens(type, true)) {\n      DomEvent.preventDefault(e);\n    }\n\n    var data = {\n      originalEvent: e\n    };\n\n    if (e.type !== 'keypress') {\n      var isMarker = (target.options && 'icon' in target.options);\n      data.containerPoint = isMarker ?\n          this.latLngToContainerPoint(target.getLatLng()) : this.mouseEventToContainerPoint(e);\n      data.layerPoint = this.containerPointToLayerPoint(data.containerPoint);\n      data.latlng = isMarker ? target.getLatLng() : this.layerPointToLatLng(data.layerPoint);\n    }\n\n    for (var i = 0; i < targets.length; i++) {\n      targets[i].fire(type, data, true);\n      if (data.originalEvent._stopped ||\n        (targets[i].options.nonBubblingEvents && Util.indexOf(targets[i].options.nonBubblingEvents, type) !== -1)) { return; }\n    }\n  },\n\n  getFixedBookPanelSize: function() {\n    // have to make the book\n    var style = window.getComputedStyle(this._panes['book']);\n    var h = this._panes['book'].clientHeight - parseFloat(style.paddingTop) - parseFloat(style.paddingBottom);\n    var w = this._panes['book'].clientWidth - parseFloat(style.paddingRight) - parseFloat(style.paddingLeft);\n    return { height: Math.floor(h * 1.00), width: Math.floor(w * 1.00) };\n  },\n\n  invalidateSize: function(options) {\n    // TODO: IS THIS EVER USED?\n    var self = this;\n\n    if ( ! self._drawn ) { return; }\n\n    Util.cancelAnimFrame(this._resizeRequest);\n\n    if (! this._loaded) { return this; }\n\n    this.fire('resized');\n  },\n\n  _resizeBookPane: function() {\n\n  },\n\n  _setupHooks: function() {\n\n  },\n\n  _checkFeatureCompatibility: function() {\n    if ( ! DomUtil.isPropertySupported('columnCount') || this._checkMobileDevice() ) {\n      // force\n      this.options.flow = 'scrolled-doc';\n    }\n    if ( this._checkMobileDevice() ) {\n      // this.options.fontSizeLarge = '160%';\n      // this.options.fontSizeSmall ='100%';\n      // this.options.fontSizeDefault = '120%';\n      this.options.text_size = 120;\n    }\n  },\n\n  _checkMobileDevice: function() {\n    if ( this._isMobile === undefined ) {\n      this._isMobile = false;\n      if ( this.options.mobileMediaQuery ) {\n        this._isMobile = window.matchMedia(this.options.mobileMediaQuery).matches;\n      }\n    }\n    return this._isMobile;\n  },\n\n  _enableBookLoader: function(delay=0) {\n    var self = this;\n    self._clearBookLoaderTimeout();\n    if ( delay < 0 ) {\n      delay = 0;\n      self._force_progress = true;\n    }\n    self._loader_timeout = setTimeout(function() {\n      self._panes['loader'].style.display = 'block';\n    }, delay);\n  },\n\n  _disableBookLoader: function(force=false) {\n    var self = this;\n    self._clearBookLoaderTimeout();\n    if ( ! self._force_progress || force ) {\n      self._panes['loader'].style.display = 'none';\n      self._force_progress = false;\n      self._panes['loader-status'].innerHTML = '';\n    }\n  },\n\n  _clearBookLoaderTimeout: function() {\n    var self = this;\n    if ( self._loader_timeout ) {\n      clearTimeout(self._loader_timeout);\n      self._loader_timeout = null;\n    }\n  },\n\n  _initBookLoader: function() {\n    // is this not awesome?\n    var template = this.options.loader_template || this.loaderTemplate();\n\n    var body = new DOMParser().parseFromString(template, \"text/html\").body;\n    while ( body.children.length ) {\n      this._panes['loader'].appendChild(body.children[0]);\n    }\n    this._panes['loader-status'] = DomUtil.create('div', 'cozy-module-book-loading-status', this._panes['loader']);\n  },\n\n  loaderTemplate: function() {\n    return `<div class=\"cozy-loader-spinner\">\n    <div class=\"spinner-backdrop spinner-backdrop--1\"></div>\n    <div class=\"spinner-backdrop spinner-backdrop--2\"></div>\n    <div class=\"spinner-backdrop spinner-backdrop--3\"></div>\n    <div class=\"spinner-backdrop spinner-backdrop--4\"></div>\n    <div class=\"spinner-quarter spinner-quarter--1\"></div>\n    <div class=\"spinner-quarter spinner-quarter--2\"></div>\n    <div class=\"spinner-quarter spinner-quarter--3\"></div>\n    <div class=\"spinner-quarter spinner-quarter--4\"></div>\n  </div>`;\n  },\n\n  EOT: true\n});\n\nexport function createReader(id, options) {\n  return new Reader(id, options);\n}\n","import {Class} from '../core/Class';\nimport {Reader} from '../reader/Reader';\nimport * as Util from '../core/Util';\nimport * as DomUtil from '../dom/DomUtil';\n\n/*\n * @class Control\n * @aka L.Control\n * @inherits Class\n *\n * L.Control is a base class for implementing reader controls. Handles regioning.\n * All other controls extend from this class.\n */\n\nexport var Control = Class.extend({\n    // @section\n    // @aka Control options\n    options: {\n        // @option region: String = 'topright'\n        // The region of the control (one of the reader corners). Possible values are `'topleft'`,\n        // `'topright'`, `'bottomleft'` or `'bottomright'`\n    },\n\n    initialize: function (options) {\n        Util.setOptions(this, options);\n        if ( options.container ) {\n            this._container = options.container;\n            this._locked = true;\n        }\n        this._id = (new Date()).getTime() + '-' + parseInt(Math.random((new Date()).getTime()) * 1000, 10);\n    },\n\n    /* @section\n     * Classes extending L.Control will inherit the following methods:\n     *\n     * @method getRegion: string\n     * Returns the region of the control.\n     */\n    getRegion: function () {\n        return this.options.region;\n    },\n\n    // @method setRegion(region: string): this\n    // Sets the region of the control.\n    setRegion: function (region) {\n        var reader = this._reader;\n\n        if (reader) {\n            reader.removeControl(this);\n        }\n\n        this.options.region = region;\n\n        if (reader) {\n            reader.addControl(this);\n        }\n\n        return this;\n    },\n\n    // @method getContainer: HTMLElement\n    // Returns the HTMLElement that contains the control.\n    getContainer: function () {\n        return this._container;\n    },\n\n    // @method addTo(reader: Map): this\n    // Adds the control to the given reader.\n    addTo: function (reader) {\n        this.remove();\n        this._reader = reader;\n\n        var container = this._container = this.onAdd(reader);\n\n        DomUtil.addClass(container, 'cozy-control');\n\n        if ( ! this._locked ) {\n            var region = this.getRegion();\n            var area = reader.getControlRegion(region);\n            area.appendChild(container);\n        }\n\n        return this;\n    },\n\n    // @method remove: this\n    // Removes the control from the reader it is currently active on.\n    remove: function () {\n        if (!this._reader) {\n            return this;\n        }\n\n        if (! this._container) {\n            return this;\n        }\n\n        if ( ! this._locked ) {\n            DomUtil.remove(this._container);\n        }\n\n        if (this.onRemove) {\n            this.onRemove(this._reader);\n        }\n\n        this._reader = null;\n\n        return this;\n    },\n\n    _refocusOnMap: function (e) {\n        // if reader exists and event is not a keyboard event\n        if (this._reader && e && e.screenX > 0 && e.screenY > 0) {\n            this._reader.getContainer().focus();\n        }\n    },\n\n    _className: function(widget) {\n        var className = [ 'cozy-control' ];\n        if ( this.options.direction ) {\n            className.push('cozy-control-' + this.options.direction);\n        }\n        if ( widget ) {\n            className.push('cozy-control-' + widget);\n        }\n        return className.join(' ');\n    }\n});\n\nexport var control = function (options) {\n    return new Control(options);\n};\n\n/* @section Extension methods\n * @uninheritable\n *\n * Every control should extend from `L.Control` and (re-)implement the following methods.\n *\n * @method onAdd(reader: Map): HTMLElement\n * Should return the container DOM element for the control and add listeners on relevant reader events. Called on [`control.addTo(reader)`](#control-addTo).\n *\n * @method onRemove(reader: Map)\n * Optional method. Should contain all clean up code that removes the listeners previously added in [`onAdd`](#control-onadd). Called on [`control.remove()`](#control-remove).\n */\n\n/* @namespace Map\n * @section Methods for Layers and Controls\n */\nReader.include({\n    // @method addControl(control: Control): this\n    // Adds the given control to the reader\n    addControl: function (control) {\n        control.addTo(this);\n        return this;\n    },\n\n    // @method removeControl(control: Control): this\n    // Removes the given control from the reader\n    removeControl: function (control) {\n        control.remove();\n        return this;\n    },\n\n    getControlContainer: function() {\n        var l = 'cozy-';\n        if ( ! this._controlContainer ) {\n            this._controlContainer =\n                DomUtil.create('div', l + 'control-container', this._container);\n        }\n        return this._controlContainer;\n    },\n\n    getControlRegion: function (target) {\n\n        if ( ! this._panes[target] ) {\n            // target is dot-delimited string\n            // first dot is the panel\n            var parts = target.split('.');\n            var tmp = [];\n            var parent = this._container;\n            var x = 0;\n            while ( parts.length ) {\n                var slug = parts.shift();\n                tmp.push(slug);\n                var panel = tmp.join(\".\");\n                var className = 'cozy-panel-' + slug;\n                if ( ! this._panes[panel] ) {\n                    this._panes[panel] = DomUtil.create('div', className, parent);\n                }\n                parent = this._panes[panel];\n                x += 1;\n                if ( x > 100 ) { break; }\n            }\n        }\n        return this._panes[target];\n    },\n\n    getControlRegion_1: function (target) {\n\n        var tmp = target.split('.');\n        var region = tmp.shift();\n        var slot = tmp.pop() || '-slot';\n\n        var container = this._panes[region];\n        if ( ! this._panes[target] ) {\n            var className = 'cozy-' + region + '--item cozy-slot-' + slot\n            if ( ! this._panes[region + '.' + slot] ) {\n                var div = DomUtil.create('div', className);\n                if ( slot == 'left' || slot == 'bottom' ) {\n                    var childElement = this._panes[region].firstChild;\n                    this._panes[region].insertBefore(div, childElement);\n                } else {\n                    this._panes[region].appendChild(div);\n                }\n                this._panes[region + '.' + slot] = div;\n            }\n            className = this._classify(tmp);\n            this._panes[target] = DomUtil.create('div', className, this._panes[region + '.' + slot]);\n        }\n\n        return this._panes[target];\n    },\n\n    _classify: function(tmp) {\n        var l = 'cozy-';\n        var className = [];\n        for(var i in tmp) {\n            className.push(l + tmp[i]);\n        }\n        className = className.join(' ');\n        return className;\n    },\n\n    _clearControlRegion: function () {\n        for (var i in this._controlRegions) {\n            DomUtil.remove(this._controlRegions[i]);\n        }\n        DomUtil.remove(this._controlContainer);\n        delete this._controlRegions;\n        delete this._controlContainer;\n    }\n});\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nvar PageControl = Control.extend({\n  onAdd: function(reader) {\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n      container = DomUtil.create('div', className),\n\n      this._control  = this._createButton(this._fill(options.html || options.label), this._fill(options.label),\n              className, container);\n    }\n    this._bindEvents();\n\n    return container;\n  },\n\n  _createButton: function (html, title, className, container) {\n    var link = DomUtil.create('a', className, container);\n    link.innerHTML = html;\n    link.href = '#';\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    return link;\n  },\n\n  _bindEvents: function() {\n    var self = this;\n    DomEvent.disableClickPropagation(this._control);\n    DomEvent.on(this._control, 'click', DomEvent.stop);\n    DomEvent.on(this._control, 'click', this._action, this);\n\n    this._reader.on('reopen', function(data) {\n      // update the button text / titles\n      var html = self.options.html || self.options.label;\n      self._control.innerHTML = self._fill(html);\n      self._control.setAttribute('title', self._fill(self.options.label));\n      self._control.setAttribute('aria-label', self._fill(self.options.label));\n    });\n\n  },\n\n  _unit: function() {\n    return ( this._reader.options.flow == 'scrolled-doc' ) ? 'Section' : 'Page';\n  },\n\n  _fill: function(s) {\n    var unit = this._unit();\n    return s.replace(/\\$\\{unit\\}/g, unit);\n  },\n\n  _label: function() {\n    return this.options.label + \" \" + ( this._reader.options.flow == 'scrolled-doc' ) ? 'Section' : 'Page';\n  },\n\n  EOT: true\n});\n\nexport var PagePrevious = PageControl.extend({\n  options: {\n    region: 'edge.left',\n    direction: 'previous',\n    label: 'Previous ${unit}',\n    html: '<i class=\"icon-chevron-left oi\" data-glyph=\"chevron-left\" title=\"Previous ${unit}\" aria-hidden=\"true\"></i>'\n  },\n\n  _action: function(e) {\n    this._reader.prev();\n  }\n});\n\nexport var PageNext = PageControl.extend({\n  options: {\n    region: 'edge.right',\n    direction: 'next',\n    label: 'Next ${unit}',\n    html: '<i class=\"icon-chevron-right oi\" data-glyph=\"chevron-right\" title=\"Next ${unit}\" aria-hidden=\"true\"></i>'\n  },\n\n  _action: function(e) {\n    this._reader.next();\n  }\n});\n\nexport var PageFirst = PageControl.extend({\n  options: {\n    direction: 'first',\n    label: 'First ${unit}'\n  },\n  _action: function(e) {\n      this._reader.first();\n  }\n});\n\nexport var PageLast = PageControl.extend({\n  options: {\n    direction: 'last',\n    label: 'Last ${unit}'\n  },\n  _action: function(e) {\n      this._reader.last();\n  }\n});\n\nexport var pageNext = function(options) {\n  return new PageNext(options);\n}\n\nexport var pagePrevious = function(options) {\n  return new PagePrevious(options);\n}\n\nexport var pageFirst = function(options) {\n  return new PageFirst(options);\n}\n\nexport var pageLast = function(options) {\n  return new PageLast(options);\n}\n","import {Class} from '../core/Class';\nimport {Reader} from '../reader/Reader';\nimport * as Util from '../core/Util';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nimport assign from 'lodash/assign';\n\nvar activeModal;\nvar dismissModalListener = false;\n\n// from https://github.com/ghosh/micromodal/blob/master/src/index.js\nconst FOCUSABLE_ELEMENTS = [\n    'a[href]',\n    'area[href]',\n    'input:not([disabled]):not([type=\"hidden\"])',\n    'select:not([disabled])',\n    'textarea:not([disabled])',\n    'button:not([disabled])',\n    'iframe',\n    'object',\n    'embed',\n    '[contenteditable]',\n    '[tabindex]:not([tabindex^=\"-\"])'\n  ];\n\nconst ACTIONABLE_ELEMENTS = [\n    'a[href]',\n    'area[href]',\n    'input[type=\"submit\"]:not([disabled])',\n    'button:not([disabled])'\n  ];\n\nexport var Modal = Class.extend({\n  options: {\n    // @option region: String = 'topright'\n    // The region of the control (one of the reader edges). Possible values are `'left' ad 'right'`\n    region: 'left',\n    fraction: 0,\n    width: null,\n    className: {},\n    actions: null,\n    callbacks: { onShow: function() {}, onClose: function() {} },\n    handlers: {}\n  },\n\n  initialize: function (options) {\n    options = Util.setOptions(this, options);\n    this._id = (new Date()).getTime() + '-' + parseInt(Math.random((new Date()).getTime()) * 1000, 10);\n    this._initializedEvents = false;\n    this.callbacks = assign({}, this.options.callbacks);\n    this.actions = this.options.actions ? assign({}, this.options.actions) : null;\n    this.handlers = assign({}, this.options.handlers);\n    if ( typeof(this.options.className) == 'string' ) {\n      this.options.className = { container: this.options.className };\n    }\n  },\n\n  addTo: function(reader) {\n    var self = this;\n    this._reader = reader;\n    var template = this.options.template;\n\n    var panelHTML = `<div class=\"cozy-modal modal-slide ${this.options.region || 'left'}\" id=\"modal-${this._id}\" aria-labelledby=\"modal-${this._id}-title\" role=\"dialog\" aria-describedby=\"modal-${this._id}-content\" aria-hidden=\"true\">\n      <div class=\"modal__overlay\" tabindex=\"-1\" data-modal-close>\n        <div class=\"modal__container ${this.options.className.container ? this.options.className.container : ''}\" role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"modal-${this._id}-title\" aria-describedby=\"modal-${this._id}-content\" id=\"modal-${this._id}-container\">\n          <div role=\"document\">\n            <header class=\"modal__header\">\n              <h3 class=\"modal__title\" id=\"modal-${this._id}-title\">${this.options.title}</h3>\n              <button class=\"modal__close\" aria-label=\"Close modal\" aria-controls=\"modal-${this._id}-container\" data-modal-close></button>\n            </header>\n            <main class=\"modal__content ${this.options.className.main ? this.options.className.main : ''}\" id=\"modal-${this._id}-content\">\n              ${template}\n            </main>`;\n\n    if ( this.options.actions ) {\n      panelHTML += '<footer class=\"modal__footer\">'\n      for(var i in this.options.actions) {\n        var action = this.options.actions[i];\n        var button_cls = action.className || 'button--default';\n        panelHTML += `<button id=\"action-${this._id}-${i}\" class=\"button button--lg ${button_cls}\">${action.label}</button>`;\n      }\n      panelHTML += '</footer>';\n    }\n\n    panelHTML += '</div></div></div></div>';\n\n    var body = new DOMParser().parseFromString(panelHTML, \"text/html\").body;\n\n    this.modal = reader._container.appendChild(body.children[0]);\n    this._container = this.modal; // compatibility\n\n    this.container = this.modal.querySelector('.modal__container');\n    this._bindEvents();\n    return this;\n  },\n\n  _bindEvents: function() {\n    var self = this;\n    this.onClick = this.onClick.bind(this);\n    this.onKeydown = this.onKeydown.bind(this);\n    this.onModalTransition = this.onModalTransition.bind(this);\n\n    this.modal.addEventListener('transitionend', function() {\n    }.bind(this));\n\n    // bind any actions\n    if ( this.actions ) {\n      for(var i in this.actions) {\n        let action = this.actions[i];\n        let button_id = '#action-' + this._id + '-' + i;\n        let button = this.modal.querySelector(button_id);\n        if ( button ) {\n          DomEvent.on(button, 'click', function(event) {\n            event.preventDefault();\n            action.callback(event);\n            if ( action.close ) {\n              self.closeModal();\n            }\n          })\n        }\n      }\n    }\n  },\n\n  deactivate: function() {\n    this.closeModal();\n  },\n\n  closeModal: function() {\n    var self = this;\n    this.modal.setAttribute('aria-hidden', 'true');\n    this.removeEventListeners();\n    if ( this.activeElement ) {\n      this.activeElement.focus();\n    }\n    this.callbacks.onClose(this.modal);\n  },\n\n  showModal: function() {\n    this.activeElement = document.activeElement\n    this._resize();\n    this.modal.setAttribute('aria-hidden', 'false')\n    this.setFocusToFirstNode()\n    this.addEventListeners()\n    this.callbacks.onShow(this.modal)\n  },\n\n  activate: function() {\n    return this.showModal();\n    var self = this;\n    activeModal = this;\n    DomUtil.addClass(self._reader._container, 'st-modal-activating');\n    this._resize();\n    DomUtil.addClass(this._reader._container, 'st-modal-open');\n    setTimeout(function() {\n      DomUtil.addClass(self._container, 'active');\n      DomUtil.removeClass(self._reader._container, 'st-modal-activating');\n      self._container.setAttribute('aria-hidden', 'false');\n      self.setFocusToFirstNode();\n    }, 25);\n  },\n\n  addEventListeners: function () {\n    // --- do we need touch listeners?\n    // this.modal.addEventListener('touchstart', this.onClick)\n    // this.modal.addEventListener('touchend', this.onClick)\n    this.modal.addEventListener('click', this.onClick)\n    document.addEventListener('keydown', this.onKeydown)\n    'webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend'.split(' ').forEach(function(event) {\n      this.modal.addEventListener(event, this.onModalTransition);\n    }.bind(this))\n  },\n\n  removeEventListeners: function () {\n    this.modal.removeEventListener('touchstart', this.onClick)\n    this.modal.removeEventListener('click', this.onClick)\n    'webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend'.split(' ').forEach(function(event) {\n      this.modal.removeEventListener(event, this.onModalTransition);\n    }.bind(this))\n    document.removeEventListener('keydown', this.onKeydown)\n  },\n\n  _resize: function() {\n    var container = this._reader._container;\n    this.container.style.height = container.offsetHeight + 'px';\n    console.log(\"AHOY MODAL\", this.container.style.height);\n    if ( ! this.options.className.container  ) {\n      this.container.style.width = this.options.width || parseInt(container.offsetWidth * this.options.fraction) + 'px';\n    }\n\n    var header = this.container.querySelector('header');\n    var footer = this.container.querySelector('footer');\n    var main = this.container.querySelector('main');\n    var height = this.container.clientHeight - header.clientHeight;\n    if ( footer ) {\n      height -= footer.clientHeight;\n    }\n    main.style.height = height + 'px';\n  },\n\n  getFocusableNodes: function() {\n    const nodes = this.modal.querySelectorAll(FOCUSABLE_ELEMENTS);\n    return Object.keys(nodes).map((key) => nodes[key]);\n  },\n\n  setFocusToFirstNode: function() {\n    var focusableNodes = this.getFocusableNodes();\n    if ( focusableNodes.length ) {\n      focusableNodes[0].focus();\n    } else {\n      activeModal._container.focus();\n    }\n  },\n\n  getActionableNodes: function() {\n    const nodes = this.modal.querySelectorAll(ACTIONABLE_ELEMENTS);\n    return Object.keys(nodes).map((key) => nodes[key]);\n  },\n\n  onKeydown: function(event) {\n    if ( event.keyCode == 27 ) { this.closeModal(); }\n    if ( event.keyCode == 9 ) {\n      this.maintainFocus(event);\n    }\n  },\n\n  onClick: function(event) {\n\n    var closeAfterAction = false;\n    var target = event.target;\n\n    // As far as I can tell, the code below isn't catching direct clicks on\n    // items with class='data-modal-close' as they're not ACTIONABLE_ELEMENTS.\n    // Adding them to ACTIONABLE_ELEMENTS causes undesirable behavior where\n    // their child items also close the modal thanks to the loop below.\n    // Children of .modal__overlay include the modal header, border area and\n    // padding. We don't want clicks on these closing the modal.\n    // Just close the modal now for direct clicks on a '.data-modal-close'.\n    if (target.hasAttribute('data-modal-close')) {\n      this.fire('closed');\n      this.closeModal();\n      return;\n    }\n\n    // if the target isn't an actionable type, walk the DOM until\n    // one is found\n    var actionableNodes = this.getActionableNodes();\n    while ( actionableNodes.indexOf(target) < 0 && target != this.modal ) {\n      target = target.parentElement;\n    }\n\n    // no target found, punt\n    if ( actionableNodes.indexOf(target) < 0 ) {\n      return;\n    }\n\n    if (this.handlers.click) {\n      var did_match = false;\n      for(var selector in this.handlers.click) {\n        if ( target.matches(selector) ) {\n          closeAfterAction = this.handlers.click[selector](this, target);\n          break;\n        }\n      }\n    }\n\n    if (closeAfterAction || target.hasAttribute('data-modal-close')) this.closeModal();\n\n    event.preventDefault();\n  },\n\n  onModalTransition: function(event) {\n    if ( this.modal.getAttribute('aria-hidden') == 'true' ) {\n      this._reader.fire('modal-closed');\n    } else {\n      this._reader.fire('modal-opened');\n    }\n  },\n\n  on: function(event, selector, handler) {\n    if (! this.handlers[event] ) {\n      this.handlers[event] = {};\n    }\n    if (typeof(selector) == 'function') {\n      handler = selector;\n      selector = '*';\n    }\n    this.handlers[event][selector] = handler;\n  },\n\n  fire: function(event) {\n    if ( this.handlers[event] && this.handlers[event]['*'] ) {\n      this.handlers[event]['*'](this);\n    }\n  },\n\n  maintainFocus: function(event) {\n    var focusableNodes = this.getFocusableNodes();\n    var focusedItemIndex = focusableNodes.indexOf(document.activeElement);\n    if (event.shiftKey && focusedItemIndex === 0) {\n      focusableNodes[focusableNodes.length - 1].focus()\n      event.preventDefault()\n    }\n\n    if (!event.shiftKey && focusedItemIndex === focusableNodes.length - 1) {\n      focusableNodes[0].focus()\n      event.preventDefault()\n    }\n  },\n\n  EOT: true\n});\n\nReader.include({\n  modal: function (options) {\n    var modal = new Modal(options);\n    return modal.addTo(this);\n    // return this;\n  },\n\n  EOT: true\n});\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport {Modal} from './Modal';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Contents = Control.extend({\n\n  defaultTemplate: `<button class=\"button--sm\" data-toggle=\"open\" aria-label=\"Table of Contents\"><i class=\"icon-menu oi\" data-glyph=\"menu\" title=\"Table of Contents\" aria-hidden=\"true\"></i></button>`,\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    this._control.setAttribute('id', 'action-' + this._id);\n    container.style.position = 'relative';\n\n    this._reader.on('updateContents', function(data) {\n\n      DomEvent.on(this._control, 'click', function(event) {\n        event.preventDefault();\n        self._reader.tracking.action('contents/open');\n        self._modal.activate();\n      }, this)\n\n      this._modal = this._reader.modal({\n        template: '<ul></ul>',\n        title: 'Contents',\n        region: 'left',\n        className: 'cozy-modal-contents'\n      });\n\n      this._modal.on('click', 'a[href]', function(modal, target) {\n        target = target.getAttribute('data-href');\n        this._reader.tracking.action('contents/go');\n        this._reader.gotoPage(target);\n        return true;\n      }.bind(this))\n\n      this._modal.on('closed', function() {\n        self._reader.tracking.action('contents/close');\n      })\n\n      this._setupSkipLink();\n\n      var parent = self._modal._container.querySelector('ul');\n      // var s = data.toc.filter(function(value) { return value.parent == null }).map(function(value) { return [ value, 0, parent ] });\n      // while ( s.length ) {\n      //   var tuple = s.shift();\n      //   var chapter = tuple[0];\n      //   var tabindex = tuple[1];\n      //   var parent = tuple[2];\n\n      //   var option = self._createOption(chapter, tabindex, parent);\n      //   data.toc.filter(function(value) { return value.parent == chapter.id }).reverse().forEach(function(chapter_) {\n      //     s.unshift([chapter_, tabindex + 1, option]);\n      //   });\n      // }\n      var _process = function(items, tabindex, parent) {\n        items.forEach(function(item) {\n          var option = self._createOption(item, tabindex, parent);\n          if ( item.subitems.length ) {\n            _process(item.subitems, tabindex + 1, option);\n          }\n        })\n      }\n      _process(data.toc, 0, parent);\n    }.bind(this))\n\n    return container;\n  },\n\n  _createOption(chapter, tabindex, parent) {\n\n    function pad(value, length) {\n        return (value.toString().length < length) ? pad(\"-\"+value, length):value;\n    }\n    var option = DomUtil.create('li');\n    if ( chapter.href ) {\n      var anchor = DomUtil.create('a', null, option);\n      anchor.textContent = chapter.label;\n      // var tab = pad('', tabindex); tab = tab.length ? tab + ' ' : '';\n      // option.textContent = tab + chapter.label;\n      anchor.setAttribute('href', chapter.href);\n      anchor.setAttribute('data-href', chapter.href);\n    } else {\n      var span = DomUtil.create('span', null, option);\n      span.textContent = chapter.label;\n    }\n\n    if ( parent.tagName == 'LI' ) {\n      // need to nest\n      var tmp = parent.querySelector('ul');\n      if ( ! tmp ) {\n        tmp = DomUtil.create('ul', null, parent);\n      }\n      parent = tmp;\n    }\n\n    parent.appendChild(option);\n    return option;\n  },\n\n  _setupSkipLink: function() {\n    if ( ! this.options.skipLink ) { return; }\n      \n    var target = document.querySelector(this.options.skipLink);\n    if ( ! target ) { return; }\n\n    var link = document.createElement('a');\n    link.textContent = 'Skip to contents';\n    link.setAttribute('href', '#action-' + this._id);\n\n    var ul = target.querySelector('ul');\n    if ( ul ) {\n      // add to list\n      target = document.createElement('li');\n      ul.appendChild(target);\n    }\n    target.appendChild(link);\n    link.addEventListener('click', function(event) {\n      event.preventDefault();\n      event.stopPropagation();\n      this._control.click();\n    }.bind(this))\n\n  },\n\n  EOT: true\n});\n\nexport var contents = function(options) {\n  return new Contents(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\n// Title + Chapter\n\nexport var Title = Control.extend({\n  onAdd: function(reader) {\n    var self = this;\n    var className = this._className(),\n        container = DomUtil.create('div', className),\n        options = this.options;\n\n    // var template = '<h1><span class=\"cozy-title\">Contents: </span><select size=\"1\" name=\"contents\"></select></label>';\n    // var control = new DOMParser().parseFromString(template, \"text/html\").body.firstChild;\n\n    var h1 = DomUtil.create('h1', 'cozy-h1', container);\n    DomUtil.setOpacity(h1, 0);\n    this._title = DomUtil.create('span', 'cozy-title', h1);\n    this._divider = DomUtil.create('span', 'cozy-divider', h1);\n    this._divider.textContent = \" · \";\n    this._section = DomUtil.create('span', 'cozy-section', h1);\n\n    // --- TODO: disable until we can work out how to \n    // --- more reliably match the current section to the contents\n    // this._reader.on('updateSection', function(data) {\n    //   if ( data && data.label ) {\n    //     self._section.textContent = data.label;\n    //     DomUtil.setOpacity(self._section, 1.0);\n    //     DomUtil.setOpacity(self._divider, 1.0);\n    //   } else {\n    //     DomUtil.setOpacity(self._section, 0);\n    //     DomUtil.setOpacity(self._divider, 0);\n    //   }\n    // })\n\n    this._reader.on('updateTitle', function(data) {\n      if ( data ) {\n        self._title.textContent = data.title || data.bookTitle;\n        DomUtil.setOpacity(self._section, 0);\n        DomUtil.setOpacity(self._divider, 0);\n        DomUtil.setOpacity(h1, 1);\n      }\n    })\n\n    return container;\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('a', className, container);\n    link.innerHTML = html;\n    link.href = '#';\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n    // DomEvent.on(link, 'click', this._refocusOnMap, this);\n\n    return link;\n  },\n\n  EOT: true\n});\n\nexport var title = function(options) {\n  return new Title(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\n// Title + Chapter\n\nexport var PublicationMetadata = Control.extend({\n  onAdd: function(reader) {\n    var self = this;\n    var className = this._className(),\n        container = DomUtil.create('div', className),\n        options = this.options;\n\n    // var template = '<h1><span class=\"cozy-title\">Contents: </span><select size=\"1\" name=\"contents\"></select></label>';\n    // var control = new DOMParser().parseFromString(template, \"text/html\").body.firstChild;\n\n    this._publisher = DomUtil.create('div', 'cozy-publisher', container);\n    this._rights = DomUtil.create('div', 'cozy-rights', container);\n\n    this._reader.on('updateTitle', function(data) {\n      if ( data ) {\n        self._publisher.textContent = data.publisher;\n        self._rights.textContent = data.rights;\n      }\n    })\n\n    return container;\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('a', className, container);\n    link.innerHTML = html;\n    link.href = '#';\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n    // DomEvent.on(link, 'click', this._refocusOnMap, this);\n\n    return link;\n  },\n\n  EOT: true\n});\n\nexport var publicationMetadata = function(options) {\n  return new PublicationMetadata(options);\n}\n","import {Class} from '../core/Class';\nimport {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\nimport * as Util from '../core/Util';\n\nimport assign from 'lodash/assign';\nimport keys from 'lodash/keys';\n\nexport var Preferences = Control.extend({\n  options: {\n    label: 'Preferences',\n    hasThemes: false,\n    html: '<i class=\"icon-cog oi\" data-glyph=\"cog\" title=\"Preferences and Settings\" aria-hidden=\"true\"></i>'\n  },\n\n  onAdd: function(reader) {\n    var self = this;\n    var className = this._className('preferences'),\n        container = DomUtil.create('div', className),\n        options = this.options;\n\n    this._activated = false;\n    this._control = this._createButton(options.html || options.label, options.label,\n            className, container, this._action)\n\n    // self.initializeForm();\n    this._modal = this._reader.modal({\n      // template: '<form></form>',\n      title: 'Preferences',\n      className: 'cozy-modal-preferences',\n      actions: [\n        {\n          label: 'Save Changes',\n          callback: function(event) {\n            self.updatePreferences(event);\n          }\n        }\n      ],\n      region: 'right'\n    });\n\n\n    return container;\n  },\n\n  _action: function() {\n    var self = this;\n    self.initializeForm();\n    self._modal.activate();\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('button', className, container);\n    link.innerHTML = html;\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n\n    return link;\n  },\n\n  _createPanel: function() {\n    var self = this;\n    if ( this._modal._container.querySelector('form') ) { return; }\n\n    var template = '';\n\n    var possible_fieldsets = [];\n    if ( this._reader.metadata.layout == 'pre-paginated' ) {\n      // different panel\n      possible_fieldsets.push('Scale');\n    } else {\n      possible_fieldsets.push('TextSize');\n    }\n    possible_fieldsets.push('Display');\n\n    if ( this._reader.rootfiles && this._reader.rootfiles.length > 1 ) {\n      // this.options.hasPackagePaths = true;\n      possible_fieldsets.push('Rendition');\n    }\n\n    if ( this._reader.options.themes && this._reader.options.themes.length > 0 ) {\n      this.options.hasThemes = true;\n      possible_fieldsets.push('Theme');\n    }\n\n    this._fieldsets = [];\n    possible_fieldsets.forEach(function(cls) {\n      var fieldset = new Preferences.fieldset[cls](this);\n      template += fieldset.template();\n      this._fieldsets.push(fieldset);\n    }.bind(this))\n\n    if ( this.options.fields ) {\n      this.options.hasFields = true;\n      for(var i in this.options.fields) {\n        var field = this.options.fields[i];\n        var id = \"preferences-custom-\" + i;\n        template += `<fieldset class=\"custom-field\">\n          <legend>${field.label}</legend>\n        `;\n        for(var j in field.inputs) {\n          var input = field.inputs[j];\n          var checked = input.value == field.value ? ' checked=\"checked\"' : '';\n          template += `<label><input id=\"preferences-custom-${i}-${j}\" type=\"radio\" name=\"x${field.name}\" value=\"${input.value}\" ${checked}/>${input.label}</label>`;\n        }\n        if ( field.hint ) {\n          template += `<p class=\"hint\" style=\"font-size: 90%\">${field.hint}</p>`;\n        }\n      }\n    }\n\n    template = '<form>' + template + '</form>';\n\n    // this._modal = this._reader.modal({\n    //   template: template,\n    //   title: 'Preferences',\n    //   className: 'cozy-modal-preferences',\n    //   actions: [\n    //     {\n    //       label: 'Save Changes',\n    //       callback: function(event) {\n    //         self.updatePreferences(event);\n    //       }\n    //     }\n    //   ],\n    //   region: 'right'\n    // });\n\n    this._modal._container.querySelector('main').innerHTML = template;\n    this._form = this._modal._container.querySelector('form');\n  },\n\n  initializeForm: function() {\n    this._createPanel();\n    this._fieldsets.forEach(function(fieldset) {\n      fieldset.initializeForm(this._form);\n    }.bind(this));\n  },\n\n  updatePreferences: function(event) {\n    event.preventDefault();\n\n    var doUpdate = false;\n    var new_options = {};\n    var saveable_options = {};\n    this._fieldsets.forEach(function(fieldset) {\n      // doUpdate = doUpdate || fieldset.updateForm(this._form, new_options);\n      // assign(new_options, fieldset.updateForm(this._form));\n      fieldset.updateForm(this._form, new_options, saveable_options);\n    }.bind(this));\n\n    if ( this.options.hasFields ) {\n      for(var i in this.options.fields) {\n        var field = this.options.fields[i];\n        var id = \"preferences-custom-\" + i;\n        var input = this._form.querySelector(`input[name=\"x${field.name}\"]:checked`);\n        if ( input.value != field.value ) {\n          field.value = input.value;\n          field.callback(field.value);\n        }\n      }\n    }\n\n    this._modal.deactivate();\n\n    setTimeout(function() {\n      this._reader.saveOptions(saveable_options);\n      this._reader.reopen(new_options);\n    }.bind(this), 100);\n  },\n\n  EOT: true\n});\n\nPreferences.fieldset = {};\n\nvar Fieldset = Class.extend({\n\n  options: {},\n\n  initialize: function (control, options) {\n      Util.setOptions(this, options);\n      this._control = control;\n      this._current = {};\n      this._id = (new Date()).getTime() + '-' + parseInt(Math.random((new Date()).getTime()) * 1000, 10);\n  },\n\n  template: function() {\n\n  },\n\n  EOT: true\n\n\n});\n\nPreferences.fieldset.TextSize = Fieldset.extend({\n\n  initializeForm: function(form) {\n    if ( ! this._input ) {\n      this._input = form.querySelector(`#x${this._id}-input`);\n      this._output = form.querySelector(`#x${this._id}-output`);\n      this._preview = form.querySelector(`#x${this._id}-preview`);\n      this._actionReset = form.querySelector(`#x${this._id}-reset`);\n\n      this._input.addEventListener('input', this._updatePreview.bind(this));\n      this._input.addEventListener('change', this._updatePreview.bind(this));\n\n      this._actionReset.addEventListener('click', function(event) {\n        event.preventDefault();\n        this._input.value = 100;\n        this._updatePreview();\n      }.bind(this));\n    }\n\n    var text_size = this._control._reader.options.text_size || 100;\n    if ( text_size == 'auto' ) { text_size = 100; }\n    this._current.text_size = text_size;\n    this._input.value = text_size;\n    this._updatePreview();\n  },\n\n  updateForm: function(form, options, saveable) {\n    // return { text_size: this._input.value };\n    options.text_size = saveable.text_size = this._input.value;\n    // options.text_size = this._input.value;\n    // return ( this._input.value != this._current.text_size );\n  },\n\n  template: function() {\n    return `<fieldset class=\"cozy-fieldset-text_size\">\n        <legend>Text Size</legend>\n        <div class=\"preview--text_size\" id=\"x${this._id}-preview\">\n          ‘Yes, that’s it,’ said the Hatter with a sigh: ‘it’s always tea-time, and we’ve no time to wash the things between whiles.’\n        </div>\n        <p style=\"white-space: no-wrap\">\n          <span>T-</span>\n          <input name=\"text_size\" type=\"range\" id=\"x${this._id}-input\" value=\"100\" min=\"50\" max=\"400\" step=\"10\" style=\"width: 75%; display: inline-block\" />\n          <span>T+</span>\n        </p>\n        <p>\n          <span>Text Size: </span>\n          <output for=\"preferences-input-text_size\" id=\"x${this._id}-output\">100</output>\n          <button id=\"x${this._id}-reset\" class=\"reset button--inline\" style=\"margin-left: 8px\">Reset</button> \n        </p>\n      </fieldset>`;\n  },\n\n  _updatePreview: function() {\n    this._preview.style.fontSize = `${( parseInt(this._input.value, 10) / 100 )}em`;\n    this._output.value = `${this._input.value}%`;\n  },\n\n  EOT: true\n\n});\n\nPreferences.fieldset.Display = Fieldset.extend({\n\n  initializeForm: function(form) {\n    var flow = this._control._reader.options.flow || this._control._reader.metadata.flow || 'auto';\n    // if ( flow == 'auto' ) { flow = 'paginated'; }\n\n    var input = form.querySelector(`#x${this._id}-input-${flow}`);\n    input.checked = true;\n    this._current.flow = flow;\n\n  },\n\n  updateForm: function(form, options, saveable) {\n    var input = form.querySelector(`input[name=\"x${this._id}-flow\"]:checked`);\n    options.flow = input.value;\n    if ( options.flow != 'auto' ) {\n      saveable.flow = options.flow;\n    }\n    // if ( input.value == 'auto' ) {\n    //   // we do NOT want to save flow as a preference\n    //   return {};\n    // }\n    // return { flow: input.value };\n  },\n\n  template: function() {\n    var scrolled_help = '';\n    if ( this._control._reader.metadata.layout != 'pre-paginated' ) {\n      scrolled_help = \"<br /><small>This is an experimental feature that may cause display and loading issues for the book when enabled.</small>\";\n    }\n    return `<fieldset>\n            <legend>Display</legend>\n            <label><input name=\"x${this._id}-flow\" type=\"radio\" id=\"x${this._id}-input-auto\" value=\"auto\" /> Auto<br /><small>Let the reader determine display mode based on your browser dimensions and the type of content you're reading</small></label>\n            <label><input name=\"x${this._id}-flow\" type=\"radio\" id=\"x${this._id}-input-paginated\" value=\"paginated\" /> Page-by-Page</label>\n            <label><input name=\"x${this._id}-flow\" type=\"radio\" id=\"x${this._id}-input-scrolled-doc\" value=\"scrolled-doc\" /> Scroll${scrolled_help}</label>\n          </fieldset>`;\n  },\n\n  EOT: true\n\n});\n\nPreferences.fieldset.Theme = Fieldset.extend({\n\n  initializeForm: function(form) {\n    var theme = this._control._reader.options.theme || 'default';\n\n    var input = form.querySelector(`#x${this._id}-input-theme-${theme}`);\n    input.checked = true;\n    this._current.theme = theme;\n  },\n\n  updateForm: function(form, options, saveable) {\n    var input = form.querySelector(`input[name=\"x${this._id}-theme\"]:checked`);\n    options.theme = saveable.theme = input.value;\n    // return { theme: input.value };\n  },\n\n  template: function() {\n    var template = `<fieldset>\n            <legend>Theme</legend>\n            <label><input name=\"x${this._id}-theme\" type=\"radio\" id=\"x${this._id}-input-theme-default\" value=\"default\" />Default</label>`;\n\n    this._control._reader.options.themes.forEach(function(theme) {\n      template += `<label><input name=\"x${this._id}-theme\" type=\"radio\" id=\"x${this._id}-input-theme-${theme.klass}\" value=\"${theme.klass}\" />${theme.name}</label>`\n    }.bind(this));\n\n    template += '</fieldset>';\n\n    return template;\n\n  },\n\n  EOT: true\n\n});\n\nPreferences.fieldset.Rendition = Fieldset.extend({\n\n  initializeForm: function(form) {\n    var rootfiles = this._control._reader.rootfiles;\n    var rootfilePath = this._control._reader.options.rootfilePath;\n    var expr = rootfilePath ? `[value=\"${rootfilePath}\"]` : \":first-child\";\n    var input = form.querySelector(`input[name=\"x${this._id}-rootfilePath\"]${expr}`);\n    input.checked = true;\n    this._current.rootfilePath = rootfilePath || rootfiles[0].rootfilePath;\n  },\n\n  updateForm: function(form, options, saveable) {\n    var input = form.querySelector(`input[name=\"x${this._id}-rootfilePath\"]:checked`);\n    if ( input.value != this._current.rootfilePath ) {\n      options.rootfilePath = input.value;\n      this._current.rootfilePath = input.value;\n    }\n  },\n\n  template: function() {\n    var template = `<fieldset>\n            <legend>Rendition</legend>\n    `;\n\n    this._control._reader.rootfiles.forEach(function(rootfile, i) {\n      template += `<label><input name=\"x${this._id}-rootfilePath\" type=\"radio\" id=\"x${this._id}-input-rootfilePath-${i}\" value=\"${rootfile.rootfilePath}\" />${rootfile.label || rootfile.accessMode || rootfile.rootfilePath}</label>`;\n    }.bind(this))\n\n    template += '</fieldset>';\n\n    return template;\n\n  },\n\n  EOT: true\n\n});\n\nPreferences.fieldset.Scale = Fieldset.extend({\n\n  initializeForm: function(form) {\n    if ( ! this._input ) {\n      this._input = form.querySelector(`#x${this._id}-input`);\n      this._output = form.querySelector(`#x${this._id}-output`);\n      this._preview = form.querySelector(`#x${this._id}-preview > div`);\n      this._actionReset = form.querySelector(`#x${this._id}-reset`);\n\n      this._input.addEventListener('input', this._updatePreview.bind(this));\n      this._input.addEventListener('change', this._updatePreview.bind(this));\n\n      this._actionReset.addEventListener('click', function(event) {\n        event.preventDefault();\n        this._input.value = 100;\n        this._updatePreview();\n      }.bind(this));\n    }\n\n    var scale = this._control._reader.options.scale || 100;\n    if ( ! scale ) { scale = 100; }\n    this._current.scale = scale;\n    this._input.value = scale;\n    this._updatePreview();\n  },\n\n  updateForm: function(form, options, saveable) {\n    // return { text_size: this._input.value };\n    options.scale = saveable.scale = this._input.value;\n    // options.text_size = this._input.value;\n    // return ( this._input.value != this._current.text_size );\n  },\n\n  template: function() {\n    return `<fieldset class=\"cozy-fieldset-text_size\">\n        <legend>Zoom In/Out</legend>\n        <div class=\"preview--scale\" id=\"x${this._id}-preview\" style=\"overflow: hidden; height: 5rem\">\n          <div>\n            ‘Yes, that’s it,’ said the Hatter with a sigh: ‘it’s always tea-time, and we’ve no time to wash the things between whiles.’\n          </div>\n        </div>\n        <p style=\"white-space: no-wrap\">\n          <span style=\"font-size: 150%\">⊖<span class=\"u-screenreader\"> Zoom Out</span></span>\n          <input name=\"scale\" type=\"range\" id=\"x${this._id}-input\" value=\"100\" min=\"50\" max=\"400\" step=\"10\" style=\"width: 75%; display: inline-block\" />\n          <span style=\"font-size: 150%\">⊕<span class=\"u-screenreader\">Zoom In </span></span>\n        </p>\n        <p>\n          <span>Scale: </span>\n          <output for=\"preferences-input-text_size\" id=\"x${this._id}-output\">100</output>\n          <button id=\"x${this._id}-reset\" class=\"reset button--inline\" style=\"margin-left: 8px\">Reset</button> \n        </p>\n      </fieldset>`;\n  },\n\n  _updatePreview: function() {\n    this._preview.style.transform = `scale(${( parseInt(this._input.value, 10) / 100 )}) translate(0,0)`;\n    this._output.value = `${this._input.value}%`;\n  },\n\n  EOT: true\n\n});\n\nexport var preferences = function(options) {\n  return new Preferences(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Widget = Control.extend({\n\n\n  options: {\n      // @option region: String = 'topright'\n      // The region of the control (one of the reader corners). Possible values are `'topleft'`,\n      // `'topright'`, `'bottomleft'` or `'bottomright'`\n  },\n\n  onAdd: function(reader) {\n    var container = this._container;\n    if ( container ) {\n      // NOOP\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n\n    }\n\n    this._onAddExtra(container);\n    this._updateTemplate(container);\n    this._updateClass(container);\n    this._bindEvents(container);\n\n    return container;\n  },\n\n  _updateTemplate: function(container) {\n    var data = this.data();\n    for(var slot in data) {\n      if ( data.hasOwnProperty(slot) ) {\n        var value = data[slot];\n        if ( typeof(value) == \"function\" ) { value = value(); }\n        var node = container.querySelector(`[data-slot=${slot}]`);\n        if ( node ) {\n          if ( node.hasAttribute('value') ) {\n            node.setAttribute('value', value);\n          } else {\n            node.innerHTML = value;\n          }\n        }\n      }\n    }\n  },\n\n  _updateClass: function(container) {\n    if ( this.options.className ) {\n      DomUtil.addClass(container, this.options.className);\n    }\n  },\n\n  _onAddExtra: function() { },\n\n  _bindEvents: function(container) {\n    var control = container.querySelector(\"[data-toggle=button]\");\n    if ( ! control ) { return ; }\n    DomEvent.disableClickPropagation(control);\n    DomEvent.on(control, 'click', DomEvent.stop);\n    DomEvent.on(control, 'click', this._action, this);\n  },\n\n  _action: function() {\n  },\n\n  data: function() {\n    return this.options.data || {};\n  },\n\n  EOT: true\n});\n\nWidget.Button = Widget.extend({\n  defaultTemplate: `<button data-toggle=\"button\" data-slot=\"label\"></button>`,\n\n  _action: function() {\n    this.options.onClick(this, this._reader);\n  },\n\n  EOT: true\n});\n\nWidget.Panel = Widget.extend({\n  defaultTemplate: `<div><span data-slot=\"text\"></span></div>`,\n\n\n  EOT: true\n});\n\nWidget.Toggle = Widget.extend({\n  defaultTemplate: `<button data-toggle=\"button\" data-slot=\"label\"></button>`,\n\n  _onAddExtra: function(container) {\n    this.state(this.options.states[0].stateName, container);\n\n    return container;\n  },\n\n  state: function(stateName, container) {\n    container = container || this._container;\n    this._resetState(container);\n    this._state = this.options.states.filter(function(s) { return s.stateName == stateName })[0];\n    this._updateClass(container);\n    this._updateTemplate(container);\n  },\n\n  _resetState: function(container) {\n    if ( ! this._state ) { return; }\n    if ( this._state.className ) {\n      DomUtil.removeClass(container, this._state.className);\n    }\n  },\n\n  _updateClass: function(container) {\n    if ( this._state.className ) {\n      DomUtil.addClass(container, this._state.className);\n    }\n  },\n\n  _action: function() {\n    this._state.onClick(this, this._reader);\n  },\n\n  data: function() {\n    return this._state.data || {};\n  },\n\n  EOT: true\n});\n\n// export var widget = function(options) {\n//   return new Widget(options);\n// }\n\nexport var widget = {\n  button: function(options) { return new Widget.Button(options); },\n  panel: function(options) { return new Widget.Panel(options); },\n  toggle: function(options) { return new Widget.Toggle(options); }\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Citation = Control.extend({\n  options: {\n    label: 'Citation',\n    html: '<span>Get Citation</span>'\n  },\n\n  defaultTemplate: `<button class=\"button--sm cozy-citation\" data-toggle=\"open\">Get Citation</button>`,\n\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._reader.on('updateContents', function(data) {\n      self._createPanel();\n    });\n\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n      self._modal.activate();\n    }, this)\n\n    return container;\n  },\n\n  _action: function() {\n    var self = this;\n    self._modal.activate();\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('button', className, container);\n    link.innerHTML = html;\n    link.title = title;\n\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n\n    return link;\n  },\n\n  _createPanel: function() {\n    var self = this;\n\n    var template = `<form>\n      <fieldset>\n        <legend>Select Citation Format</legend>\n      </fieldset>\n    </form>\n    <blockquote id=\"formatted\" style=\"padding: 8px; border-left: 4px solid black; background-color: #fff\"></blockquote>\n    <div class=\"alert alert-info\" id=\"message\" style=\"display: none\"></div>`;\n\n    this._modal = this._reader.modal({\n      template: template,\n      title: 'Copy Citation to Clipboard',\n      className: 'cozy-modal-citatation',\n      actions: [\n        {\n          label: 'Copy Citation',\n          callback: function(event) {\n            document.designMode = \"on\";\n            var formatted = self._modal._container.querySelector(\"#formatted\");\n\n            var range = document.createRange();\n            range.selectNode(formatted);\n            var sel = window.getSelection();\n            sel.removeAllRanges();\n            sel.addRange(range);\n\n            // formatted.select();\n\n            try {\n              var flag = document.execCommand('copy');\n            } catch(err) {\n              console.log(\"AHOY COPY FAILED\", err);\n            }\n\n            self._message.innerHTML = 'Success! Citation copied to your clipboard.';\n            self._message.style.display = 'block';\n            sel.removeAllRanges();\n            range.detach();\n            document.designMode = \"off\";\n          }\n        }\n      ],\n      region: 'left',\n      fraction: 1.0\n    });\n\n    this._form = this._modal._container.querySelector('form');\n    var fieldset = this._form.querySelector('fieldset');\n\n    var citations = this.options.citations || this._reader.metadata.citations;\n\n    citations.forEach(function(citation, index) {\n      var label = DomUtil.create('label', null, fieldset);\n      var input = DomUtil.create('input', null, label);\n      input.setAttribute('name', 'format');\n      input.setAttribute('value', citation.format);\n      input.setAttribute('type', 'radio');\n      if ( index == 0 ) {\n        input.setAttribute('checked', 'checked');\n      }\n      var text = document.createTextNode(\" \" + citation.format);\n      label.appendChild(text);\n      input.setAttribute('data-text', citation.text);\n    });\n\n    this._formatted = this._modal._container.querySelector(\"#formatted\");\n    this._message = this._modal._container.querySelector(\"#message\");\n    DomEvent.on(this._form, 'change', function(event) {\n      var target = event.target;\n      if ( target.tagName == 'INPUT' ) {\n        this._initializeForm();\n      }\n    }, this);\n\n    this._initializeForm();\n  },\n\n  _initializeForm: function() {\n    var formatted = this._formatCitation();\n    this._formatted.innerHTML = formatted;\n    this._message.style.display = 'none';\n    this._message.innerHTML = '';\n  },\n\n  _formatCitation: function(format) {\n    if ( format == null ) {\n      var selected = this._form.querySelector(\"input:checked\");\n      format = selected.value;\n    }\n    var selected = this._form.querySelector(\"input[value=\" + format + \"]\");\n    return selected.getAttribute('data-text');\n    // return selected.dataset.text;\n  },\n\n  EOT: true\n});\n\nexport var citation = function(options) {\n  return new Citation(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Search = Control.extend({\n  options: {\n    label: 'Search',\n    html: '<span>Search</span>'\n  },\n\n  defaultTemplate: `<form class=\"search\">\n    <label class=\"u-screenreader\" for=\"cozy-search-string\">Search in this text</label>\n    <input id=\"cozy-search-string\" name=\"search\" type=\"text\" placeholder=\"Search in this text...\"/>\n    <button class=\"button--sm\" data-toggle=\"open\" aria-label=\"Search\"><i class=\"icon-magnifying-glass oi\" data-glyph=\"magnifying-glass\" title=\"Search\" aria-hidden=\"true\"></i></button>\n  </form>`,\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    container.style.position = 'relative';\n\n    this._data = null;\n    this._canceled = false;\n    this._processing = false;\n\n    this._reader.on('ready', function() {\n\n      this._modal = this._reader.modal({\n        template: '<article></article>',\n        title: 'Search Results',\n        className: { container: 'cozy-modal-search' },\n        region: 'left',\n      });\n\n      this._modal.callbacks.onClose = function() {\n        if ( self._processing ) {\n          self._canceled = true;\n        }\n      };\n\n      this._article = this._modal._container.querySelector('article');\n\n      this._modal.on('click', 'a[href]', function(modal, target) {\n        target = target.getAttribute('href');\n        this._reader.tracking.action('search/go');\n        this._reader.gotoPage(target);\n        return true;\n      }.bind(this));\n\n      this._modal.on('closed', function() {\n        this._reader.tracking.action('contents/close');\n      }.bind(this))\n\n    }.bind(this));\n\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n\n      var searchString = this._container.querySelector(\"#cozy-search-string\").value;\n      searchString = searchString.replace(/^\\s*/, '').replace(/\\s*$/, '');\n\n      if ( ! searchString ) {\n        // just punt\n        return;\n      }\n\n      if ( searchString == this.searchString ) {\n        // cached results\n        self.openModalResults();\n      } else {\n        this.searchString = searchString;\n        self.openModalWaiting();\n        self.submitQuery();\n      }\n    }, this);\n\n    return container;\n  },\n\n  openModalWaiting: function() {\n    this._processing = true;\n    this._emptyArticle();\n    var value = this.searchString;\n    this._article.innerHTML = '<p>Submitting query for <em>' + value + '</em>...</p>' + this._reader.loaderTemplate();\n    this._modal.activate();\n  },\n\n  openModalResults: function() {\n    if ( this._canceled ) {\n      this._canceled = false;\n      return;\n    }\n    this._buildResults();\n    this._modal.activate();\n    this._reader.tracking.action(\"search/open\");\n  },\n\n  submitQuery: function() {\n    var self = this;\n\n    var url = this.options.searchUrl + this.searchString;\n\n    var request = new XMLHttpRequest();\n    request.open('GET', url, true);\n\n    request.onload = function() {\n      if (this.status >= 200 && this.status < 400) {\n        // Success!\n        var data = JSON.parse(this.response);\n        console.log(\"SEARCH DATA\", data);\n\n        self._data = data;\n\n      } else {\n        // We reached our target server, but it returned an error\n\n        self._data = null;\n        console.log(this.response);\n      }\n\n      self._reader.tracking.action(\"search/submitQuery\");\n      self.openModalResults();\n\n    };\n\n    request.onerror = function() {\n      // There was a connection error of some sort\n      self._data = null;\n      self.openModalResults();\n    };\n\n    request.send();\n\n  },\n\n  _emptyArticle: function() {\n    while (this._article && this._article.hasChildNodes()) {\n      this._article.removeChild(this._article.lastChild);\n    }\n  },\n\n  _buildResults: function() {\n    var self = this;\n    var content;\n\n    this._processing = false;\n\n    self._emptyArticle();\n\n    var reader = this._reader;\n    reader.annotations.reset();\n\n    if ( this._data ) {\n      var highlight = true\n      if (this._data.highlight_off == \"yes\") {\n        highlight = false;\n      }\n      if ( this._data.search_results.length ) {\n        content = DomUtil.create('ul');\n\n        this._data.search_results.forEach(function(result) {\n          var option = DomUtil.create('li');\n          var anchor = DomUtil.create('a', null, option);\n          var cfiRange = \"epubcfi(\" + result.cfi + \")\";\n\n          if (result.snippet) {\n            if (result.title) {\n              var chapterTitle = DomUtil.create('i');\n              chapterTitle.textContent = result.title + \": \";\n              anchor.appendChild(chapterTitle);\n            }\n            anchor.appendChild(document.createTextNode(result.snippet));\n\n            anchor.setAttribute(\"href\", cfiRange);\n            content.appendChild(option);\n          }\n          if (highlight) {\n            reader.annotations.highlight(cfiRange);\n          }\n        });\n      } else {\n        content = DomUtil.create(\"p\")\n        content.textContent = 'No results found for \"' + self.searchString + '\"';\n      }\n    } else {\n      content = DomUtil.create(\"p\")\n      content.textContent = 'There was a problem processing this query.';\n    }\n\n    self._article.appendChild(content);\n  },\n\n  EOT: true\n});\n\nexport var search = function(options) {\n  return new Search(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\n// Title + Chapter\n\nexport var BibliographicInformation = Control.extend({\n  options: {\n    label: 'Info',\n    direction: 'left',\n    html: '<span class=\"oi\" data-glyph=\"info\">Info</span>'\n  },\n\n  defaultTemplate: `<button class=\"button--sm cozy-bib-info oi\" data-glyph=\"info\" data-toggle=\"open\" aria-label=\"Bibliographic Information\"> Info</button>`,\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._reader.on('updateContents', function(data) {\n      self._createPanel();\n    });\n\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n      self._modal.activate();\n    }, this)\n\n    return container;\n  },\n\n  _createPanel: function() {\n    var self = this;\n\n    var template = `<dl>\n    </dl>`;\n\n    this._modal = this._reader.modal({\n      template: template,\n      title: 'Info',\n      region: 'left',\n      fraction: 1.0\n    });\n\n    var dl = this._modal._container.querySelector('dl');\n\n    var metadata_fields = [\n      [ 'title', 'Title' ],\n      [ 'creator', 'Author' ],\n      [ 'pubdate', 'Publication Date' ],\n      [ 'modified_date', 'Modified Date' ],\n      [ 'publisher', 'Publisher' ],\n      [ 'rights', 'Rights' ],\n      [ 'doi', 'DOI' ],\n      [ 'description', 'Description' ],\n    ];\n\n    var metadata_fields_seen = {};\n\n    var metadata = this._reader.metadata;\n\n    for(var idx in metadata_fields) {\n      var key = metadata_fields[idx][0];\n      var label = metadata_fields[idx][1];\n      if ( metadata[key] ) {\n        var value = metadata[key];\n        if ( key == 'pubdate' || key == 'modified_date' ) {\n          value = this._formatDate(value);\n          if ( ! value ) { continue; }\n          // value = d.toISOString().slice(0,10); // for YYYY-MM-DD\n        }\n        metadata_fields_seen[key] = true;\n        var dt = DomUtil.create('dt', 'cozy-bib-info-label', dl);\n        dt.innerHTML = label;\n        var dd = DomUtil.create('dd', 'cozy-bib-info-value cozy-bib-info-value-' + key, dl);\n        dd.innerHTML = value;\n      }\n    }\n\n  },\n\n  _formatDate: function(value) {\n    var match = value.match(/\\d{4}/);\n    if ( match ) {\n      return match[0];\n    }\n    return null;\n  },\n\n  EOT: true\n});\n\nexport var bibliographicInformation = function(options) {\n  return new BibliographicInformation(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Download = Control.extend({\n  options: {\n    label: 'Download Book',\n    html: '<span>Download Book</span>'\n  },\n\n  defaultTemplate: `<button class=\"button--sm cozy-download oi\" data-toggle=\"open\" data-glyph=\"data-transfer-download\"> Download Book</button>`,\n\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._reader.on('updateContents', function(data) {\n      self._createPanel();\n    });\n\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n      self._modal.activate();\n    }, this)\n\n    return container;\n  },\n\n  _createPanel: function() {\n    var self = this;\n\n    var template = `<form>\n      <fieldset>\n        <legend>Choose File Format</legend>\n      </fieldset>\n    </form>`;\n\n    this._modal = this._reader.modal({\n      template: template,\n      title: 'Download Book',\n      className: 'cozy-modal-download',\n      actions: [\n        {\n          label: 'Download',\n          callback: function(event) {\n            var selected = self._form.querySelector(\"input:checked\");\n            var href = selected.getAttribute('data-href');\n            self._configureDownloadForm(href);\n            self._form.submit();\n          }\n        }\n      ],\n      region: 'left',\n      fraction: 1.0\n    });\n\n    this._form = this._modal._container.querySelector('form');    \n    var fieldset = this._form.querySelector('fieldset');\n    this._reader.options.download_links.forEach(function(link, index) {\n      var label = DomUtil.create('label', null, fieldset);\n      var input = DomUtil.create('input', null, label);\n      input.setAttribute('name', 'format');\n      input.setAttribute('value', link.format);\n      input.setAttribute('data-href', link.href);\n      input.setAttribute('type', 'radio');\n      if ( index == 0 ) {\n        input.setAttribute('checked', 'checked');\n      }\n      var text = link.format;\n      if ( link.size ) {\n        text += \" (\" + link.size + \")\";\n      }\n      var text = document.createTextNode(\" \" + text);\n      label.appendChild(text);\n    });\n\n  },\n\n  _configureDownloadForm: function(href) {\n    var self = this;\n    self._form.setAttribute('method', 'GET');\n    self._form.setAttribute('action', href);\n    self._form.setAttribute('target', '_blank');\n  },\n\n\n  EOT: true\n});\n\nexport var download = function(options) {\n  return new Download(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Navigator = Control.extend({\n  onAdd: function(reader) {\n    var container = this._container;\n    if ( container ) {\n    } else {\n\n      var className = this._className('navigator'),\n          options = this.options;\n      \n      container = DomUtil.create('div', className);\n    }\n    this._setup(container);\n\n    this._reader.on('updateLocations', function(locations) {      \n      // if ( ! this._reader.currentLocation() || ! this._reader.currentLocation().start ) {\n      //   console.log(\"AHOY updateLocations NO START\", this._reader.currentLocation().then);\n      //   setTimeout(function() {\n      //     this._initializeNavigator(locations);\n      //   }.bind(this), 100);\n      //   return;\n      // }\n      this._initializeNavigator(locations);\n    }.bind(this));\n\n    return container;\n  },\n\n  _setup: function(container) {\n    this._control = container.querySelector(\"input[type=range]\");\n    if ( ! this._control ) {\n      this._createControl(container);\n    }\n    this._background = container.querySelector(\".cozy-navigator-range__background\");\n    this._status = container.querySelector(\".cozy-navigator-range__status\");\n    this._spanCurrentPercentage = container.querySelector(\".currentPercentage\");\n    this._spanCurrentLocation = container.querySelector(\".currentLocation\");\n    this._spanTotalLocations = container.querySelector(\".totalLocations\");\n\n    this._bindEvents();\n  },\n\n  _createControl: function (container) {\n    var template = `<div class=\"cozy-navigator-range\">\n        <label class=\"u-screenreader\" for=\"cozy-navigator-range-input\">Location: </label>\n        <input class=\"cozy-navigator-range__input\" id=\"cozy-navigator-range-input\" type=\"range\" name=\"locations-range-value\" min=\"0\" max=\"100\" aria-valuemin=\"0\" aria-valuemax=\"100\" aria-valuenow=\"0\" aria-valuetext=\"0% • Location 0 of ?\" value=\"0\" data-background-position=\"0\" />\n        <div class=\"cozy-navigator-range__background\"></div>\n      </div>\n      <div class=\"cozy-navigator-range__status\"><span class=\"currentPercentage\">0%</span> • Location <span class=\"currentLocation\">0</span> of <span class=\"totalLocations\">?</span></div>\n    `;\n\n    var body = new DOMParser().parseFromString(template, \"text/html\").body;\n    while ( body.children.length ) {\n      container.appendChild(body.children[0]);\n    }\n\n    this._control = container.querySelector(\"input[type=range]\");\n  },\n\n  _bindEvents: function() {\n    var self = this;\n\n    this._control.addEventListener(\"input\", function() {\n      self._update();\n    }, false);\n    this._control.addEventListener(\"change\", function() { self._action(); }, false);\n    this._control.addEventListener(\"mousedown\", function(){\n        self._mouseDown = true;\n    }, false);\n    this._control.addEventListener(\"mouseup\", function(){\n        self._mouseDown = false;\n    }, false);\n    this._control.addEventListener(\"keydown\", function(){\n      self._mouseDown = true;\n    }, false);\n    this._control.addEventListener(\"keyup\", function(){\n      self._mouseDown = false;\n    }, false);\n\n    this._reader.on('relocated', function(location) {\n      if ( ! self._initiated ) { return; }\n      if ( ! self._mouseDown ) {\n        self._control.value = Math.ceil(self._reader.locations.percentageFromCfi(self._reader.currentLocation().start.cfi) * 100);\n        self._update();\n      }\n    })\n\n  },\n\n  _action: function() {\n    var value = this._control.value;\n    var locations = this._reader.locations;\n    var cfi = locations.cfiFromPercentage(value / 100);\n    this._reader.tracking.action(\"navigator/go\");\n    this._reader.gotoPage(cfi);\n  },\n\n  _update: function() {\n    var self = this;\n\n    var current = this._reader.currentLocation();\n    if ( ! current || ! current.start ) {\n      setTimeout(function() {\n        this._update();\n      }.bind(this), 100);\n    }\n\n    var rangeBg = this._background;\n    var range = self._control;\n\n    var value = parseInt(range.value, 10);\n    var percentage = value;\n\n    rangeBg.setAttribute('style', 'background-position: ' + (-percentage) + '% 0%, left top;');\n    self._control.setAttribute('data-background-position', Math.ceil(percentage));\n\n    this._spanCurrentPercentage.innerHTML = percentage + '%';\n    if ( current && current.start ) {\n      var current_location = this._reader.locations.locationFromCfi(current.start.cfi);\n      this._spanCurrentLocation.innerHTML = ( current_location );\n    }\n    self._last_delta = self._last_value > value; self._last_value = value;\n  },\n\n  _initializeNavigator: function(locations) {\n    console.log(\"AHOY updateLocations PROCESSING LOCATION\");\n    this._initiated = true;\n    this._total = this._reader.locations.total;\n    if ( this._reader.currentLocation() && this._reader.currentLocation().start ) {\n      this._control.value = Math.ceil(this._reader.locations.percentageFromCfi(this._reader.currentLocation().start.cfi) * 100);\n      this._last_value = this._control.value;\n    } else {\n      this._last_value = this._control.value;\n    }\n\n    this._spanTotalLocations.innerHTML = this._total;\n\n    this._update();\n    setTimeout(function() {\n      DomUtil.addClass(this._container, 'initialized');\n    }.bind(this), 0);\n  },\n\n  EOT: true\n});\n\nexport var navigator = function(options) {\n  return new Navigator(options);\n}\n","import {Control, control} from './Control';\nimport {PageNext, PagePrevious, pageNext, pagePrevious, PageFirst, pageFirst, PageLast, pageLast} from './Control.Paging';\nimport {Contents, contents} from './Control.Contents';\nimport {Title, title} from './Control.Title';\nimport {PublicationMetadata, publicationMetadata} from './Control.PublicationMetadata';\nimport {Preferences, preferences} from './Control.Preferences';\nimport {Widget, widget} from './Control.Widget';\nimport {Citation, citation} from './Control.Citation';\nimport {Search, search} from './Control.Search';\nimport {BibliographicInformation, bibliographicInformation} from './Control.BibliographicInformation';\nimport {Download, download} from './Control.Download';\nimport {Navigator, navigator} from './Control.Navigator';\n\n// import {Zoom, zoom} from './Control.Zoom';\n// import {Attribution, attribution} from './Control.Attribution';\n\nControl.PageNext = PageNext;\nControl.PagePrevious = PagePrevious;\nControl.PageFirst = PageFirst;\nControl.PageLast = PageLast;\ncontrol.pagePrevious = pagePrevious;\ncontrol.pageNext = pageNext;\ncontrol.pageFirst = pageFirst;\ncontrol.pageLast = pageLast;\n\nControl.Contents = Contents;\ncontrol.contents = contents;\n\nControl.Title = Title;\ncontrol.title = title;\n\nControl.PublicationMetadata = PublicationMetadata;\ncontrol.publicationMetadata = publicationMetadata;\n\nControl.Preferences = Preferences;\ncontrol.preferences = preferences;\n\nControl.Widget = Widget;\ncontrol.widget = widget;\n\nControl.Citation = Citation;\ncontrol.citation = citation;\n\nControl.Search = Search;\ncontrol.search = search;\n\nControl.BibliographicInformation = BibliographicInformation;\ncontrol.bibliographicInformation = bibliographicInformation;\n\nControl.Download = Download;\ncontrol.download = download;\n\nControl.Navigator = Navigator;\ncontrol.navigator = navigator;\n\nexport {Control, control};\n","import {Evented} from './Events';\n\nvar Bus = Evented.extend({\n});\n\nvar instance;\nexport var bus = function() {\n  return instance || ( instance = new Bus() );\n}\n","import * as Browser from './Browser';\nexport {Browser};\n\nexport {Class} from './Class';\n\nimport {Evented} from './Events';\nexport {Evented};\nexport var Mixin = {Events: Evented.prototype};\n\nimport * as Util from './Util';\nexport {Util};\nexport {extend, bind, stamp, setOptions} from './Util';\nexport {bus} from './Bus';\n","\n// var ePub = window.ePub;\n// export {ePub};\n\nexport function ePub(href, options) {\n\tif ( window.require !== undefined ) {\n\t\twindow.ePub = require(\"ePub\");\n\t}\n  return window.ePub(href, options);\n}\n","'use strict';\n\nif (!process) {\n  var process = {\n    \"cwd\" : function () { return '/' }\n  };\n}\n\nfunction assertPath(path) {\n  if (typeof path !== 'string') {\n    throw new TypeError('Path must be a string. Received ' + path);\n  }\n}\n\n// Resolves . and .. elements in a path with directory names\nfunction normalizeStringPosix(path, allowAboveRoot) {\n  var res = '';\n  var lastSlash = -1;\n  var dots = 0;\n  var code;\n  for (var i = 0; i <= path.length; ++i) {\n    if (i < path.length)\n      code = path.charCodeAt(i);\n    else if (code === 47/*/*/)\n      break;\n    else\n      code = 47/*/*/;\n    if (code === 47/*/*/) {\n      if (lastSlash === i - 1 || dots === 1) {\n        // NOOP\n      } else if (lastSlash !== i - 1 && dots === 2) {\n        if (res.length < 2 ||\n            res.charCodeAt(res.length - 1) !== 46/*.*/ ||\n            res.charCodeAt(res.length - 2) !== 46/*.*/) {\n          if (res.length > 2) {\n            var start = res.length - 1;\n            var j = start;\n            for (; j >= 0; --j) {\n              if (res.charCodeAt(j) === 47/*/*/)\n                break;\n            }\n            if (j !== start) {\n              if (j === -1)\n                res = '';\n              else\n                res = res.slice(0, j);\n              lastSlash = i;\n              dots = 0;\n              continue;\n            }\n          } else if (res.length === 2 || res.length === 1) {\n            res = '';\n            lastSlash = i;\n            dots = 0;\n            continue;\n          }\n        }\n        if (allowAboveRoot) {\n          if (res.length > 0)\n            res += '/..';\n          else\n            res = '..';\n        }\n      } else {\n        if (res.length > 0)\n          res += '/' + path.slice(lastSlash + 1, i);\n        else\n          res = path.slice(lastSlash + 1, i);\n      }\n      lastSlash = i;\n      dots = 0;\n    } else if (code === 46/*.*/ && dots !== -1) {\n      ++dots;\n    } else {\n      dots = -1;\n    }\n  }\n  return res;\n}\n\nfunction _format(sep, pathObject) {\n  var dir = pathObject.dir || pathObject.root;\n  var base = pathObject.base ||\n    ((pathObject.name || '') + (pathObject.ext || ''));\n  if (!dir) {\n    return base;\n  }\n  if (dir === pathObject.root) {\n    return dir + base;\n  }\n  return dir + sep + base;\n}\n\nvar posix = {\n  // path.resolve([from ...], to)\n  resolve: function resolve() {\n    var resolvedPath = '';\n    var resolvedAbsolute = false;\n    var cwd;\n\n    for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n      var path;\n      if (i >= 0)\n        path = arguments[i];\n      else {\n        if (cwd === undefined)\n          cwd = process.cwd();\n        path = cwd;\n      }\n\n      assertPath(path);\n\n      // Skip empty entries\n      if (path.length === 0) {\n        continue;\n      }\n\n      resolvedPath = path + '/' + resolvedPath;\n      resolvedAbsolute = path.charCodeAt(0) === 47/*/*/;\n    }\n\n    // At this point the path should be resolved to a full absolute path, but\n    // handle relative paths to be safe (might happen when process.cwd() fails)\n\n    // Normalize the path\n    resolvedPath = normalizeStringPosix(resolvedPath, !resolvedAbsolute);\n\n    if (resolvedAbsolute) {\n      if (resolvedPath.length > 0)\n        return '/' + resolvedPath;\n      else\n        return '/';\n    } else if (resolvedPath.length > 0) {\n      return resolvedPath;\n    } else {\n      return '.';\n    }\n  },\n\n\n  normalize: function normalize(path) {\n    assertPath(path);\n\n    if (path.length === 0)\n      return '.';\n\n    var isAbsolute = path.charCodeAt(0) === 47/*/*/;\n    var trailingSeparator = path.charCodeAt(path.length - 1) === 47/*/*/;\n\n    // Normalize the path\n    path = normalizeStringPosix(path, !isAbsolute);\n\n    if (path.length === 0 && !isAbsolute)\n      path = '.';\n    if (path.length > 0 && trailingSeparator)\n      path += '/';\n\n    if (isAbsolute)\n      return '/' + path;\n    return path;\n  },\n\n\n  isAbsolute: function isAbsolute(path) {\n    assertPath(path);\n    return path.length > 0 && path.charCodeAt(0) === 47/*/*/;\n  },\n\n\n  join: function join() {\n    if (arguments.length === 0)\n      return '.';\n    var joined;\n    for (var i = 0; i < arguments.length; ++i) {\n      var arg = arguments[i];\n      assertPath(arg);\n      if (arg.length > 0) {\n        if (joined === undefined)\n          joined = arg;\n        else\n          joined += '/' + arg;\n      }\n    }\n    if (joined === undefined)\n      return '.';\n    return posix.normalize(joined);\n  },\n\n\n  relative: function relative(from, to) {\n    assertPath(from);\n    assertPath(to);\n\n    if (from === to)\n      return '';\n\n    from = posix.resolve(from);\n    to = posix.resolve(to);\n\n    if (from === to)\n      return '';\n\n    // Trim any leading backslashes\n    var fromStart = 1;\n    for (; fromStart < from.length; ++fromStart) {\n      if (from.charCodeAt(fromStart) !== 47/*/*/)\n        break;\n    }\n    var fromEnd = from.length;\n    var fromLen = (fromEnd - fromStart);\n\n    // Trim any leading backslashes\n    var toStart = 1;\n    for (; toStart < to.length; ++toStart) {\n      if (to.charCodeAt(toStart) !== 47/*/*/)\n        break;\n    }\n    var toEnd = to.length;\n    var toLen = (toEnd - toStart);\n\n    // Compare paths to find the longest common path from root\n    var length = (fromLen < toLen ? fromLen : toLen);\n    var lastCommonSep = -1;\n    var i = 0;\n    for (; i <= length; ++i) {\n      if (i === length) {\n        if (toLen > length) {\n          if (to.charCodeAt(toStart + i) === 47/*/*/) {\n            // We get here if `from` is the exact base path for `to`.\n            // For example: from='/foo/bar'; to='/foo/bar/baz'\n            return to.slice(toStart + i + 1);\n          } else if (i === 0) {\n            // We get here if `from` is the root\n            // For example: from='/'; to='/foo'\n            return to.slice(toStart + i);\n          }\n        } else if (fromLen > length) {\n          if (from.charCodeAt(fromStart + i) === 47/*/*/) {\n            // We get here if `to` is the exact base path for `from`.\n            // For example: from='/foo/bar/baz'; to='/foo/bar'\n            lastCommonSep = i;\n          } else if (i === 0) {\n            // We get here if `to` is the root.\n            // For example: from='/foo'; to='/'\n            lastCommonSep = 0;\n          }\n        }\n        break;\n      }\n      var fromCode = from.charCodeAt(fromStart + i);\n      var toCode = to.charCodeAt(toStart + i);\n      if (fromCode !== toCode)\n        break;\n      else if (fromCode === 47/*/*/)\n        lastCommonSep = i;\n    }\n\n    var out = '';\n    // Generate the relative path based on the path difference between `to`\n    // and `from`\n    for (i = fromStart + lastCommonSep + 1; i <= fromEnd; ++i) {\n      if (i === fromEnd || from.charCodeAt(i) === 47/*/*/) {\n        if (out.length === 0)\n          out += '..';\n        else\n          out += '/..';\n      }\n    }\n\n    // Lastly, append the rest of the destination (`to`) path that comes after\n    // the common path parts\n    if (out.length > 0)\n      return out + to.slice(toStart + lastCommonSep);\n    else {\n      toStart += lastCommonSep;\n      if (to.charCodeAt(toStart) === 47/*/*/)\n        ++toStart;\n      return to.slice(toStart);\n    }\n  },\n\n\n  _makeLong: function _makeLong(path) {\n    return path;\n  },\n\n\n  dirname: function dirname(path) {\n    assertPath(path);\n    if (path.length === 0)\n      return '.';\n    var code = path.charCodeAt(0);\n    var hasRoot = (code === 47/*/*/);\n    var end = -1;\n    var matchedSlash = true;\n    for (var i = path.length - 1; i >= 1; --i) {\n      code = path.charCodeAt(i);\n      if (code === 47/*/*/) {\n        if (!matchedSlash) {\n          end = i;\n          break;\n        }\n      } else {\n        // We saw the first non-path separator\n        matchedSlash = false;\n      }\n    }\n\n    if (end === -1)\n      return hasRoot ? '/' : '.';\n    if (hasRoot && end === 1)\n      return '//';\n    return path.slice(0, end);\n  },\n\n\n  basename: function basename(path, ext) {\n    if (ext !== undefined && typeof ext !== 'string')\n      throw new TypeError('\"ext\" argument must be a string');\n    assertPath(path);\n\n    var start = 0;\n    var end = -1;\n    var matchedSlash = true;\n    var i;\n\n    if (ext !== undefined && ext.length > 0 && ext.length <= path.length) {\n      if (ext.length === path.length && ext === path)\n        return '';\n      var extIdx = ext.length - 1;\n      var firstNonSlashEnd = -1;\n      for (i = path.length - 1; i >= 0; --i) {\n        var code = path.charCodeAt(i);\n        if (code === 47/*/*/) {\n          // If we reached a path separator that was not part of a set of path\n          // separators at the end of the string, stop now\n          if (!matchedSlash) {\n            start = i + 1;\n            break;\n          }\n        } else {\n          if (firstNonSlashEnd === -1) {\n            // We saw the first non-path separator, remember this index in case\n            // we need it if the extension ends up not matching\n            matchedSlash = false;\n            firstNonSlashEnd = i + 1;\n          }\n          if (extIdx >= 0) {\n            // Try to match the explicit extension\n            if (code === ext.charCodeAt(extIdx)) {\n              if (--extIdx === -1) {\n                // We matched the extension, so mark this as the end of our path\n                // component\n                end = i;\n              }\n            } else {\n              // Extension does not match, so our result is the entire path\n              // component\n              extIdx = -1;\n              end = firstNonSlashEnd;\n            }\n          }\n        }\n      }\n\n      if (start === end)\n        end = firstNonSlashEnd;\n      else if (end === -1)\n        end = path.length;\n      return path.slice(start, end);\n    } else {\n      for (i = path.length - 1; i >= 0; --i) {\n        if (path.charCodeAt(i) === 47/*/*/) {\n          // If we reached a path separator that was not part of a set of path\n          // separators at the end of the string, stop now\n          if (!matchedSlash) {\n            start = i + 1;\n            break;\n          }\n        } else if (end === -1) {\n          // We saw the first non-path separator, mark this as the end of our\n          // path component\n          matchedSlash = false;\n          end = i + 1;\n        }\n      }\n\n      if (end === -1)\n        return '';\n      return path.slice(start, end);\n    }\n  },\n\n\n  extname: function extname(path) {\n    assertPath(path);\n    var startDot = -1;\n    var startPart = 0;\n    var end = -1;\n    var matchedSlash = true;\n    // Track the state of characters (if any) we see before our first dot and\n    // after any path separator we find\n    var preDotState = 0;\n    for (var i = path.length - 1; i >= 0; --i) {\n      var code = path.charCodeAt(i);\n      if (code === 47/*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          startPart = i + 1;\n          break;\n        }\n        continue;\n      }\n      if (end === -1) {\n        // We saw the first non-path separator, mark this as the end of our\n        // extension\n        matchedSlash = false;\n        end = i + 1;\n      }\n      if (code === 46/*.*/) {\n        // If this is our first dot, mark it as the start of our extension\n        if (startDot === -1)\n          startDot = i;\n        else if (preDotState !== 1)\n          preDotState = 1;\n      } else if (startDot !== -1) {\n        // We saw a non-dot and non-path separator before our dot, so we should\n        // have a good chance at having a non-empty extension\n        preDotState = -1;\n      }\n    }\n\n    if (startDot === -1 ||\n        end === -1 ||\n        // We saw a non-dot character immediately before the dot\n        preDotState === 0 ||\n        // The (right-most) trimmed path component is exactly '..'\n        (preDotState === 1 &&\n         startDot === end - 1 &&\n         startDot === startPart + 1)) {\n      return '';\n    }\n    return path.slice(startDot, end);\n  },\n\n\n  format: function format(pathObject) {\n    if (pathObject === null || typeof pathObject !== 'object') {\n      throw new TypeError(\n        'Parameter \"pathObject\" must be an object, not ' + typeof(pathObject)\n      );\n    }\n    return _format('/', pathObject);\n  },\n\n\n  parse: function parse(path) {\n    assertPath(path);\n\n    var ret = { root: '', dir: '', base: '', ext: '', name: '' };\n    if (path.length === 0)\n      return ret;\n    var code = path.charCodeAt(0);\n    var isAbsolute = (code === 47/*/*/);\n    var start;\n    if (isAbsolute) {\n      ret.root = '/';\n      start = 1;\n    } else {\n      start = 0;\n    }\n    var startDot = -1;\n    var startPart = 0;\n    var end = -1;\n    var matchedSlash = true;\n    var i = path.length - 1;\n\n    // Track the state of characters (if any) we see before our first dot and\n    // after any path separator we find\n    var preDotState = 0;\n\n    // Get non-dir info\n    for (; i >= start; --i) {\n      code = path.charCodeAt(i);\n      if (code === 47/*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          startPart = i + 1;\n          break;\n        }\n        continue;\n      }\n      if (end === -1) {\n        // We saw the first non-path separator, mark this as the end of our\n        // extension\n        matchedSlash = false;\n        end = i + 1;\n      }\n      if (code === 46/*.*/) {\n        // If this is our first dot, mark it as the start of our extension\n        if (startDot === -1)\n          startDot = i;\n        else if (preDotState !== 1)\n          preDotState = 1;\n      } else if (startDot !== -1) {\n        // We saw a non-dot and non-path separator before our dot, so we should\n        // have a good chance at having a non-empty extension\n        preDotState = -1;\n      }\n    }\n\n    if (startDot === -1 ||\n        end === -1 ||\n        // We saw a non-dot character immediately before the dot\n        preDotState === 0 ||\n        // The (right-most) trimmed path component is exactly '..'\n        (preDotState === 1 &&\n         startDot === end - 1 &&\n         startDot === startPart + 1)) {\n      if (end !== -1) {\n        if (startPart === 0 && isAbsolute)\n          ret.base = ret.name = path.slice(1, end);\n        else\n          ret.base = ret.name = path.slice(startPart, end);\n      }\n    } else {\n      if (startPart === 0 && isAbsolute) {\n        ret.name = path.slice(1, startDot);\n        ret.base = path.slice(1, end);\n      } else {\n        ret.name = path.slice(startPart, startDot);\n        ret.base = path.slice(startPart, end);\n      }\n      ret.ext = path.slice(startDot, end);\n    }\n\n    if (startPart > 0)\n      ret.dir = path.slice(0, startPart - 1);\n    else if (isAbsolute)\n      ret.dir = '/';\n\n    return ret;\n  },\n\n\n  sep: '/',\n  delimiter: ':',\n  posix: null\n};\n\n\nmodule.exports = posix;\n","import * as Util from '../core/Util';\nimport {Reader} from './Reader';\nimport * as epubjs from '../epubjs';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as Browser from '../core/Browser';\n\nimport path from \"path-webpack\";\n\nReader.EpubJS = Reader.extend({\n\n  initialize: function(id, options) {\n    Reader.prototype.initialize.apply(this, arguments);\n    this._epubjs_ready = false;\n    window.xpath = path;\n  },\n\n  open: function(target, callback) {\n    var self = this;\n    if ( typeof(target) == 'function' ) {\n      callback = target;\n      target = undefined;\n    }\n    if ( callback == null ) {\n      callback = function() { };\n    }\n\n    self.rootfiles = [];\n\n    this.options.rootfilePath = this.options.rootfilePath || sessionStorage.getItem('rootfilePath');\n\n    var book_href = this.options.href;\n    var book_options = { packagePath: this.options.rootfilePath };\n    if ( this.options.useArchive ) {\n      book_href = book_href.replace(/\\/(\\w+)\\/$/, '/$1/$1.sm.epub');\n      book_options.openAs = 'epub';\n    }\n    this._book = epubjs.ePub(book_href, book_options);\n    sessionStorage.removeItem('rootfilePath');\n\n    this._book.loaded.navigation.then(function(toc) {\n      self._contents = toc;\n      self.metadata = self._book.package.metadata;\n      self.fire('updateContents', toc);\n      self.fire('updateTitle', self._book.package.metadata);\n    })\n    this._book.ready.then(function() {\n      self.parseRootfiles();\n\n      self.draw(target, callback);\n\n      if ( self.metadata.layout == 'pre-paginated' ) {\n        // fake it with the spine\n        var locations = [];\n        self._book.spine.each(function(item) {\n          locations.push(`epubcfi(${item.cfiBase}!/4/2)`);\n          self.locations._locations.push(`epubcfi(${item.cfiBase}!/4/2)`);\n        });\n        self.locations.total = locations.length;\n        var t;\n        var f = function() {\n          if ( self._rendition && self._rendition.manager && self._rendition.manager.stage ) {\n            var location = self._rendition.currentLocation();\n            if ( location && location.start) {\n              self.fire('updateLocations', locations);\n              clearTimeout(t);\n              return;\n            }\n          }\n          t = setTimeout(f, 100);\n        }\n\n        t = setTimeout(f, 100);\n      } else {\n        self._book.locations.generate(1600).then(function(locations) {\n          // console.log(\"AHOY WUT\", locations);\n          self.fire('updateLocations', locations);\n        })\n      }\n    })\n    // .then(callback);\n  },\n\n  parseRootfiles: function() {\n    var self = this;\n    self._book.load(self._book.url.resolve(\"META-INF/container.xml\")).then(function(containerDoc) {\n        var rootfiles = containerDoc.querySelectorAll(\"rootfile\");\n        if ( rootfiles.length > 1 ) {\n          console.log(\"AHOY ROOTFILES MULTIPLE RENDITIONS\", rootfiles.length);\n          for(var i = 0; i < rootfiles.length; i++) {\n            var rootfile = rootfiles[i];\n            var rootfilePath = rootfile.getAttribute('full-path');\n            var label = rootfile.getAttribute('rendition:label');\n            var layout = rootfile.getAttribute('rendition:layout');\n            self.rootfiles.push({\n              rootfilePath: rootfilePath,\n              label: label,\n              layout: layout\n            })\n          }\n        }\n    })\n  },\n\n  draw: function(target, callback) {\n    var self = this;\n\n    if ( self._rendition ) {\n      // self._unbindEvents();\n      var container = self._rendition.manager.container;\n      Object.keys(self._rendition.hooks).forEach(function(key) {\n        console.log(\"AHOY draw clearing\", key);\n        self._rendition.hooks[key].clear();\n      })\n      self._rendition.destroy();\n      self._rendition = null;\n    }\n\n    this.settings = { flow: this.options.flow };\n    this.settings.manager = this.options.manager || 'default';\n\n    if ( this.settings.flow == 'auto' && this.metadata.layout == 'pre-paginated' ) {\n      // dumb check to see if the window is _tall_ enough to put\n      // two pages side by side\n      if ( this._container.offsetHeight <= this.options.forceScrolledDocHeight ) {\n        this.settings.flow = 'scrolled-doc';\n        this.settings.manager = 'prepaginated';\n      }\n    }\n\n    if ( this.settings.flow == 'auto' || this.settings.flow == 'paginated' ) {\n      this._panes['epub'].style.overflow = this.metadata.layout == 'pre-paginated' ? 'auto' : 'hidden';\n      this.settings.manager = 'default';\n    } else {\n      this._panes['epub'].style.overflow = 'auto';\n      if ( this.settings.manager == 'default' ) {\n        this.settings.manager = 'continuous';\n      }\n    }\n\n    if ( ! callback ) {\n      callback = function() { };\n    }\n\n    if ( this.metadata.layout == 'pre-paginated' && this.settings.manager == 'continuous' ) {\n        this.settings.manager = 'prepaginated';\n    }\n\n    if ( this.settings.manager == 'prepaginated' ) {\n      this.settings.spread = 'none';\n    }\n\n    // would pre-paginated work better if we scaled the default view from the start? maybe?\n    if ( false && this.metadata.layout == 'pre-paginated' && this.settings.manager == 'default' ) {\n      this.settings.spread = 'none';\n      this._panes['epub'].style.overflow = 'auto';\n    }\n\n    self.settings.height = '100%';\n    self.settings.width = '100%';\n    self.settings['ignoreClass'] = 'annotator-hl';\n\n    if ( self.options.scale != '100' ) {\n      self.settings.scale = parseInt(self.options.scale, 10) / 100;\n    }\n\n    self._panes['book'].dataset.manager = this.settings.manager + ( this.settings.spread ? `-${this.settings.spread}` : '');\n    self._panes['book'].dataset.layout = this.metadata.layout || 'reflowable';\n\n    self._drawRendition(target, callback);\n  },\n\n  _drawRendition: function(target, callback) {\n    var self = this;\n\n    self._rendition = self._book.renderTo(self._panes['epub'], self.settings);\n    self._updateFontSize();\n    self._bindEvents();\n    self._drawn = true;\n\n    if ( target && target.start ) { target = target.start; }\n    if ( ! target && window.location.hash ) {\n      if ( window.location.hash.substr(1, 3) == '/6/' ) {\n        target = \"epubcfi(\" + window.location.hash.substr(1) + \")\";\n      } else {\n        target = window.location.hash.substr(2);\n        target = self._book.url.path().resolve(target);\n      }\n    }\n\n    var status_index = 0;\n    self._rendition.on('started', function() {\n\n      self._rendition.manager.on(\"building\", function(status) {\n        if ( status ) {\n          status_index += 1;\n          self._panes['loader-status'].innerHTML = `<span>${Math.round((status_index / status.total) * 100.0)}%</span>`;\n        } else {\n          self._enableBookLoader(-1);\n        }\n      })\n      self._rendition.manager.on(\"built\", function() {\n        console.log(\"AHOY manager built\");\n        self._disableBookLoader(true);\n      })\n    })\n\n    self._rendition.hooks.content.register(function(contents) {\n      self.fire('ready:contents', contents);\n      self.fire('readyContents', contents);\n      contents.document.addEventListener('keydown', (event) => {\n        const keyName = event.key;\n        self.fire('keyDown', { keyName: keyName, shiftKey: event.shiftKey, inner: true });\n        console.log('inner keydown event: ', keyName);\n      });\n    })\n\n    self.gotoPage(target, function() {\n      window._loaded = true;\n      self._initializeReaderStyles();\n\n      if ( callback ) { callback(); }\n\n      self._epubjs_ready = true;\n\n      setTimeout(function() {\n        self.fire('opened');\n        self.fire('ready');\n        clearTimeout(self._queueTimeout);\n        self.tracking.event(\"openBook\", {\n          rootFilePath: self.options.rootFilePath,\n          flow: self.settings.flow,\n          manager: self.settings.manager\n        });\n      }, 100);\n    })\n  },\n\n  _scroll: function(delta) {\n    var self = this;\n    if ( self.options.flow == 'XXscrolled-doc' ) {\n      var container = self._rendition.manager.container;\n      var rect = container.getBoundingClientRect();\n      var scrollTop = container.scrollTop;\n      var newScrollTop = scrollTop;\n      var scrollBy = ( rect.height * 0.98 );\n      switch(delta) {\n        case 'PREV':\n          newScrollTop = -( scrollTop + scrollBy );\n          break;\n        case 'NEXT':\n          newScrollTop = ( scrollTop + scrollBy );\n          break;\n        case 'HOME':\n          newScrollTop = 0;\n          break;\n        case 'END':\n          newScrollTop = container.scrollHeight - scrollBy;\n          break;\n      }\n      container.scrollTop = newScrollTop;\n      return ( Math.floor(container.scrollTop) != Math.floor(scrollTop) );\n    }\n    return false;\n  },\n\n  _navigate: function(promise, callback) {\n    var self = this;\n    self._enableBookLoader(100);\n    promise.then(function() {\n      console.log(\"AHOY NAVIGATE FIN\");\n      self._disableBookLoader();\n      if ( callback ) { callback(); }\n    }).catch(function(e) {\n      self._disableBookLoader();\n      if ( callback ) { callback(); }\n      console.log(\"AHOY NAVIGATE ERROR\", e);\n      throw(e);\n    })\n  },\n\n  next: function() {\n    var self = this;\n    this.tracking.action('reader/go/next');\n    self._scroll('NEXT') || self._navigate(this._rendition.next());\n  },\n\n  prev: function() {\n    this.tracking.action('reader/go/previous');\n    this._scroll('PREV') || this._navigate(this._rendition.prev());\n  },\n\n  first: function() {\n    this.tracking.action('reader/go/first');\n    this._navigate(this._rendition.display(0), undefined);\n  },\n\n  last: function() {\n    var self = this;\n    this.tracking.action('reader/go/last');\n    var target = this._book.spine.length - 1;\n    this._navigate(this._rendition.display(target), undefined);\n  },\n\n  gotoPage: function(target, callback) {\n    if ( target != null ) {\n      var section = this._book.spine.get(target);\n      if ( ! section) {\n        // maybe it needs to be resolved\n        var guessed = target;\n        if ( guessed.indexOf(\"://\") < 0 ) {\n          var path1 = path.resolve(this._book.path.directory, this._book.package.navPath);\n          var path2 = path.resolve(path.dirname(path1), target);\n          guessed = this._book.canonical(path2);\n        }\n        if ( guessed.indexOf(\"#\") !== 0 ) {\n          guessed = guessed.split('#')[0];\n        }\n\n        this._book.spine.each(function(item) {\n          if ( item.canonical == guessed ) {\n            section = item;\n            target = section.href;\n            return;\n          }\n        })\n\n        console.log(\"AHOY GUESSED\", target);\n      } else if ( target.toString().match(/^\\d+$/) ) {\n        console.log(\"AHOY USING\", section.href);\n        target = section.href;\n      }\n\n      if ( ! section ) {\n        if ( ! this._epubjs_ready ) {\n          target = 0;\n        } else {\n          return;\n        }\n      }\n    }\n\n    console.log(\"AHOY gotoPage\", target);\n\n    var navigating = this._rendition.display(target).then(function() {\n      this._rendition.display(target);\n    }.bind(this));\n    this._navigate(navigating, callback);\n  },\n\n  percentageFromCfi: function(cfi) {\n    return this._book.percentageFromCfi(cfi);\n  },\n\n  destroy: function() {\n    if ( this._rendition ) {\n      try {\n        this._rendition.destroy();\n      } catch(e) {}\n    }\n    this._rendition = null;\n    this._drawn = false;\n  },\n\n  reopen: function(options, target) {\n    // different per reader?\n    var target = target || this.currentLocation();\n    if( target.start ) { target = target.start ; }\n    if ( target.cfi ) { target = target.cfi ; }\n\n    var doUpdate = false;\n    if ( options === true ) { doUpdate = true; options = {}; }\n    var changed = {};\n    Object.keys(options).forEach(function(key) {\n      if ( options[key] != this.options[key] ) {\n        doUpdate = true;\n        changed[key] = true;\n      }\n      // doUpdate = doUpdate || ( options[key] != this.options[key] );\n    }.bind(this));\n\n    if ( ! doUpdate ) {\n      return;\n    }\n\n    // performance hack\n    if ( Object.keys(changed).length == 1 && changed.scale ) {\n      reader.options.scale = options.scale;\n      this._updateScale();\n      return;\n    }\n\n    if ( options.rootfilePath && options.rootfilePath != this.options.rootfilePath ) {\n      // we need to REOPEN THE DANG BOOK\n      sessionStorage.setItem('rootfilePath', options.rootfilePath);\n      location.reload();\n      return;\n    }\n\n    Util.extend(this.options, options);\n\n    this.draw(target, function() {\n      this._updateFontSize();\n      this._updateScale();\n      this._updateTheme();\n      this._selectTheme(true);\n    }.bind(this))\n  },\n\n  currentLocation: function() {\n    if ( this._rendition && this._rendition.manager ) {\n      this._cached_location = this._rendition.currentLocation();\n    }\n    return this._cached_location;\n  },\n\n  _bindEvents: function() {\n    var self = this;\n\n    // add a stylesheet to stop images from breaking their columns\n    var add_max_img_styles = false;\n    if ( this._book.package.metadata.layout == 'pre-paginated' ) {\n      // NOOP\n    } else if ( this.options.flow == 'auto' || this.options.flow == 'paginated' ) {\n      add_max_img_styles = true;\n    }\n\n    var custom_stylesheet_rules = [];\n\n    // force 90% height instead of default 60%\n    if ( this.metadata.layout != 'pre-paginated' ) {\n      this._rendition.hooks.content.register(function(contents) {\n        contents.addStylesheetRules({\n          \"img\" : {\n            \"max-width\": (this._layout.columnWidth ? this._layout.columnWidth + \"px\" : \"100%\") + \"!important\",\n            \"max-height\": (this._layout.height ? (this._layout.height * 0.9) + \"px\" : \"90%\") + \"!important\",\n            \"object-fit\": \"contain\",\n            \"page-break-inside\": \"avoid\"\n          },\n          \"svg\" : {\n            \"max-width\": (this._layout.columnWidth ? this._layout.columnWidth + \"px\" : \"100%\") + \"!important\",\n            \"max-height\": (this._layout.height ? (this._layout.height * 0.9) + \"px\" : \"90%\") + \"!important\",\n            \"page-break-inside\": \"avoid\"\n          }\n        });\n      }.bind(this._rendition))\n    } else {\n      this._rendition.hooks.content.register(function(contents) {\n        contents.addStylesheetRules({\n          \"img\" : {\n            // \"border\": \"64px solid black !important\",\n            \"box-sizing\": \"border-box !important\"\n          },\n          \"figure\": {\n            \"box-sizing\": \"border-box !important\",\n            \"margin\": \"0 !important\"\n          },\n          \"body\": {\n            \"margin\": \"0\"\n          }\n        });\n      }.bind(this._rendition));\n    }\n\n    this._updateFontSize();\n\n    if ( custom_stylesheet_rules.length ) {\n      this._rendition.hooks.content.register(function(view) {\n        view.addStylesheetRules(custom_stylesheet_rules);\n      })\n    }\n\n    this._rendition.on('resized', function(box) {\n      self.fire('resized', box);\n    })\n\n    this._rendition.on('relocated', function(location) {\n      self.fire('relocated', location);\n    })\n\n    this._rendition.on('displayerror', function(err) {\n      console.log(\"AHOY RENDITION DISPLAY ERROR\", err);\n    })\n\n    this._rendition.on(\"locationChanged\", function(location) {\n      var view = this.manager.current();\n      var section = view.section;\n      var current = this.book.navigation.get(section.href);\n\n      self.fire(\"updateSection\", current);\n      self.fire(\"updateLocation\", location);\n      // self.fire(\"relocated\", location);\n    });\n\n    this._rendition.on(\"rendered\", function(section, view) {\n\n      if ( view.contents ) {\n        // view.contents.on(\"xxlinkClicked\", function(href) {\n        //   console.log(\"AHOY CLICKED\", href);\n        //   var tmp = href.split(\"#\");\n        //   href = tmp[0];\n        //   var hash = tmp[1]\n        //   // var current = self.currentLocation().start.href;\n        //   // var section = self._book.spine.get(current.href);\n        //   console.log(\"AHOY CLICKED CHECK\", section.canonical, href);\n        //   if ( section.canonical.indexOf(href) < 0 ) {\n        //     self.gotoPage(href);\n        //     // self._rendition.display(href);\n\n        //   } else if ( hash ) {\n        //     // we're already on this page, so we need to scroll to this location\n        //     var node = view.contents.content.querySelector('#' + hash);\n        //     console.log(\"AHOY INTERNAL\", hash, view.contents, node);\n        //   }\n        //   // self._rendition.display(href);\n        // })\n      }\n\n      if(false) {\n        if ( ! self._rendition.manager.container.dataset.__scroll ) {\n          var ticking;\n          self._rendition.manager.container.addEventListener(\"scroll\", function(event) {\n            if ( self._rendition && self._rendition.manager ) {\n              var container = self._rendition.manager.container;\n              var mod = container.scrollLeft % parseInt(self._rendition.manager.layout.delta, 10);\n              console.log(\"AHOY DETECTED SCROLL\", mod, mod / self._rendition.manager.layout.delta);\n            }\n          });\n          self._rendition.manager.container.dataset.__scroll = true;\n        }\n      }\n\n      self.on('keyDown', function(data) {\n        if ( data.keyName == 'Tab' && data.inner ) {\n          var container = self._rendition.manager.container;\n          var mod;\n          var delta;\n          var x; var xyz;\n          setTimeout(function() {\n            var scrollLeft = container.scrollLeft;\n            mod = scrollLeft % parseInt(self._rendition.manager.layout.delta, 10);\n            if ( mod > 0 && ( mod / self._rendition.manager.layout.delta ) < 0.99 ) {\n              // var x = Math.floor(event.target.scrollLeft / parseInt(self._rendition.manager.layout.delta, 10)) + 1;\n              // var delta = ( x * self._rendition.manager.layout.delta) - event.target.scrollLeft;\n              x = Math.floor(container.scrollLeft / parseInt(self._rendition.manager.layout.delta, 10));\n              if ( data.shiftKey ) { x -= 0 ; }\n              else { x += 1; }\n              var y = container.scrollLeft;\n              delta = ( x * self._rendition.manager.layout.delta ) - y;\n              xyz = ( x * self._rendition.manager.layout.delta );\n              // if ( data.shiftKey ) { delta *= -1 ; }\n              if ( true || ! data.shiftKey ) {\n                self._rendition.manager.scrollBy(delta);\n              }\n            }\n            console.log(\"AHOY DOING THE SCROLLING\", data.shiftKey, scrollLeft, mod, x, xyz, delta);\n          }, 0);\n        }\n      })\n\n\n    })\n  },\n\n  _initializeReaderStyles: function() {\n    var self = this;\n    var themes = this.options.themes;\n    if ( themes ) {\n      themes.forEach(function(theme) {\n        self._rendition.themes.register(theme['klass'], theme.href ? theme.href : theme.rules);\n      })\n    }\n\n    // base for highlights\n    this._rendition.themes.override('.epubjs-hl', \"fill: yellow; fill-opacity: 0.3; mix-blend-mode: multiply;\");\n  },\n\n  _selectTheme: function(refresh) {\n    var theme = this.options.theme || 'default';\n    this._rendition.themes.select(theme);\n    if ( 0 && refresh ) {\n      var cfi = this.currentLocation().end.cfi;\n      this._rendition.manager.clear();\n      console.log(\"AHOY\", cfi);\n      this._rendition.display(cfi);\n    }\n  },\n\n  _updateFontSize: function() {\n    if ( this.metadata.layout == 'pre-paginated') {\n      // we're not doing font changes for pre-paginted\n      return;\n    }\n\n    var text_size = this.options.text_size == 'auto' ? 100 : this.options.text_size;\n    this._rendition.themes.fontSize(`${text_size}%`);\n  },\n\n  _updateScale: function() {\n    if ( this.metadata.layout != 'pre-paginated') {\n      // we're not scaling for reflowable\n      return;\n    }\n    var scale = this.options.scale;\n    if ( scale ) {\n      this.settings.scale = parseInt(scale, 10) / 100.0;\n      this._queueScale();\n    }\n  },\n\n  _queueScale: function(scale) {\n    this._queueTimeout = setTimeout(function() {\n      if ( this._rendition.manager && this._rendition.manager.stage ) {\n        console.log(\"AHOY SCALING\", this.settings.scale);\n        this._rendition.scale(this.settings.scale);\n      } else {\n        this._queueScale();\n      }\n    }.bind(this), 100);\n  },\n\n  EOT: true\n\n})\n\nObject.defineProperty(Reader.EpubJS.prototype, 'metadata', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    return this._metadata;\n  },\n\n  set: function(data) {\n    this._metadata = Util.extend({}, data, this.options.metadata);\n  }\n});\n\nObject.defineProperty(Reader.EpubJS.prototype, 'annotations', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    if ( Browser.ie ) {\n      return {\n        reset: function() { /* NOOP */ },\n        highlight: function(cfiRange) { /* NOOP */ }\n      }\n    }\n    if ( ! this._rendition.annotations.reset ) {\n      this._rendition.annotations.reset = function(){\n        for(var hash in this._annotations) {\n            var cfiRange = decodeURI(hash);\n            this.remove(cfiRange);\n        }\n        this._annotationsBySectionIndex = {};\n      }.bind(this._rendition.annotations);\n    }\n    return this._rendition.annotations;\n  }\n});\n\nObject.defineProperty(Reader.EpubJS.prototype, 'locations', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    return this._book.locations;\n  }\n});\n\nwindow.Reader = Reader;\n\nexport function createReader(id, options) {\n  return new Reader.EpubJS(id, options);\n}\n","import * as Util from '../core/Util';\nimport {Reader} from './Reader';\nimport * as DomUtil from '../dom/DomUtil';\n\nReader.Mock = Reader.extend({\n\n  initialize: function(id, options) {\n    Reader.prototype.initialize.apply(this, arguments);\n  },\n\n  open: function(target, callback) {\n    var self = this;\n    this._book = {\n      metadata: {\n        title: 'The Mock Life',\n        creator: 'Alex Mock',\n        publisher: 'University Press',\n        location: 'Ann Arbor, MI',\n        pubdate: '2017-05-23'\n      },\n      contents: {\n        toc: [\n          {id: 1, href: \"/epubs/mock/ops/xhtml/TitlePage.xhtml\", label: \"Title\", parent: null},\n          {id: 2, href: \"/epubs/mock/ops/xhtml/Chapter01.xhtml\", label: \"Chapter 1\", parent: null},\n          {id: 3, href: \"/epubs/mock/ops/xhtml/Chapter02.xhtml\", label: \"Chapter 2\", parent: null},\n          {id: 4, href: \"/epubs/mock/ops/xhtml/Chapter03.xhtml\", label: \"Chapter 3\", parent: null},\n          {id: 5, href: \"/epubs/mock/ops/xhtml/Chapter04.xhtml\", label: \"Chapter 4\", parent: null},\n          {id: 6, href: \"/epubs/mock/ops/xhtml/Chapter05.xhtml\", label: \"Chapter 5\", parent: null},\n          {id: 7, href: \"/epubs/mock/ops/xhtml/Chapter06.xhtml\", label: \"Chapter 6\", parent: null},\n          {id: 8, href: \"/epubs/mock/ops/xhtml/Chapter07.xhtml\", label: \"Chapter 7\", parent: null},\n          {id: 9, href: \"/epubs/mock/ops/xhtml/Index.xhtml\", label: \"Index\", parent: null},\n        ]\n      }\n    };\n\n    this._locations = [\n      'epubcfi(/6/4[TitlePage.xhtml])',\n      'epubcfi(/6/4[Chapter01.xhtml])',\n      'epubcfi(/6/4[Chapter02.xhtml])',\n      'epubcfi(/6/4[Chapter03.xhtml])',\n      'epubcfi(/6/4[Chapter04.xhtml])',\n      'epubcfi(/6/4[Chapter05.xhtml])',\n      'epubcfi(/6/4[Chapter06.xhtml])',\n      'epubcfi(/6/4[Chapter07.xhtml])',\n      'epubcfi(/6/4[Chapter08.xhtml])',\n      'epubcfi(/6/4[Index.xhtml])',\n    ];\n\n    this.__currentIndex = 0;\n\n    this.metadata = this._book.metadata;\n    this.fire('updateContents', this._book.contents);\n    this.fire('updateTitle', this._metadata);\n    this.fire('updateLocations', this._locations);\n    this.draw(target, callback);\n  },\n\n  draw: function(target, callback) {\n    var self = this;\n    this.settings = { flow: this.options.flow };\n    this.settings.height = '100%';\n    this.settings.width = '99%';\n    // this.settings.width = '100%';\n    if ( this.options.flow == 'auto' ) {\n      this._panes['book'].style.overflow = 'hidden';\n    } else {\n      this._panes['book'].style.overflow = 'auto';\n    }\n    if ( typeof(target) == 'function' && cb === undefined ) {\n      callback = target;\n      target = undefined;\n    }\n    callback();\n    self.fire('ready');\n  },\n\n  next: function() {\n    // this._rendition.next();\n  },\n\n  prev: function() {\n    // this._rendition.prev();\n  },\n\n  first: function() {\n    // this._rendition.display(0);\n  },\n\n  last: function() {\n  },\n\n  gotoPage: function(target) {\n    if ( typeof(target) == \"string\" ) {\n      this.__currentIndex = this._locations.indexOf(target);\n    } else {\n      this.__currentIndex = target;\n    }\n    this.fire(\"relocated\", this.currentLocation());\n  },\n\n  destroy: function() {\n    // if ( this._rendition ) {\n    //   this._rendition.destroy();\n    // }\n    // this._rendition = null;\n  },\n\n  currentLocation: function() {\n    var cfi = this._locations[this.__currentIndex];\n    return {\n      start: { cfi: cfi, href: cfi },\n      end: { cfi: cfi, href: cfi }\n    }\n  },\n\n  _bindEvents: function() {\n    var self = this;\n\n  },\n\n  _updateTheme: function() {\n\n  },\n\n  EOT: true\n\n})\n\nObject.defineProperty(Reader.Mock.prototype, 'metadata', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    return this._metadata;\n  },\n\n  set: function(data) {\n    this._metadata = Util.extend({}, data, this.options.metadata);\n  }\n});\n\nObject.defineProperty(Reader.Mock.prototype, 'locations', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    var self = this;\n    return {\n      total: self._locations.length,\n      locationFromCfi: function(cfi) {\n        return self._locations.indexOf(cfi);\n      },\n      percentageFromCfi: function(cfi) {\n        var index = self.locations.locationFromCfi(cfi);\n        return ( index / self.locations.total );\n      },\n      cfiFromPercentage: function(percentage) {\n        var index = Math.ceil(percentage * 10);\n        return self._locations[index];\n      }\n    }\n  }\n});\n\nObject.defineProperty(Reader.Mock.prototype, 'annotations', {\n  get: function() {\n    return {\n      reset: function() {},\n      highlight: function() {}\n    }\n  }\n})\n\nexport function createReader(id, options) {\n  return new Reader.Mock(id, options);\n}\n","import {Reader} from './Reader';\nimport * as EpubJS from './Reader.EpubJS';\nimport * as Mock from './Reader.Mock';\n\nvar engines = {\n  epubjs: EpubJS.createReader,\n  mock: Mock.createReader\n}\n\nexport var reader = function(id, options) {\n  options = options || {};\n  var engine = options.engine || window.COZY_EPUB_ENGINE || 'epubjs';\n  var engine_href = options.engine_href || window.COZY_EPUB_ENGINE_HREF;\n  var _this = this;\n  var _arguments = arguments;\n\n  options.engine = engine;\n  options.engine_href = engine_href;\n\n  return engines[engine].apply(_this, [id, options]);\n}"],"names":["global","this","extend","dest","i","j","len","src","arguments","length","create","Object","F","proto","prototype","bind","fn","obj","slice","Array","apply","call","args","concat","lastId","stamp","_cozy_id","throttle","time","context","lock","wrapperFn","later","setTimeout","wrapNum","x","range","includeMax","max","min","d","falseFn","formatNum","num","digits","pow","Math","round","isNumeric","isNaN","parseFloat","isFinite","trim","str","replace","splitWords","split","setOptions","options","hasOwnProperty","getParamString","existingUrl","uppercase","params","push","encodeURIComponent","toUpperCase","indexOf","join","templateRe","template","data","key","value","undefined","Error","isArray","toString","array","el","emptyImageUrl","getPrefixed","name","window","lastTime","timeoutDefer","Date","timeToCall","requestFn","requestAnimationFrame","cancelFn","cancelAnimationFrame","id","clearTimeout","requestAnimFrame","immediate","cancelAnimFrame","loader","js","url","handler","_resolved","callbacks","error","then","cb","resolve","catch","reject","_argv","shift","e","console","log","trace","element","document","createElement","onload","onerror","async","parent","attr","appendChild","Class","props","NewClass","initialize","callInitHooks","parentProto","__super__","Util","constructor","statics","includes","checkDeprecatedMixinEvents","_initHooks","_initHooksCalled","include","mergeOptions","addInitHook","init","cozy","Mixin","Evented","on","types","type","_on","off","_events","_off","typeListeners","newListener","ctx","listeners","l","_firingCount","splice","fire","propagate","listens","event","target","_propagateEvent","_eventParents","once","addEventParent","removeEventParent","layer","addEventListener","removeEventListener","clearAllEventListeners","addOneTimeEventListener","fireEvent","hasEventListeners","style","documentElement","ie","ielt9","edge","navigator","webkit","userAgentContains","android","android23","opera","chrome","gecko","safari","phantom","opera12","win","platform","ie3d","webkit3d","WebKitCSSMatrix","gecko3d","any3d","L_DISABLE_3D","mobile","orientation","mobileWebkit","mobileWebkit3d","msPointer","PointerEvent","MSPointerEvent","pointer","touch","L_NO_TOUCH","DocumentTouch","mobileOpera","mobileGecko","retina","devicePixelRatio","screen","deviceXDPI","logicalXDPI","canvas","getContext","svg","vml","div","innerHTML","shape","firstChild","behavior","babelHelpers.typeof","adj","columnCount","classList","userAgent","toLowerCase","Point","y","clone","add","point","_add","toPoint","subtract","_subtract","divideBy","_divideBy","multiplyBy","_multiplyBy","scaleBy","unscaleBy","_round","floor","_floor","ceil","_ceil","distanceTo","sqrt","equals","contains","abs","POINTER_DOWN","Browser","POINTER_MOVE","POINTER_UP","POINTER_CANCEL","TAG_WHITE_LIST","_pointers","_pointerDocListener","_pointersCount","addPointerListener","_addPointerStart","_addPointerMove","_addPointerEnd","removePointerListener","onDown","pointerType","MSPOINTER_TYPE_MOUSE","tagName","DomEvent","_handlePointer","_globalPointerDown","_globalPointerMove","_globalPointerUp","pointerId","touches","changedTouches","onMove","buttons","onUp","_touchstart","_touchend","_pre","addDoubleTapListener","last","doubleTap","delay","onTouchStart","count","now","delta","onTouchEnd","cancelBubble","newTouch","prop","removeDoubleTapListener","touchstart","touchend","dblclick","addOne","eventsKey","removeOne","originalHandler","isExternalTarget","filterClick","attachEvent","detachEvent","stopPropagation","originalEvent","_stopped","skipped","disableScrollPropagation","disableClickPropagation","fakeStop","preventDefault","returnValue","stop","getMousePosition","container","clientX","clientY","rect","getBoundingClientRect","left","clientLeft","top","clientTop","wheelPxFactor","getWheelDelta","wheelDeltaY","deltaY","deltaMode","deltaX","deltaZ","wheelDelta","detail","skipEvents","events","related","relatedTarget","parentNode","err","lastClick","timeStamp","elapsed","_simulatedClick","_simulated","Element","matches","ep","webkitMatchesSelector","msMatchesSelector","mozMatchesSelector","TRANSFORM","testProp","TRANSITION","TRANSITION_END","get","getElementById","getStyle","currentStyle","defaultView","css","getComputedStyle","className","remove","removeChild","empty","toFront","toBack","insertBefore","hasClass","getClass","RegExp","test","addClass","classes","setClass","removeClass","baseVal","setOpacity","opacity","_setOpacityIE","filter","filterName","filters","item","Enabled","Opacity","isPropertySupported","setTransform","offset","scale","pos","setPosition","_leaflet_pos","getPosition","disableTextSelection","enableTextSelection","_userSelect","userSelectProperty","disableImageDrag","enableImageDrag","_outlineElement","_outlineStyle","preventOutline","tabIndex","restoreOutline","outline","freeGlobal","Symbol","root","objectProto","nativeObjectToString","symToStringTag","getRawTag","objectToString","isObject","baseGetTag","coreJsData","funcProto","funcToString","isMasked","isFunction","toSource","getValue","baseIsNative","defineProperty","getNative","eq","baseAssignValue","assignValue","nativeMax","identity","constant","shortOut","baseSetToString","setToString","overRest","isLength","MAX_SAFE_INTEGER","isArrayLike","isIndex","baseRest","isIterateeCall","isObjectLike","baseIsArguments","stubFalse","argsTag","funcTag","nodeUtil","baseUnary","baseIsTypedArray","isArguments","isBuffer","isTypedArray","baseTimes","overArg","isPrototype","nativeKeys","arrayLikeKeys","baseKeys","createAssigner","copyObject","keys","keyboardAllowed","val","fnMap","ret","eventNameMap","change","fullscreenchange","fullscreenerror","screenfull","request","elem","requestFullscreen","ALLOW_KEYBOARD_INPUT","exit","exitFullscreen","toggle","isFullscreen","onchange","callback","eventName","raw","defineProperties","Boolean","fullscreenElement","enumerable","enabled","fullscreenEnabled","Reader","regions","metadata","flow","engine","fontSizeLarge","fontSizeSmall","fontSizeDefault","trackResize","text_size","mobileMediaQuery","forceScrolledDocHeight","theme","rootfilePath","themes","self","_original_document_title","title","localStorage","getItem","assign","JSON","parse","_checkFeatureCompatibility","_initContainer","_initLayout","forEach","href","klass","rules","rule","new_rule","_updateTheme","_initEvents","_mode","mode","start","engine_href","_start","_loaded","open","reopen","saveOptions","saved_options","setItem","stringify","DomUtil","_container","dataset","draw","next","prev","display","index","gotoPage","goBack","history","back","goForward","forward","_preResize","_onScroll","_containerId","_fadeAnimated","fadeAnimation","position","_initPanes","panes","_panes","prefix","_initBookLoader","_checkIfLoaded","_targets","tracking","reader","_action","_last_location_start","_reader","action","v","pop","pageview","location","cfi","transform3DLimit","_onMoveEnd","location_href","_ignoreHistory","tmp_href","substr","pushState","percentage","p","isTrusted","state","keyName","check","activeElement","localName","parentElement","IGNORE_TARGETS","shiftKey","_scroll","scrollTop","scrollLeft","_handleDOMEvent","keyCode","srcElement","_fireDOMEvent","targets","synth","_findEventTargets","isMarker","containerPoint","latLngToContainerPoint","getLatLng","mouseEventToContainerPoint","layerPoint","containerPointToLayerPoint","latlng","layerPointToLatLng","nonBubblingEvents","getFixedBookPanelSize","h","clientHeight","paddingTop","paddingBottom","w","clientWidth","paddingRight","paddingLeft","height","width","invalidateSize","_drawn","_resizeRequest","_resizeBookPane","_setupHooks","_checkMobileDevice","_isMobile","matchMedia","_enableBookLoader","_clearBookLoaderTimeout","_force_progress","_loader_timeout","_disableBookLoader","force","loader_template","loaderTemplate","body","DOMParser","parseFromString","children","EOT","Control","_locked","_id","getTime","parseInt","random","getRegion","region","setRegion","removeControl","addControl","getContainer","addTo","onAdd","area","getControlRegion","onRemove","_refocusOnMap","screenX","screenY","focus","_className","widget","direction","control","getControlContainer","_controlContainer","parts","tmp","slug","panel","getControlRegion_1","slot","childElement","_classify","_clearControlRegion","_controlRegions","PageControl","_control","querySelector","_createButton","_fill","html","label","_bindEvents","link","setAttribute","_unit","s","unit","_label","PagePrevious","PageNext","PageFirst","first","PageLast","pageNext","pagePrevious","pageFirst","pageLast","activeModal","FOCUSABLE_ELEMENTS","ACTIONABLE_ELEMENTS","Modal","fraction","actions","onShow","onClose","handlers","_initializedEvents","panelHTML","main","button_cls","modal","onClick","onKeydown","onModalTransition","button_id","button","close","closeModal","deactivate","removeEventListeners","showModal","_resize","setFocusToFirstNode","addEventListeners","activate","offsetHeight","offsetWidth","header","footer","getFocusableNodes","nodes","querySelectorAll","map","focusableNodes","getActionableNodes","maintainFocus","closeAfterAction","hasAttribute","actionableNodes","click","selector","getAttribute","focusedItemIndex","Contents","defaultTemplate","_modal","_setupSkipLink","_process","items","tabindex","option","_createOption","subitems","toc","chapter","anchor","textContent","span","skipLink","ul","contents","Title","h1","_title","_divider","_section","bookTitle","PublicationMetadata","_publisher","_rights","publisher","rights","publicationMetadata","Preferences","hasThemes","_activated","updatePreferences","initializeForm","_createPanel","possible_fieldsets","layout","rootfiles","_fieldsets","cls","fieldset","fields","hasFields","field","inputs","input","checked","hint","_form","new_options","saveable_options","updateForm","Fieldset","_current","TextSize","form","_input","_output","_preview","_actionReset","_updatePreview","saveable","fontSize","Display","scrolled_help","Theme","Rendition","expr","rootfile","accessMode","Scale","transform","preferences","Widget","_onAddExtra","_updateTemplate","_updateClass","node","Button","Panel","Toggle","states","stateName","_resetState","_state","Citation","designMode","formatted","createRange","selectNode","sel","getSelection","removeAllRanges","addRange","flag","execCommand","_message","detach","citations","citation","format","text","createTextNode","_formatted","_initializeForm","_formatCitation","selected","Search","_data","_canceled","_processing","_article","searchString","openModalResults","openModalWaiting","submitQuery","_emptyArticle","_buildResults","searchUrl","XMLHttpRequest","status","response","send","hasChildNodes","lastChild","content","annotations","reset","highlight","highlight_off","search_results","result","cfiRange","snippet","chapterTitle","search","BibliographicInformation","dl","metadata_fields","idx","_formatDate","metadata_fields_seen","dt","dd","match","bibliographicInformation","Download","_configureDownloadForm","submit","download_links","size","download","Navigator","_setup","locations","_initializeNavigator","_createControl","_background","_status","_spanCurrentPercentage","_spanCurrentLocation","_spanTotalLocations","_update","_mouseDown","_initiated","percentageFromCfi","currentLocation","cfiFromPercentage","current","rangeBg","current_location","locationFromCfi","_last_delta","_last_value","_total","total","Bus","instance","bus","Events","ePub","require","EpubJS","_epubjs_ready","xpath","path","sessionStorage","book_href","book_options","packagePath","useArchive","openAs","_book","epubjs","removeItem","loaded","navigation","_contents","package","ready","parseRootfiles","spine","each","cfiBase","_locations","t","f","_rendition","manager","stage","generate","load","containerDoc","hooks","clear","destroy","settings","overflow","spread","_drawRendition","renderTo","_updateFontSize","hash","status_index","register","inner","_initializeReaderStyles","_queueTimeout","rootFilePath","newScrollTop","scrollBy","scrollHeight","_navigate","promise","section","guessed","path1","directory","navPath","path2","dirname","canonical","navigating","doUpdate","changed","_updateScale","reload","_selectTheme","_cached_location","custom_stylesheet_rules","addStylesheetRules","_layout","columnWidth","view","box","book","mod","xyz","override","refresh","select","_queueScale","_metadata","set","_annotations","decodeURI","_annotationsBySectionIndex","createReader","Mock","creator","pubdate","__currentIndex","end","engines","mock","COZY_EPUB_ENGINE","COZY_EPUB_ENGINE_HREF","_this"],"mappings":"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"}
>>>>>>> 1d1a122... builds
=======
{"version":3,"file":"cozy-sun-bear.js","sources":["../node_modules/url-polyfill/url-polyfill.js","../node_modules/classlist-polyfill/src/index.js","../src/core/Util.js","../src/core/Class.js","../src/core/Events.js","../src/core/Browser.js","../src/geometry/Point.js","../src/dom/DomEvent.Pointer.js","../src/dom/DomEvent.DoubleTap.js","../src/dom/DomEvent.js","../src/dom/DomUtil.js","../node_modules/lodash/isObject.js","../node_modules/lodash/_freeGlobal.js","../node_modules/lodash/_root.js","../node_modules/lodash/_Symbol.js","../node_modules/lodash/_getRawTag.js","../node_modules/lodash/_objectToString.js","../node_modules/lodash/_baseGetTag.js","../node_modules/lodash/isObjectLike.js","../node_modules/lodash/isFunction.js","../node_modules/lodash/_coreJsData.js","../node_modules/lodash/_isMasked.js","../node_modules/lodash/_toSource.js","../node_modules/lodash/_baseIsNative.js","../node_modules/lodash/_getValue.js","../node_modules/lodash/_getNative.js","../node_modules/lodash/_defineProperty.js","../node_modules/lodash/_baseAssignValue.js","../node_modules/lodash/eq.js","../node_modules/lodash/_assignValue.js","../node_modules/lodash/_copyObject.js","../node_modules/lodash/identity.js","../node_modules/lodash/_apply.js","../node_modules/lodash/_overRest.js","../node_modules/lodash/constant.js","../node_modules/lodash/_baseSetToString.js","../node_modules/lodash/_shortOut.js","../node_modules/lodash/_setToString.js","../node_modules/lodash/_baseRest.js","../node_modules/lodash/isLength.js","../node_modules/lodash/isArrayLike.js","../node_modules/lodash/_isIndex.js","../node_modules/lodash/_isIterateeCall.js","../node_modules/lodash/_createAssigner.js","../node_modules/lodash/_isPrototype.js","../node_modules/lodash/_baseTimes.js","../node_modules/lodash/_baseIsArguments.js","../node_modules/lodash/isArguments.js","../node_modules/lodash/isArray.js","../node_modules/lodash/stubFalse.js","../node_modules/lodash/isBuffer.js","../node_modules/lodash/_baseIsTypedArray.js","../node_modules/lodash/_baseUnary.js","../node_modules/lodash/_nodeUtil.js","../node_modules/lodash/isTypedArray.js","../node_modules/lodash/_arrayLikeKeys.js","../node_modules/lodash/_overArg.js","../node_modules/lodash/_nativeKeys.js","../node_modules/lodash/_baseKeys.js","../node_modules/lodash/keys.js","../node_modules/lodash/assign.js","../src/screenfull.js","../src/reader/Reader.js","../src/control/Control.js","../src/control/Control.Paging.js","../src/control/Modal.js","../src/control/Control.Contents.js","../src/control/Control.Title.js","../src/control/Control.PublicationMetadata.js","../src/control/Control.Preferences.js","../src/control/Control.Widget.js","../src/control/Control.Citation.js","../src/control/Control.Search.js","../src/control/Control.BibliographicInformation.js","../src/control/Control.Download.js","../src/control/Control.Navigator.js","../src/control/index.js","../src/core/Bus.js","../src/core/index.js","../src/epubjs.js","../node_modules/path-webpack/path.js","../src/reader/Reader.EpubJS.js","../src/reader/Reader.Mock.js","../src/reader/index.js"],"sourcesContent":["(function(global) {\r\n  /**\r\n   * Polyfill URLSearchParams\r\n   *\r\n   * Inspired from : https://github.com/WebReflection/url-search-params/blob/master/src/url-search-params.js\r\n   */\r\n\r\n  var checkIfIteratorIsSupported = function() {\r\n    try {\r\n      return !!Symbol.iterator;\r\n    } catch(error) {\r\n      return false;\r\n    }\r\n  };\r\n\r\n\r\n  var iteratorSupported = checkIfIteratorIsSupported();\r\n\r\n  var createIterator = function(items) {\r\n    var iterator = {\r\n      next: function() {\r\n        var value = items.shift();\r\n        return { done: value === void 0, value: value };\r\n      }\r\n    };\r\n\r\n    if(iteratorSupported) {\r\n      iterator[Symbol.iterator] = function() {\r\n        return iterator;\r\n      };\r\n    }\r\n\r\n    return iterator;\r\n  };\r\n\r\n  /**\r\n   * Search param name and values should be encoded according to https://url.spec.whatwg.org/#urlencoded-serializing\r\n   * encodeURIComponent() produces the same result except encoding spaces as `%20` instead of `+`.\r\n   */\r\n  var serializeParam = function(value) {\r\n    return encodeURIComponent(value).replace(/%20/g, '+');\r\n  };\r\n\r\n  var deserializeParam = function(value) {\r\n    return decodeURIComponent(value).replace(/\\+/g, ' ');\r\n  };\r\n\r\n  var polyfillURLSearchParams= function() {\r\n\r\n    var URLSearchParams = function(searchString) {\r\n      Object.defineProperty(this, '_entries', { value: {} });\r\n\r\n      if(typeof searchString === 'string') {\r\n        if(searchString !== '') {\r\n          searchString = searchString.replace(/^\\?/, '');\r\n          var attributes = searchString.split('&');\r\n          var attribute;\r\n          for(var i = 0; i < attributes.length; i++) {\r\n            attribute = attributes[i].split('=');\r\n            this.append(\r\n              deserializeParam(attribute[0]),\r\n              (attribute.length > 1) ? deserializeParam(attribute[1]) : ''\r\n            );\r\n          }\r\n        }\r\n      } else if(searchString instanceof URLSearchParams) {\r\n        var _this = this;\r\n        searchString.forEach(function(value, name) {\r\n          _this.append(value, name);\r\n        });\r\n      }\r\n    };\r\n\r\n    var proto = URLSearchParams.prototype;\r\n\r\n    proto.append = function(name, value) {\r\n      if(name in this._entries) {\r\n        this._entries[name].push(value.toString());\r\n      } else {\r\n        this._entries[name] = [value.toString()];\r\n      }\r\n    };\r\n\r\n    proto.delete = function(name) {\r\n      delete this._entries[name];\r\n    };\r\n\r\n    proto.get = function(name) {\r\n      return (name in this._entries) ? this._entries[name][0] : null;\r\n    };\r\n\r\n    proto.getAll = function(name) {\r\n      return (name in this._entries) ? this._entries[name].slice(0) : [];\r\n    };\r\n\r\n    proto.has = function(name) {\r\n      return (name in this._entries);\r\n    };\r\n\r\n    proto.set = function(name, value) {\r\n      this._entries[name] = [value.toString()];\r\n    };\r\n\r\n    proto.forEach = function(callback, thisArg) {\r\n      var entries;\r\n      for(var name in this._entries) {\r\n        if(this._entries.hasOwnProperty(name)) {\r\n          entries = this._entries[name];\r\n          for(var i = 0; i < entries.length; i++) {\r\n            callback.call(thisArg, entries[i], name, this);\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    proto.keys = function() {\r\n      var items = [];\r\n      this.forEach(function(value, name) { items.push(name); });\r\n      return createIterator(items);\r\n    };\r\n\r\n    proto.values = function() {\r\n      var items = [];\r\n      this.forEach(function(value) { items.push(value); });\r\n      return createIterator(items);\r\n    };\r\n\r\n    proto.entries = function() {\r\n      var items = [];\r\n      this.forEach(function(value, name) { items.push([name, value]); });\r\n      return createIterator(items);\r\n    };\r\n\r\n    if(iteratorSupported) {\r\n      proto[Symbol.iterator] = proto.entries;\r\n    }\r\n\r\n    proto.toString = function() {\r\n      var searchString = '';\r\n      this.forEach(function(value, name) {\r\n        if(searchString.length > 0) searchString+= '&';\r\n        searchString += serializeParam(name) + '=' + serializeParam(value);\r\n      });\r\n      return searchString;\r\n    };\r\n\r\n    global.URLSearchParams = URLSearchParams;\r\n  };\r\n\r\n  if(!('URLSearchParams' in global) || (new URLSearchParams('?a=1').toString() !== 'a=1')) {\r\n    polyfillURLSearchParams();\r\n  }\r\n\r\n  // HTMLAnchorElement\r\n\r\n})(\r\n  (typeof global !== 'undefined') ? global\r\n    : ((typeof window !== 'undefined') ? window\r\n    : ((typeof self !== 'undefined') ? self : this))\r\n);\r\n\r\n(function(global) {\r\n  /**\r\n   * Polyfill URL\r\n   *\r\n   * Inspired from : https://github.com/arv/DOM-URL-Polyfill/blob/master/src/url.js\r\n   */\r\n\r\n  var checkIfURLIsSupported = function() {\r\n    try {\r\n      var u = new URL('b', 'http://a');\r\n      u.pathname = 'c%20d';\r\n      return (u.href === 'http://a/c%20d') && u.searchParams;\r\n    } catch(e) {\r\n      return false;\r\n    }\r\n  };\r\n\r\n\r\n  var polyfillURL = function() {\r\n    var _URL = global.URL;\r\n\r\n    var URL = function(url, base) {\r\n      if(typeof url !== 'string') url = String(url);\r\n\r\n      var doc = document.implementation.createHTMLDocument('');\r\n      window.doc = doc;\r\n      if(base) {\r\n        var baseElement = doc.createElement('base');\r\n        baseElement.href = base;\r\n        doc.head.appendChild(baseElement);\r\n      }\r\n\r\n      var anchorElement = doc.createElement('a');\r\n      anchorElement.href = url;\r\n      doc.body.appendChild(anchorElement);\r\n      anchorElement.href = anchorElement.href; // force href to refresh\r\n\r\n      if(anchorElement.protocol === ':' || !/:/.test(anchorElement.href)) {\r\n        throw new TypeError('Invalid URL');\r\n      }\r\n\r\n      Object.defineProperty(this, '_anchorElement', {\r\n        value: anchorElement\r\n      });\r\n    };\r\n\r\n    var proto = URL.prototype;\r\n\r\n    var linkURLWithAnchorAttribute = function(attributeName) {\r\n      Object.defineProperty(proto, attributeName, {\r\n        get: function() {\r\n          return this._anchorElement[attributeName];\r\n        },\r\n        set: function(value) {\r\n          this._anchorElement[attributeName] = value;\r\n        },\r\n        enumerable: true\r\n      });\r\n    };\r\n\r\n    ['hash', 'host', 'hostname', 'port', 'protocol', 'search']\r\n    .forEach(function(attributeName) {\r\n      linkURLWithAnchorAttribute(attributeName);\r\n    });\r\n\r\n    Object.defineProperties(proto, {\r\n\r\n      'toString': {\r\n        get: function() {\r\n          var _this = this;\r\n          return function() {\r\n            return _this.href;\r\n          };\r\n        }\r\n      },\r\n\r\n      'href' : {\r\n        get: function() {\r\n          return this._anchorElement.href.replace(/\\?$/,'');\r\n        },\r\n        set: function(value) {\r\n          this._anchorElement.href = value;\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'pathname' : {\r\n        get: function() {\r\n          return this._anchorElement.pathname.replace(/(^\\/?)/,'/');\r\n        },\r\n        set: function(value) {\r\n          this._anchorElement.pathname = value;\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'origin': {\r\n        get: function() {\r\n          // get expected port from protocol\r\n          var expectedPort = {'http:': 80, 'https:': 443, 'ftp:': 21}[this._anchorElement.protocol];\r\n          // add port to origin if, expected port is different than actual port\r\n          // and it is not empty f.e http://foo:8080\r\n          // 8080 != 80 && 8080 != ''\r\n          var addPortToOrigin = this._anchorElement.port != expectedPort &&\r\n            this._anchorElement.port !== ''\r\n\r\n          return this._anchorElement.protocol +\r\n            '//' +\r\n            this._anchorElement.hostname +\r\n            (addPortToOrigin ? (':' + this._anchorElement.port) : '');\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'password': { // TODO\r\n        get: function() {\r\n          return '';\r\n        },\r\n        set: function(value) {\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'username': { // TODO\r\n        get: function() {\r\n          return '';\r\n        },\r\n        set: function(value) {\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'searchParams': {\r\n        get: function() {\r\n          var searchParams = new URLSearchParams(this.search);\r\n          var _this = this;\r\n          ['append', 'delete', 'set'].forEach(function(methodName) {\r\n            var method = searchParams[methodName];\r\n            searchParams[methodName] = function() {\r\n              method.apply(searchParams, arguments);\r\n              _this.search = searchParams.toString();\r\n            };\r\n          });\r\n          return searchParams;\r\n        },\r\n        enumerable: true\r\n      }\r\n    });\r\n\r\n    URL.createObjectURL = function(blob) {\r\n      return _URL.createObjectURL.apply(_URL, arguments);\r\n    };\r\n\r\n    URL.revokeObjectURL = function(url) {\r\n      return _URL.revokeObjectURL.apply(_URL, arguments);\r\n    };\r\n\r\n    global.URL = URL;\r\n\r\n  };\r\n\r\n  if(!checkIfURLIsSupported()) {\r\n    polyfillURL();\r\n  }\r\n\r\n  if((global.location !== void 0) && !('origin' in global.location)) {\r\n    var getOrigin = function() {\r\n      return global.location.protocol + '//' + global.location.hostname + (global.location.port ? (':' + global.location.port) : '');\r\n    };\r\n\r\n    try {\r\n      Object.defineProperty(global.location, 'origin', {\r\n        get: getOrigin,\r\n        enumerable: true\r\n      });\r\n    } catch(e) {\r\n      setInterval(function() {\r\n        global.location.origin = getOrigin();\r\n      }, 100);\r\n    }\r\n  }\r\n\r\n})(\r\n  (typeof global !== 'undefined') ? global\r\n    : ((typeof window !== 'undefined') ? window\r\n    : ((typeof self !== 'undefined') ? self : this))\r\n);\r\n","/*\n * classList.js: Cross-browser full element.classList implementation.\n * 1.1.20170427\n *\n * By Eli Grey, http://eligrey.com\n * License: Dedicated to the public domain.\n *   See https://github.com/eligrey/classList.js/blob/master/LICENSE.md\n */\n\n/*global self, document, DOMException */\n\n/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js */\n\nif (\"document\" in window.self) {\n\n// Full polyfill for browsers with no classList support\n// Including IE < Edge missing SVGElement.classList\nif (!(\"classList\" in document.createElement(\"_\")) \n\t|| document.createElementNS && !(\"classList\" in document.createElementNS(\"http://www.w3.org/2000/svg\",\"g\"))) {\n\n(function (view) {\n\n\"use strict\";\n\nif (!('Element' in view)) return;\n\nvar\n\t  classListProp = \"classList\"\n\t, protoProp = \"prototype\"\n\t, elemCtrProto = view.Element[protoProp]\n\t, objCtr = Object\n\t, strTrim = String[protoProp].trim || function () {\n\t\treturn this.replace(/^\\s+|\\s+$/g, \"\");\n\t}\n\t, arrIndexOf = Array[protoProp].indexOf || function (item) {\n\t\tvar\n\t\t\t  i = 0\n\t\t\t, len = this.length\n\t\t;\n\t\tfor (; i < len; i++) {\n\t\t\tif (i in this && this[i] === item) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t}\n\t// Vendors: please allow content code to instantiate DOMExceptions\n\t, DOMEx = function (type, message) {\n\t\tthis.name = type;\n\t\tthis.code = DOMException[type];\n\t\tthis.message = message;\n\t}\n\t, checkTokenAndGetIndex = function (classList, token) {\n\t\tif (token === \"\") {\n\t\t\tthrow new DOMEx(\n\t\t\t\t  \"SYNTAX_ERR\"\n\t\t\t\t, \"An invalid or illegal string was specified\"\n\t\t\t);\n\t\t}\n\t\tif (/\\s/.test(token)) {\n\t\t\tthrow new DOMEx(\n\t\t\t\t  \"INVALID_CHARACTER_ERR\"\n\t\t\t\t, \"String contains an invalid character\"\n\t\t\t);\n\t\t}\n\t\treturn arrIndexOf.call(classList, token);\n\t}\n\t, ClassList = function (elem) {\n\t\tvar\n\t\t\t  trimmedClasses = strTrim.call(elem.getAttribute(\"class\") || \"\")\n\t\t\t, classes = trimmedClasses ? trimmedClasses.split(/\\s+/) : []\n\t\t\t, i = 0\n\t\t\t, len = classes.length\n\t\t;\n\t\tfor (; i < len; i++) {\n\t\t\tthis.push(classes[i]);\n\t\t}\n\t\tthis._updateClassName = function () {\n\t\t\telem.setAttribute(\"class\", this.toString());\n\t\t};\n\t}\n\t, classListProto = ClassList[protoProp] = []\n\t, classListGetter = function () {\n\t\treturn new ClassList(this);\n\t}\n;\n// Most DOMException implementations don't allow calling DOMException's toString()\n// on non-DOMExceptions. Error's toString() is sufficient here.\nDOMEx[protoProp] = Error[protoProp];\nclassListProto.item = function (i) {\n\treturn this[i] || null;\n};\nclassListProto.contains = function (token) {\n\ttoken += \"\";\n\treturn checkTokenAndGetIndex(this, token) !== -1;\n};\nclassListProto.add = function () {\n\tvar\n\t\t  tokens = arguments\n\t\t, i = 0\n\t\t, l = tokens.length\n\t\t, token\n\t\t, updated = false\n\t;\n\tdo {\n\t\ttoken = tokens[i] + \"\";\n\t\tif (checkTokenAndGetIndex(this, token) === -1) {\n\t\t\tthis.push(token);\n\t\t\tupdated = true;\n\t\t}\n\t}\n\twhile (++i < l);\n\n\tif (updated) {\n\t\tthis._updateClassName();\n\t}\n};\nclassListProto.remove = function () {\n\tvar\n\t\t  tokens = arguments\n\t\t, i = 0\n\t\t, l = tokens.length\n\t\t, token\n\t\t, updated = false\n\t\t, index\n\t;\n\tdo {\n\t\ttoken = tokens[i] + \"\";\n\t\tindex = checkTokenAndGetIndex(this, token);\n\t\twhile (index !== -1) {\n\t\t\tthis.splice(index, 1);\n\t\t\tupdated = true;\n\t\t\tindex = checkTokenAndGetIndex(this, token);\n\t\t}\n\t}\n\twhile (++i < l);\n\n\tif (updated) {\n\t\tthis._updateClassName();\n\t}\n};\nclassListProto.toggle = function (token, force) {\n\ttoken += \"\";\n\n\tvar\n\t\t  result = this.contains(token)\n\t\t, method = result ?\n\t\t\tforce !== true && \"remove\"\n\t\t:\n\t\t\tforce !== false && \"add\"\n\t;\n\n\tif (method) {\n\t\tthis[method](token);\n\t}\n\n\tif (force === true || force === false) {\n\t\treturn force;\n\t} else {\n\t\treturn !result;\n\t}\n};\nclassListProto.toString = function () {\n\treturn this.join(\" \");\n};\n\nif (objCtr.defineProperty) {\n\tvar classListPropDesc = {\n\t\t  get: classListGetter\n\t\t, enumerable: true\n\t\t, configurable: true\n\t};\n\ttry {\n\t\tobjCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\n\t} catch (ex) { // IE 8 doesn't support enumerable:true\n\t\t// adding undefined to fight this issue https://github.com/eligrey/classList.js/issues/36\n\t\t// modernie IE8-MSW7 machine has IE8 8.0.6001.18702 and is affected\n\t\tif (ex.number === undefined || ex.number === -0x7FF5EC54) {\n\t\t\tclassListPropDesc.enumerable = false;\n\t\t\tobjCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\n\t\t}\n\t}\n} else if (objCtr[protoProp].__defineGetter__) {\n\telemCtrProto.__defineGetter__(classListProp, classListGetter);\n}\n\n}(window.self));\n\n}\n\n// There is full or partial native classList support, so just check if we need\n// to normalize the add/remove and toggle APIs.\n\n(function () {\n\t\"use strict\";\n\n\tvar testElement = document.createElement(\"_\");\n\n\ttestElement.classList.add(\"c1\", \"c2\");\n\n\t// Polyfill for IE 10/11 and Firefox <26, where classList.add and\n\t// classList.remove exist but support only one argument at a time.\n\tif (!testElement.classList.contains(\"c2\")) {\n\t\tvar createMethod = function(method) {\n\t\t\tvar original = DOMTokenList.prototype[method];\n\n\t\t\tDOMTokenList.prototype[method] = function(token) {\n\t\t\t\tvar i, len = arguments.length;\n\n\t\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t\ttoken = arguments[i];\n\t\t\t\t\toriginal.call(this, token);\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t\tcreateMethod('add');\n\t\tcreateMethod('remove');\n\t}\n\n\ttestElement.classList.toggle(\"c3\", false);\n\n\t// Polyfill for IE 10 and Firefox <24, where classList.toggle does not\n\t// support the second argument.\n\tif (testElement.classList.contains(\"c3\")) {\n\t\tvar _toggle = DOMTokenList.prototype.toggle;\n\n\t\tDOMTokenList.prototype.toggle = function(token, force) {\n\t\t\tif (1 in arguments && !this.contains(token) === !force) {\n\t\t\t\treturn force;\n\t\t\t} else {\n\t\t\t\treturn _toggle.call(this, token);\n\t\t\t}\n\t\t};\n\n\t}\n\n\ttestElement = null;\n}());\n\n}\n","/*\n * @namespace Util\n *\n * Various utility functions, used by Leaflet internally.\n */\n\n// @function extend(dest: Object, src?: Object): Object\n// Merges the properties of the `src` object (or multiple objects) into `dest` object and returns the latter. Has an `L.extend` shortcut.\nexport function extend(dest) {\n    var i, j, len, src;\n\n    for (j = 1, len = arguments.length; j < len; j++) {\n        src = arguments[j];\n        for (i in src) {\n            dest[i] = src[i];\n        }\n    }\n    return dest;\n}\n\n// @function create(proto: Object, properties?: Object): Object\n// Compatibility polyfill for [Object.create](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/create)\nexport var create = Object.create || (function () {\n    function F() {}\n    return function (proto) {\n        F.prototype = proto;\n        return new F();\n    };\n})();\n\n// @function bind(fn: Function, …): Function\n// Returns a new function bound to the arguments passed, like [Function.prototype.bind](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Function/bind).\n// Has a `L.bind()` shortcut.\nexport function bind(fn, obj) {\n    var slice = Array.prototype.slice;\n\n    if (fn.bind) {\n        return fn.bind.apply(fn, slice.call(arguments, 1));\n    }\n\n    var args = slice.call(arguments, 2);\n\n    return function () {\n        return fn.apply(obj, args.length ? args.concat(slice.call(arguments)) : arguments);\n    };\n}\n\n// @property lastId: Number\n// Last unique ID used by [`stamp()`](#util-stamp)\nexport var lastId = 0;\n\n// @function stamp(obj: Object): Number\n// Returns the unique ID of an object, assiging it one if it doesn't have it.\nexport function stamp(obj) {\n    /*eslint-disable */\n    obj._cozy_id = obj._cozy_id || ++lastId;\n    return obj._cozy_id; /* not leaflet */\n    /*eslint-enable */\n}\n\n// @function throttle(fn: Function, time: Number, context: Object): Function\n// Returns a function which executes function `fn` with the given scope `context`\n// (so that the `this` keyword refers to `context` inside `fn`'s code). The function\n// `fn` will be called no more than one time per given amount of `time`. The arguments\n// received by the bound function will be any arguments passed when binding the\n// function, followed by any arguments passed when invoking the bound function.\n// Has an `L.throttle` shortcut.\nexport function throttle(fn, time, context) {\n    var lock, args, wrapperFn, later;\n\n    later = function () {\n        // reset lock and call if queued\n        lock = false;\n        if (args) {\n            wrapperFn.apply(context, args);\n            args = false;\n        }\n    };\n\n    wrapperFn = function () {\n        if (lock) {\n            // called too soon, queue to call later\n            args = arguments;\n\n        } else {\n            // call and lock until later\n            fn.apply(context, arguments);\n            setTimeout(later, time);\n            lock = true;\n        }\n    };\n\n    return wrapperFn;\n}\n\n// @function wrapNum(num: Number, range: Number[], includeMax?: Boolean): Number\n// Returns the number `num` modulo `range` in such a way so it lies within\n// `range[0]` and `range[1]`. The returned value will be always smaller than\n// `range[1]` unless `includeMax` is set to `true`.\nexport function wrapNum(x, range, includeMax) {\n    var max = range[1],\n        min = range[0],\n        d = max - min;\n    return x === max && includeMax ? x : ((x - min) % d + d) % d + min;\n}\n\n// @function falseFn(): Function\n// Returns a function which always returns `false`.\nexport function falseFn() { return false; }\n\n// @function formatNum(num: Number, digits?: Number): Number\n// Returns the number `num` rounded to `digits` decimals, or to 5 decimals by default.\nexport function formatNum(num, digits) {\n    var pow = Math.pow(10, digits || 5);\n    return Math.round(num * pow) / pow;\n}\n\n// @function isNumeric(num: Number): Boolean\n// Returns whether num is actually numeric\nexport function isNumeric(num) {\n  return !isNaN(parseFloat(num)) && isFinite(num);\n}\n\n// @function trim(str: String): String\n// Compatibility polyfill for [String.prototype.trim](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String/Trim)\nexport function trim(str) {\n    return str.trim ? str.trim() : str.replace(/^\\s+|\\s+$/g, '');\n}\n\n// @function splitWords(str: String): String[]\n// Trims and splits the string on whitespace and returns the array of parts.\nexport function splitWords(str) {\n    return trim(str).split(/\\s+/);\n}\n\n// @function setOptions(obj: Object, options: Object): Object\n// Merges the given properties to the `options` of the `obj` object, returning the resulting options. See `Class options`. Has an `L.setOptions` shortcut.\nexport function setOptions(obj, options) {\n    if (!obj.hasOwnProperty('options')) {\n        obj.options = obj.options ? create(obj.options) : {};\n    }\n    for (var i in options) {\n        obj.options[i] = options[i];\n    }\n    return obj.options;\n}\n\n// @function getParamString(obj: Object, existingUrl?: String, uppercase?: Boolean): String\n// Converts an object into a parameter URL string, e.g. `{a: \"foo\", b: \"bar\"}`\n// translates to `'?a=foo&b=bar'`. If `existingUrl` is set, the parameters will\n// be appended at the end. If `uppercase` is `true`, the parameter names will\n// be uppercased (e.g. `'?A=foo&B=bar'`)\nexport function getParamString(obj, existingUrl, uppercase) {\n    var params = [];\n    for (var i in obj) {\n        params.push(encodeURIComponent(uppercase ? i.toUpperCase() : i) + '=' + encodeURIComponent(obj[i]));\n    }\n    return ((!existingUrl || existingUrl.indexOf('?') === -1) ? '?' : '&') + params.join('&');\n}\n\nvar templateRe = /\\{ *([\\w_\\-]+) *\\}/g;\n\n// @function template(str: String, data: Object): String\n// Simple templating facility, accepts a template string of the form `'Hello {a}, {b}'`\n// and a data object like `{a: 'foo', b: 'bar'}`, returns evaluated string\n// `('Hello foo, bar')`. You can also specify functions instead of strings for\n// data values — they will be evaluated passing `data` as an argument.\nexport function template(str, data) {\n    return str.replace(templateRe, function (str, key) {\n        var value = data[key];\n\n        if (value === undefined) {\n            throw new Error('No value provided for variable ' + str);\n\n        } else if (typeof value === 'function') {\n            value = value(data);\n        }\n        return value;\n    });\n}\n\n// @function isArray(obj): Boolean\n// Compatibility polyfill for [Array.isArray](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array/isArray)\nexport var isArray = Array.isArray || function (obj) {\n    return (Object.prototype.toString.call(obj) === '[object Array]');\n};\n\n// @function indexOf(array: Array, el: Object): Number\n// Compatibility polyfill for [Array.prototype.indexOf](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf)\nexport function indexOf(array, el) {\n    for (var i = 0; i < array.length; i++) {\n        if (array[i] === el) { return i; }\n    }\n    return -1;\n}\n\n// @property emptyImageUrl: String\n// Data URI string containing a base64-encoded empty GIF image.\n// Used as a hack to free memory from unused images on WebKit-powered\n// mobile devices (by setting image `src` to this string).\nexport var emptyImageUrl = 'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=';\n\n// inspired by http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n\nfunction getPrefixed(name) {\n    return window['webkit' + name] || window['moz' + name] || window['ms' + name];\n}\n\nvar lastTime = 0;\n\n// fallback for IE 7-8\nfunction timeoutDefer(fn) {\n    var time = +new Date(),\n        timeToCall = Math.max(0, 16 - (time - lastTime));\n\n    lastTime = time + timeToCall;\n    return window.setTimeout(fn, timeToCall);\n}\n\nexport var requestFn = window.requestAnimationFrame || getPrefixed('RequestAnimationFrame') || timeoutDefer;\nexport var cancelFn = window.cancelAnimationFrame || getPrefixed('CancelAnimationFrame') ||\n        getPrefixed('CancelRequestAnimationFrame') || function (id) { window.clearTimeout(id); };\n\n// @function requestAnimFrame(fn: Function, context?: Object, immediate?: Boolean): Number\n// Schedules `fn` to be executed when the browser repaints. `fn` is bound to\n// `context` if given. When `immediate` is set, `fn` is called immediately if\n// the browser doesn't have native support for\n// [`window.requestAnimationFrame`](https://developer.mozilla.org/docs/Web/API/window/requestAnimationFrame),\n// otherwise it's delayed. Returns a request ID that can be used to cancel the request.\nexport function requestAnimFrame(fn, context, immediate) {\n    if (immediate && requestFn === timeoutDefer) {\n        fn.call(context);\n    } else {\n        return requestFn.call(window, bind(fn, context));\n    }\n}\n\n// @function cancelAnimFrame(id: Number): undefined\n// Cancels a previous `requestAnimFrame`. See also [window.cancelAnimationFrame](https://developer.mozilla.org/docs/Web/API/window/cancelAnimationFrame).\nexport function cancelAnimFrame(id) {\n    if (id) {\n        cancelFn.call(window, id);\n    }\n}\n\nexport var loader = {\n    js: function(url) {\n        var handler = { _resolved: false };\n        handler.callbacks = [];\n        handler.error = [];\n        handler.then = function(cb) {\n            handler.callbacks.push(cb);\n            if ( handler._resolved ) { return handler.resolve(); }\n            return handler;\n        }\n        handler.catch = function(cb) {\n            handler.error.push(cb);\n            if ( handler._resolved ) { return handler.reject(); }\n            return handler;\n        }\n        handler.resolve = function(_argv) {\n            // var _argv;\n            handler._resolved = true;\n            while ( handler.callbacks.length ) {\n                var cb = handler.callbacks.shift();\n                var retval;\n                try {\n                    _argv = cb(_argv);\n                } catch(e) {\n                    console.log(e);\n                    handler.reject(e);\n                    break;\n                }\n            }\n            return handler;\n        }\n\n        handler.reject = function(e) {\n            while ( handler.error.length ) {\n                var cb = handler.error.shift();\n                cb(e);\n            }\n            console.log(e);\n            console.trace();\n            return handler;\n        }\n\n        if ( url == undefined ) {\n            handler._resolved = true;\n            return handler;\n        }\n\n        var element = document.createElement('script');\n\n        element.onload = function() {\n          handler.resolve(url);\n        };\n        element.onerror = function() {\n          handler.catch.apply(arguments);\n        };\n\n        element.async = true;\n        var parent = 'body';\n        var attr = 'src';\n        element[attr] = url;\n        document[parent].appendChild(element);\n\n        console.log(\"AHOY APPENDED\", url);\n\n        return handler;\n    }\n}","import * as Util from './Util';\r\n\r\n// @class Class\r\n// @aka L.Class\r\n\r\n// @section\r\n// @uninheritable\r\n\r\n// Thanks to John Resig and Dean Edwards for inspiration!\r\n\r\nexport function Class() {}\r\n\r\nClass.extend = function (props) {\r\n\r\n\t// @function extend(props: Object): Function\r\n\t// [Extends the current class](#class-inheritance) given the properties to be included.\r\n\t// Returns a Javascript function that is a class constructor (to be called with `new`).\r\n\tvar NewClass = function () {\r\n\r\n\t\t// call the constructor\r\n\t\tif (this.initialize) {\r\n\t\t\tthis.initialize.apply(this, arguments);\r\n\t\t}\r\n\r\n\t\t// call all constructor hooks\r\n\t\tthis.callInitHooks();\r\n\t};\r\n\r\n\tvar parentProto = NewClass.__super__ = this.prototype;\r\n\r\n\tvar proto = Util.create(parentProto);\r\n\tproto.constructor = NewClass;\r\n\r\n\tNewClass.prototype = proto;\r\n\r\n\t// inherit parent's statics\r\n\tfor (var i in this) {\r\n\t\tif (this.hasOwnProperty(i) && i !== 'prototype') {\r\n\t\t\tNewClass[i] = this[i];\r\n\t\t}\r\n\t}\r\n\r\n\t// mix static properties into the class\r\n\tif (props.statics) {\r\n\t\tUtil.extend(NewClass, props.statics);\r\n\t\tdelete props.statics;\r\n\t}\r\n\r\n\t// mix includes into the prototype\r\n\tif (props.includes) {\r\n\t\tcheckDeprecatedMixinEvents(props.includes);\r\n\t\tUtil.extend.apply(null, [proto].concat(props.includes));\r\n\t\tdelete props.includes;\r\n\t}\r\n\r\n\t// merge options\r\n\tif (proto.options) {\r\n\t\tprops.options = Util.extend(Util.create(proto.options), props.options);\r\n\t}\r\n\r\n\t// mix given properties into the prototype\r\n\tUtil.extend(proto, props);\r\n\t\r\n\tproto._initHooks = [];\r\n\r\n\t// add method for calling all hooks\r\n\tproto.callInitHooks = function () {\r\n\r\n\t\tif (this._initHooksCalled) { return; }\r\n\r\n\t\tif (parentProto.callInitHooks) {\r\n\t\t\tparentProto.callInitHooks.call(this);\r\n\t\t}\r\n\r\n\t\tthis._initHooksCalled = true;\r\n\r\n\t\tfor (var i = 0, len = proto._initHooks.length; i < len; i++) {\r\n\t\t\tproto._initHooks[i].call(this);\r\n\t\t}\r\n\t};\r\n\r\n\treturn NewClass;\r\n};\r\n\r\n\r\n// @function include(properties: Object): this\r\n// [Includes a mixin](#class-includes) into the current class.\r\nClass.include = function (props) {\r\n\tUtil.extend(this.prototype, props);\r\n\treturn this;\r\n};\r\n\r\n// @function mergeOptions(options: Object): this\r\n// [Merges `options`](#class-options) into the defaults of the class.\r\nClass.mergeOptions = function (options) {\r\n\tUtil.extend(this.prototype.options, options);\r\n\treturn this;\r\n};\r\n\r\n// @function addInitHook(fn: Function): this\r\n// Adds a [constructor hook](#class-constructor-hooks) to the class.\r\nClass.addInitHook = function (fn) { // (Function) || (String, args...)\r\n\tvar args = Array.prototype.slice.call(arguments, 1);\r\n\r\n\tvar init = typeof fn === 'function' ? fn : function () {\r\n\t\tthis[fn].apply(this, args);\r\n\t};\r\n\r\n\tthis.prototype._initHooks = this.prototype._initHooks || [];\r\n\tthis.prototype._initHooks.push(init);\r\n\treturn this;\r\n};\r\n\r\nfunction checkDeprecatedMixinEvents(includes) {\r\n\tif (!cozy || !cozy.Mixin) { return; }\r\n\r\n\tincludes = cozy.Util.isArray(includes) ? includes : [includes];\r\n\r\n\t// for (var i = 0; i < includes.length; i++) {\r\n\t// \tif (includes[i] === cozy.Mixin.Events) {\r\n\t// \t\tconsole.warn('Deprecated include of cozy.Mixin.Events: ' +\r\n\t// \t\t\t'this property will be removed in future releases, ' +\r\n\t// \t\t\t'please inherit from cozy.Evented instead.', new Error().stack);\r\n\t// \t}\r\n\t// }\r\n}\r\n","import {Class} from './Class';\r\nimport * as Util from './Util';\r\n\r\n/*\r\n * @class Evented\r\n * @aka L.Evented\r\n * @inherits Class\r\n *\r\n * A set of methods shared between event-powered classes (like `Map` and `Marker`). Generally, events allow you to execute some function when something happens with an object (e.g. the user clicks on the map, causing the map to fire `'click'` event).\r\n *\r\n * @example\r\n *\r\n * ```js\r\n * map.on('click', function(e) {\r\n * \talert(e.latlng);\r\n * } );\r\n * ```\r\n *\r\n * Leaflet deals with event listeners by reference, so if you want to add a listener and then remove it, define it as a function:\r\n *\r\n * ```js\r\n * function onClick(e) { ... }\r\n *\r\n * map.on('click', onClick);\r\n * map.off('click', onClick);\r\n * ```\r\n */\r\n\r\nexport var Evented = Class.extend({\r\n\r\n\t/* @method on(type: String, fn: Function, context?: Object): this\r\n\t * Adds a listener function (`fn`) to a particular event type of the object. You can optionally specify the context of the listener (object the this keyword will point to). You can also pass several space-separated types (e.g. `'click dblclick'`).\r\n\t *\r\n\t * @alternative\r\n\t * @method on(eventMap: Object): this\r\n\t * Adds a set of type/listener pairs, e.g. `{click: onClick, mousemove: onMouseMove}`\r\n\t */\r\n\ton: function (types, fn, context) {\r\n\r\n\t\t// types can be a map of types/handlers\r\n\t\tif (typeof types === 'object') {\r\n\t\t\tfor (var type in types) {\r\n\t\t\t\t// we don't process space-separated events here for performance;\r\n\t\t\t\t// it's a hot path since Layer uses the on(obj) syntax\r\n\t\t\t\tthis._on(type, types[type], fn);\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\t// types can be a string of space-separated words\r\n\t\t\ttypes = Util.splitWords(types);\r\n\r\n\t\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\t\tthis._on(types[i], fn, context);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t/* @method off(type: String, fn?: Function, context?: Object): this\r\n\t * Removes a previously added listener function. If no function is specified, it will remove all the listeners of that particular event from the object. Note that if you passed a custom context to `on`, you must pass the same context to `off` in order to remove the listener.\r\n\t *\r\n\t * @alternative\r\n\t * @method off(eventMap: Object): this\r\n\t * Removes a set of type/listener pairs.\r\n\t *\r\n\t * @alternative\r\n\t * @method off: this\r\n\t * Removes all listeners to all events on the object.\r\n\t */\r\n\toff: function (types, fn, context) {\r\n\r\n\t\tif (!types) {\r\n\t\t\t// clear all listeners if called without arguments\r\n\t\t\tdelete this._events;\r\n\r\n\t\t} else if (typeof types === 'object') {\r\n\t\t\tfor (var type in types) {\r\n\t\t\t\tthis._off(type, types[type], fn);\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\ttypes = Util.splitWords(types);\r\n\r\n\t\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\t\tthis._off(types[i], fn, context);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// attach listener (without syntactic sugar now)\r\n\t_on: function (type, fn, context) {\r\n\t\tthis._events = this._events || {};\r\n\r\n\t\t/* get/init listeners for type */\r\n\t\tvar typeListeners = this._events[type];\r\n\t\tif (!typeListeners) {\r\n\t\t\ttypeListeners = [];\r\n\t\t\tthis._events[type] = typeListeners;\r\n\t\t}\r\n\r\n\t\tif (context === this) {\r\n\t\t\t// Less memory footprint.\r\n\t\t\tcontext = undefined;\r\n\t\t}\r\n\t\tvar newListener = {fn: fn, ctx: context},\r\n\t\t    listeners = typeListeners;\r\n\r\n\t\t// check if fn already there\r\n\t\tfor (var i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\tif (listeners[i].fn === fn && listeners[i].ctx === context) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlisteners.push(newListener);\r\n\t},\r\n\r\n\t_off: function (type, fn, context) {\r\n\t\tvar listeners,\r\n\t\t    i,\r\n\t\t    len;\r\n\r\n\t\tif (!this._events) { return; }\r\n\r\n\t\tlisteners = this._events[type];\r\n\r\n\t\tif (!listeners) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!fn) {\r\n\t\t\t// Set all removed listeners to noop so they are not called if remove happens in fire\r\n\t\t\tfor (i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\t\tlisteners[i].fn = Util.falseFn;\r\n\t\t\t}\r\n\t\t\t// clear all listeners for a type if function isn't specified\r\n\t\t\tdelete this._events[type];\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (context === this) {\r\n\t\t\tcontext = undefined;\r\n\t\t}\r\n\r\n\t\tif (listeners) {\r\n\r\n\t\t\t// find fn and remove it\r\n\t\t\tfor (i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\t\tvar l = listeners[i];\r\n\t\t\t\tif (l.ctx !== context) { continue; }\r\n\t\t\t\tif (l.fn === fn) {\r\n\r\n\t\t\t\t\t// set the removed listener to noop so that's not called if remove happens in fire\r\n\t\t\t\t\tl.fn = Util.falseFn;\r\n\r\n\t\t\t\t\tif (this._firingCount) {\r\n\t\t\t\t\t\t/* copy array in case events are being fired */\r\n\t\t\t\t\t\tthis._events[type] = listeners = listeners.slice();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlisteners.splice(i, 1);\r\n\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t// @method fire(type: String, data?: Object, propagate?: Boolean): this\r\n\t// Fires an event of the specified type. You can optionally provide an data\r\n\t// object — the first argument of the listener function will contain its\r\n\t// properties. The event can optionally be propagated to event parents.\r\n\tfire: function (type, data, propagate) {\r\n\t\tif (!this.listens(type, propagate)) { return this; }\r\n\r\n\t\tvar event = Util.extend({}, data, {type: type, target: this});\r\n\r\n\t\tif (this._events) {\r\n\t\t\tvar listeners = this._events[type];\r\n\r\n\t\t\tif (listeners) {\r\n\t\t\t\tthis._firingCount = (this._firingCount + 1) || 1;\r\n\t\t\t\tfor (var i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\t\t\tvar l = listeners[i];\r\n\t\t\t\t\tl.fn.call(l.ctx || this, event);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._firingCount--;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (propagate) {\r\n\t\t\t// propagate the event to parents (set with addEventParent)\r\n\t\t\tthis._propagateEvent(event);\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method listens(type: String): Boolean\r\n\t// Returns `true` if a particular event type has any listeners attached to it.\r\n\tlistens: function (type, propagate) {\r\n\t\tvar listeners = this._events && this._events[type];\r\n\t\tif (listeners && listeners.length) { return true; }\r\n\r\n\t\tif (propagate) {\r\n\t\t\t// also check parents for listeners if event propagates\r\n\t\t\tfor (var id in this._eventParents) {\r\n\t\t\t\tif (this._eventParents[id].listens(type, propagate)) { return true; }\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\r\n\t// @method once(…): this\r\n\t// Behaves as [`on(…)`](#evented-on), except the listener will only get fired once and then removed.\r\n\tonce: function (types, fn, context) {\r\n\r\n\t\tif (typeof types === 'object') {\r\n\t\t\tfor (var type in types) {\r\n\t\t\t\tthis.once(type, types[type], fn);\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tvar handler = Util.bind(function () {\r\n\t\t\tthis\r\n\t\t\t    .off(types, fn, context)\r\n\t\t\t    .off(types, handler, context);\r\n\t\t}, this);\r\n\r\n\t\t// add a listener that's executed once and removed after that\r\n\t\treturn this\r\n\t\t    .on(types, fn, context)\r\n\t\t    .on(types, handler, context);\r\n\t},\r\n\r\n\t// @method addEventParent(obj: Evented): this\r\n\t// Adds an event parent - an `Evented` that will receive propagated events\r\n\taddEventParent: function (obj) {\r\n\t\tthis._eventParents = this._eventParents || {};\r\n\t\tthis._eventParents[Util.stamp(obj)] = obj;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method removeEventParent(obj: Evented): this\r\n\t// Removes an event parent, so it will stop receiving propagated events\r\n\tremoveEventParent: function (obj) {\r\n\t\tif (this._eventParents) {\r\n\t\t\tdelete this._eventParents[Util.stamp(obj)];\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\t_propagateEvent: function (e) {\r\n\t\tfor (var id in this._eventParents) {\r\n\t\t\tthis._eventParents[id].fire(e.type, Util.extend({layer: e.target}, e), true);\r\n\t\t}\r\n\t}\r\n});\r\n\r\nvar proto = Evented.prototype;\r\n\r\n// aliases; we should ditch those eventually\r\n\r\n// @method addEventListener(…): this\r\n// Alias to [`on(…)`](#evented-on)\r\nproto.addEventListener = proto.on;\r\n\r\n// @method removeEventListener(…): this\r\n// Alias to [`off(…)`](#evented-off)\r\n\r\n// @method clearAllEventListeners(…): this\r\n// Alias to [`off()`](#evented-off)\r\nproto.removeEventListener = proto.clearAllEventListeners = proto.off;\r\n\r\n// @method addOneTimeEventListener(…): this\r\n// Alias to [`once(…)`](#evented-once)\r\nproto.addOneTimeEventListener = proto.once;\r\n\r\n// @method fireEvent(…): this\r\n// Alias to [`fire(…)`](#evented-fire)\r\nproto.fireEvent = proto.fire;\r\n\r\n// @method hasEventListeners(…): Boolean\r\n// Alias to [`listens(…)`](#evented-listens)\r\nproto.hasEventListeners = proto.listens;\r\n","\n/*\n * @namespace Browser\n * @aka L.Browser\n *\n * A namespace with static properties for browser/feature detection used by Leaflet internally.\n *\n * @example\n *\n * ```js\n * if (L.Browser.ielt9) {\n *   alert('Upgrade your browser, dude!');\n * }\n * ```\n */\n\nvar style = document.documentElement.style;\n\n// @property ie: Boolean; `true` for all Internet Explorer versions (not Edge).\nexport var ie = 'ActiveXObject' in window;\n\n// @property ielt9: Boolean; `true` for Internet Explorer versions less than 9.\nexport var ielt9 = ie && !document.addEventListener;\n\n// @property edge: Boolean; `true` for the Edge web browser.\nexport var edge = 'msLaunchUri' in navigator && !('documentMode' in document);\n\n// @property webkit: Boolean;\n// `true` for webkit-based browsers like Chrome and Safari (including mobile versions).\nexport var webkit = userAgentContains('webkit');\n\n// @property android: Boolean\n// `true` for any browser running on an Android platform.\nexport var android = userAgentContains('android');\n\n// @property android23: Boolean; `true` for browsers running on Android 2 or Android 3.\nexport var android23 = userAgentContains('android 2') || userAgentContains('android 3');\n\n// @property opera: Boolean; `true` for the Opera browser\nexport var opera = !!window.opera;\n\n// @property chrome: Boolean; `true` for the Chrome browser.\nexport var chrome = userAgentContains('chrome');\n\n// @property gecko: Boolean; `true` for gecko-based browsers like Firefox.\nexport var gecko = userAgentContains('gecko') && !webkit && !opera && !ie;\n\n// @property safari: Boolean; `true` for the Safari browser.\nexport var safari = !chrome && userAgentContains('safari');\n\nexport var phantom = userAgentContains('phantom');\n\n// @property opera12: Boolean\n// `true` for the Opera browser supporting CSS transforms (version 12 or later).\nexport var opera12 = 'OTransition' in style;\n\n// @property win: Boolean; `true` when the browser is running in a Windows platform\nexport var win = navigator.platform.indexOf('Win') === 0;\n\n// @property ie3d: Boolean; `true` for all Internet Explorer versions supporting CSS transforms.\nexport var ie3d = ie && ('transition' in style);\n\n// @property webkit3d: Boolean; `true` for webkit-based browsers supporting CSS transforms.\nexport var webkit3d = ('WebKitCSSMatrix' in window) && ('m11' in new window.WebKitCSSMatrix()) && !android23;\n\n// @property gecko3d: Boolean; `true` for gecko-based browsers supporting CSS transforms.\nexport var gecko3d = 'MozPerspective' in style;\n\n// @property any3d: Boolean\n// `true` for all browsers supporting CSS transforms.\nexport var any3d = !window.L_DISABLE_3D && (ie3d || webkit3d || gecko3d) && !opera12 && !phantom;\n\n// @property mobile: Boolean; `true` for all browsers running in a mobile device.\nexport var mobile = typeof orientation !== 'undefined' || userAgentContains('mobile');\n\n// @property mobileWebkit: Boolean; `true` for all webkit-based browsers in a mobile device.\nexport var mobileWebkit = mobile && webkit;\n\n// @property mobileWebkit3d: Boolean\n// `true` for all webkit-based browsers in a mobile device supporting CSS transforms.\nexport var mobileWebkit3d = mobile && webkit3d;\n\n// @property msPointer: Boolean\n// `true` for browsers implementing the Microsoft touch events model (notably IE10).\nexport var msPointer = !window.PointerEvent && window.MSPointerEvent;\n\n// @property pointer: Boolean\n// `true` for all browsers supporting [pointer events](https://msdn.microsoft.com/en-us/library/dn433244%28v=vs.85%29.aspx).\nexport var pointer = !!(window.PointerEvent || msPointer);\n\n// @property touch: Boolean\n// `true` for all browsers supporting [touch events](https://developer.mozilla.org/docs/Web/API/Touch_events).\n// This does not necessarily mean that the browser is running in a computer with\n// a touchscreen, it only means that the browser is capable of understanding\n// touch events.\nexport var touch = !window.L_NO_TOUCH && (pointer || 'ontouchstart' in window ||\n        (window.DocumentTouch && document instanceof window.DocumentTouch));\n\n// @property mobileOpera: Boolean; `true` for the Opera browser in a mobile device.\nexport var mobileOpera = mobile && opera;\n\n// @property mobileGecko: Boolean\n// `true` for gecko-based browsers running in a mobile device.\nexport var mobileGecko = mobile && gecko;\n\n// @property retina: Boolean\n// `true` for browsers on a high-resolution \"retina\" screen.\nexport var retina = (window.devicePixelRatio || (window.screen.deviceXDPI / window.screen.logicalXDPI)) > 1;\n\n\n// @property canvas: Boolean\n// `true` when the browser supports [`<canvas>`](https://developer.mozilla.org/docs/Web/API/Canvas_API).\nexport var canvas = (function () {\n    return !!document.createElement('canvas').getContext;\n}());\n\n// @property svg: Boolean\n// `true` when the browser supports [SVG](https://developer.mozilla.org/docs/Web/SVG).\n// export var svg = !!(document.createElementNS && svgCreate('svg').createSVGRect);\nexport var svg = true;\n\n// @property vml: Boolean\n// `true` if the browser supports [VML](https://en.wikipedia.org/wiki/Vector_Markup_Language).\nexport var vml = !svg && (function () {\n    try {\n        var div = document.createElement('div');\n        div.innerHTML = '<v:shape adj=\"1\"/>';\n\n        var shape = div.firstChild;\n        shape.style.behavior = 'url(#default#VML)';\n\n        return shape && (typeof shape.adj === 'object');\n\n    } catch (e) {\n        return false;\n    }\n}());\n\nexport var columnCount = ( 'columnCount' in style );\nexport var classList = ( document.documentElement.classList !== undefined );\n\nfunction userAgentContains(str) {\n    return navigator.userAgent.toLowerCase().indexOf(str) >= 0;\n}\n","import {isArray, formatNum} from '../core/Util';\r\n\r\n/*\r\n * @class Point\r\n * @aka L.Point\r\n *\r\n * Represents a point with `x` and `y` coordinates in pixels.\r\n *\r\n * @example\r\n *\r\n * ```js\r\n * var point = L.point(200, 300);\r\n * ```\r\n *\r\n * All Leaflet methods and options that accept `Point` objects also accept them in a simple Array form (unless noted otherwise), so these lines are equivalent:\r\n *\r\n * ```js\r\n * map.panBy([200, 300]);\r\n * map.panBy(L.point(200, 300));\r\n * ```\r\n */\r\n\r\nexport function Point(x, y, round) {\r\n\t// @property x: Number; The `x` coordinate of the point\r\n\tthis.x = (round ? Math.round(x) : x);\r\n\t// @property y: Number; The `y` coordinate of the point\r\n\tthis.y = (round ? Math.round(y) : y);\r\n}\r\n\r\nPoint.prototype = {\r\n\r\n\t// @method clone(): Point\r\n\t// Returns a copy of the current point.\r\n\tclone: function () {\r\n\t\treturn new Point(this.x, this.y);\r\n\t},\r\n\r\n\t// @method add(otherPoint: Point): Point\r\n\t// Returns the result of addition of the current and the given points.\r\n\tadd: function (point) {\r\n\t\t// non-destructive, returns a new point\r\n\t\treturn this.clone()._add(toPoint(point));\r\n\t},\r\n\r\n\t_add: function (point) {\r\n\t\t// destructive, used directly for performance in situations where it's safe to modify existing point\r\n\t\tthis.x += point.x;\r\n\t\tthis.y += point.y;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method subtract(otherPoint: Point): Point\r\n\t// Returns the result of subtraction of the given point from the current.\r\n\tsubtract: function (point) {\r\n\t\treturn this.clone()._subtract(toPoint(point));\r\n\t},\r\n\r\n\t_subtract: function (point) {\r\n\t\tthis.x -= point.x;\r\n\t\tthis.y -= point.y;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method divideBy(num: Number): Point\r\n\t// Returns the result of division of the current point by the given number.\r\n\tdivideBy: function (num) {\r\n\t\treturn this.clone()._divideBy(num);\r\n\t},\r\n\r\n\t_divideBy: function (num) {\r\n\t\tthis.x /= num;\r\n\t\tthis.y /= num;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method multiplyBy(num: Number): Point\r\n\t// Returns the result of multiplication of the current point by the given number.\r\n\tmultiplyBy: function (num) {\r\n\t\treturn this.clone()._multiplyBy(num);\r\n\t},\r\n\r\n\t_multiplyBy: function (num) {\r\n\t\tthis.x *= num;\r\n\t\tthis.y *= num;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method scaleBy(scale: Point): Point\r\n\t// Multiply each coordinate of the current point by each coordinate of\r\n\t// `scale`. In linear algebra terms, multiply the point by the\r\n\t// [scaling matrix](https://en.wikipedia.org/wiki/Scaling_%28geometry%29#Matrix_representation)\r\n\t// defined by `scale`.\r\n\tscaleBy: function (point) {\r\n\t\treturn new Point(this.x * point.x, this.y * point.y);\r\n\t},\r\n\r\n\t// @method unscaleBy(scale: Point): Point\r\n\t// Inverse of `scaleBy`. Divide each coordinate of the current point by\r\n\t// each coordinate of `scale`.\r\n\tunscaleBy: function (point) {\r\n\t\treturn new Point(this.x / point.x, this.y / point.y);\r\n\t},\r\n\r\n\t// @method round(): Point\r\n\t// Returns a copy of the current point with rounded coordinates.\r\n\tround: function () {\r\n\t\treturn this.clone()._round();\r\n\t},\r\n\r\n\t_round: function () {\r\n\t\tthis.x = Math.round(this.x);\r\n\t\tthis.y = Math.round(this.y);\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method floor(): Point\r\n\t// Returns a copy of the current point with floored coordinates (rounded down).\r\n\tfloor: function () {\r\n\t\treturn this.clone()._floor();\r\n\t},\r\n\r\n\t_floor: function () {\r\n\t\tthis.x = Math.floor(this.x);\r\n\t\tthis.y = Math.floor(this.y);\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method ceil(): Point\r\n\t// Returns a copy of the current point with ceiled coordinates (rounded up).\r\n\tceil: function () {\r\n\t\treturn this.clone()._ceil();\r\n\t},\r\n\r\n\t_ceil: function () {\r\n\t\tthis.x = Math.ceil(this.x);\r\n\t\tthis.y = Math.ceil(this.y);\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method distanceTo(otherPoint: Point): Number\r\n\t// Returns the cartesian distance between the current and the given points.\r\n\tdistanceTo: function (point) {\r\n\t\tpoint = toPoint(point);\r\n\r\n\t\tvar x = point.x - this.x,\r\n\t\t    y = point.y - this.y;\r\n\r\n\t\treturn Math.sqrt(x * x + y * y);\r\n\t},\r\n\r\n\t// @method equals(otherPoint: Point): Boolean\r\n\t// Returns `true` if the given point has the same coordinates.\r\n\tequals: function (point) {\r\n\t\tpoint = toPoint(point);\r\n\r\n\t\treturn point.x === this.x &&\r\n\t\t       point.y === this.y;\r\n\t},\r\n\r\n\t// @method contains(otherPoint: Point): Boolean\r\n\t// Returns `true` if both coordinates of the given point are less than the corresponding current point coordinates (in absolute values).\r\n\tcontains: function (point) {\r\n\t\tpoint = toPoint(point);\r\n\r\n\t\treturn Math.abs(point.x) <= Math.abs(this.x) &&\r\n\t\t       Math.abs(point.y) <= Math.abs(this.y);\r\n\t},\r\n\r\n\t// @method toString(): String\r\n\t// Returns a string representation of the point for debugging purposes.\r\n\ttoString: function () {\r\n\t\treturn 'Point(' +\r\n\t\t        formatNum(this.x) + ', ' +\r\n\t\t        formatNum(this.y) + ')';\r\n\t}\r\n};\r\n\r\n// @factory L.point(x: Number, y: Number, round?: Boolean)\r\n// Creates a Point object with the given `x` and `y` coordinates. If optional `round` is set to true, rounds the `x` and `y` values.\r\n\r\n// @alternative\r\n// @factory L.point(coords: Number[])\r\n// Expects an array of the form `[x, y]` instead.\r\n\r\n// @alternative\r\n// @factory L.point(coords: Object)\r\n// Expects a plain object of the form `{x: Number, y: Number}` instead.\r\nexport function toPoint(x, y, round) {\r\n\tif (x instanceof Point) {\r\n\t\treturn x;\r\n\t}\r\n\tif (isArray(x)) {\r\n\t\treturn new Point(x[0], x[1]);\r\n\t}\r\n\tif (x === undefined || x === null) {\r\n\t\treturn x;\r\n\t}\r\n\tif (typeof x === 'object' && 'x' in x && 'y' in x) {\r\n\t\treturn new Point(x.x, x.y);\r\n\t}\r\n\treturn new Point(x, y, round);\r\n}\r\n","import * as DomEvent from './DomEvent';\nimport * as Util from '../core/Util';\nimport * as Browser from '../core/Browser';\n\n/*\n * Extends L.DomEvent to provide touch support for Internet Explorer and Windows-based devices.\n */\n\n\nvar POINTER_DOWN =   Browser.msPointer ? 'MSPointerDown'   : 'pointerdown',\n    POINTER_MOVE =   Browser.msPointer ? 'MSPointerMove'   : 'pointermove',\n    POINTER_UP =     Browser.msPointer ? 'MSPointerUp'     : 'pointerup',\n    POINTER_CANCEL = Browser.msPointer ? 'MSPointerCancel' : 'pointercancel',\n    TAG_WHITE_LIST = ['INPUT', 'SELECT', 'OPTION'],\n\n    _pointers = {},\n    _pointerDocListener = false;\n\n// DomEvent.DoubleTap needs to know about this\nexport var _pointersCount = 0;\n\n// Provides a touch events wrapper for (ms)pointer events.\n// ref http://www.w3.org/TR/pointerevents/ https://www.w3.org/Bugs/Public/show_bug.cgi?id=22890\n\nexport function addPointerListener(obj, type, handler, id) {\n\tif (type === 'touchstart') {\n\t\t_addPointerStart(obj, handler, id);\n\n\t} else if (type === 'touchmove') {\n\t\t_addPointerMove(obj, handler, id);\n\n\t} else if (type === 'touchend') {\n\t\t_addPointerEnd(obj, handler, id);\n\t}\n\n\treturn this;\n}\n\nexport function removePointerListener(obj, type, id) {\n\tvar handler = obj['_leaflet_' + type + id];\n\n\tif (type === 'touchstart') {\n\t\tobj.removeEventListener(POINTER_DOWN, handler, false);\n\n\t} else if (type === 'touchmove') {\n\t\tobj.removeEventListener(POINTER_MOVE, handler, false);\n\n\t} else if (type === 'touchend') {\n\t\tobj.removeEventListener(POINTER_UP, handler, false);\n\t\tobj.removeEventListener(POINTER_CANCEL, handler, false);\n\t}\n\n\treturn this;\n}\n\nfunction _addPointerStart(obj, handler, id) {\n\tvar onDown = Util.bind(function (e) {\n\t\tif (e.pointerType !== 'mouse' && e.pointerType !== e.MSPOINTER_TYPE_MOUSE && e.pointerType !== e.MSPOINTER_TYPE_MOUSE) {\n\t\t\t// In IE11, some touch events needs to fire for form controls, or\n\t\t\t// the controls will stop working. We keep a whitelist of tag names that\n\t\t\t// need these events. For other target tags, we prevent default on the event.\n\t\t\tif (TAG_WHITE_LIST.indexOf(e.target.tagName) < 0) {\n\t\t\t\tDomEvent.preventDefault(e);\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t_handlePointer(e, handler);\n\t});\n\n\tobj['_leaflet_touchstart' + id] = onDown;\n\tobj.addEventListener(POINTER_DOWN, onDown, false);\n\n\t// need to keep track of what pointers and how many are active to provide e.touches emulation\n\tif (!_pointerDocListener) {\n\t\t// we listen documentElement as any drags that end by moving the touch off the screen get fired there\n\t\tdocument.documentElement.addEventListener(POINTER_DOWN, _globalPointerDown, true);\n\t\tdocument.documentElement.addEventListener(POINTER_MOVE, _globalPointerMove, true);\n\t\tdocument.documentElement.addEventListener(POINTER_UP, _globalPointerUp, true);\n\t\tdocument.documentElement.addEventListener(POINTER_CANCEL, _globalPointerUp, true);\n\n\t\t_pointerDocListener = true;\n\t}\n}\n\nfunction _globalPointerDown(e) {\n\t_pointers[e.pointerId] = e;\n\t_pointersCount++;\n}\n\nfunction _globalPointerMove(e) {\n\tif (_pointers[e.pointerId]) {\n\t\t_pointers[e.pointerId] = e;\n\t}\n}\n\nfunction _globalPointerUp(e) {\n\tdelete _pointers[e.pointerId];\n\t_pointersCount--;\n}\n\nfunction _handlePointer(e, handler) {\n\te.touches = [];\n\tfor (var i in _pointers) {\n\t\te.touches.push(_pointers[i]);\n\t}\n\te.changedTouches = [e];\n\n\thandler(e);\n}\n\nfunction _addPointerMove(obj, handler, id) {\n\tvar onMove = function (e) {\n\t\t// don't fire touch moves when mouse isn't down\n\t\tif ((e.pointerType === e.MSPOINTER_TYPE_MOUSE || e.pointerType === 'mouse') && e.buttons === 0) { return; }\n\n\t\t_handlePointer(e, handler);\n\t};\n\n\tobj['_leaflet_touchmove' + id] = onMove;\n\tobj.addEventListener(POINTER_MOVE, onMove, false);\n}\n\nfunction _addPointerEnd(obj, handler, id) {\n\tvar onUp = function (e) {\n\t\t_handlePointer(e, handler);\n\t};\n\n\tobj['_leaflet_touchend' + id] = onUp;\n\tobj.addEventListener(POINTER_UP, onUp, false);\n\tobj.addEventListener(POINTER_CANCEL, onUp, false);\n}\n\n","import * as Browser from '../core/Browser';\r\nimport {_pointersCount} from './DomEvent.Pointer';\r\n\r\n/*\r\n * Extends the event handling code with double tap support for mobile browsers.\r\n */\r\n\r\nvar _touchstart = Browser.msPointer ? 'MSPointerDown' : Browser.pointer ? 'pointerdown' : 'touchstart',\r\n    _touchend = Browser.msPointer ? 'MSPointerUp' : Browser.pointer ? 'pointerup' : 'touchend',\r\n    _pre = '_leaflet_';\r\n\r\n// inspired by Zepto touch code by Thomas Fuchs\r\nexport function addDoubleTapListener(obj, handler, id) {\r\n\tvar last, touch,\r\n\t    doubleTap = false,\r\n\t    delay = 250;\r\n\r\n\tfunction onTouchStart(e) {\r\n\t\tvar count;\r\n\r\n\t\tif (Browser.pointer) {\r\n\t\t\tif ((!Browser.edge) || e.pointerType === 'mouse') { return; }\r\n\t\t\tcount = _pointersCount;\r\n\t\t} else {\r\n\t\t\tcount = e.touches.length;\r\n\t\t}\r\n\r\n\t\tif (count > 1) { return; }\r\n\r\n\t\tvar now = Date.now(),\r\n\t\t    delta = now - (last || now);\r\n\r\n\t\ttouch = e.touches ? e.touches[0] : e;\r\n\t\tdoubleTap = (delta > 0 && delta <= delay);\r\n\t\tlast = now;\r\n\t}\r\n\r\n\tfunction onTouchEnd(e) {\r\n\t\tif (doubleTap && !touch.cancelBubble) {\r\n\t\t\tif (Browser.pointer) {\r\n\t\t\t\tif ((!Browser.edge) || e.pointerType === 'mouse') { return; }\r\n\t\t\t\t// work around .type being readonly with MSPointer* events\r\n\t\t\t\tvar newTouch = {},\r\n\t\t\t\t    prop, i;\r\n\r\n\t\t\t\tfor (i in touch) {\r\n\t\t\t\t\tprop = touch[i];\r\n\t\t\t\t\tnewTouch[i] = prop && prop.bind ? prop.bind(touch) : prop;\r\n\t\t\t\t}\r\n\t\t\t\ttouch = newTouch;\r\n\t\t\t}\r\n\t\t\ttouch.type = 'dblclick';\r\n\t\t\thandler(touch);\r\n\t\t\tlast = null;\r\n\t\t}\r\n\t}\r\n\r\n\tobj[_pre + _touchstart + id] = onTouchStart;\r\n\tobj[_pre + _touchend + id] = onTouchEnd;\r\n\tobj[_pre + 'dblclick' + id] = handler;\r\n\r\n\tobj.addEventListener(_touchstart, onTouchStart, false);\r\n\tobj.addEventListener(_touchend, onTouchEnd, false);\r\n\r\n\t// On some platforms (notably, chrome<55 on win10 + touchscreen + mouse),\r\n\t// the browser doesn't fire touchend/pointerup events but does fire\r\n\t// native dblclicks. See #4127.\r\n\t// Edge 14 also fires native dblclicks, but only for pointerType mouse, see #5180.\r\n\tobj.addEventListener('dblclick', handler, false);\r\n\r\n\treturn this;\r\n}\r\n\r\nexport function removeDoubleTapListener(obj, id) {\r\n\tvar touchstart = obj[_pre + _touchstart + id],\r\n\t    touchend = obj[_pre + _touchend + id],\r\n\t    dblclick = obj[_pre + 'dblclick' + id];\r\n\r\n\tobj.removeEventListener(_touchstart, touchstart, false);\r\n\tobj.removeEventListener(_touchend, touchend, false);\r\n\tif (!Browser.edge) {\r\n\t\tobj.removeEventListener('dblclick', dblclick, false);\r\n\t}\r\n\r\n\treturn this;\r\n}\r\n","import {Point} from '../geometry/Point';\r\nimport * as Util from '../core/Util';\r\nimport * as Browser from '../core/Browser';\r\nimport {addPointerListener, removePointerListener} from './DomEvent.Pointer';\r\nimport {addDoubleTapListener, removeDoubleTapListener} from './DomEvent.DoubleTap';\r\n\r\n/*\r\n * @namespace DomEvent\r\n * Utility functions to work with the [DOM events](https://developer.mozilla.org/docs/Web/API/Event), used by Leaflet internally.\r\n */\r\n\r\n// Inspired by John Resig, Dean Edwards and YUI addEvent implementations.\r\n\r\n// @function on(el: HTMLElement, types: String, fn: Function, context?: Object): this\r\n// Adds a listener function (`fn`) to a particular DOM event type of the\r\n// element `el`. You can optionally specify the context of the listener\r\n// (object the `this` keyword will point to). You can also pass several\r\n// space-separated types (e.g. `'click dblclick'`).\r\n\r\n// @alternative\r\n// @function on(el: HTMLElement, eventMap: Object, context?: Object): this\r\n// Adds a set of type/listener pairs, e.g. `{click: onClick, mousemove: onMouseMove}`\r\nexport function on(obj, types, fn, context) {\r\n\r\n\tif (typeof types === 'object') {\r\n\t\tfor (var type in types) {\r\n\t\t\taddOne(obj, type, types[type], fn);\r\n\t\t}\r\n\t} else {\r\n\t\ttypes = Util.splitWords(types);\r\n\r\n\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\taddOne(obj, types[i], fn, context);\r\n\t\t}\r\n\t}\r\n\r\n\treturn this;\r\n}\r\n\r\nvar eventsKey = '_leaflet_events';\r\n\r\n// @function off(el: HTMLElement, types: String, fn: Function, context?: Object): this\r\n// Removes a previously added listener function. If no function is specified,\r\n// it will remove all the listeners of that particular DOM event from the element.\r\n// Note that if you passed a custom context to on, you must pass the same\r\n// context to `off` in order to remove the listener.\r\n\r\n// @alternative\r\n// @function off(el: HTMLElement, eventMap: Object, context?: Object): this\r\n// Removes a set of type/listener pairs, e.g. `{click: onClick, mousemove: onMouseMove}`\r\n\r\n// @alternative\r\n// @function off(el: HTMLElement): this\r\n// Removes all known event listeners\r\nexport function off(obj, types, fn, context) {\r\n\r\n\tif (typeof types === 'object') {\r\n\t\tfor (var type in types) {\r\n\t\t\tremoveOne(obj, type, types[type], fn);\r\n\t\t}\r\n\t} else if (types) {\r\n\t\ttypes = Util.splitWords(types);\r\n\r\n\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\tremoveOne(obj, types[i], fn, context);\r\n\t\t}\r\n\t} else {\r\n\t\tfor (var j in obj[eventsKey]) {\r\n\t\t\tremoveOne(obj, j, obj[eventsKey][j]);\r\n\t\t}\r\n\t\tdelete obj[eventsKey];\r\n\t}\r\n}\r\n\r\nfunction addOne(obj, type, fn, context) {\r\n\tvar id = type + Util.stamp(fn) + (context ? '_' + Util.stamp(context) : '');\r\n\r\n\tif (obj[eventsKey] && obj[eventsKey][id]) { return this; }\r\n\r\n\tvar handler = function (e) {\r\n\t\treturn fn.call(context || obj, e || window.event);\r\n\t};\r\n\r\n\tvar originalHandler = handler;\r\n\r\n\tif (Browser.pointer && type.indexOf('touch') === 0) {\r\n\t\t// Needs DomEvent.Pointer.js\r\n\t\taddPointerListener(obj, type, handler, id);\r\n\r\n\t} else if (Browser.touch && (type === 'dblclick') && addDoubleTapListener &&\r\n\t           !(Browser.pointer && Browser.chrome)) {\r\n\t\t// Chrome >55 does not need the synthetic dblclicks from addDoubleTapListener\r\n\t\t// See #5180\r\n\t\taddDoubleTapListener(obj, handler, id);\r\n\r\n\t} else if ('addEventListener' in obj) {\r\n\r\n\t\tif (type === 'mousewheel') {\r\n\t\t\tobj.addEventListener('onwheel' in obj ? 'wheel' : 'mousewheel', handler, false);\r\n\r\n\t\t} else if ((type === 'mouseenter') || (type === 'mouseleave')) {\r\n\t\t\thandler = function (e) {\r\n\t\t\t\te = e || window.event;\r\n\t\t\t\tif (isExternalTarget(obj, e)) {\r\n\t\t\t\t\toriginalHandler(e);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tobj.addEventListener(type === 'mouseenter' ? 'mouseover' : 'mouseout', handler, false);\r\n\r\n\t\t} else {\r\n\t\t\tif (type === 'click' && Browser.android) {\r\n\t\t\t\thandler = function (e) {\r\n\t\t\t\t\tfilterClick(e, originalHandler);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tobj.addEventListener(type, handler, false);\r\n\t\t}\r\n\r\n\t} else if ('attachEvent' in obj) {\r\n\t\tobj.attachEvent('on' + type, handler);\r\n\t}\r\n\r\n\tobj[eventsKey] = obj[eventsKey] || {};\r\n\tobj[eventsKey][id] = handler;\r\n}\r\n\r\nfunction removeOne(obj, type, fn, context) {\r\n\r\n\tvar id = type + Util.stamp(fn) + (context ? '_' + Util.stamp(context) : ''),\r\n\t    handler = obj[eventsKey] && obj[eventsKey][id];\r\n\r\n\tif (!handler) { return this; }\r\n\r\n\tif (Browser.pointer && type.indexOf('touch') === 0) {\r\n\t\tremovePointerListener(obj, type, id);\r\n\r\n\t} else if (Browser.touch && (type === 'dblclick') && removeDoubleTapListener) {\r\n\t\tremoveDoubleTapListener(obj, id);\r\n\r\n\t} else if ('removeEventListener' in obj) {\r\n\r\n\t\tif (type === 'mousewheel') {\r\n\t\t\tobj.removeEventListener('onwheel' in obj ? 'wheel' : 'mousewheel', handler, false);\r\n\r\n\t\t} else {\r\n\t\t\tobj.removeEventListener(\r\n\t\t\t\ttype === 'mouseenter' ? 'mouseover' :\r\n\t\t\t\ttype === 'mouseleave' ? 'mouseout' : type, handler, false);\r\n\t\t}\r\n\r\n\t} else if ('detachEvent' in obj) {\r\n\t\tobj.detachEvent('on' + type, handler);\r\n\t}\r\n\r\n\tobj[eventsKey][id] = null;\r\n}\r\n\r\n// @function stopPropagation(ev: DOMEvent): this\r\n// Stop the given event from propagation to parent elements. Used inside the listener functions:\r\n// ```js\r\n// L.DomEvent.on(div, 'click', function (ev) {\r\n// \tL.DomEvent.stopPropagation(ev);\r\n// });\r\n// ```\r\nexport function stopPropagation(e) {\r\n\r\n\tif (e.stopPropagation) {\r\n\t\te.stopPropagation();\r\n\t} else if (e.originalEvent) {  // In case of Leaflet event.\r\n\t\te.originalEvent._stopped = true;\r\n\t} else {\r\n\t\te.cancelBubble = true;\r\n\t}\r\n\tskipped(e);\r\n\r\n\treturn this;\r\n}\r\n\r\n// @function disableScrollPropagation(el: HTMLElement): this\r\n// Adds `stopPropagation` to the element's `'mousewheel'` events (plus browser variants).\r\nexport function disableScrollPropagation(el) {\r\n\treturn addOne(el, 'mousewheel', stopPropagation);\r\n}\r\n\r\n// @function disableClickPropagation(el: HTMLElement): this\r\n// Adds `stopPropagation` to the element's `'click'`, `'doubleclick'`,\r\n// `'mousedown'` and `'touchstart'` events (plus browser variants).\r\nexport function disableClickPropagation(el) {\r\n\ton(el, 'mousedown touchstart dblclick', stopPropagation);\r\n\taddOne(el, 'click', fakeStop);\r\n\treturn this;\r\n}\r\n\r\n// @function preventDefault(ev: DOMEvent): this\r\n// Prevents the default action of the DOM Event `ev` from happening (such as\r\n// following a link in the href of the a element, or doing a POST request\r\n// with page reload when a `<form>` is submitted).\r\n// Use it inside listener functions.\r\nexport function preventDefault(e) {\r\n\tif (e.preventDefault) {\r\n\t\te.preventDefault();\r\n\t} else {\r\n\t\te.returnValue = false;\r\n\t}\r\n\treturn this;\r\n}\r\n\r\n// @function stop(ev): this\r\n// Does `stopPropagation` and `preventDefault` at the same time.\r\nexport function stop(e) {\r\n\tpreventDefault(e);\r\n\tstopPropagation(e);\r\n\treturn this;\r\n}\r\n\r\n// @function getMousePosition(ev: DOMEvent, container?: HTMLElement): Point\r\n// Gets normalized mouse position from a DOM event relative to the\r\n// `container` or to the whole page if not specified.\r\nexport function getMousePosition(e, container) {\r\n\tif (!container) {\r\n\t\treturn new Point(e.clientX, e.clientY);\r\n\t}\r\n\r\n\tvar rect = container.getBoundingClientRect();\r\n\r\n\treturn new Point(\r\n\t\te.clientX - rect.left - container.clientLeft,\r\n\t\te.clientY - rect.top - container.clientTop);\r\n}\r\n\r\n// Chrome on Win scrolls double the pixels as in other platforms (see #4538),\r\n// and Firefox scrolls device pixels, not CSS pixels\r\nvar wheelPxFactor =\r\n\t(Browser.win && Browser.chrome) ? 2 :\r\n\tBrowser.gecko ? window.devicePixelRatio : 1;\r\n\r\n// @function getWheelDelta(ev: DOMEvent): Number\r\n// Gets normalized wheel delta from a mousewheel DOM event, in vertical\r\n// pixels scrolled (negative if scrolling down).\r\n// Events from pointing devices without precise scrolling are mapped to\r\n// a best guess of 60 pixels.\r\nexport function getWheelDelta(e) {\r\n\treturn (Browser.edge) ? e.wheelDeltaY / 2 : // Don't trust window-geometry-based delta\r\n\t       (e.deltaY && e.deltaMode === 0) ? -e.deltaY / wheelPxFactor : // Pixels\r\n\t       (e.deltaY && e.deltaMode === 1) ? -e.deltaY * 20 : // Lines\r\n\t       (e.deltaY && e.deltaMode === 2) ? -e.deltaY * 60 : // Pages\r\n\t       (e.deltaX || e.deltaZ) ? 0 :\t// Skip horizontal/depth wheel events\r\n\t       e.wheelDelta ? (e.wheelDeltaY || e.wheelDelta) / 2 : // Legacy IE pixels\r\n\t       (e.detail && Math.abs(e.detail) < 32765) ? -e.detail * 20 : // Legacy Moz lines\r\n\t       e.detail ? e.detail / -32765 * 60 : // Legacy Moz pages\r\n\t       0;\r\n}\r\n\r\nvar skipEvents = {};\r\n\r\nexport function fakeStop(e) {\r\n\t// fakes stopPropagation by setting a special event flag, checked/reset with skipped(e)\r\n\tskipEvents[e.type] = true;\r\n}\r\n\r\nexport function skipped(e) {\r\n\tvar events = skipEvents[e.type];\r\n\t// reset when checking, as it's only used in map container and propagates outside of the map\r\n\tskipEvents[e.type] = false;\r\n\treturn events;\r\n}\r\n\r\n// check if element really left/entered the event target (for mouseenter/mouseleave)\r\nexport function isExternalTarget(el, e) {\r\n\r\n\tvar related = e.relatedTarget;\r\n\r\n\tif (!related) { return true; }\r\n\r\n\ttry {\r\n\t\twhile (related && (related !== el)) {\r\n\t\t\trelated = related.parentNode;\r\n\t\t}\r\n\t} catch (err) {\r\n\t\treturn false;\r\n\t}\r\n\treturn (related !== el);\r\n}\r\n\r\nvar lastClick;\r\n\r\n// this is a horrible workaround for a bug in Android where a single touch triggers two click events\r\nfunction filterClick(e, handler) {\r\n\tvar timeStamp = (e.timeStamp || (e.originalEvent && e.originalEvent.timeStamp)),\r\n\t    elapsed = lastClick && (timeStamp - lastClick);\r\n\r\n\t// are they closer together than 500ms yet more than 100ms?\r\n\t// Android typically triggers them ~300ms apart while multiple listeners\r\n\t// on the same event should be triggered far faster;\r\n\t// or check if click is simulated on the element, and if it is, reject any non-simulated events\r\n\r\n\tif ((elapsed && elapsed > 100 && elapsed < 500) || (e.target._simulatedClick && !e._simulated)) {\r\n\t\tstop(e);\r\n\t\treturn;\r\n\t}\r\n\tlastClick = timeStamp;\r\n\r\n\thandler(e);\r\n}\r\n\r\n// @function addListener(…): this\r\n// Alias to [`L.DomEvent.on`](#domevent-on)\r\nexport {on as addListener};\r\n\r\n// @function removeListener(…): this\r\n// Alias to [`L.DomEvent.off`](#domevent-off)\r\nexport {off as removeListener};\r\n","import * as DomEvent from './DomEvent';\nimport * as Util from '../core/Util';\nimport {Point} from '../geometry/Point';\nimport * as Browser from '../core/Browser';\n\n/*\n * @namespace DomUtil\n *\n * Utility functions to work with the [DOM](https://developer.mozilla.org/docs/Web/API/Document_Object_Model)\n * tree, used by Leaflet internally.\n *\n * Most functions expecting or returning a `HTMLElement` also work for\n * SVG elements. The only difference is that classes refer to CSS classes\n * in HTML and SVG classes in SVG.\n */\n\n if (!Element.prototype.matches) {\n    var ep = Element.prototype;\n \n    if (ep.webkitMatchesSelector) // Chrome <34, SF<7.1, iOS<8\n      ep.matches = ep.webkitMatchesSelector;\n \n    if (ep.msMatchesSelector) // IE9/10/11 & Edge\n      ep.matches = ep.msMatchesSelector;\n \n    if (ep.mozMatchesSelector) // FF<34\n      ep.matches = ep.mozMatchesSelector;\n }\n\n// @property TRANSFORM: String\n// Vendor-prefixed fransform style name (e.g. `'webkitTransform'` for WebKit).\nexport var TRANSFORM = testProp(\n    ['transform', 'WebkitTransform', 'OTransform', 'MozTransform', 'msTransform']);\n\n// webkitTransition comes first because some browser versions that drop vendor prefix don't do\n// the same for the transitionend event, in particular the Android 4.1 stock browser\n\n// @property TRANSITION: String\n// Vendor-prefixed transform style name.\nexport var TRANSITION = testProp(\n    ['webkitTransition', 'transition', 'OTransition', 'MozTransition', 'msTransition']);\n\nexport var TRANSITION_END =\n    TRANSITION === 'webkitTransition' || TRANSITION === 'OTransition' ? TRANSITION + 'End' : 'transitionend';\n\n\n// @function get(id: String|HTMLElement): HTMLElement\n// Returns an element given its DOM id, or returns the element itself\n// if it was passed directly.\nexport function get(id) {\n    return typeof id === 'string' ? document.getElementById(id) : id;\n}\n\n// @function getStyle(el: HTMLElement, styleAttrib: String): String\n// Returns the value for a certain style attribute on an element,\n// including computed values or values set through CSS.\nexport function getStyle(el, style) {\n    var value = el.style[style] || (el.currentStyle && el.currentStyle[style]);\n\n    if ((!value || value === 'auto') && document.defaultView) {\n        var css = document.defaultView.getComputedStyle(el, null);\n        value = css ? css[style] : null;\n    }\n    return value === 'auto' ? null : value;\n}\n\n// @function create(tagName: String, className?: String, container?: HTMLElement): HTMLElement\n// Creates an HTML element with `tagName`, sets its class to `className`, and optionally appends it to `container` element.\nexport function create(tagName, className, container) {\n    var el = document.createElement(tagName);\n    el.className = className || '';\n\n    if (container) {\n        container.appendChild(el);\n    }\n    return el;\n}\n\n// @function remove(el: HTMLElement)\n// Removes `el` from its parent element\nexport function remove(el) {\n    var parent = el.parentNode;\n    if (parent) {\n        parent.removeChild(el);\n    }\n}\n\n// @function empty(el: HTMLElement)\n// Removes all of `el`'s children elements from `el`\nexport function empty(el) {\n    while (el.firstChild) {\n        el.removeChild(el.firstChild);\n    }\n}\n\n// @function toFront(el: HTMLElement)\n// Makes `el` the last child of its parent, so it renders in front of the other children.\nexport function toFront(el) {\n    el.parentNode.appendChild(el);\n}\n\n// @function toBack(el: HTMLElement)\n// Makes `el` the first child of its parent, so it renders behind the other children.\nexport function toBack(el) {\n    var parent = el.parentNode;\n    parent.insertBefore(el, parent.firstChild);\n}\n\n// @function hasClass(el: HTMLElement, name: String): Boolean\n// Returns `true` if the element's class attribute contains `name`.\nexport function hasClass(el, name) {\n    if (el.classList !== undefined) {\n        return el.classList.contains(name);\n    }\n    var className = getClass(el);\n    return className.length > 0 && new RegExp('(^|\\\\s)' + name + '(\\\\s|$)').test(className);\n}\n\n// @function addClass(el: HTMLElement, name: String)\n// Adds `name` to the element's class attribute.\nexport function addClass(el, name) {\n    if (el.classList !== undefined) {\n        var classes = Util.splitWords(name);\n        for (var i = 0, len = classes.length; i < len; i++) {\n            el.classList.add(classes[i]);\n        }\n    } else if (!hasClass(el, name)) {\n        var className = getClass(el);\n        setClass(el, (className ? className + ' ' : '') + name);\n    }\n}\n\n// @function removeClass(el: HTMLElement, name: String)\n// Removes `name` from the element's class attribute.\nexport function removeClass(el, name) {\n    if (el.classList !== undefined) {\n        el.classList.remove(name);\n    } else {\n        setClass(el, Util.trim((' ' + getClass(el) + ' ').replace(' ' + name + ' ', ' ')));\n    }\n}\n\n// @function setClass(el: HTMLElement, name: String)\n// Sets the element's class.\nexport function setClass(el, name) {\n    if (el.className.baseVal === undefined) {\n        el.className = name;\n    } else {\n        // in case of SVG element\n        el.className.baseVal = name;\n    }\n}\n\n// @function getClass(el: HTMLElement): String\n// Returns the element's class.\nexport function getClass(el) {\n    return el.className.baseVal === undefined ? el.className : el.className.baseVal;\n}\n\n// @function setOpacity(el: HTMLElement, opacity: Number)\n// Set the opacity of an element (including old IE support).\n// `opacity` must be a number from `0` to `1`.\nexport function setOpacity(el, value) {\n    if ('opacity' in el.style) {\n        el.style.opacity = value;\n    } else if ('filter' in el.style) {\n        _setOpacityIE(el, value);\n    }\n}\n\nfunction _setOpacityIE(el, value) {\n    var filter = false,\n        filterName = 'DXImageTransform.Microsoft.Alpha';\n\n    // filters collection throws an error if we try to retrieve a filter that doesn't exist\n    try {\n        filter = el.filters.item(filterName);\n    } catch (e) {\n        // don't set opacity to 1 if we haven't already set an opacity,\n        // it isn't needed and breaks transparent pngs.\n        if (value === 1) { return; }\n    }\n\n    value = Math.round(value * 100);\n\n    if (filter) {\n        filter.Enabled = (value !== 100);\n        filter.Opacity = value;\n    } else {\n        el.style.filter += ' progid:' + filterName + '(opacity=' + value + ')';\n    }\n}\n\n// @function testProp(props: String[]): String|false\n// Goes through the array of style names and returns the first name\n// that is a valid style name for an element. If no such name is found,\n// it returns false. Useful for vendor-prefixed styles like `transform`.\nexport function testProp(props) {\n    var style = document.documentElement.style;\n\n    for (var i = 0; i < props.length; i++) {\n        if (props[i] in style) {\n            return props[i];\n        }\n    }\n    return false;\n}\n\nexport function isPropertySupported(prop) {\n    var style = document.documentElement.style;\n    return prop in style;\n}\n\n// @function setTransform(el: HTMLElement, offset: Point, scale?: Number)\n// Resets the 3D CSS transform of `el` so it is translated by `offset` pixels\n// and optionally scaled by `scale`. Does not have an effect if the\n// browser doesn't support 3D CSS transforms.\nexport function setTransform(el, offset, scale) {\n    var pos = offset || new Point(0, 0);\n\n    el.style[TRANSFORM] =\n        (Browser.ie3d ?\n            'translate(' + pos.x + 'px,' + pos.y + 'px)' :\n            'translate3d(' + pos.x + 'px,' + pos.y + 'px,0)') +\n        (scale ? ' scale(' + scale + ')' : '');\n}\n\n// @function setPosition(el: HTMLElement, position: Point)\n// Sets the position of `el` to coordinates specified by `position`,\n// using CSS translate or top/left positioning depending on the browser\n// (used by Leaflet internally to position its layers).\nexport function setPosition(el, point) {\n\n    /*eslint-disable */\n    el._leaflet_pos = point;\n    /*eslint-enable */\n\n    if (Browser.any3d) {\n        setTransform(el, point);\n    } else {\n        el.style.left = point.x + 'px';\n        el.style.top = point.y + 'px';\n    }\n}\n\n// @function getPosition(el: HTMLElement): Point\n// Returns the coordinates of an element previously positioned with setPosition.\nexport function getPosition(el) {\n    // this method is only used for elements previously positioned using setPosition,\n    // so it's safe to cache the position for performance\n\n    return el._leaflet_pos || new Point(0, 0);\n}\n\n// @function disableTextSelection()\n// Prevents the user from generating `selectstart` DOM events, usually generated\n// when the user drags the mouse through a page with text. Used internally\n// by Leaflet to override the behaviour of any click-and-drag interaction on\n// the map. Affects drag interactions on the whole document.\n\n// @function enableTextSelection()\n// Cancels the effects of a previous [`L.DomUtil.disableTextSelection`](#domutil-disabletextselection).\nexport var disableTextSelection;\nexport var enableTextSelection;\nvar _userSelect;\nif ('onselectstart' in document) {\n    disableTextSelection = function () {\n        DomEvent.on(window, 'selectstart', DomEvent.preventDefault);\n    };\n    enableTextSelection = function () {\n        DomEvent.off(window, 'selectstart', DomEvent.preventDefault);\n    };\n} else {\n    var userSelectProperty = testProp(\n        ['userSelect', 'WebkitUserSelect', 'OUserSelect', 'MozUserSelect', 'msUserSelect']);\n\n    disableTextSelection = function () {\n        if (userSelectProperty) {\n            var style = document.documentElement.style;\n            _userSelect = style[userSelectProperty];\n            style[userSelectProperty] = 'none';\n        }\n    };\n    enableTextSelection = function () {\n        if (userSelectProperty) {\n            document.documentElement.style[userSelectProperty] = _userSelect;\n            _userSelect = undefined;\n        }\n    };\n}\n\n// @function disableImageDrag()\n// As [`L.DomUtil.disableTextSelection`](#domutil-disabletextselection), but\n// for `dragstart` DOM events, usually generated when the user drags an image.\nexport function disableImageDrag() {\n    DomEvent.on(window, 'dragstart', DomEvent.preventDefault);\n}\n\n// @function enableImageDrag()\n// Cancels the effects of a previous [`L.DomUtil.disableImageDrag`](#domutil-disabletextselection).\nexport function enableImageDrag() {\n    DomEvent.off(window, 'dragstart', DomEvent.preventDefault);\n}\n\nvar _outlineElement, _outlineStyle;\n// @function preventOutline(el: HTMLElement)\n// Makes the [outline](https://developer.mozilla.org/docs/Web/CSS/outline)\n// of the element `el` invisible. Used internally by Leaflet to prevent\n// focusable elements from displaying an outline when the user performs a\n// drag interaction on them.\nexport function preventOutline(element) {\n    while (element.tabIndex === -1) {\n        element = element.parentNode;\n    }\n    if (!element || !element.style) { return; }\n    restoreOutline();\n    _outlineElement = element;\n    _outlineStyle = element.style.outline;\n    element.style.outline = 'none';\n    DomEvent.on(window, 'keydown', restoreOutline);\n}\n\n// @function restoreOutline()\n// Cancels the effects of a previous [`L.DomUtil.preventOutline`]().\nexport function restoreOutline() {\n    if (!_outlineElement) { return; }\n    _outlineElement.style.outline = _outlineStyle;\n    _outlineElement = undefined;\n    _outlineStyle = undefined;\n    DomEvent.off(window, 'keydown', restoreOutline);\n}\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var baseGetTag = require('./_baseGetTag'),\n    isObject = require('./isObject');\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nmodule.exports = isFunction;\n","var root = require('./_root');\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nmodule.exports = coreJsData;\n","var coreJsData = require('./_coreJsData');\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nmodule.exports = isMasked;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nmodule.exports = toSource;\n","var isFunction = require('./isFunction'),\n    isMasked = require('./_isMasked'),\n    isObject = require('./isObject'),\n    toSource = require('./_toSource');\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nmodule.exports = baseIsNative;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nmodule.exports = getValue;\n","var baseIsNative = require('./_baseIsNative'),\n    getValue = require('./_getValue');\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nmodule.exports = getNative;\n","var getNative = require('./_getNative');\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nmodule.exports = defineProperty;\n","var defineProperty = require('./_defineProperty');\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\nmodule.exports = baseAssignValue;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nmodule.exports = eq;\n","var baseAssignValue = require('./_baseAssignValue'),\n    eq = require('./eq');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nmodule.exports = assignValue;\n","var assignValue = require('./_assignValue'),\n    baseAssignValue = require('./_baseAssignValue');\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property identifiers to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @param {Function} [customizer] The function to customize copied values.\n * @returns {Object} Returns `object`.\n */\nfunction copyObject(source, props, object, customizer) {\n  var isNew = !object;\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n\n    var newValue = customizer\n      ? customizer(object[key], source[key], key, object, source)\n      : undefined;\n\n    if (newValue === undefined) {\n      newValue = source[key];\n    }\n    if (isNew) {\n      baseAssignValue(object, key, newValue);\n    } else {\n      assignValue(object, key, newValue);\n    }\n  }\n  return object;\n}\n\nmodule.exports = copyObject;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nmodule.exports = identity;\n","/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\nmodule.exports = apply;\n","var apply = require('./_apply');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * A specialized version of `baseRest` which transforms the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @param {Function} transform The rest array transform.\n * @returns {Function} Returns the new function.\n */\nfunction overRest(func, start, transform) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = transform(array);\n    return apply(func, this, otherArgs);\n  };\n}\n\nmodule.exports = overRest;\n","/**\n * Creates a function that returns `value`.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {*} value The value to return from the new function.\n * @returns {Function} Returns the new constant function.\n * @example\n *\n * var objects = _.times(2, _.constant({ 'a': 1 }));\n *\n * console.log(objects);\n * // => [{ 'a': 1 }, { 'a': 1 }]\n *\n * console.log(objects[0] === objects[1]);\n * // => true\n */\nfunction constant(value) {\n  return function() {\n    return value;\n  };\n}\n\nmodule.exports = constant;\n","var constant = require('./constant'),\n    defineProperty = require('./_defineProperty'),\n    identity = require('./identity');\n\n/**\n * The base implementation of `setToString` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar baseSetToString = !defineProperty ? identity : function(func, string) {\n  return defineProperty(func, 'toString', {\n    'configurable': true,\n    'enumerable': false,\n    'value': constant(string),\n    'writable': true\n  });\n};\n\nmodule.exports = baseSetToString;\n","/** Used to detect hot functions by number of calls within a span of milliseconds. */\nvar HOT_COUNT = 800,\n    HOT_SPAN = 16;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeNow = Date.now;\n\n/**\n * Creates a function that'll short out and invoke `identity` instead\n * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n * milliseconds.\n *\n * @private\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new shortable function.\n */\nfunction shortOut(func) {\n  var count = 0,\n      lastCalled = 0;\n\n  return function() {\n    var stamp = nativeNow(),\n        remaining = HOT_SPAN - (stamp - lastCalled);\n\n    lastCalled = stamp;\n    if (remaining > 0) {\n      if (++count >= HOT_COUNT) {\n        return arguments[0];\n      }\n    } else {\n      count = 0;\n    }\n    return func.apply(undefined, arguments);\n  };\n}\n\nmodule.exports = shortOut;\n","var baseSetToString = require('./_baseSetToString'),\n    shortOut = require('./_shortOut');\n\n/**\n * Sets the `toString` method of `func` to return `string`.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar setToString = shortOut(baseSetToString);\n\nmodule.exports = setToString;\n","var identity = require('./identity'),\n    overRest = require('./_overRest'),\n    setToString = require('./_setToString');\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  return setToString(overRest(func, start, identity), func + '');\n}\n\nmodule.exports = baseRest;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nmodule.exports = isLength;\n","var isFunction = require('./isFunction'),\n    isLength = require('./isLength');\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nmodule.exports = isArrayLike;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  length = length == null ? MAX_SAFE_INTEGER : length;\n  return !!length &&\n    (typeof value == 'number' || reIsUint.test(value)) &&\n    (value > -1 && value % 1 == 0 && value < length);\n}\n\nmodule.exports = isIndex;\n","var eq = require('./eq'),\n    isArrayLike = require('./isArrayLike'),\n    isIndex = require('./_isIndex'),\n    isObject = require('./isObject');\n\n/**\n * Checks if the given arguments are from an iteratee call.\n *\n * @private\n * @param {*} value The potential iteratee value argument.\n * @param {*} index The potential iteratee index or key argument.\n * @param {*} object The potential iteratee object argument.\n * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n *  else `false`.\n */\nfunction isIterateeCall(value, index, object) {\n  if (!isObject(object)) {\n    return false;\n  }\n  var type = typeof index;\n  if (type == 'number'\n        ? (isArrayLike(object) && isIndex(index, object.length))\n        : (type == 'string' && index in object)\n      ) {\n    return eq(object[index], value);\n  }\n  return false;\n}\n\nmodule.exports = isIterateeCall;\n","var baseRest = require('./_baseRest'),\n    isIterateeCall = require('./_isIterateeCall');\n\n/**\n * Creates a function like `_.assign`.\n *\n * @private\n * @param {Function} assigner The function to assign values.\n * @returns {Function} Returns the new assigner function.\n */\nfunction createAssigner(assigner) {\n  return baseRest(function(object, sources) {\n    var index = -1,\n        length = sources.length,\n        customizer = length > 1 ? sources[length - 1] : undefined,\n        guard = length > 2 ? sources[2] : undefined;\n\n    customizer = (assigner.length > 3 && typeof customizer == 'function')\n      ? (length--, customizer)\n      : undefined;\n\n    if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n      customizer = length < 3 ? undefined : customizer;\n      length = 1;\n    }\n    object = Object(object);\n    while (++index < length) {\n      var source = sources[index];\n      if (source) {\n        assigner(object, source, index, customizer);\n      }\n    }\n    return object;\n  });\n}\n\nmodule.exports = createAssigner;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nmodule.exports = isPrototype;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nmodule.exports = baseTimes;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nmodule.exports = baseIsArguments;\n","var baseIsArguments = require('./_baseIsArguments'),\n    isObjectLike = require('./isObjectLike');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nmodule.exports = isArguments;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nmodule.exports = isArray;\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = stubFalse;\n","var root = require('./_root'),\n    stubFalse = require('./stubFalse');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nmodule.exports = isBuffer;\n","var baseGetTag = require('./_baseGetTag'),\n    isLength = require('./isLength'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nmodule.exports = baseIsTypedArray;\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nmodule.exports = baseUnary;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nmodule.exports = nodeUtil;\n","var baseIsTypedArray = require('./_baseIsTypedArray'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nmodule.exports = isTypedArray;\n","var baseTimes = require('./_baseTimes'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isIndex = require('./_isIndex'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayLikeKeys;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nmodule.exports = overArg;\n","var overArg = require('./_overArg');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nmodule.exports = nativeKeys;\n","var isPrototype = require('./_isPrototype'),\n    nativeKeys = require('./_nativeKeys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseKeys;\n","var arrayLikeKeys = require('./_arrayLikeKeys'),\n    baseKeys = require('./_baseKeys'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nmodule.exports = keys;\n","var assignValue = require('./_assignValue'),\n    copyObject = require('./_copyObject'),\n    createAssigner = require('./_createAssigner'),\n    isArrayLike = require('./isArrayLike'),\n    isPrototype = require('./_isPrototype'),\n    keys = require('./keys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns own enumerable string keyed properties of source objects to the\n * destination object. Source objects are applied from left to right.\n * Subsequent sources overwrite property assignments of previous sources.\n *\n * **Note:** This method mutates `object` and is loosely based on\n * [`Object.assign`](https://mdn.io/Object/assign).\n *\n * @static\n * @memberOf _\n * @since 0.10.0\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} [sources] The source objects.\n * @returns {Object} Returns `object`.\n * @see _.assignIn\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * function Bar() {\n *   this.c = 3;\n * }\n *\n * Foo.prototype.b = 2;\n * Bar.prototype.d = 4;\n *\n * _.assign({ 'a': 0 }, new Foo, new Bar);\n * // => { 'a': 1, 'c': 3 }\n */\nvar assign = createAssigner(function(object, source) {\n  if (isPrototype(source) || isArrayLike(source)) {\n    copyObject(source, keys(source), object);\n    return;\n  }\n  for (var key in source) {\n    if (hasOwnProperty.call(source, key)) {\n      assignValue(object, key, source[key]);\n    }\n  }\n});\n\nmodule.exports = assign;\n","var document = typeof window !== 'undefined' && typeof window.document !== 'undefined' ? window.document : {};\nvar keyboardAllowed = typeof Element !== 'undefined' && 'ALLOW_KEYBOARD_INPUT' in Element;\n\nvar fn = (function () {\n  var val;\n\n  var fnMap = [\n    [\n      'requestFullscreen',\n      'exitFullscreen',\n      'fullscreenElement',\n      'fullscreenEnabled',\n      'fullscreenchange',\n      'fullscreenerror'\n    ],\n    // New WebKit\n    [\n      'webkitRequestFullscreen',\n      'webkitExitFullscreen',\n      'webkitFullscreenElement',\n      'webkitFullscreenEnabled',\n      'webkitfullscreenchange',\n      'webkitfullscreenerror'\n\n    ],\n    // Old WebKit (Safari 5.1)\n    [\n      'webkitRequestFullScreen',\n      'webkitCancelFullScreen',\n      'webkitCurrentFullScreenElement',\n      'webkitCancelFullScreen',\n      'webkitfullscreenchange',\n      'webkitfullscreenerror'\n\n    ],\n    [\n      'mozRequestFullScreen',\n      'mozCancelFullScreen',\n      'mozFullScreenElement',\n      'mozFullScreenEnabled',\n      'mozfullscreenchange',\n      'mozfullscreenerror'\n    ],\n    [\n      'msRequestFullscreen',\n      'msExitFullscreen',\n      'msFullscreenElement',\n      'msFullscreenEnabled',\n      'MSFullscreenChange',\n      'MSFullscreenError'\n    ]\n  ];\n\n  var i = 0;\n  var l = fnMap.length;\n  var ret = {};\n\n  for (; i < l; i++) {\n    val = fnMap[i];\n    if (val && val[1] in document) {\n      for (i = 0; i < val.length; i++) {\n        ret[fnMap[0][i]] = val[i];\n      }\n      return ret;\n    }\n  }\n\n  return false;\n})();\n\nvar eventNameMap = {\n  change: fn.fullscreenchange,\n  error: fn.fullscreenerror\n};\n\nvar screenfull = {\n  request: function (elem) {\n    var request = fn.requestFullscreen;\n\n    elem = elem || document.documentElement;\n\n    // Work around Safari 5.1 bug: reports support for\n    // keyboard in fullscreen even though it doesn't.\n    // Browser sniffing, since the alternative with\n    // setTimeout is even worse.\n    if (/5\\.1[.\\d]* Safari/.test(navigator.userAgent)) {\n      elem[request]();\n    } else {\n      elem[request](keyboardAllowed && Element.ALLOW_KEYBOARD_INPUT);\n    }\n  },\n  exit: function () {\n    document[fn.exitFullscreen]();\n  },\n  toggle: function (elem) {\n    if (this.isFullscreen) {\n      this.exit();\n    } else {\n      this.request(elem);\n    }\n  },\n  onchange: function (callback) {\n    this.on('change', callback);\n  },\n  onerror: function (callback) {\n    this.on('error', callback);\n  },\n  on: function (event, callback) {\n    var eventName = eventNameMap[event];\n    if (eventName) {\n      document.addEventListener(eventName, callback, false);\n    }\n  },\n  off: function (event, callback) {\n    var eventName = eventNameMap[event];\n    if (eventName) {\n      document.removeEventListener(eventName, callback, false);\n    }\n  },\n  raw: fn\n};\n\nObject.defineProperties(screenfull, {\n  isFullscreen: {\n    get: function () {\n      return Boolean(document[fn.fullscreenElement]);\n    }\n  },\n  element: {\n    enumerable: true,\n    get: function () {\n      return document[fn.fullscreenElement];\n    }\n  },\n  enabled: {\n    enumerable: true,\n    get: function () {\n      // Coerce to boolean in case of old WebKit\n      return Boolean(document[fn.fullscreenEnabled]);\n    }\n  }\n});\n\nexport {screenfull};","import * as Util from '../core/Util';\nimport {Evented} from '../core/Events';\n// import {Class} from '../core/Class';\nimport * as Browser from '../core/Browser';\nimport * as DomEvent from '../dom/DomEvent';\nimport * as DomUtil from '../dom/DomUtil';\n\nimport debounce from 'lodash/debounce';\nimport assign from 'lodash/assign';\n\nimport {screenfull} from '../screenfull';\n\n/*\n * @class Reader\n * @aka cozy.Map\n * @inherits Evented\n *\n * The central class of the API — it is used to create a book on a page and manipulate it.\n *\n * @example\n *\n * ```js\n * // initialize the map on the \"map\" div with a given center and zoom\n * var map = L.map('map', {\n *  center: [51.505, -0.09],\n *  zoom: 13\n * });\n * ```\n *\n */\n\nvar _padding = 1.0;\nexport var Reader = Evented.extend({\n  options: {\n    regions: [\n      'header',\n      'toolbar.top',\n      'toolbar.left',\n      'main',\n      'toolbar.right',\n      'toolbar.bottom',\n      'footer'\n    ],\n    metadata: {},\n    flow: 'auto',\n    engine: 'epubjs',\n    fontSizeLarge: '140%',\n    fontSizeSmall: '90%',\n    fontSizeDefault: '100%',\n    trackResize: true,\n    text_size: 100,\n    mobileMediaQuery: '(min-device-width : 300px) and (max-device-width : 600px)',\n    forceScrolledDocHeight: 1200,\n    theme: 'default',\n    rootfilePath: '',\n    themes: []\n  },\n\n  initialize: function(id, options) {\n    var self = this\n\n    self._original_document_title = document.title;\n\n    if ( localStorage.getItem('cozy.options') ) {\n      options = assign(options, JSON.parse(localStorage.getItem('cozy.options')));\n    }\n    options = Util.setOptions(this, options);\n\n    this._checkFeatureCompatibility();\n\n    this.metadata = this.options.metadata; // initial seed\n\n    this._initContainer(id);\n    this._initLayout();\n\n    if ( this.options.themes && this.options.themes.length > 0 ) {\n        this.options.themes.forEach(function(theme) {\n            if ( theme.href ) { return; }\n            var klass = theme.klass;\n            var rules = {};\n            for(var rule in theme.rules) {\n                var new_rule = '.' + klass;\n                if ( rule == 'body' ) { new_rule = 'body' + new_rule; }\n                else { new_rule += ' ' + rule ; }\n                rules[new_rule] = theme.rules[rule];\n            }\n            theme.rules = rules;\n        });\n    }\n\n    this._updateTheme();\n\n    // hack for https://github.com/Leaflet/Leaflet/issues/1980\n    // this._onResize = Util.bind(this._onResize, this);\n\n    this._initEvents();\n\n    this.callInitHooks();\n\n    this._mode = this.options.mode;\n  },\n\n  start: function(target, cb) {\n    var self = this;\n\n    if ( typeof(target) == 'function' && cb === undefined ) {\n      cb = target;\n      target = undefined;\n    }\n\n    Util.loader.js(this.options.engine_href).then(function() {\n      self._start(target, cb);\n      self._loaded = true;\n    })\n  },\n\n  _start: function(target, cb) {\n    var self = this;\n    target = target || 0;\n\n    // self.open(function() {\n    //   self.draw(target, cb);\n    // });\n\n    self.open(target, cb);\n  },\n\n  reopen: function(options, target) {\n    /* NOP */\n  },\n\n  saveOptions: function(options) {\n    var saved_options = {};\n    assign(saved_options, options);\n    if ( saved_options.flow == 'auto' ) {\n      // do not save\n      delete saved_options.flow;\n    }\n    localStorage.setItem('cozy.options', JSON.stringify(saved_options));\n  },\n\n  _updateTheme: function() {\n    DomUtil.removeClass(this._container, 'cozy-theme-' + ( this._container.dataset.theme || 'default' ));\n    DomUtil.addClass(this._container, 'cozy-theme-' + this.options.theme);\n    this._container.dataset.theme = this.options.theme;\n  },\n\n  draw: function(target) {\n    // NOOP\n  },\n\n  next: function() {\n    // NOOP\n  },\n\n  prev: function() {\n    // NOOP\n  },\n\n  display: function(index) {\n    // NOOP\n  },\n\n  gotoPage: function(target) {\n    // NOOP\n  },\n\n  goBack: function() {\n    history.back();\n  },\n\n  goForward: function() {\n    history.forward();\n  },\n\n  requestFullscreen: function() {\n    if ( screenfull.enabled ) {\n      // this._preResize();\n      screenfull.toggle(this._container);\n    }\n  },\n\n  _preResize: function() {\n\n  },\n\n  _initContainer: function (id) {\n    var container = this._container = DomUtil.get(id);\n\n    if (!container) {\n      throw new Error('Reader container not found.');\n    } else if (container._cozy_id) {\n      throw new Error('Reader container is already initialized.');\n    }\n\n    DomEvent.on(container, 'scroll', this._onScroll, this);\n    this._containerId = Util.stamp(container);\n  },\n\n  _initLayout: function () {\n    var container = this._container;\n\n    this._fadeAnimated = this.options.fadeAnimation && Browser.any3d;\n\n    DomUtil.addClass(container, 'cozy-container' +\n      (Browser.touch ? ' cozy-touch' : '') +\n      (Browser.retina ? ' cozy-retina' : '') +\n      (Browser.ielt9 ? ' cozy-oldie' : '') +\n      (Browser.safari ? ' cozy-safari' : '') +\n      (this._fadeAnimated ? ' cozy-fade-anim' : '') +\n      ' cozy-engine-' + this.options.engine +\n      ' cozy-theme-' + this.options.theme);\n\n    var position = DomUtil.getStyle(container, 'position');\n\n    this._initPanes();\n\n    if ( ! Browser.columnCount ) {\n      this.options.flow = 'scrolled-doc';\n    }\n  },\n\n  _initPanes: function () {\n    var self = this;\n\n    var panes = this._panes = {};\n\n    var l = 'cozy-';\n    var container = this._container;\n\n    var prefix = 'cozy-module-';\n\n    DomUtil.addClass(container, 'cozy-container');\n    panes['top'] = DomUtil.create('div', prefix + 'top', container);\n    panes['main'] = DomUtil.create('div', prefix + 'main', container);\n    panes['bottom'] = DomUtil.create('div', prefix + 'bottom', container);\n\n    panes['left'] = DomUtil.create('div', prefix + 'left', panes['main']);\n    panes['book-cover'] = DomUtil.create('div', prefix + 'book-cover', panes['main']);\n    panes['right'] = DomUtil.create('div', prefix + 'right', panes['main']);\n    panes['book'] = DomUtil.create('div', prefix + 'book', panes['book-cover']);\n    panes['loader'] = DomUtil.create('div', prefix + 'book-loading', panes['book']);\n    panes['epub'] = DomUtil.create('div', prefix + 'book-epub', panes['book']);\n    this._initBookLoader();\n  },\n\n  _checkIfLoaded: function () {\n    if (!this._loaded) {\n      throw new Error('Set map center and zoom first.');\n    }\n  },\n\n  // DOM event handling\n\n  // @section Interaction events\n  _initEvents: function (remove) {\n    this._targets = {};\n    this._targets[Util.stamp(this._container)] = this;\n\n    this.tracking = function(reader) {\n      var _action = [];\n      var _last_location_start;\n      var _reader = reader;\n      return {\n        action: function(v) {\n          if ( v ) {\n            _action = [v];\n            this.event(v);\n            // _reader.fire('trackAction', { action: v })\n          } else {\n            return _action.pop();\n          }\n        },\n\n        event: function(action, data) {\n          if ( data == null ) { data = {}; }\n          data.action = action;\n          _reader.fire(\"trackAction\", data);\n        },\n\n        pageview: function(location) {\n          if ( location.start != _last_location_start ) {\n            _last_location_start = location.start;\n            // console.log(\"AHOY RELOCATED\", location, location.start, location.href, location.location, this.action());\n            _reader.fire('trackPageview', { cfi: location.start, href: location.href, action: this.action()})\n            return true;\n          }\n          return false;\n        }\n      }\n    }(this);\n\n    var onOff = remove ? DomEvent.off : DomEvent.on;\n\n    // @event click: MouseEvent\n    // Fired when the user clicks (or taps) the map.\n    // @event dblclick: MouseEvent\n    // Fired when the user double-clicks (or double-taps) the map.\n    // @event mousedown: MouseEvent\n    // Fired when the user pushes the mouse button on the map.\n    // @event mouseup: MouseEvent\n    // Fired when the user releases the mouse button on the map.\n    // @event mouseover: MouseEvent\n    // Fired when the mouse enters the map.\n    // @event mouseout: MouseEvent\n    // Fired when the mouse leaves the map.\n    // @event mousemove: MouseEvent\n    // Fired while the mouse moves over the map.\n    // @event contextmenu: MouseEvent\n    // Fired when the user pushes the right mouse button on the map, prevents\n    // default browser context menu from showing if there are listeners on\n    // this event. Also fired on mobile when the user holds a single touch\n    // for a second (also called long press).\n    // @event keypress: KeyboardEvent\n    // Fired when the user presses a key from the keyboard while the map is focused.\n    // onOff(this._container, 'click dblclick mousedown mouseup ' +\n    //   'mouseover mouseout mousemove contextmenu keypress', this._handleDOMEvent, this);\n\n    // if (this.options.trackResize) {\n    //   var self = this;\n    //   var fn = debounce(function(){ self.invalidateSize({}); }, 150);\n    //   onOff(window, 'resize', fn, this);\n    // }\n\n    if (Browser.any3d && this.options.transform3DLimit) {\n      (remove ? this.off : this.on).call(this, 'moveend', this._onMoveEnd);\n    }\n\n    var self = this;\n    if (screenfull.enabled) {\n      screenfull.on('change', function() {\n        // setTimeout(function() {\n        //   self.invalidateSize({});\n        // }, 100);\n        console.log('AHOY: Am I fullscreen?', screenfull.isFullscreen ? 'YES' : 'NO');\n      });\n    }\n\n    self.on(\"updateLocation\", function(location) {\n      var location_href = location.start;\n\n      if ( self._ignoreHistory ) {\n        self._ignoreHistory = false;\n        return;\n      }\n\n      if ( self.tracking.pageview(location) ) {\n        var tmp_href = window.location.href.split(\"#\");\n        tmp_href[1] = location.start.substr(8, location.start.length - 8 - 1);\n        history.pushState({ cfi: location.start }, '', tmp_href.join('#'));\n\n        if ( location.percentage ) {\n          var p = Math.ceil(location.percentage * 100);\n          document.title = `${self._original_document_title} - ${p}%`;\n        }        \n      }\n    })\n\n    window.addEventListener('popstate', function(event) {\n      if ( event.isTrusted && event.state !== null ) {\n        self._ignoreHistory = true;\n        self.gotoPage(event.state.cfi);\n      }\n    })\n\n    document.addEventListener('keydown', function(event) {\n      var keyName = event.key;\n      var target = event.target;\n\n      // check if the activeElement is \".special-panel\"\n      var check = document.activeElement;\n      while ( check.localName != 'body' ) {\n        if ( check.classList.contains('special-panel') ) {\n          return;\n        }\n        check = check.parentElement;\n      }\n\n      var IGNORE_TARGETS = [ 'input', 'target' ];\n      if ( IGNORE_TARGETS.indexOf(target.localName) >= 0 ) {\n        return;\n      }\n\n      self.fire('keyDown', { keyName: keyName, shiftKey: event.shiftKey });\n    });\n\n    self.on('keyDown', function(data) {\n      switch(data.keyName) {\n        case 'ArrowRight':\n        case 'PageDown':\n          self.next();\n          break;\n        case 'ArrowLeft':\n        case 'PageUp':\n          self.prev();\n          break;\n        case 'Home':\n          self._scroll('HOME');\n          break;\n        case 'End':\n          self._scroll('END')\n          break;\n      }\n    });\n  },\n\n  // _onResize: function() {\n  //   if ( ! this._resizeRequest ) {\n  //     this._resizeRequest = Util.requestAnimFrame(function() {\n  //       this.invalidateSize({})\n  //     }, this);\n  //   }\n  // },\n\n  _onScroll: function () {\n    this._container.scrollTop  = 0;\n    this._container.scrollLeft = 0;\n  },\n\n  _handleDOMEvent: function (e) {\n    if (!this._loaded || DomEvent.skipped(e)) { return; }\n\n    var type = e.type === 'keypress' && e.keyCode === 13 ? 'click' : e.type;\n\n    if (type === 'mousedown') {\n      // prevents outline when clicking on keyboard-focusable element\n      DomUtil.preventOutline(e.target || e.srcElement);\n    }\n\n    this._fireDOMEvent(e, type);\n  },\n\n  _fireDOMEvent: function (e, type, targets) {\n\n    if (e.type === 'click') {\n      // Fire a synthetic 'preclick' event which propagates up (mainly for closing popups).\n      // @event preclick: MouseEvent\n      // Fired before mouse click on the map (sometimes useful when you\n      // want something to happen on click before any existing click\n      // handlers start running).\n      var synth = Util.extend({}, e);\n      synth.type = 'preclick';\n      this._fireDOMEvent(synth, synth.type, targets);\n    }\n\n    if (e._stopped) { return; }\n\n    // Find the layer the event is propagating from and its parents.\n    targets = (targets || []).concat(this._findEventTargets(e, type));\n\n    if (!targets.length) { return; }\n\n    var target = targets[0];\n    if (type === 'contextmenu' && target.listens(type, true)) {\n      DomEvent.preventDefault(e);\n    }\n\n    var data = {\n      originalEvent: e\n    };\n\n    if (e.type !== 'keypress') {\n      var isMarker = (target.options && 'icon' in target.options);\n      data.containerPoint = isMarker ?\n          this.latLngToContainerPoint(target.getLatLng()) : this.mouseEventToContainerPoint(e);\n      data.layerPoint = this.containerPointToLayerPoint(data.containerPoint);\n      data.latlng = isMarker ? target.getLatLng() : this.layerPointToLatLng(data.layerPoint);\n    }\n\n    for (var i = 0; i < targets.length; i++) {\n      targets[i].fire(type, data, true);\n      if (data.originalEvent._stopped ||\n        (targets[i].options.nonBubblingEvents && Util.indexOf(targets[i].options.nonBubblingEvents, type) !== -1)) { return; }\n    }\n  },\n\n  getFixedBookPanelSize: function() {\n    // have to make the book\n    var style = window.getComputedStyle(this._panes['book']);\n    var h = this._panes['book'].clientHeight - parseFloat(style.paddingTop) - parseFloat(style.paddingBottom);\n    var w = this._panes['book'].clientWidth - parseFloat(style.paddingRight) - parseFloat(style.paddingLeft);\n    return { height: Math.floor(h * 1.00), width: Math.floor(w * 1.00) };\n  },\n\n  invalidateSize: function(options) {\n    // TODO: IS THIS EVER USED?\n    var self = this;\n\n    if ( ! self._drawn ) { return; }\n\n    Util.cancelAnimFrame(this._resizeRequest);\n\n    if (! this._loaded) { return this; }\n\n    this.fire('resized');\n  },\n\n  _resizeBookPane: function() {\n\n  },\n\n  _setupHooks: function() {\n\n  },\n\n  _checkFeatureCompatibility: function() {\n    if ( ! DomUtil.isPropertySupported('columnCount') || this._checkMobileDevice() ) {\n      // force\n      this.options.flow = 'scrolled-doc';\n    }\n    if ( this._checkMobileDevice() ) {\n      // this.options.fontSizeLarge = '160%';\n      // this.options.fontSizeSmall ='100%';\n      // this.options.fontSizeDefault = '120%';\n      this.options.text_size = 120;\n    }\n  },\n\n  _checkMobileDevice: function() {\n    if ( this._isMobile === undefined ) {\n      this._isMobile = false;\n      if ( this.options.mobileMediaQuery ) {\n        this._isMobile = window.matchMedia(this.options.mobileMediaQuery).matches;\n      }\n    }\n    return this._isMobile;\n  },\n\n  _enableBookLoader: function(delay=0) {\n    var self = this;\n    self._clearBookLoaderTimeout();\n    if ( delay < 0 ) {\n      delay = 0;\n      self._force_progress = true;\n    }\n    self._loader_timeout = setTimeout(function() {\n      self._panes['loader'].style.display = 'block';\n    }, delay);\n  },\n\n  _disableBookLoader: function(force=false) {\n    var self = this;\n    self._clearBookLoaderTimeout();\n    if ( ! self._force_progress || force ) {\n      self._panes['loader'].style.display = 'none';\n      self._force_progress = false;\n      self._panes['loader-status'].innerHTML = '';\n    }\n  },\n\n  _clearBookLoaderTimeout: function() {\n    var self = this;\n    if ( self._loader_timeout ) {\n      clearTimeout(self._loader_timeout);\n      self._loader_timeout = null;\n    }\n  },\n\n  _initBookLoader: function() {\n    // is this not awesome?\n    var template = this.options.loader_template || this.loaderTemplate();\n\n    var body = new DOMParser().parseFromString(template, \"text/html\").body;\n    while ( body.children.length ) {\n      this._panes['loader'].appendChild(body.children[0]);\n    }\n    this._panes['loader-status'] = DomUtil.create('div', 'cozy-module-book-loading-status', this._panes['loader']);\n  },\n\n  loaderTemplate: function() {\n    return `<div class=\"cozy-loader-spinner\">\n    <div class=\"spinner-backdrop spinner-backdrop--1\"></div>\n    <div class=\"spinner-backdrop spinner-backdrop--2\"></div>\n    <div class=\"spinner-backdrop spinner-backdrop--3\"></div>\n    <div class=\"spinner-backdrop spinner-backdrop--4\"></div>\n    <div class=\"spinner-quarter spinner-quarter--1\"></div>\n    <div class=\"spinner-quarter spinner-quarter--2\"></div>\n    <div class=\"spinner-quarter spinner-quarter--3\"></div>\n    <div class=\"spinner-quarter spinner-quarter--4\"></div>\n  </div>`;\n  },\n\n  EOT: true\n});\n\nexport function createReader(id, options) {\n  return new Reader(id, options);\n}\n","import {Class} from '../core/Class';\nimport {Reader} from '../reader/Reader';\nimport * as Util from '../core/Util';\nimport * as DomUtil from '../dom/DomUtil';\n\n/*\n * @class Control\n * @aka L.Control\n * @inherits Class\n *\n * L.Control is a base class for implementing reader controls. Handles regioning.\n * All other controls extend from this class.\n */\n\nexport var Control = Class.extend({\n    // @section\n    // @aka Control options\n    options: {\n        // @option region: String = 'topright'\n        // The region of the control (one of the reader corners). Possible values are `'topleft'`,\n        // `'topright'`, `'bottomleft'` or `'bottomright'`\n    },\n\n    initialize: function (options) {\n        Util.setOptions(this, options);\n        if ( options.container ) {\n            this._container = options.container;\n            this._locked = true;\n        }\n        this._id = (new Date()).getTime() + '-' + parseInt(Math.random((new Date()).getTime()) * 1000, 10);\n    },\n\n    /* @section\n     * Classes extending L.Control will inherit the following methods:\n     *\n     * @method getRegion: string\n     * Returns the region of the control.\n     */\n    getRegion: function () {\n        return this.options.region;\n    },\n\n    // @method setRegion(region: string): this\n    // Sets the region of the control.\n    setRegion: function (region) {\n        var reader = this._reader;\n\n        if (reader) {\n            reader.removeControl(this);\n        }\n\n        this.options.region = region;\n\n        if (reader) {\n            reader.addControl(this);\n        }\n\n        return this;\n    },\n\n    // @method getContainer: HTMLElement\n    // Returns the HTMLElement that contains the control.\n    getContainer: function () {\n        return this._container;\n    },\n\n    // @method addTo(reader: Map): this\n    // Adds the control to the given reader.\n    addTo: function (reader) {\n        this.remove();\n        this._reader = reader;\n\n        var container = this._container = this.onAdd(reader);\n\n        DomUtil.addClass(container, 'cozy-control');\n\n        if ( ! this._locked ) {\n            var region = this.getRegion();\n            var area = reader.getControlRegion(region);\n            area.appendChild(container);\n        }\n\n        return this;\n    },\n\n    // @method remove: this\n    // Removes the control from the reader it is currently active on.\n    remove: function () {\n        if (!this._reader) {\n            return this;\n        }\n\n        if (! this._container) {\n            return this;\n        }\n\n        if ( ! this._locked ) {\n            DomUtil.remove(this._container);\n        }\n\n        if (this.onRemove) {\n            this.onRemove(this._reader);\n        }\n\n        this._reader = null;\n\n        return this;\n    },\n\n    _refocusOnMap: function (e) {\n        // if reader exists and event is not a keyboard event\n        if (this._reader && e && e.screenX > 0 && e.screenY > 0) {\n            this._reader.getContainer().focus();\n        }\n    },\n\n    _className: function(widget) {\n        var className = [ 'cozy-control' ];\n        if ( this.options.direction ) {\n            className.push('cozy-control-' + this.options.direction);\n        }\n        if ( widget ) {\n            className.push('cozy-control-' + widget);\n        }\n        return className.join(' ');\n    }\n});\n\nexport var control = function (options) {\n    return new Control(options);\n};\n\n/* @section Extension methods\n * @uninheritable\n *\n * Every control should extend from `L.Control` and (re-)implement the following methods.\n *\n * @method onAdd(reader: Map): HTMLElement\n * Should return the container DOM element for the control and add listeners on relevant reader events. Called on [`control.addTo(reader)`](#control-addTo).\n *\n * @method onRemove(reader: Map)\n * Optional method. Should contain all clean up code that removes the listeners previously added in [`onAdd`](#control-onadd). Called on [`control.remove()`](#control-remove).\n */\n\n/* @namespace Map\n * @section Methods for Layers and Controls\n */\nReader.include({\n    // @method addControl(control: Control): this\n    // Adds the given control to the reader\n    addControl: function (control) {\n        control.addTo(this);\n        return this;\n    },\n\n    // @method removeControl(control: Control): this\n    // Removes the given control from the reader\n    removeControl: function (control) {\n        control.remove();\n        return this;\n    },\n\n    getControlContainer: function() {\n        var l = 'cozy-';\n        if ( ! this._controlContainer ) {\n            this._controlContainer =\n                DomUtil.create('div', l + 'control-container', this._container);\n        }\n        return this._controlContainer;\n    },\n\n    getControlRegion: function (target) {\n\n        if ( ! this._panes[target] ) {\n            // target is dot-delimited string\n            // first dot is the panel\n            var parts = target.split('.');\n            var tmp = [];\n            var parent = this._container;\n            var x = 0;\n            while ( parts.length ) {\n                var slug = parts.shift();\n                tmp.push(slug);\n                var panel = tmp.join(\".\");\n                var className = 'cozy-panel-' + slug;\n                if ( ! this._panes[panel] ) {\n                    this._panes[panel] = DomUtil.create('div', className, parent);\n                }\n                parent = this._panes[panel];\n                x += 1;\n                if ( x > 100 ) { break; }\n            }\n        }\n        return this._panes[target];\n    },\n\n    getControlRegion_1: function (target) {\n\n        var tmp = target.split('.');\n        var region = tmp.shift();\n        var slot = tmp.pop() || '-slot';\n\n        var container = this._panes[region];\n        if ( ! this._panes[target] ) {\n            var className = 'cozy-' + region + '--item cozy-slot-' + slot\n            if ( ! this._panes[region + '.' + slot] ) {\n                var div = DomUtil.create('div', className);\n                if ( slot == 'left' || slot == 'bottom' ) {\n                    var childElement = this._panes[region].firstChild;\n                    this._panes[region].insertBefore(div, childElement);\n                } else {\n                    this._panes[region].appendChild(div);\n                }\n                this._panes[region + '.' + slot] = div;\n            }\n            className = this._classify(tmp);\n            this._panes[target] = DomUtil.create('div', className, this._panes[region + '.' + slot]);\n        }\n\n        return this._panes[target];\n    },\n\n    _classify: function(tmp) {\n        var l = 'cozy-';\n        var className = [];\n        for(var i in tmp) {\n            className.push(l + tmp[i]);\n        }\n        className = className.join(' ');\n        return className;\n    },\n\n    _clearControlRegion: function () {\n        for (var i in this._controlRegions) {\n            DomUtil.remove(this._controlRegions[i]);\n        }\n        DomUtil.remove(this._controlContainer);\n        delete this._controlRegions;\n        delete this._controlContainer;\n    }\n});\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nvar PageControl = Control.extend({\n  onAdd: function(reader) {\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n      container = DomUtil.create('div', className),\n\n      this._control  = this._createButton(this._fill(options.html || options.label), this._fill(options.label),\n              className, container);\n    }\n    this._bindEvents();\n\n    return container;\n  },\n\n  _createButton: function (html, title, className, container) {\n    var link = DomUtil.create('a', className, container);\n    link.innerHTML = html;\n    link.href = '#';\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    return link;\n  },\n\n  _bindEvents: function() {\n    var self = this;\n    DomEvent.disableClickPropagation(this._control);\n    DomEvent.on(this._control, 'click', DomEvent.stop);\n    DomEvent.on(this._control, 'click', this._action, this);\n\n    this._reader.on('reopen', function(data) {\n      // update the button text / titles\n      var html = self.options.html || self.options.label;\n      self._control.innerHTML = self._fill(html);\n      self._control.setAttribute('title', self._fill(self.options.label));\n      self._control.setAttribute('aria-label', self._fill(self.options.label));\n    });\n\n  },\n\n  _unit: function() {\n    return ( this._reader.options.flow == 'scrolled-doc' ) ? 'Section' : 'Page';\n  },\n\n  _fill: function(s) {\n    var unit = this._unit();\n    return s.replace(/\\$\\{unit\\}/g, unit);\n  },\n\n  _label: function() {\n    return this.options.label + \" \" + ( this._reader.options.flow == 'scrolled-doc' ) ? 'Section' : 'Page';\n  },\n\n  EOT: true\n});\n\nexport var PagePrevious = PageControl.extend({\n  options: {\n    region: 'edge.left',\n    direction: 'previous',\n    label: 'Previous ${unit}',\n    html: '<i class=\"icon-chevron-left oi\" data-glyph=\"chevron-left\" title=\"Previous ${unit}\" aria-hidden=\"true\"></i>'\n  },\n\n  _action: function(e) {\n    this._reader.prev();\n  }\n});\n\nexport var PageNext = PageControl.extend({\n  options: {\n    region: 'edge.right',\n    direction: 'next',\n    label: 'Next ${unit}',\n    html: '<i class=\"icon-chevron-right oi\" data-glyph=\"chevron-right\" title=\"Next ${unit}\" aria-hidden=\"true\"></i>'\n  },\n\n  _action: function(e) {\n    this._reader.next();\n  }\n});\n\nexport var PageFirst = PageControl.extend({\n  options: {\n    direction: 'first',\n    label: 'First ${unit}'\n  },\n  _action: function(e) {\n      this._reader.first();\n  }\n});\n\nexport var PageLast = PageControl.extend({\n  options: {\n    direction: 'last',\n    label: 'Last ${unit}'\n  },\n  _action: function(e) {\n      this._reader.last();\n  }\n});\n\nexport var pageNext = function(options) {\n  return new PageNext(options);\n}\n\nexport var pagePrevious = function(options) {\n  return new PagePrevious(options);\n}\n\nexport var pageFirst = function(options) {\n  return new PageFirst(options);\n}\n\nexport var pageLast = function(options) {\n  return new PageLast(options);\n}\n","import {Class} from '../core/Class';\nimport {Reader} from '../reader/Reader';\nimport * as Util from '../core/Util';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nimport assign from 'lodash/assign';\n\nvar activeModal;\nvar dismissModalListener = false;\n\n// from https://github.com/ghosh/micromodal/blob/master/src/index.js\nconst FOCUSABLE_ELEMENTS = [\n    'a[href]',\n    'area[href]',\n    'input:not([disabled]):not([type=\"hidden\"])',\n    'select:not([disabled])',\n    'textarea:not([disabled])',\n    'button:not([disabled])',\n    'iframe',\n    'object',\n    'embed',\n    '[contenteditable]',\n    '[tabindex]:not([tabindex^=\"-\"])'\n  ];\n\nconst ACTIONABLE_ELEMENTS = [\n    'a[href]',\n    'area[href]',\n    'input[type=\"submit\"]:not([disabled])',\n    'button:not([disabled])'\n  ];\n\nexport var Modal = Class.extend({\n  options: {\n    // @option region: String = 'topright'\n    // The region of the control (one of the reader edges). Possible values are `'left' ad 'right'`\n    region: 'left',\n    fraction: 0,\n    width: null,\n    className: {},\n    actions: null,\n    callbacks: { onShow: function() {}, onClose: function() {} },\n    handlers: {}\n  },\n\n  initialize: function (options) {\n    options = Util.setOptions(this, options);\n    this._id = (new Date()).getTime() + '-' + parseInt(Math.random((new Date()).getTime()) * 1000, 10);\n    this._initializedEvents = false;\n    this.callbacks = assign({}, this.options.callbacks);\n    this.actions = this.options.actions ? assign({}, this.options.actions) : null;\n    this.handlers = assign({}, this.options.handlers);\n    if ( typeof(this.options.className) == 'string' ) {\n      this.options.className = { container: this.options.className };\n    }\n  },\n\n  addTo: function(reader) {\n    var self = this;\n    this._reader = reader;\n    var template = this.options.template;\n\n    var panelHTML = `<div class=\"cozy-modal modal-slide ${this.options.region || 'left'}\" id=\"modal-${this._id}\" aria-labelledby=\"modal-${this._id}-title\" role=\"dialog\" aria-describedby=\"modal-${this._id}-content\" aria-hidden=\"true\">\n      <div class=\"modal__overlay\" tabindex=\"-1\" data-modal-close>\n        <div class=\"modal__container ${this.options.className.container ? this.options.className.container : ''}\" role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"modal-${this._id}-title\" aria-describedby=\"modal-${this._id}-content\" id=\"modal-${this._id}-container\">\n          <div role=\"document\">\n            <header class=\"modal__header\">\n              <h3 class=\"modal__title\" id=\"modal-${this._id}-title\">${this.options.title}</h3>\n              <button class=\"modal__close\" aria-label=\"Close modal\" aria-controls=\"modal-${this._id}-container\" data-modal-close></button>\n            </header>\n            <main class=\"modal__content ${this.options.className.main ? this.options.className.main : ''}\" id=\"modal-${this._id}-content\">\n              ${template}\n            </main>`;\n\n    if ( this.options.actions ) {\n      panelHTML += '<footer class=\"modal__footer\">'\n      for(var i in this.options.actions) {\n        var action = this.options.actions[i];\n        var button_cls = action.className || 'button--default';\n        panelHTML += `<button id=\"action-${this._id}-${i}\" class=\"button button--lg ${button_cls}\">${action.label}</button>`;\n      }\n      panelHTML += '</footer>';\n    }\n\n    panelHTML += '</div></div></div></div>';\n\n    var body = new DOMParser().parseFromString(panelHTML, \"text/html\").body;\n\n    this.modal = reader._container.appendChild(body.children[0]);\n    this._container = this.modal; // compatibility\n\n    this.container = this.modal.querySelector('.modal__container');\n    this._bindEvents();\n    return this;\n  },\n\n  _bindEvents: function() {\n    var self = this;\n    this.onClick = this.onClick.bind(this);\n    this.onKeydown = this.onKeydown.bind(this);\n    this.onModalTransition = this.onModalTransition.bind(this);\n\n    this.modal.addEventListener('transitionend', function() {\n    }.bind(this));\n\n    // bind any actions\n    if ( this.actions ) {\n      for(var i in this.actions) {\n        let action = this.actions[i];\n        let button_id = '#action-' + this._id + '-' + i;\n        let button = this.modal.querySelector(button_id);\n        if ( button ) {\n          DomEvent.on(button, 'click', function(event) {\n            event.preventDefault();\n            action.callback(event);\n            if ( action.close ) {\n              self.closeModal();\n            }\n          })\n        }\n      }\n    }\n  },\n\n  deactivate: function() {\n    this.closeModal();\n  },\n\n  closeModal: function() {\n    var self = this;\n    this.modal.setAttribute('aria-hidden', 'true');\n    this.removeEventListeners();\n    if ( this.activeElement ) {\n      this.activeElement.focus();\n    }\n    this.callbacks.onClose(this.modal);\n  },\n\n  showModal: function() {\n    this.activeElement = document.activeElement\n    this._resize();\n    this.modal.setAttribute('aria-hidden', 'false')\n    this.setFocusToFirstNode()\n    this.addEventListeners()\n    this.callbacks.onShow(this.modal)\n  },\n\n  activate: function() {\n    return this.showModal();\n    var self = this;\n    activeModal = this;\n    DomUtil.addClass(self._reader._container, 'st-modal-activating');\n    this._resize();\n    DomUtil.addClass(this._reader._container, 'st-modal-open');\n    setTimeout(function() {\n      DomUtil.addClass(self._container, 'active');\n      DomUtil.removeClass(self._reader._container, 'st-modal-activating');\n      self._container.setAttribute('aria-hidden', 'false');\n      self.setFocusToFirstNode();\n    }, 25);\n  },\n\n  addEventListeners: function () {\n    // --- do we need touch listeners?\n    // this.modal.addEventListener('touchstart', this.onClick)\n    // this.modal.addEventListener('touchend', this.onClick)\n    this.modal.addEventListener('click', this.onClick)\n    document.addEventListener('keydown', this.onKeydown)\n    'webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend'.split(' ').forEach(function(event) {\n      this.modal.addEventListener(event, this.onModalTransition);\n    }.bind(this))\n  },\n\n  removeEventListeners: function () {\n    this.modal.removeEventListener('touchstart', this.onClick)\n    this.modal.removeEventListener('click', this.onClick)\n    'webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend'.split(' ').forEach(function(event) {\n      this.modal.removeEventListener(event, this.onModalTransition);\n    }.bind(this))\n    document.removeEventListener('keydown', this.onKeydown)\n  },\n\n  _resize: function() {\n    var container = this._reader._container;\n    this.container.style.height = container.offsetHeight + 'px';\n    // console.log(\"AHOY MODAL\", this.container.style.height);\n    if ( ! this.options.className.container  ) {\n      this.container.style.width = this.options.width || parseInt(container.offsetWidth * this.options.fraction) + 'px';\n    }\n\n    var header = this.container.querySelector('header');\n    var footer = this.container.querySelector('footer');\n    var main = this.container.querySelector('main');\n    var height = this.container.clientHeight - header.clientHeight;\n    if ( footer ) {\n      height -= footer.clientHeight;\n    }\n    main.style.height = height + 'px';\n  },\n\n  getFocusableNodes: function() {\n    const nodes = this.modal.querySelectorAll(FOCUSABLE_ELEMENTS);\n    return Object.keys(nodes).map((key) => nodes[key]);\n  },\n\n  setFocusToFirstNode: function() {\n    var focusableNodes = this.getFocusableNodes();\n    if ( focusableNodes.length ) {\n      focusableNodes[0].focus();\n    } else {\n      activeModal._container.focus();\n    }\n  },\n\n  getActionableNodes: function() {\n    const nodes = this.modal.querySelectorAll(ACTIONABLE_ELEMENTS);\n    return Object.keys(nodes).map((key) => nodes[key]);\n  },\n\n  onKeydown: function(event) {\n    if ( event.keyCode == 27 ) { this.closeModal(); }\n    if ( event.keyCode == 9 ) {\n      this.maintainFocus(event);\n    }\n  },\n\n  onClick: function(event) {\n\n    var closeAfterAction = false;\n    var target = event.target;\n\n    // As far as I can tell, the code below isn't catching direct clicks on\n    // items with class='data-modal-close' as they're not ACTIONABLE_ELEMENTS.\n    // Adding them to ACTIONABLE_ELEMENTS causes undesirable behavior where\n    // their child items also close the modal thanks to the loop below.\n    // Children of .modal__overlay include the modal header, border area and\n    // padding. We don't want clicks on these closing the modal.\n    // Just close the modal now for direct clicks on a '.data-modal-close'.\n    if (target.hasAttribute('data-modal-close')) {\n      this.fire('closed');\n      this.closeModal();\n      return;\n    }\n\n    // if the target isn't an actionable type, walk the DOM until\n    // one is found\n    var actionableNodes = this.getActionableNodes();\n    while ( actionableNodes.indexOf(target) < 0 && target != this.modal ) {\n      target = target.parentElement;\n    }\n\n    // no target found, punt\n    if ( actionableNodes.indexOf(target) < 0 ) {\n      return;\n    }\n\n    if (this.handlers.click) {\n      var did_match = false;\n      for(var selector in this.handlers.click) {\n        if ( target.matches(selector) ) {\n          closeAfterAction = this.handlers.click[selector](this, target);\n          break;\n        }\n      }\n    }\n\n    if (closeAfterAction || target.hasAttribute('data-modal-close')) this.closeModal();\n\n    event.preventDefault();\n  },\n\n  onModalTransition: function(event) {\n    if ( this.modal.getAttribute('aria-hidden') == 'true' ) {\n      this._reader.fire('modal-closed');\n    } else {\n      this._reader.fire('modal-opened');\n    }\n  },\n\n  on: function(event, selector, handler) {\n    if (! this.handlers[event] ) {\n      this.handlers[event] = {};\n    }\n    if (typeof(selector) == 'function') {\n      handler = selector;\n      selector = '*';\n    }\n    this.handlers[event][selector] = handler;\n  },\n\n  fire: function(event) {\n    if ( this.handlers[event] && this.handlers[event]['*'] ) {\n      this.handlers[event]['*'](this);\n    }\n  },\n\n  maintainFocus: function(event) {\n    var focusableNodes = this.getFocusableNodes();\n    var focusedItemIndex = focusableNodes.indexOf(document.activeElement);\n    if (event.shiftKey && focusedItemIndex === 0) {\n      focusableNodes[focusableNodes.length - 1].focus()\n      event.preventDefault()\n    }\n\n    if (!event.shiftKey && focusedItemIndex === focusableNodes.length - 1) {\n      focusableNodes[0].focus()\n      event.preventDefault()\n    }\n  },\n\n  EOT: true\n});\n\nReader.include({\n  modal: function (options) {\n    var modal = new Modal(options);\n    return modal.addTo(this);\n    // return this;\n  },\n\n  EOT: true\n});\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport {Modal} from './Modal';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Contents = Control.extend({\n\n  defaultTemplate: `<button class=\"button--sm\" data-toggle=\"open\" aria-label=\"Table of Contents\"><i class=\"icon-menu oi\" data-glyph=\"menu\" title=\"Table of Contents\" aria-hidden=\"true\"></i></button>`,\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    this._control.setAttribute('id', 'action-' + this._id);\n    container.style.position = 'relative';\n\n    this._reader.on('updateContents', function(data) {\n\n      DomEvent.on(this._control, 'click', function(event) {\n        event.preventDefault();\n        self._reader.tracking.action('contents/open');\n        self._modal.activate();\n      }, this)\n\n      this._modal = this._reader.modal({\n        template: '<ul></ul>',\n        title: 'Contents',\n        region: 'left',\n        className: 'cozy-modal-contents'\n      });\n\n      this._modal.on('click', 'a[href]', function(modal, target) {\n        target = target.getAttribute('data-href');\n        this._reader.tracking.action('contents/go');\n        this._reader.gotoPage(target);\n        return true;\n      }.bind(this))\n\n      this._modal.on('closed', function() {\n        self._reader.tracking.action('contents/close');\n      })\n\n      this._setupSkipLink();\n\n      var parent = self._modal._container.querySelector('ul');\n      // var s = data.toc.filter(function(value) { return value.parent == null }).map(function(value) { return [ value, 0, parent ] });\n      // while ( s.length ) {\n      //   var tuple = s.shift();\n      //   var chapter = tuple[0];\n      //   var tabindex = tuple[1];\n      //   var parent = tuple[2];\n\n      //   var option = self._createOption(chapter, tabindex, parent);\n      //   data.toc.filter(function(value) { return value.parent == chapter.id }).reverse().forEach(function(chapter_) {\n      //     s.unshift([chapter_, tabindex + 1, option]);\n      //   });\n      // }\n      var _process = function(items, tabindex, parent) {\n        items.forEach(function(item) {\n          var option = self._createOption(item, tabindex, parent);\n          if ( item.subitems && item.subitems.length ) {\n            _process(item.subitems, tabindex + 1, option);\n          }\n        })\n      }\n      _process(data.toc, 0, parent);\n    }.bind(this))\n\n    return container;\n  },\n\n  _createOption(chapter, tabindex, parent) {\n\n    function pad(value, length) {\n        return (value.toString().length < length) ? pad(\"-\"+value, length):value;\n    }\n    var option = DomUtil.create('li');\n    if ( chapter.href ) {\n      var anchor = DomUtil.create('a', null, option);\n      anchor.textContent = chapter.label;\n      // var tab = pad('', tabindex); tab = tab.length ? tab + ' ' : '';\n      // option.textContent = tab + chapter.label;\n      anchor.setAttribute('href', chapter.href);\n      anchor.setAttribute('data-href', chapter.href);\n    } else {\n      var span = DomUtil.create('span', null, option);\n      span.textContent = chapter.label;\n    }\n\n    if ( parent.tagName == 'LI' ) {\n      // need to nest\n      var tmp = parent.querySelector('ul');\n      if ( ! tmp ) {\n        tmp = DomUtil.create('ul', null, parent);\n      }\n      parent = tmp;\n    }\n\n    parent.appendChild(option);\n    return option;\n  },\n\n  _setupSkipLink: function() {\n    if ( ! this.options.skipLink ) { return; }\n      \n    var target = document.querySelector(this.options.skipLink);\n    if ( ! target ) { return; }\n\n    var link = document.createElement('a');\n    link.textContent = 'Skip to contents';\n    link.setAttribute('href', '#action-' + this._id);\n\n    var ul = target.querySelector('ul');\n    if ( ul ) {\n      // add to list\n      target = document.createElement('li');\n      ul.appendChild(target);\n    }\n    target.appendChild(link);\n    link.addEventListener('click', function(event) {\n      event.preventDefault();\n      event.stopPropagation();\n      this._control.click();\n    }.bind(this))\n\n  },\n\n  EOT: true\n});\n\nexport var contents = function(options) {\n  return new Contents(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\n// Title + Chapter\n\nexport var Title = Control.extend({\n  onAdd: function(reader) {\n    var self = this;\n    var className = this._className(),\n        container = DomUtil.create('div', className),\n        options = this.options;\n\n    // var template = '<h1><span class=\"cozy-title\">Contents: </span><select size=\"1\" name=\"contents\"></select></label>';\n    // var control = new DOMParser().parseFromString(template, \"text/html\").body.firstChild;\n\n    var h1 = DomUtil.create('h1', 'cozy-h1', container);\n    DomUtil.setOpacity(h1, 0);\n    this._title = DomUtil.create('span', 'cozy-title', h1);\n    this._divider = DomUtil.create('span', 'cozy-divider', h1);\n    this._divider.textContent = \" · \";\n    this._section = DomUtil.create('span', 'cozy-section', h1);\n\n    // --- TODO: disable until we can work out how to \n    // --- more reliably match the current section to the contents\n    // this._reader.on('updateSection', function(data) {\n    //   if ( data && data.label ) {\n    //     self._section.textContent = data.label;\n    //     DomUtil.setOpacity(self._section, 1.0);\n    //     DomUtil.setOpacity(self._divider, 1.0);\n    //   } else {\n    //     DomUtil.setOpacity(self._section, 0);\n    //     DomUtil.setOpacity(self._divider, 0);\n    //   }\n    // })\n\n    this._reader.on('updateTitle', function(data) {\n      if ( data ) {\n        self._title.textContent = data.title || data.bookTitle;\n        DomUtil.setOpacity(self._section, 0);\n        DomUtil.setOpacity(self._divider, 0);\n        DomUtil.setOpacity(h1, 1);\n      }\n    })\n\n    return container;\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('a', className, container);\n    link.innerHTML = html;\n    link.href = '#';\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n    // DomEvent.on(link, 'click', this._refocusOnMap, this);\n\n    return link;\n  },\n\n  EOT: true\n});\n\nexport var title = function(options) {\n  return new Title(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\n// Title + Chapter\n\nexport var PublicationMetadata = Control.extend({\n  onAdd: function(reader) {\n    var self = this;\n    var className = this._className(),\n        container = DomUtil.create('div', className),\n        options = this.options;\n\n    // var template = '<h1><span class=\"cozy-title\">Contents: </span><select size=\"1\" name=\"contents\"></select></label>';\n    // var control = new DOMParser().parseFromString(template, \"text/html\").body.firstChild;\n\n    this._publisher = DomUtil.create('div', 'cozy-publisher', container);\n    this._rights = DomUtil.create('div', 'cozy-rights', container);\n\n    this._reader.on('updateTitle', function(data) {\n      if ( data ) {\n        self._publisher.textContent = data.publisher;\n        self._rights.textContent = data.rights;\n      }\n    })\n\n    return container;\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('a', className, container);\n    link.innerHTML = html;\n    link.href = '#';\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n    // DomEvent.on(link, 'click', this._refocusOnMap, this);\n\n    return link;\n  },\n\n  EOT: true\n});\n\nexport var publicationMetadata = function(options) {\n  return new PublicationMetadata(options);\n}\n","import {Class} from '../core/Class';\nimport {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\nimport * as Util from '../core/Util';\n\nimport assign from 'lodash/assign';\nimport keys from 'lodash/keys';\n\nexport var Preferences = Control.extend({\n  options: {\n    label: 'Preferences',\n    hasThemes: false,\n    html: '<i class=\"icon-cog oi\" data-glyph=\"cog\" title=\"Preferences and Settings\" aria-hidden=\"true\"></i>'\n  },\n\n  onAdd: function(reader) {\n    var self = this;\n    var className = this._className('preferences'),\n        container = DomUtil.create('div', className),\n        options = this.options;\n\n    this._activated = false;\n    this._control = this._createButton(options.html || options.label, options.label,\n            className, container, this._action)\n\n    // self.initializeForm();\n    this._modal = this._reader.modal({\n      // template: '<form></form>',\n      title: 'Preferences',\n      className: 'cozy-modal-preferences',\n      actions: [\n        {\n          label: 'Save Changes',\n          callback: function(event) {\n            self.updatePreferences(event);\n          }\n        }\n      ],\n      region: 'right'\n    });\n\n\n    return container;\n  },\n\n  _action: function() {\n    var self = this;\n    self.initializeForm();\n    self._modal.activate();\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('button', className, container);\n    link.innerHTML = html;\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n\n    return link;\n  },\n\n  _createPanel: function() {\n    var self = this;\n    if ( this._modal._container.querySelector('form') ) { return; }\n\n    var template = '';\n\n    var possible_fieldsets = [];\n    if ( this._reader.metadata.layout == 'pre-paginated' ) {\n      // different panel\n      possible_fieldsets.push('Scale');\n    } else {\n      possible_fieldsets.push('TextSize');\n    }\n    possible_fieldsets.push('Display');\n\n    if ( this._reader.rootfiles && this._reader.rootfiles.length > 1 ) {\n      // this.options.hasPackagePaths = true;\n      possible_fieldsets.push('Rendition');\n    }\n\n    if ( this._reader.options.themes && this._reader.options.themes.length > 0 ) {\n      this.options.hasThemes = true;\n      possible_fieldsets.push('Theme');\n    }\n\n    this._fieldsets = [];\n    possible_fieldsets.forEach(function(cls) {\n      var fieldset = new Preferences.fieldset[cls](this);\n      template += fieldset.template();\n      this._fieldsets.push(fieldset);\n    }.bind(this))\n\n    if ( this.options.fields ) {\n      this.options.hasFields = true;\n      for(var i in this.options.fields) {\n        var field = this.options.fields[i];\n        var id = \"preferences-custom-\" + i;\n        template += `<fieldset class=\"custom-field\">\n          <legend>${field.label}</legend>\n        `;\n        for(var j in field.inputs) {\n          var input = field.inputs[j];\n          var checked = input.value == field.value ? ' checked=\"checked\"' : '';\n          template += `<label><input id=\"preferences-custom-${i}-${j}\" type=\"radio\" name=\"x${field.name}\" value=\"${input.value}\" ${checked}/>${input.label}</label>`;\n        }\n        if ( field.hint ) {\n          template += `<p class=\"hint\" style=\"font-size: 90%\">${field.hint}</p>`;\n        }\n      }\n    }\n\n    template = '<form>' + template + '</form>';\n\n    // this._modal = this._reader.modal({\n    //   template: template,\n    //   title: 'Preferences',\n    //   className: 'cozy-modal-preferences',\n    //   actions: [\n    //     {\n    //       label: 'Save Changes',\n    //       callback: function(event) {\n    //         self.updatePreferences(event);\n    //       }\n    //     }\n    //   ],\n    //   region: 'right'\n    // });\n\n    this._modal._container.querySelector('main').innerHTML = template;\n    this._form = this._modal._container.querySelector('form');\n  },\n\n  initializeForm: function() {\n    this._createPanel();\n    this._fieldsets.forEach(function(fieldset) {\n      fieldset.initializeForm(this._form);\n    }.bind(this));\n  },\n\n  updatePreferences: function(event) {\n    event.preventDefault();\n\n    var doUpdate = false;\n    var new_options = {};\n    var saveable_options = {};\n    this._fieldsets.forEach(function(fieldset) {\n      // doUpdate = doUpdate || fieldset.updateForm(this._form, new_options);\n      // assign(new_options, fieldset.updateForm(this._form));\n      fieldset.updateForm(this._form, new_options, saveable_options);\n    }.bind(this));\n\n    if ( this.options.hasFields ) {\n      for(var i in this.options.fields) {\n        var field = this.options.fields[i];\n        var id = \"preferences-custom-\" + i;\n        var input = this._form.querySelector(`input[name=\"x${field.name}\"]:checked`);\n        if ( input.value != field.value ) {\n          field.value = input.value;\n          field.callback(field.value);\n        }\n      }\n    }\n\n    this._modal.deactivate();\n\n    setTimeout(function() {\n      this._reader.saveOptions(saveable_options);\n      this._reader.reopen(new_options);\n    }.bind(this), 100);\n  },\n\n  EOT: true\n});\n\nPreferences.fieldset = {};\n\nvar Fieldset = Class.extend({\n\n  options: {},\n\n  initialize: function (control, options) {\n      Util.setOptions(this, options);\n      this._control = control;\n      this._current = {};\n      this._id = (new Date()).getTime() + '-' + parseInt(Math.random((new Date()).getTime()) * 1000, 10);\n  },\n\n  template: function() {\n\n  },\n\n  EOT: true\n\n\n});\n\nPreferences.fieldset.TextSize = Fieldset.extend({\n\n  initializeForm: function(form) {\n    if ( ! this._input ) {\n      this._input = form.querySelector(`#x${this._id}-input`);\n      this._output = form.querySelector(`#x${this._id}-output`);\n      this._preview = form.querySelector(`#x${this._id}-preview`);\n      this._actionReset = form.querySelector(`#x${this._id}-reset`);\n\n      this._input.addEventListener('input', this._updatePreview.bind(this));\n      this._input.addEventListener('change', this._updatePreview.bind(this));\n\n      this._actionReset.addEventListener('click', function(event) {\n        event.preventDefault();\n        this._input.value = 100;\n        this._updatePreview();\n      }.bind(this));\n    }\n\n    var text_size = this._control._reader.options.text_size || 100;\n    if ( text_size == 'auto' ) { text_size = 100; }\n    this._current.text_size = text_size;\n    this._input.value = text_size;\n    this._updatePreview();\n  },\n\n  updateForm: function(form, options, saveable) {\n    // return { text_size: this._input.value };\n    options.text_size = saveable.text_size = this._input.value;\n    // options.text_size = this._input.value;\n    // return ( this._input.value != this._current.text_size );\n  },\n\n  template: function() {\n    return `<fieldset class=\"cozy-fieldset-text_size\">\n        <legend>Text Size</legend>\n        <div class=\"preview--text_size\" id=\"x${this._id}-preview\">\n          ‘Yes, that’s it,’ said the Hatter with a sigh: ‘it’s always tea-time, and we’ve no time to wash the things between whiles.’\n        </div>\n        <p style=\"white-space: no-wrap\">\n          <span>T-</span>\n          <input name=\"text_size\" type=\"range\" id=\"x${this._id}-input\" value=\"100\" min=\"50\" max=\"400\" step=\"10\" style=\"width: 75%; display: inline-block\" />\n          <span>T+</span>\n        </p>\n        <p>\n          <span>Text Size: </span>\n          <span id=\"x${this._id}-output\">100</span>\n          <button id=\"x${this._id}-reset\" class=\"reset button--inline\" style=\"margin-left: 8px\">Reset</button> \n        </p>\n      </fieldset>`;\n  },\n\n  _updatePreview: function() {\n    this._preview.style.fontSize = `${( parseInt(this._input.value, 10) / 100 )}em`;\n    this._output.innerHTML = `${this._input.value}%`;\n  },\n\n  EOT: true\n\n});\n\nPreferences.fieldset.Display = Fieldset.extend({\n\n  initializeForm: function(form) {\n    var flow = this._control._reader.options.flow || this._control._reader.metadata.flow || 'auto';\n    // if ( flow == 'auto' ) { flow = 'paginated'; }\n\n    var input = form.querySelector(`#x${this._id}-input-${flow}`);\n    input.checked = true;\n    this._current.flow = flow;\n\n  },\n\n  updateForm: function(form, options, saveable) {\n    var input = form.querySelector(`input[name=\"x${this._id}-flow\"]:checked`);\n    options.flow = input.value;\n    if ( options.flow != 'auto' ) {\n      saveable.flow = options.flow;\n    }\n    // if ( input.value == 'auto' ) {\n    //   // we do NOT want to save flow as a preference\n    //   return {};\n    // }\n    // return { flow: input.value };\n  },\n\n  template: function() {\n    var scrolled_help = '';\n    if ( this._control._reader.metadata.layout != 'pre-paginated' ) {\n      scrolled_help = \"<br /><small>This is an experimental feature that may cause display and loading issues for the book when enabled.</small>\";\n    }\n    return `<fieldset>\n            <legend>Display</legend>\n            <label><input name=\"x${this._id}-flow\" type=\"radio\" id=\"x${this._id}-input-auto\" value=\"auto\" /> Auto<br /><small>Let the reader determine display mode based on your browser dimensions and the type of content you're reading</small></label>\n            <label><input name=\"x${this._id}-flow\" type=\"radio\" id=\"x${this._id}-input-paginated\" value=\"paginated\" /> Page-by-Page</label>\n            <label><input name=\"x${this._id}-flow\" type=\"radio\" id=\"x${this._id}-input-scrolled-doc\" value=\"scrolled-doc\" /> Scroll${scrolled_help}</label>\n          </fieldset>`;\n  },\n\n  EOT: true\n\n});\n\nPreferences.fieldset.Theme = Fieldset.extend({\n\n  initializeForm: function(form) {\n    var theme = this._control._reader.options.theme || 'default';\n\n    var input = form.querySelector(`#x${this._id}-input-theme-${theme}`);\n    input.checked = true;\n    this._current.theme = theme;\n  },\n\n  updateForm: function(form, options, saveable) {\n    var input = form.querySelector(`input[name=\"x${this._id}-theme\"]:checked`);\n    options.theme = saveable.theme = input.value;\n    // return { theme: input.value };\n  },\n\n  template: function() {\n    var template = `<fieldset>\n            <legend>Theme</legend>\n            <label><input name=\"x${this._id}-theme\" type=\"radio\" id=\"x${this._id}-input-theme-default\" value=\"default\" />Default</label>`;\n\n    this._control._reader.options.themes.forEach(function(theme) {\n      template += `<label><input name=\"x${this._id}-theme\" type=\"radio\" id=\"x${this._id}-input-theme-${theme.klass}\" value=\"${theme.klass}\" />${theme.name}</label>`\n    }.bind(this));\n\n    template += '</fieldset>';\n\n    return template;\n\n  },\n\n  EOT: true\n\n});\n\nPreferences.fieldset.Rendition = Fieldset.extend({\n\n  initializeForm: function(form) {\n    var rootfiles = this._control._reader.rootfiles;\n    var rootfilePath = this._control._reader.options.rootfilePath;\n    var expr = rootfilePath ? `[value=\"${rootfilePath}\"]` : \":first-child\";\n    var input = form.querySelector(`input[name=\"x${this._id}-rootfilePath\"]${expr}`);\n    input.checked = true;\n    this._current.rootfilePath = rootfilePath || rootfiles[0].rootfilePath;\n  },\n\n  updateForm: function(form, options, saveable) {\n    var input = form.querySelector(`input[name=\"x${this._id}-rootfilePath\"]:checked`);\n    if ( input.value != this._current.rootfilePath ) {\n      options.rootfilePath = input.value;\n      this._current.rootfilePath = input.value;\n    }\n  },\n\n  template: function() {\n    var template = `<fieldset>\n            <legend>Rendition</legend>\n    `;\n\n    this._control._reader.rootfiles.forEach(function(rootfile, i) {\n      template += `<label><input name=\"x${this._id}-rootfilePath\" type=\"radio\" id=\"x${this._id}-input-rootfilePath-${i}\" value=\"${rootfile.rootfilePath}\" />${rootfile.label || rootfile.accessMode || rootfile.rootfilePath}</label>`;\n    }.bind(this))\n\n    template += '</fieldset>';\n\n    return template;\n\n  },\n\n  EOT: true\n\n});\n\nPreferences.fieldset.Scale = Fieldset.extend({\n\n  initializeForm: function(form) {\n    if ( ! this._input ) {\n      this._input = form.querySelector(`#x${this._id}-input`);\n      this._output = form.querySelector(`#x${this._id}-output`);\n      this._preview = form.querySelector(`#x${this._id}-preview > div`);\n      this._actionReset = form.querySelector(`#x${this._id}-reset`);\n\n      this._input.addEventListener('input', this._updatePreview.bind(this));\n      this._input.addEventListener('change', this._updatePreview.bind(this));\n\n      this._actionReset.addEventListener('click', function(event) {\n        event.preventDefault();\n        this._input.value = 100;\n        this._updatePreview();\n      }.bind(this));\n    }\n\n    var scale = this._control._reader.options.scale || 100;\n    if ( ! scale ) { scale = 100; }\n    this._current.scale = scale;\n    this._input.value = scale;\n    this._updatePreview();\n  },\n\n  updateForm: function(form, options, saveable) {\n    // return { text_size: this._input.value };\n    options.scale = saveable.scale = this._input.value;\n    // options.text_size = this._input.value;\n    // return ( this._input.value != this._current.text_size );\n  },\n\n  template: function() {\n    return `<fieldset class=\"cozy-fieldset-text_size\">\n        <legend>Zoom In/Out</legend>\n        <div class=\"preview--scale\" id=\"x${this._id}-preview\" style=\"overflow: hidden; height: 5rem\">\n          <div>\n            ‘Yes, that’s it,’ said the Hatter with a sigh: ‘it’s always tea-time, and we’ve no time to wash the things between whiles.’\n          </div>\n        </div>\n        <p style=\"white-space: no-wrap\">\n          <span style=\"font-size: 150%\">⊖<span class=\"u-screenreader\"> Zoom Out</span></span>\n          <input name=\"scale\" type=\"range\" id=\"x${this._id}-input\" value=\"100\" min=\"50\" max=\"400\" step=\"10\" style=\"width: 75%; display: inline-block\" />\n          <span style=\"font-size: 150%\">⊕<span class=\"u-screenreader\">Zoom In </span></span>\n        </p>\n        <p>\n          <span>Scale: </span>\n          <span id=\"x${this._id}-output\">100</span>\n          <button id=\"x${this._id}-reset\" class=\"reset button--inline\" style=\"margin-left: 8px\">Reset</button> \n        </p>\n      </fieldset>`;\n  },\n\n  _updatePreview: function() {\n    this._preview.style.transform = `scale(${( parseInt(this._input.value, 10) / 100 )}) translate(0,0)`;\n    this._output.innerHTML = `${this._input.value}%`;\n  },\n\n  EOT: true\n\n});\n\nexport var preferences = function(options) {\n  return new Preferences(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Widget = Control.extend({\n\n\n  options: {\n      // @option region: String = 'topright'\n      // The region of the control (one of the reader corners). Possible values are `'topleft'`,\n      // `'topright'`, `'bottomleft'` or `'bottomright'`\n  },\n\n  onAdd: function(reader) {\n    var container = this._container;\n    if ( container ) {\n      // NOOP\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n\n    }\n\n    this._onAddExtra(container);\n    this._updateTemplate(container);\n    this._updateClass(container);\n    this._bindEvents(container);\n\n    return container;\n  },\n\n  _updateTemplate: function(container) {\n    var data = this.data();\n    for(var slot in data) {\n      if ( data.hasOwnProperty(slot) ) {\n        var value = data[slot];\n        if ( typeof(value) == \"function\" ) { value = value(); }\n        var node = container.querySelector(`[data-slot=${slot}]`);\n        if ( node ) {\n          if ( node.hasAttribute('value') ) {\n            node.setAttribute('value', value);\n          } else {\n            node.innerHTML = value;\n          }\n        }\n      }\n    }\n  },\n\n  _updateClass: function(container) {\n    if ( this.options.className ) {\n      DomUtil.addClass(container, this.options.className);\n    }\n  },\n\n  _onAddExtra: function() { },\n\n  _bindEvents: function(container) {\n    var control = container.querySelector(\"[data-toggle=button]\");\n    if ( ! control ) { return ; }\n    DomEvent.disableClickPropagation(control);\n    DomEvent.on(control, 'click', DomEvent.stop);\n    DomEvent.on(control, 'click', this._action, this);\n  },\n\n  _action: function() {\n  },\n\n  data: function() {\n    return this.options.data || {};\n  },\n\n  EOT: true\n});\n\nWidget.Button = Widget.extend({\n  defaultTemplate: `<button data-toggle=\"button\" data-slot=\"label\"></button>`,\n\n  _action: function() {\n    this.options.onClick(this, this._reader);\n  },\n\n  EOT: true\n});\n\nWidget.Panel = Widget.extend({\n  defaultTemplate: `<div><span data-slot=\"text\"></span></div>`,\n\n\n  EOT: true\n});\n\nWidget.Toggle = Widget.extend({\n  defaultTemplate: `<button data-toggle=\"button\" data-slot=\"label\"></button>`,\n\n  _onAddExtra: function(container) {\n    this.state(this.options.states[0].stateName, container);\n\n    return container;\n  },\n\n  state: function(stateName, container) {\n    container = container || this._container;\n    this._resetState(container);\n    this._state = this.options.states.filter(function(s) { return s.stateName == stateName })[0];\n    this._updateClass(container);\n    this._updateTemplate(container);\n  },\n\n  _resetState: function(container) {\n    if ( ! this._state ) { return; }\n    if ( this._state.className ) {\n      DomUtil.removeClass(container, this._state.className);\n    }\n  },\n\n  _updateClass: function(container) {\n    if ( this._state.className ) {\n      DomUtil.addClass(container, this._state.className);\n    }\n  },\n\n  _action: function() {\n    this._state.onClick(this, this._reader);\n  },\n\n  data: function() {\n    return this._state.data || {};\n  },\n\n  EOT: true\n});\n\n// export var widget = function(options) {\n//   return new Widget(options);\n// }\n\nexport var widget = {\n  button: function(options) { return new Widget.Button(options); },\n  panel: function(options) { return new Widget.Panel(options); },\n  toggle: function(options) { return new Widget.Toggle(options); }\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Citation = Control.extend({\n  options: {\n    label: 'Citation',\n    html: '<span>Get Citation</span>'\n  },\n\n  defaultTemplate: `<button class=\"button--sm cozy-citation\" data-toggle=\"open\">Get Citation</button>`,\n\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._reader.on('updateContents', function(data) {\n      self._createPanel();\n    });\n\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n      self._modal.activate();\n    }, this)\n\n    return container;\n  },\n\n  _action: function() {\n    var self = this;\n    self._modal.activate();\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('button', className, container);\n    link.innerHTML = html;\n    link.title = title;\n\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n\n    return link;\n  },\n\n  _createPanel: function() {\n    var self = this;\n\n    var template = `<form>\n      <fieldset>\n        <legend>Select Citation Format</legend>\n      </fieldset>\n    </form>\n    <blockquote id=\"formatted\" style=\"padding: 8px; border-left: 4px solid black; background-color: #fff\"></blockquote>\n    <div class=\"alert alert-info\" id=\"message\" style=\"display: none\"></div>`;\n\n    this._modal = this._reader.modal({\n      template: template,\n      title: 'Copy Citation to Clipboard',\n      className: 'cozy-modal-citatation',\n      actions: [\n        {\n          label: 'Copy Citation',\n          callback: function(event) {\n            document.designMode = \"on\";\n            var formatted = self._modal._container.querySelector(\"#formatted\");\n\n            var range = document.createRange();\n            range.selectNode(formatted);\n            var sel = window.getSelection();\n            sel.removeAllRanges();\n            sel.addRange(range);\n\n            // formatted.select();\n\n            try {\n              var flag = document.execCommand('copy');\n            } catch(err) {\n              console.log(\"AHOY COPY FAILED\", err);\n            }\n\n            self._message.innerHTML = 'Success! Citation copied to your clipboard.';\n            self._message.style.display = 'block';\n            sel.removeAllRanges();\n            range.detach();\n            document.designMode = \"off\";\n          }\n        }\n      ],\n      region: 'left',\n      fraction: 1.0\n    });\n\n    this._form = this._modal._container.querySelector('form');\n    var fieldset = this._form.querySelector('fieldset');\n\n    var citations = this.options.citations || this._reader.metadata.citations;\n\n    citations.forEach(function(citation, index) {\n      var label = DomUtil.create('label', null, fieldset);\n      var input = DomUtil.create('input', null, label);\n      input.setAttribute('name', 'format');\n      input.setAttribute('value', citation.format);\n      input.setAttribute('type', 'radio');\n      if ( index == 0 ) {\n        input.setAttribute('checked', 'checked');\n      }\n      var text = document.createTextNode(\" \" + citation.format);\n      label.appendChild(text);\n      input.setAttribute('data-text', citation.text);\n    });\n\n    this._formatted = this._modal._container.querySelector(\"#formatted\");\n    this._message = this._modal._container.querySelector(\"#message\");\n    DomEvent.on(this._form, 'change', function(event) {\n      var target = event.target;\n      if ( target.tagName == 'INPUT' ) {\n        this._initializeForm();\n      }\n    }, this);\n\n    this._initializeForm();\n  },\n\n  _initializeForm: function() {\n    var formatted = this._formatCitation();\n    this._formatted.innerHTML = formatted;\n    this._message.style.display = 'none';\n    this._message.innerHTML = '';\n  },\n\n  _formatCitation: function(format) {\n    if ( format == null ) {\n      var selected = this._form.querySelector(\"input:checked\");\n      format = selected.value;\n    }\n    var selected = this._form.querySelector(\"input[value=\" + format + \"]\");\n    return selected.getAttribute('data-text');\n    // return selected.dataset.text;\n  },\n\n  EOT: true\n});\n\nexport var citation = function(options) {\n  return new Citation(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Search = Control.extend({\n  options: {\n    label: 'Search',\n    html: '<span>Search</span>'\n  },\n\n  defaultTemplate: `<form class=\"search\">\n    <label class=\"u-screenreader\" for=\"cozy-search-string\">Search in this text</label>\n    <input id=\"cozy-search-string\" name=\"search\" type=\"text\" placeholder=\"Search in this text...\"/>\n    <button class=\"button--sm\" data-toggle=\"open\" aria-label=\"Search\"><i class=\"icon-magnifying-glass oi\" data-glyph=\"magnifying-glass\" title=\"Search\" aria-hidden=\"true\"></i></button>\n  </form>`,\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    container.style.position = 'relative';\n\n    this._data = null;\n    this._canceled = false;\n    this._processing = false;\n\n    this._reader.on('ready', function() {\n\n      this._modal = this._reader.modal({\n        template: '<article></article>',\n        title: 'Search Results',\n        className: { container: 'cozy-modal-search' },\n        region: 'left',\n      });\n\n      this._modal.callbacks.onClose = function() {\n        if ( self._processing ) {\n          self._canceled = true;\n        }\n      };\n\n      this._article = this._modal._container.querySelector('article');\n\n      this._modal.on('click', 'a[href]', function(modal, target) {\n        target = target.getAttribute('href');\n        this._reader.tracking.action('search/go');\n        this._reader.gotoPage(target);\n        return true;\n      }.bind(this));\n\n      this._modal.on('closed', function() {\n        this._reader.tracking.action('contents/close');\n      }.bind(this))\n\n    }.bind(this));\n\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n\n      var searchString = this._container.querySelector(\"#cozy-search-string\").value;\n      searchString = searchString.replace(/^\\s*/, '').replace(/\\s*$/, '');\n\n      if ( ! searchString ) {\n        // just punt\n        return;\n      }\n\n      if ( searchString == this.searchString ) {\n        // cached results\n        self.openModalResults();\n      } else {\n        this.searchString = searchString;\n        self.openModalWaiting();\n        self.submitQuery();\n      }\n    }, this);\n\n    return container;\n  },\n\n  openModalWaiting: function() {\n    this._processing = true;\n    this._emptyArticle();\n    var value = this.searchString;\n    this._article.innerHTML = '<p>Submitting query for <em>' + value + '</em>...</p>' + this._reader.loaderTemplate();\n    this._modal.activate();\n  },\n\n  openModalResults: function() {\n    if ( this._canceled ) {\n      this._canceled = false;\n      return;\n    }\n    this._buildResults();\n    this._modal.activate();\n    this._reader.tracking.action(\"search/open\");\n  },\n\n  submitQuery: function() {\n    var self = this;\n\n    var url = this.options.searchUrl + this.searchString;\n\n    var request = new XMLHttpRequest();\n    request.open('GET', url, true);\n\n    request.onload = function() {\n      if (this.status >= 200 && this.status < 400) {\n        // Success!\n        var data = JSON.parse(this.response);\n        console.log(\"SEARCH DATA\", data);\n\n        self._data = data;\n\n      } else {\n        // We reached our target server, but it returned an error\n\n        self._data = null;\n        console.log(this.response);\n      }\n\n      self._reader.tracking.action(\"search/submitQuery\");\n      self.openModalResults();\n\n    };\n\n    request.onerror = function() {\n      // There was a connection error of some sort\n      self._data = null;\n      self.openModalResults();\n    };\n\n    request.send();\n\n  },\n\n  _emptyArticle: function() {\n    while (this._article && this._article.hasChildNodes()) {\n      this._article.removeChild(this._article.lastChild);\n    }\n  },\n\n  _buildResults: function() {\n    var self = this;\n    var content;\n\n    this._processing = false;\n\n    self._emptyArticle();\n\n    var reader = this._reader;\n    reader.annotations.reset();\n\n    if ( this._data ) {\n      var highlight = true\n      if (this._data.highlight_off == \"yes\") {\n        highlight = false;\n      }\n      if ( this._data.search_results.length ) {\n        content = DomUtil.create('ul');\n\n        this._data.search_results.forEach(function(result) {\n          var option = DomUtil.create('li');\n          var anchor = DomUtil.create('a', null, option);\n          var cfiRange = \"epubcfi(\" + result.cfi + \")\";\n\n          if (result.snippet) {\n            if (result.title) {\n              var chapterTitle = DomUtil.create('i');\n              chapterTitle.textContent = result.title + \": \";\n              anchor.appendChild(chapterTitle);\n            }\n            anchor.appendChild(document.createTextNode(result.snippet));\n\n            anchor.setAttribute(\"href\", cfiRange);\n            content.appendChild(option);\n          }\n          if (highlight) {\n            reader.annotations.highlight(cfiRange);\n          }\n        });\n      } else {\n        content = DomUtil.create(\"p\")\n        content.textContent = 'No results found for \"' + self.searchString + '\"';\n      }\n    } else {\n      content = DomUtil.create(\"p\")\n      content.textContent = 'There was a problem processing this query.';\n    }\n\n    self._article.appendChild(content);\n  },\n\n  EOT: true\n});\n\nexport var search = function(options) {\n  return new Search(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\n// Title + Chapter\n\nexport var BibliographicInformation = Control.extend({\n  options: {\n    label: 'Info',\n    direction: 'left',\n    html: '<span class=\"oi\" data-glyph=\"info\">Info</span>'\n  },\n\n  defaultTemplate: `<button class=\"button--sm cozy-bib-info oi\" data-glyph=\"info\" data-toggle=\"open\" aria-label=\"Bibliographic Information\"> Info</button>`,\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._reader.on('updateContents', function(data) {\n      self._createPanel();\n    });\n\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n      self._modal.activate();\n    }, this)\n\n    return container;\n  },\n\n  _createPanel: function() {\n    var self = this;\n\n    var template = `<dl>\n    </dl>`;\n\n    this._modal = this._reader.modal({\n      template: template,\n      title: 'Info',\n      region: 'left',\n      fraction: 1.0\n    });\n\n    var dl = this._modal._container.querySelector('dl');\n\n    var metadata_fields = [\n      [ 'title', 'Title' ],\n      [ 'creator', 'Author' ],\n      [ 'pubdate', 'Publication Date' ],\n      [ 'modified_date', 'Modified Date' ],\n      [ 'publisher', 'Publisher' ],\n      [ 'rights', 'Rights' ],\n      [ 'doi', 'DOI' ],\n      [ 'description', 'Description' ],\n    ];\n\n    var metadata_fields_seen = {};\n\n    var metadata = this._reader.metadata;\n\n    for(var idx in metadata_fields) {\n      var key = metadata_fields[idx][0];\n      var label = metadata_fields[idx][1];\n      if ( metadata[key] ) {\n        var value = metadata[key];\n        if ( key == 'pubdate' || key == 'modified_date' ) {\n          value = this._formatDate(value);\n          if ( ! value ) { continue; }\n          // value = d.toISOString().slice(0,10); // for YYYY-MM-DD\n        }\n        metadata_fields_seen[key] = true;\n        var dt = DomUtil.create('dt', 'cozy-bib-info-label', dl);\n        dt.innerHTML = label;\n        var dd = DomUtil.create('dd', 'cozy-bib-info-value cozy-bib-info-value-' + key, dl);\n        dd.innerHTML = value;\n      }\n    }\n\n  },\n\n  _formatDate: function(value) {\n    var match = value.match(/\\d{4}/);\n    if ( match ) {\n      return match[0];\n    }\n    return null;\n  },\n\n  EOT: true\n});\n\nexport var bibliographicInformation = function(options) {\n  return new BibliographicInformation(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Download = Control.extend({\n  options: {\n    label: 'Download Book',\n    html: '<span>Download Book</span>'\n  },\n\n  defaultTemplate: `<button class=\"button--sm cozy-download oi\" data-toggle=\"open\" data-glyph=\"data-transfer-download\"> Download Book</button>`,\n\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._reader.on('updateContents', function(data) {\n      self._createPanel();\n    });\n\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n      self._modal.activate();\n    }, this)\n\n    return container;\n  },\n\n  _createPanel: function() {\n    var self = this;\n\n    var template = `<form>\n      <fieldset>\n        <legend>Choose File Format</legend>\n      </fieldset>\n    </form>`;\n\n    this._modal = this._reader.modal({\n      template: template,\n      title: 'Download Book',\n      className: 'cozy-modal-download',\n      actions: [\n        {\n          label: 'Download',\n          callback: function(event) {\n            var selected = self._form.querySelector(\"input:checked\");\n            var href = selected.getAttribute('data-href');\n            self._configureDownloadForm(href);\n            self._form.submit();\n          }\n        }\n      ],\n      region: 'left',\n      fraction: 1.0\n    });\n\n    this._form = this._modal._container.querySelector('form');    \n    var fieldset = this._form.querySelector('fieldset');\n    this._reader.options.download_links.forEach(function(link, index) {\n      var label = DomUtil.create('label', null, fieldset);\n      var input = DomUtil.create('input', null, label);\n      input.setAttribute('name', 'format');\n      input.setAttribute('value', link.format);\n      input.setAttribute('data-href', link.href);\n      input.setAttribute('type', 'radio');\n      if ( index == 0 ) {\n        input.setAttribute('checked', 'checked');\n      }\n      var text = link.format;\n      if ( link.size ) {\n        text += \" (\" + link.size + \")\";\n      }\n      var text = document.createTextNode(\" \" + text);\n      label.appendChild(text);\n    });\n\n  },\n\n  _configureDownloadForm: function(href) {\n    var self = this;\n    self._form.setAttribute('method', 'GET');\n    self._form.setAttribute('action', href);\n    self._form.setAttribute('target', '_blank');\n  },\n\n\n  EOT: true\n});\n\nexport var download = function(options) {\n  return new Download(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Navigator = Control.extend({\n  onAdd: function(reader) {\n    var container = this._container;\n    if ( container ) {\n    } else {\n\n      var className = this._className('navigator'),\n          options = this.options;\n      \n      container = DomUtil.create('div', className);\n    }\n    this._setup(container);\n\n    this._reader.on('updateLocations', function(locations) {      \n      // if ( ! this._reader.currentLocation() || ! this._reader.currentLocation().start ) {\n      //   console.log(\"AHOY updateLocations NO START\", this._reader.currentLocation().then);\n      //   setTimeout(function() {\n      //     this._initializeNavigator(locations);\n      //   }.bind(this), 100);\n      //   return;\n      // }\n      this._initializeNavigator(locations);\n    }.bind(this));\n\n    return container;\n  },\n\n  _setup: function(container) {\n    this._control = container.querySelector(\"input[type=range]\");\n    if ( ! this._control ) {\n      this._createControl(container);\n    }\n    this._background = container.querySelector(\".cozy-navigator-range__background\");\n    this._status = container.querySelector(\".cozy-navigator-range__status\");\n    this._spanCurrentPercentage = container.querySelector(\".currentPercentage\");\n    this._spanCurrentLocation = container.querySelector(\".currentLocation\");\n    this._spanTotalLocations = container.querySelector(\".totalLocations\");\n\n    this._bindEvents();\n  },\n\n  _createControl: function (container) {\n    var template = `<div class=\"cozy-navigator-range\">\n        <label class=\"u-screenreader\" for=\"cozy-navigator-range-input\">Location: </label>\n        <input class=\"cozy-navigator-range__input\" id=\"cozy-navigator-range-input\" type=\"range\" name=\"locations-range-value\" min=\"0\" max=\"100\" aria-valuemin=\"0\" aria-valuemax=\"100\" aria-valuenow=\"0\" aria-valuetext=\"0% • Location 0 of ?\" value=\"0\" data-background-position=\"0\" />\n        <div class=\"cozy-navigator-range__background\"></div>\n      </div>\n      <div class=\"cozy-navigator-range__status\"><span class=\"currentPercentage\">0%</span> • Location <span class=\"currentLocation\">0</span> of <span class=\"totalLocations\">?</span></div>\n    `;\n\n    var body = new DOMParser().parseFromString(template, \"text/html\").body;\n    while ( body.children.length ) {\n      container.appendChild(body.children[0]);\n    }\n\n    this._control = container.querySelector(\"input[type=range]\");\n  },\n\n  _bindEvents: function() {\n    var self = this;\n\n    this._control.addEventListener(\"input\", function() {\n      self._update();\n    }, false);\n    this._control.addEventListener(\"change\", function() { self._action(); }, false);\n    this._control.addEventListener(\"mousedown\", function(){\n        self._mouseDown = true;\n    }, false);\n    this._control.addEventListener(\"mouseup\", function(){\n        self._mouseDown = false;\n    }, false);\n    this._control.addEventListener(\"keydown\", function(){\n      self._mouseDown = true;\n    }, false);\n    this._control.addEventListener(\"keyup\", function(){\n      self._mouseDown = false;\n    }, false);\n\n    this._reader.on('relocated', function(location) {\n      if ( ! self._initiated ) { return; }\n      if ( ! self._mouseDown ) {\n        self._control.value = Math.ceil(self._reader.locations.percentageFromCfi(self._reader.currentLocation().start.cfi) * 100);\n        self._update();\n      }\n    })\n\n  },\n\n  _action: function() {\n    var value = this._control.value;\n    var locations = this._reader.locations;\n    var cfi = locations.cfiFromPercentage(value / 100);\n    this._reader.tracking.action(\"navigator/go\");\n    this._reader.gotoPage(cfi);\n  },\n\n  _update: function() {\n    var self = this;\n\n    var current = this._reader.currentLocation();\n    if ( ! current || ! current.start ) {\n      setTimeout(function() {\n        this._update();\n      }.bind(this), 100);\n    }\n\n    var rangeBg = this._background;\n    var range = self._control;\n\n    var value = parseInt(range.value, 10);\n    var percentage = value;\n\n    rangeBg.setAttribute('style', 'background-position: ' + (-percentage) + '% 0%, left top;');\n    self._control.setAttribute('data-background-position', Math.ceil(percentage));\n\n    this._spanCurrentPercentage.innerHTML = percentage + '%';\n    if ( current && current.start ) {\n      var current_location = this._reader.locations.locationFromCfi(current.start.cfi);\n      this._spanCurrentLocation.innerHTML = ( current_location );\n    }\n    self._last_delta = self._last_value > value; self._last_value = value;\n  },\n\n  _initializeNavigator: function(locations) {\n    console.log(\"AHOY updateLocations PROCESSING LOCATION\");\n    this._initiated = true;\n    this._total = this._reader.locations.total;\n    if ( this._reader.currentLocation() && this._reader.currentLocation().start ) {\n      this._control.value = Math.ceil(this._reader.locations.percentageFromCfi(this._reader.currentLocation().start.cfi) * 100);\n      this._last_value = this._control.value;\n    } else {\n      this._last_value = this._control.value;\n    }\n\n    this._spanTotalLocations.innerHTML = this._total;\n\n    this._update();\n    setTimeout(function() {\n      DomUtil.addClass(this._container, 'initialized');\n    }.bind(this), 0);\n  },\n\n  EOT: true\n});\n\nexport var navigator = function(options) {\n  return new Navigator(options);\n}\n","import {Control, control} from './Control';\nimport {PageNext, PagePrevious, pageNext, pagePrevious, PageFirst, pageFirst, PageLast, pageLast} from './Control.Paging';\nimport {Contents, contents} from './Control.Contents';\nimport {Title, title} from './Control.Title';\nimport {PublicationMetadata, publicationMetadata} from './Control.PublicationMetadata';\nimport {Preferences, preferences} from './Control.Preferences';\nimport {Widget, widget} from './Control.Widget';\nimport {Citation, citation} from './Control.Citation';\nimport {Search, search} from './Control.Search';\nimport {BibliographicInformation, bibliographicInformation} from './Control.BibliographicInformation';\nimport {Download, download} from './Control.Download';\nimport {Navigator, navigator} from './Control.Navigator';\n\n// import {Zoom, zoom} from './Control.Zoom';\n// import {Attribution, attribution} from './Control.Attribution';\n\nControl.PageNext = PageNext;\nControl.PagePrevious = PagePrevious;\nControl.PageFirst = PageFirst;\nControl.PageLast = PageLast;\ncontrol.pagePrevious = pagePrevious;\ncontrol.pageNext = pageNext;\ncontrol.pageFirst = pageFirst;\ncontrol.pageLast = pageLast;\n\nControl.Contents = Contents;\ncontrol.contents = contents;\n\nControl.Title = Title;\ncontrol.title = title;\n\nControl.PublicationMetadata = PublicationMetadata;\ncontrol.publicationMetadata = publicationMetadata;\n\nControl.Preferences = Preferences;\ncontrol.preferences = preferences;\n\nControl.Widget = Widget;\ncontrol.widget = widget;\n\nControl.Citation = Citation;\ncontrol.citation = citation;\n\nControl.Search = Search;\ncontrol.search = search;\n\nControl.BibliographicInformation = BibliographicInformation;\ncontrol.bibliographicInformation = bibliographicInformation;\n\nControl.Download = Download;\ncontrol.download = download;\n\nControl.Navigator = Navigator;\ncontrol.navigator = navigator;\n\nexport {Control, control};\n","import {Evented} from './Events';\n\nvar Bus = Evented.extend({\n});\n\nvar instance;\nexport var bus = function() {\n  return instance || ( instance = new Bus() );\n}\n","import * as Browser from './Browser';\nexport {Browser};\n\nexport {Class} from './Class';\n\nimport {Evented} from './Events';\nexport {Evented};\nexport var Mixin = {Events: Evented.prototype};\n\nimport * as Util from './Util';\nexport {Util};\nexport {extend, bind, stamp, setOptions} from './Util';\nexport {bus} from './Bus';\n","\n// var ePub = window.ePub;\n// export {ePub};\n\nexport function ePub(href, options) {\n\tif ( window.require !== undefined ) {\n\t\twindow.ePub = require(\"ePub\");\n\t}\n  return window.ePub(href, options);\n}\n","'use strict';\n\nif (!process) {\n  var process = {\n    \"cwd\" : function () { return '/' }\n  };\n}\n\nfunction assertPath(path) {\n  if (typeof path !== 'string') {\n    throw new TypeError('Path must be a string. Received ' + path);\n  }\n}\n\n// Resolves . and .. elements in a path with directory names\nfunction normalizeStringPosix(path, allowAboveRoot) {\n  var res = '';\n  var lastSlash = -1;\n  var dots = 0;\n  var code;\n  for (var i = 0; i <= path.length; ++i) {\n    if (i < path.length)\n      code = path.charCodeAt(i);\n    else if (code === 47/*/*/)\n      break;\n    else\n      code = 47/*/*/;\n    if (code === 47/*/*/) {\n      if (lastSlash === i - 1 || dots === 1) {\n        // NOOP\n      } else if (lastSlash !== i - 1 && dots === 2) {\n        if (res.length < 2 ||\n            res.charCodeAt(res.length - 1) !== 46/*.*/ ||\n            res.charCodeAt(res.length - 2) !== 46/*.*/) {\n          if (res.length > 2) {\n            var start = res.length - 1;\n            var j = start;\n            for (; j >= 0; --j) {\n              if (res.charCodeAt(j) === 47/*/*/)\n                break;\n            }\n            if (j !== start) {\n              if (j === -1)\n                res = '';\n              else\n                res = res.slice(0, j);\n              lastSlash = i;\n              dots = 0;\n              continue;\n            }\n          } else if (res.length === 2 || res.length === 1) {\n            res = '';\n            lastSlash = i;\n            dots = 0;\n            continue;\n          }\n        }\n        if (allowAboveRoot) {\n          if (res.length > 0)\n            res += '/..';\n          else\n            res = '..';\n        }\n      } else {\n        if (res.length > 0)\n          res += '/' + path.slice(lastSlash + 1, i);\n        else\n          res = path.slice(lastSlash + 1, i);\n      }\n      lastSlash = i;\n      dots = 0;\n    } else if (code === 46/*.*/ && dots !== -1) {\n      ++dots;\n    } else {\n      dots = -1;\n    }\n  }\n  return res;\n}\n\nfunction _format(sep, pathObject) {\n  var dir = pathObject.dir || pathObject.root;\n  var base = pathObject.base ||\n    ((pathObject.name || '') + (pathObject.ext || ''));\n  if (!dir) {\n    return base;\n  }\n  if (dir === pathObject.root) {\n    return dir + base;\n  }\n  return dir + sep + base;\n}\n\nvar posix = {\n  // path.resolve([from ...], to)\n  resolve: function resolve() {\n    var resolvedPath = '';\n    var resolvedAbsolute = false;\n    var cwd;\n\n    for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n      var path;\n      if (i >= 0)\n        path = arguments[i];\n      else {\n        if (cwd === undefined)\n          cwd = process.cwd();\n        path = cwd;\n      }\n\n      assertPath(path);\n\n      // Skip empty entries\n      if (path.length === 0) {\n        continue;\n      }\n\n      resolvedPath = path + '/' + resolvedPath;\n      resolvedAbsolute = path.charCodeAt(0) === 47/*/*/;\n    }\n\n    // At this point the path should be resolved to a full absolute path, but\n    // handle relative paths to be safe (might happen when process.cwd() fails)\n\n    // Normalize the path\n    resolvedPath = normalizeStringPosix(resolvedPath, !resolvedAbsolute);\n\n    if (resolvedAbsolute) {\n      if (resolvedPath.length > 0)\n        return '/' + resolvedPath;\n      else\n        return '/';\n    } else if (resolvedPath.length > 0) {\n      return resolvedPath;\n    } else {\n      return '.';\n    }\n  },\n\n\n  normalize: function normalize(path) {\n    assertPath(path);\n\n    if (path.length === 0)\n      return '.';\n\n    var isAbsolute = path.charCodeAt(0) === 47/*/*/;\n    var trailingSeparator = path.charCodeAt(path.length - 1) === 47/*/*/;\n\n    // Normalize the path\n    path = normalizeStringPosix(path, !isAbsolute);\n\n    if (path.length === 0 && !isAbsolute)\n      path = '.';\n    if (path.length > 0 && trailingSeparator)\n      path += '/';\n\n    if (isAbsolute)\n      return '/' + path;\n    return path;\n  },\n\n\n  isAbsolute: function isAbsolute(path) {\n    assertPath(path);\n    return path.length > 0 && path.charCodeAt(0) === 47/*/*/;\n  },\n\n\n  join: function join() {\n    if (arguments.length === 0)\n      return '.';\n    var joined;\n    for (var i = 0; i < arguments.length; ++i) {\n      var arg = arguments[i];\n      assertPath(arg);\n      if (arg.length > 0) {\n        if (joined === undefined)\n          joined = arg;\n        else\n          joined += '/' + arg;\n      }\n    }\n    if (joined === undefined)\n      return '.';\n    return posix.normalize(joined);\n  },\n\n\n  relative: function relative(from, to) {\n    assertPath(from);\n    assertPath(to);\n\n    if (from === to)\n      return '';\n\n    from = posix.resolve(from);\n    to = posix.resolve(to);\n\n    if (from === to)\n      return '';\n\n    // Trim any leading backslashes\n    var fromStart = 1;\n    for (; fromStart < from.length; ++fromStart) {\n      if (from.charCodeAt(fromStart) !== 47/*/*/)\n        break;\n    }\n    var fromEnd = from.length;\n    var fromLen = (fromEnd - fromStart);\n\n    // Trim any leading backslashes\n    var toStart = 1;\n    for (; toStart < to.length; ++toStart) {\n      if (to.charCodeAt(toStart) !== 47/*/*/)\n        break;\n    }\n    var toEnd = to.length;\n    var toLen = (toEnd - toStart);\n\n    // Compare paths to find the longest common path from root\n    var length = (fromLen < toLen ? fromLen : toLen);\n    var lastCommonSep = -1;\n    var i = 0;\n    for (; i <= length; ++i) {\n      if (i === length) {\n        if (toLen > length) {\n          if (to.charCodeAt(toStart + i) === 47/*/*/) {\n            // We get here if `from` is the exact base path for `to`.\n            // For example: from='/foo/bar'; to='/foo/bar/baz'\n            return to.slice(toStart + i + 1);\n          } else if (i === 0) {\n            // We get here if `from` is the root\n            // For example: from='/'; to='/foo'\n            return to.slice(toStart + i);\n          }\n        } else if (fromLen > length) {\n          if (from.charCodeAt(fromStart + i) === 47/*/*/) {\n            // We get here if `to` is the exact base path for `from`.\n            // For example: from='/foo/bar/baz'; to='/foo/bar'\n            lastCommonSep = i;\n          } else if (i === 0) {\n            // We get here if `to` is the root.\n            // For example: from='/foo'; to='/'\n            lastCommonSep = 0;\n          }\n        }\n        break;\n      }\n      var fromCode = from.charCodeAt(fromStart + i);\n      var toCode = to.charCodeAt(toStart + i);\n      if (fromCode !== toCode)\n        break;\n      else if (fromCode === 47/*/*/)\n        lastCommonSep = i;\n    }\n\n    var out = '';\n    // Generate the relative path based on the path difference between `to`\n    // and `from`\n    for (i = fromStart + lastCommonSep + 1; i <= fromEnd; ++i) {\n      if (i === fromEnd || from.charCodeAt(i) === 47/*/*/) {\n        if (out.length === 0)\n          out += '..';\n        else\n          out += '/..';\n      }\n    }\n\n    // Lastly, append the rest of the destination (`to`) path that comes after\n    // the common path parts\n    if (out.length > 0)\n      return out + to.slice(toStart + lastCommonSep);\n    else {\n      toStart += lastCommonSep;\n      if (to.charCodeAt(toStart) === 47/*/*/)\n        ++toStart;\n      return to.slice(toStart);\n    }\n  },\n\n\n  _makeLong: function _makeLong(path) {\n    return path;\n  },\n\n\n  dirname: function dirname(path) {\n    assertPath(path);\n    if (path.length === 0)\n      return '.';\n    var code = path.charCodeAt(0);\n    var hasRoot = (code === 47/*/*/);\n    var end = -1;\n    var matchedSlash = true;\n    for (var i = path.length - 1; i >= 1; --i) {\n      code = path.charCodeAt(i);\n      if (code === 47/*/*/) {\n        if (!matchedSlash) {\n          end = i;\n          break;\n        }\n      } else {\n        // We saw the first non-path separator\n        matchedSlash = false;\n      }\n    }\n\n    if (end === -1)\n      return hasRoot ? '/' : '.';\n    if (hasRoot && end === 1)\n      return '//';\n    return path.slice(0, end);\n  },\n\n\n  basename: function basename(path, ext) {\n    if (ext !== undefined && typeof ext !== 'string')\n      throw new TypeError('\"ext\" argument must be a string');\n    assertPath(path);\n\n    var start = 0;\n    var end = -1;\n    var matchedSlash = true;\n    var i;\n\n    if (ext !== undefined && ext.length > 0 && ext.length <= path.length) {\n      if (ext.length === path.length && ext === path)\n        return '';\n      var extIdx = ext.length - 1;\n      var firstNonSlashEnd = -1;\n      for (i = path.length - 1; i >= 0; --i) {\n        var code = path.charCodeAt(i);\n        if (code === 47/*/*/) {\n          // If we reached a path separator that was not part of a set of path\n          // separators at the end of the string, stop now\n          if (!matchedSlash) {\n            start = i + 1;\n            break;\n          }\n        } else {\n          if (firstNonSlashEnd === -1) {\n            // We saw the first non-path separator, remember this index in case\n            // we need it if the extension ends up not matching\n            matchedSlash = false;\n            firstNonSlashEnd = i + 1;\n          }\n          if (extIdx >= 0) {\n            // Try to match the explicit extension\n            if (code === ext.charCodeAt(extIdx)) {\n              if (--extIdx === -1) {\n                // We matched the extension, so mark this as the end of our path\n                // component\n                end = i;\n              }\n            } else {\n              // Extension does not match, so our result is the entire path\n              // component\n              extIdx = -1;\n              end = firstNonSlashEnd;\n            }\n          }\n        }\n      }\n\n      if (start === end)\n        end = firstNonSlashEnd;\n      else if (end === -1)\n        end = path.length;\n      return path.slice(start, end);\n    } else {\n      for (i = path.length - 1; i >= 0; --i) {\n        if (path.charCodeAt(i) === 47/*/*/) {\n          // If we reached a path separator that was not part of a set of path\n          // separators at the end of the string, stop now\n          if (!matchedSlash) {\n            start = i + 1;\n            break;\n          }\n        } else if (end === -1) {\n          // We saw the first non-path separator, mark this as the end of our\n          // path component\n          matchedSlash = false;\n          end = i + 1;\n        }\n      }\n\n      if (end === -1)\n        return '';\n      return path.slice(start, end);\n    }\n  },\n\n\n  extname: function extname(path) {\n    assertPath(path);\n    var startDot = -1;\n    var startPart = 0;\n    var end = -1;\n    var matchedSlash = true;\n    // Track the state of characters (if any) we see before our first dot and\n    // after any path separator we find\n    var preDotState = 0;\n    for (var i = path.length - 1; i >= 0; --i) {\n      var code = path.charCodeAt(i);\n      if (code === 47/*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          startPart = i + 1;\n          break;\n        }\n        continue;\n      }\n      if (end === -1) {\n        // We saw the first non-path separator, mark this as the end of our\n        // extension\n        matchedSlash = false;\n        end = i + 1;\n      }\n      if (code === 46/*.*/) {\n        // If this is our first dot, mark it as the start of our extension\n        if (startDot === -1)\n          startDot = i;\n        else if (preDotState !== 1)\n          preDotState = 1;\n      } else if (startDot !== -1) {\n        // We saw a non-dot and non-path separator before our dot, so we should\n        // have a good chance at having a non-empty extension\n        preDotState = -1;\n      }\n    }\n\n    if (startDot === -1 ||\n        end === -1 ||\n        // We saw a non-dot character immediately before the dot\n        preDotState === 0 ||\n        // The (right-most) trimmed path component is exactly '..'\n        (preDotState === 1 &&\n         startDot === end - 1 &&\n         startDot === startPart + 1)) {\n      return '';\n    }\n    return path.slice(startDot, end);\n  },\n\n\n  format: function format(pathObject) {\n    if (pathObject === null || typeof pathObject !== 'object') {\n      throw new TypeError(\n        'Parameter \"pathObject\" must be an object, not ' + typeof(pathObject)\n      );\n    }\n    return _format('/', pathObject);\n  },\n\n\n  parse: function parse(path) {\n    assertPath(path);\n\n    var ret = { root: '', dir: '', base: '', ext: '', name: '' };\n    if (path.length === 0)\n      return ret;\n    var code = path.charCodeAt(0);\n    var isAbsolute = (code === 47/*/*/);\n    var start;\n    if (isAbsolute) {\n      ret.root = '/';\n      start = 1;\n    } else {\n      start = 0;\n    }\n    var startDot = -1;\n    var startPart = 0;\n    var end = -1;\n    var matchedSlash = true;\n    var i = path.length - 1;\n\n    // Track the state of characters (if any) we see before our first dot and\n    // after any path separator we find\n    var preDotState = 0;\n\n    // Get non-dir info\n    for (; i >= start; --i) {\n      code = path.charCodeAt(i);\n      if (code === 47/*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          startPart = i + 1;\n          break;\n        }\n        continue;\n      }\n      if (end === -1) {\n        // We saw the first non-path separator, mark this as the end of our\n        // extension\n        matchedSlash = false;\n        end = i + 1;\n      }\n      if (code === 46/*.*/) {\n        // If this is our first dot, mark it as the start of our extension\n        if (startDot === -1)\n          startDot = i;\n        else if (preDotState !== 1)\n          preDotState = 1;\n      } else if (startDot !== -1) {\n        // We saw a non-dot and non-path separator before our dot, so we should\n        // have a good chance at having a non-empty extension\n        preDotState = -1;\n      }\n    }\n\n    if (startDot === -1 ||\n        end === -1 ||\n        // We saw a non-dot character immediately before the dot\n        preDotState === 0 ||\n        // The (right-most) trimmed path component is exactly '..'\n        (preDotState === 1 &&\n         startDot === end - 1 &&\n         startDot === startPart + 1)) {\n      if (end !== -1) {\n        if (startPart === 0 && isAbsolute)\n          ret.base = ret.name = path.slice(1, end);\n        else\n          ret.base = ret.name = path.slice(startPart, end);\n      }\n    } else {\n      if (startPart === 0 && isAbsolute) {\n        ret.name = path.slice(1, startDot);\n        ret.base = path.slice(1, end);\n      } else {\n        ret.name = path.slice(startPart, startDot);\n        ret.base = path.slice(startPart, end);\n      }\n      ret.ext = path.slice(startDot, end);\n    }\n\n    if (startPart > 0)\n      ret.dir = path.slice(0, startPart - 1);\n    else if (isAbsolute)\n      ret.dir = '/';\n\n    return ret;\n  },\n\n\n  sep: '/',\n  delimiter: ':',\n  posix: null\n};\n\n\nmodule.exports = posix;\n","import * as Util from '../core/Util';\nimport {Reader} from './Reader';\nimport * as epubjs from '../epubjs';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as Browser from '../core/Browser';\n\nimport path from \"path-webpack\";\n\nReader.EpubJS = Reader.extend({\n\n  initialize: function(id, options) {\n    Reader.prototype.initialize.apply(this, arguments);\n    this._epubjs_ready = false;\n    window.xpath = path;\n  },\n\n  open: function(target, callback) {\n    var self = this;\n    if ( typeof(target) == 'function' ) {\n      callback = target;\n      target = undefined;\n    }\n    if ( callback == null ) {\n      callback = function() { };\n    }\n\n    self.rootfiles = [];\n\n    this.options.rootfilePath = this.options.rootfilePath || sessionStorage.getItem('rootfilePath');\n\n    var book_href = this.options.href;\n    var book_options = { packagePath: this.options.rootfilePath };\n    if ( this.options.useArchive ) {\n      book_href = book_href.replace(/\\/(\\w+)\\/$/, '/$1/$1.sm.epub');\n      book_options.openAs = 'epub';\n    }\n    this._book = epubjs.ePub(book_href, book_options);\n    sessionStorage.removeItem('rootfilePath');\n\n    this._book.loaded.navigation.then(function(toc) {\n      self._contents = toc;\n      self.metadata = self._book.package.metadata;\n      self.fire('updateContents', toc);\n      self.fire('updateTitle', self._book.package.metadata);\n    })\n    this._book.ready.then(function() {\n      self.parseRootfiles();\n\n      self.draw(target, callback);\n\n      if ( self.metadata.layout == 'pre-paginated' ) {\n        // fake it with the spine\n        var locations = [];\n        self._book.spine.each(function(item) {\n          locations.push(`epubcfi(${item.cfiBase}!/4/2)`);\n          self.locations._locations.push(`epubcfi(${item.cfiBase}!/4/2)`);\n        });\n        self.locations.total = locations.length;\n        var t;\n        var f = function() {\n          if ( self._rendition && self._rendition.manager && self._rendition.manager.stage ) {\n            var location = self._rendition.currentLocation();\n            if ( location && location.start) {\n              self.fire('updateLocations', locations);\n              clearTimeout(t);\n              return;\n            }\n          }\n          t = setTimeout(f, 100);\n        }\n\n        t = setTimeout(f, 100);\n      } else {\n        self._book.locations.generate(1600).then(function(locations) {\n          // console.log(\"AHOY WUT\", locations);\n          self.fire('updateLocations', locations);\n        })\n      }\n    })\n    // .then(callback);\n  },\n\n  parseRootfiles: function() {\n    var self = this;\n    self._book.load(self._book.url.resolve(\"META-INF/container.xml\")).then(function(containerDoc) {\n        var rootfiles = containerDoc.querySelectorAll(\"rootfile\");\n        if ( rootfiles.length > 1 ) {\n          console.log(\"AHOY ROOTFILES MULTIPLE RENDITIONS\", rootfiles.length);\n          for(var i = 0; i < rootfiles.length; i++) {\n            var rootfile = rootfiles[i];\n            var rootfilePath = rootfile.getAttribute('full-path');\n            var label = rootfile.getAttribute('rendition:label');\n            var layout = rootfile.getAttribute('rendition:layout');\n            self.rootfiles.push({\n              rootfilePath: rootfilePath,\n              label: label,\n              layout: layout\n            })\n          }\n        }\n    })\n  },\n\n  draw: function(target, callback) {\n    var self = this;\n\n    if ( self._rendition ) {\n      // self._unbindEvents();\n      var container = self._rendition.manager.container;\n      Object.keys(self._rendition.hooks).forEach(function(key) {\n        console.log(\"AHOY draw clearing\", key);\n        self._rendition.hooks[key].clear();\n      })\n      self._rendition.destroy();\n      self._rendition = null;\n    }\n\n    this.settings = { flow: this.options.flow };\n    this.settings.manager = this.options.manager || 'default';\n\n    if ( this.settings.flow == 'auto' && this.metadata.layout == 'pre-paginated' ) {\n      // dumb check to see if the window is _tall_ enough to put\n      // two pages side by side\n      if ( this._container.offsetHeight <= this.options.forceScrolledDocHeight ) {\n        this.settings.flow = 'scrolled-doc';\n        this.settings.manager = 'prepaginated';\n      }\n    }\n\n    if ( this.settings.flow == 'auto' || this.settings.flow == 'paginated' ) {\n      this._panes['epub'].style.overflow = this.metadata.layout == 'pre-paginated' ? 'auto' : 'hidden';\n      this.settings.manager = 'default';\n    } else {\n      this._panes['epub'].style.overflow = 'auto';\n      if ( this.settings.manager == 'default' ) {\n        this.settings.manager = 'continuous';\n      }\n    }\n\n    if ( ! callback ) {\n      callback = function() { };\n    }\n\n    if ( this.metadata.layout == 'pre-paginated' && this.settings.manager == 'continuous' ) {\n        this.settings.manager = 'prepaginated';\n    }\n\n    if ( this.settings.manager == 'prepaginated' ) {\n      this.settings.spread = 'none';\n    }\n\n    // would pre-paginated work better if we scaled the default view from the start? maybe?\n    if ( false && this.metadata.layout == 'pre-paginated' && this.settings.manager == 'default' ) {\n      this.settings.spread = 'none';\n      this._panes['epub'].style.overflow = 'auto';\n    }\n\n    self.settings.height = '100%';\n    self.settings.width = '100%';\n    self.settings['ignoreClass'] = 'annotator-hl';\n\n    if ( self.options.scale != '100' ) {\n      self.settings.scale = parseInt(self.options.scale, 10) / 100;\n    }\n\n    self._panes['book'].dataset.manager = this.settings.manager + ( this.settings.spread ? `-${this.settings.spread}` : '');\n    self._panes['book'].dataset.layout = this.metadata.layout || 'reflowable';\n\n    self._drawRendition(target, callback);\n  },\n\n  _drawRendition: function(target, callback) {\n    var self = this;\n\n    self._rendition = self._book.renderTo(self._panes['epub'], self.settings);\n    self._updateFontSize();\n    self._bindEvents();\n    self._drawn = true;\n\n    if ( target && target.start ) { target = target.start; }\n    if ( ! target && window.location.hash ) {\n      if ( window.location.hash.substr(1, 3) == '/6/' ) {\n        target = \"epubcfi(\" + window.location.hash.substr(1) + \")\";\n      } else {\n        target = window.location.hash.substr(2);\n        target = self._book.url.path().resolve(target);\n      }\n    }\n\n    var status_index = 0;\n    self._rendition.on('started', function() {\n\n      self._rendition.manager.on(\"building\", function(status) {\n        if ( status ) {\n          status_index += 1;\n          self._panes['loader-status'].innerHTML = `<span>${Math.round((status_index / status.total) * 100.0)}%</span>`;\n        } else {\n          self._enableBookLoader(-1);\n        }\n      })\n      self._rendition.manager.on(\"built\", function() {\n        console.log(\"AHOY manager built\");\n        self._disableBookLoader(true);\n      })\n    })\n\n    self._rendition.hooks.content.register(function(contents) {\n      self.fire('ready:contents', contents);\n      self.fire('readyContents', contents);\n      contents.document.addEventListener('keydown', (event) => {\n        const keyName = event.key;\n        self.fire('keyDown', { keyName: keyName, shiftKey: event.shiftKey, inner: true });\n        console.log('inner keydown event: ', keyName);\n      });\n    })\n\n    self.gotoPage(target, function() {\n      window._loaded = true;\n      self._initializeReaderStyles();\n\n      if ( callback ) { callback(); }\n\n      self._epubjs_ready = true;\n\n      setTimeout(function() {\n        self.fire('opened');\n        self.fire('ready');\n        clearTimeout(self._queueTimeout);\n        self.tracking.event(\"openBook\", {\n          rootFilePath: self.options.rootFilePath,\n          flow: self.settings.flow,\n          manager: self.settings.manager\n        });\n      }, 100);\n    })\n  },\n\n  _scroll: function(delta) {\n    var self = this;\n    if ( self.options.flow == 'XXscrolled-doc' ) {\n      var container = self._rendition.manager.container;\n      var rect = container.getBoundingClientRect();\n      var scrollTop = container.scrollTop;\n      var newScrollTop = scrollTop;\n      var scrollBy = ( rect.height * 0.98 );\n      switch(delta) {\n        case 'PREV':\n          newScrollTop = -( scrollTop + scrollBy );\n          break;\n        case 'NEXT':\n          newScrollTop = ( scrollTop + scrollBy );\n          break;\n        case 'HOME':\n          newScrollTop = 0;\n          break;\n        case 'END':\n          newScrollTop = container.scrollHeight - scrollBy;\n          break;\n      }\n      container.scrollTop = newScrollTop;\n      return ( Math.floor(container.scrollTop) != Math.floor(scrollTop) );\n    }\n    return false;\n  },\n\n  _navigate: function(promise, callback) {\n    var self = this;\n    self._enableBookLoader(100);\n    promise.then(function() {\n      console.log(\"AHOY NAVIGATE FIN\");\n      self._disableBookLoader();\n      if ( callback ) { callback(); }\n    }).catch(function(e) {\n      self._disableBookLoader();\n      if ( callback ) { callback(); }\n      console.log(\"AHOY NAVIGATE ERROR\", e);\n      throw(e);\n    })\n  },\n\n  next: function() {\n    var self = this;\n    this.tracking.action('reader/go/next');\n    self._scroll('NEXT') || self._navigate(this._rendition.next());\n  },\n\n  prev: function() {\n    this.tracking.action('reader/go/previous');\n    this._scroll('PREV') || this._navigate(this._rendition.prev());\n  },\n\n  first: function() {\n    this.tracking.action('reader/go/first');\n    this._navigate(this._rendition.display(0), undefined);\n  },\n\n  last: function() {\n    var self = this;\n    this.tracking.action('reader/go/last');\n    var target = this._book.spine.length - 1;\n    this._navigate(this._rendition.display(target), undefined);\n  },\n\n  gotoPage: function(target, callback) {\n    var hash;\n    if ( target != null ) {\n      var section = this._book.spine.get(target);\n      if ( ! section) {\n        // maybe it needs to be resolved\n        var guessed = target;\n        if ( guessed.indexOf(\"://\") < 0 ) {\n          var path1 = path.resolve(this._book.path.directory, this._book.package.navPath);\n          var path2 = path.resolve(path.dirname(path1), target);\n          guessed = this._book.canonical(path2);\n        }\n        if ( guessed.indexOf(\"#\") !== 0 ) {\n          hash = guessed.split('#')[1];\n          guessed = guessed.split('#')[0];\n        }\n\n        this._book.spine.each(function(item) {\n          if ( item.canonical == guessed ) {\n            section = item;\n            target = section.href;\n            return;\n          }\n        })\n\n        console.log(\"AHOY GUESSED\", target);\n      } else if ( target.toString().match(/^\\d+$/) ) {\n        console.log(\"AHOY USING\", section.href);\n        target = section.href;\n      }\n\n      if ( ! section ) {\n        if ( ! this._epubjs_ready ) {\n          target = 0;\n        } else {\n          return;\n        }\n      }\n    }\n\n    console.log(\"AHOY gotoPage\", target);\n\n    this.__hash = hash;\n    var navigating = this._rendition.display(target).then(function() {\n      this._rendition.display(target).then(function(a) {\n      })\n    }.bind(this));\n    this._navigate(navigating, callback);\n  },\n\n  percentageFromCfi: function(cfi) {\n    return this._book.percentageFromCfi(cfi);\n  },\n\n  destroy: function() {\n    if ( this._rendition ) {\n      try {\n        this._rendition.destroy();\n      } catch(e) {}\n    }\n    this._rendition = null;\n    this._drawn = false;\n  },\n\n  reopen: function(options, target) {\n    // different per reader?\n    var target = target || this.currentLocation();\n    if( target.start ) { target = target.start ; }\n    if ( target.cfi ) { target = target.cfi ; }\n\n    var doUpdate = false;\n    if ( options === true ) { doUpdate = true; options = {}; }\n    var changed = {};\n    Object.keys(options).forEach(function(key) {\n      if ( options[key] != this.options[key] ) {\n        doUpdate = true;\n        changed[key] = true;\n      }\n      // doUpdate = doUpdate || ( options[key] != this.options[key] );\n    }.bind(this));\n\n    if ( ! doUpdate ) {\n      return;\n    }\n\n    // performance hack\n    if ( Object.keys(changed).length == 1 && changed.scale ) {\n      reader.options.scale = options.scale;\n      this._updateScale();\n      return;\n    }\n\n    if ( options.rootfilePath && options.rootfilePath != this.options.rootfilePath ) {\n      // we need to REOPEN THE DANG BOOK\n      sessionStorage.setItem('rootfilePath', options.rootfilePath);\n      location.reload();\n      return;\n    }\n\n    Util.extend(this.options, options);\n\n    this.draw(target, function() {\n      this._updateFontSize();\n      this._updateScale();\n      this._updateTheme();\n      this._selectTheme(true);\n    }.bind(this))\n  },\n\n  currentLocation: function() {\n    if ( this._rendition && this._rendition.manager ) {\n      this._cached_location = this._rendition.currentLocation();\n    }\n    return this._cached_location;\n  },\n\n  _bindEvents: function() {\n    var self = this;\n\n    // add a stylesheet to stop images from breaking their columns\n    var add_max_img_styles = false;\n    if ( this._book.package.metadata.layout == 'pre-paginated' ) {\n      // NOOP\n    } else if ( this.options.flow == 'auto' || this.options.flow == 'paginated' ) {\n      add_max_img_styles = true;\n    }\n\n    var custom_stylesheet_rules = [];\n\n    // force 90% height instead of default 60%\n    if ( this.metadata.layout != 'pre-paginated' ) {\n      this._rendition.hooks.content.register(function(contents) {\n        contents.addStylesheetRules({\n          \"img\" : {\n            \"max-width\": (this._layout.columnWidth ? this._layout.columnWidth + \"px\" : \"100%\") + \"!important\",\n            \"max-height\": (this._layout.height ? (this._layout.height * 0.9) + \"px\" : \"90%\") + \"!important\",\n            \"object-fit\": \"contain\",\n            \"page-break-inside\": \"avoid\"\n          },\n          \"svg\" : {\n            \"max-width\": (this._layout.columnWidth ? this._layout.columnWidth + \"px\" : \"100%\") + \"!important\",\n            \"max-height\": (this._layout.height ? (this._layout.height * 0.9) + \"px\" : \"90%\") + \"!important\",\n            \"page-break-inside\": \"avoid\"\n          }\n        });\n      }.bind(this._rendition))\n    } else {\n      this._rendition.hooks.content.register(function(contents) {\n        contents.addStylesheetRules({\n          \"img\" : {\n            // \"border\": \"64px solid black !important\",\n            \"box-sizing\": \"border-box !important\"\n          },\n          \"figure\": {\n            \"box-sizing\": \"border-box !important\",\n            \"margin\": \"0 !important\"\n          },\n          \"body\": {\n            \"margin\": \"0\"\n          }\n        });\n      }.bind(this._rendition));\n    }\n\n    this._updateFontSize();\n\n    if ( custom_stylesheet_rules.length ) {\n      this._rendition.hooks.content.register(function(view) {\n        view.addStylesheetRules(custom_stylesheet_rules);\n      })\n    }\n\n    this._rendition.on('resized', function(box) {\n      self.fire('resized', box);\n    })\n\n    this._rendition.on('relocated', function(location) {\n      self.fire('relocated', location);\n    })\n\n    this._rendition.on('displayerror', function(err) {\n      console.log(\"AHOY RENDITION DISPLAY ERROR\", err);\n    })\n\n    this._rendition.on(\"locationChanged\", function(location) {\n      var view = this.manager.current();\n      var section = view.section;\n      var current = this.book.navigation.get(section.href);\n\n      if ( self.__hash && view.contents ) {\n        var check = section.contents.querySelector(`#${self.__hash}`);\n        if ( check ) {\n          var new_target = section.cfiFromElement(check);\n          this.display(new_target);\n          self.__hash = null;\n          return;\n        }\n      }\n\n      self.fire(\"updateSection\", current);\n      self.fire(\"updateLocation\", location);\n      // self.fire(\"relocated\", location);\n    });\n\n    this._rendition.on(\"rendered\", function(section, view) {\n\n      if ( view.contents ) {\n        // view.contents.on(\"xxlinkClicked\", function(href) {\n        //   console.log(\"AHOY CLICKED\", href);\n        //   var tmp = href.split(\"#\");\n        //   href = tmp[0];\n        //   var hash = tmp[1]\n        //   // var current = self.currentLocation().start.href;\n        //   // var section = self._book.spine.get(current.href);\n        //   console.log(\"AHOY CLICKED CHECK\", section.canonical, href);\n        //   if ( section.canonical.indexOf(href) < 0 ) {\n        //     self.gotoPage(href);\n        //     // self._rendition.display(href);\n\n        //   } else if ( hash ) {\n        //     // we're already on this page, so we need to scroll to this location\n        //     var node = view.contents.content.querySelector('#' + hash);\n        //     console.log(\"AHOY INTERNAL\", hash, view.contents, node);\n        //   }\n        //   // self._rendition.display(href);\n        // })\n      }\n\n      if(false) {\n        if ( ! self._rendition.manager.container.dataset.__scroll ) {\n          var ticking;\n          self._rendition.manager.container.addEventListener(\"scroll\", function(event) {\n            if ( self._rendition && self._rendition.manager ) {\n              var container = self._rendition.manager.container;\n              var mod = container.scrollLeft % parseInt(self._rendition.manager.layout.delta, 10);\n              console.log(\"AHOY DETECTED SCROLL\", mod, mod / self._rendition.manager.layout.delta);\n            }\n          });\n          self._rendition.manager.container.dataset.__scroll = true;\n        }\n      }\n\n      self.on('keyDown', function(data) {\n        if ( data.keyName == 'Tab' && data.inner ) {\n          var container = self._rendition.manager.container;\n          var mod;\n          var delta;\n          var x; var xyz;\n          setTimeout(function() {\n            var scrollLeft = container.scrollLeft;\n            mod = scrollLeft % parseInt(self._rendition.manager.layout.delta, 10);\n            if ( mod > 0 && ( mod / self._rendition.manager.layout.delta ) < 0.99 ) {\n              // var x = Math.floor(event.target.scrollLeft / parseInt(self._rendition.manager.layout.delta, 10)) + 1;\n              // var delta = ( x * self._rendition.manager.layout.delta) - event.target.scrollLeft;\n              x = Math.floor(container.scrollLeft / parseInt(self._rendition.manager.layout.delta, 10));\n              if ( data.shiftKey ) { x -= 0 ; }\n              else { x += 1; }\n              var y = container.scrollLeft;\n              delta = ( x * self._rendition.manager.layout.delta ) - y;\n              xyz = ( x * self._rendition.manager.layout.delta );\n              // if ( data.shiftKey ) { delta *= -1 ; }\n              if ( true || ! data.shiftKey ) {\n                self._rendition.manager.scrollBy(delta);\n              }\n            }\n            console.log(\"AHOY DOING THE SCROLLING\", data.shiftKey, scrollLeft, mod, x, xyz, delta);\n          }, 0);\n        }\n      })\n\n\n    })\n  },\n\n  _initializeReaderStyles: function() {\n    var self = this;\n    var themes = this.options.themes;\n    if ( themes ) {\n      themes.forEach(function(theme) {\n        self._rendition.themes.register(theme['klass'], theme.href ? theme.href : theme.rules);\n      })\n    }\n\n    // base for highlights\n    this._rendition.themes.override('.epubjs-hl', \"fill: yellow; fill-opacity: 0.3; mix-blend-mode: multiply;\");\n  },\n\n  _selectTheme: function(refresh) {\n    var theme = this.options.theme || 'default';\n    this._rendition.themes.select(theme);\n    if ( 0 && refresh ) {\n      var cfi = this.currentLocation().end.cfi;\n      this._rendition.manager.clear();\n      console.log(\"AHOY\", cfi);\n      this._rendition.display(cfi);\n    }\n  },\n\n  _updateFontSize: function() {\n    if ( this.metadata.layout == 'pre-paginated') {\n      // we're not doing font changes for pre-paginted\n      return;\n    }\n\n    var text_size = this.options.text_size == 'auto' ? 100 : this.options.text_size;\n    this._rendition.themes.fontSize(`${text_size}%`);\n  },\n\n  _updateScale: function() {\n    if ( this.metadata.layout != 'pre-paginated') {\n      // we're not scaling for reflowable\n      return;\n    }\n    var scale = this.options.scale;\n    if ( scale ) {\n      this.settings.scale = parseInt(scale, 10) / 100.0;\n      this._queueScale();\n    }\n  },\n\n  _queueScale: function(scale) {\n    this._queueTimeout = setTimeout(function() {\n      if ( this._rendition.manager && this._rendition.manager.stage ) {\n        console.log(\"AHOY SCALING\", this.settings.scale);\n        this._rendition.scale(this.settings.scale);\n      } else {\n        this._queueScale();\n      }\n    }.bind(this), 100);\n  },\n\n  EOT: true\n\n})\n\nObject.defineProperty(Reader.EpubJS.prototype, 'metadata', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    return this._metadata;\n  },\n\n  set: function(data) {\n    this._metadata = Util.extend({}, data, this.options.metadata);\n  }\n});\n\nObject.defineProperty(Reader.EpubJS.prototype, 'annotations', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    if ( Browser.ie ) {\n      return {\n        reset: function() { /* NOOP */ },\n        highlight: function(cfiRange) { /* NOOP */ }\n      }\n    }\n    if ( ! this._rendition.annotations.reset ) {\n      this._rendition.annotations.reset = function(){\n        for(var hash in this._annotations) {\n            var cfiRange = decodeURI(hash);\n            this.remove(cfiRange);\n        }\n        this._annotationsBySectionIndex = {};\n      }.bind(this._rendition.annotations);\n    }\n    return this._rendition.annotations;\n  }\n});\n\nObject.defineProperty(Reader.EpubJS.prototype, 'locations', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    return this._book.locations;\n  }\n});\n\nwindow.Reader = Reader;\n\nexport function createReader(id, options) {\n  return new Reader.EpubJS(id, options);\n}\n","import * as Util from '../core/Util';\nimport {Reader} from './Reader';\nimport * as DomUtil from '../dom/DomUtil';\n\nReader.Mock = Reader.extend({\n\n  initialize: function(id, options) {\n    Reader.prototype.initialize.apply(this, arguments);\n  },\n\n  open: function(target, callback) {\n    var self = this;\n    this._book = {\n      metadata: {\n        title: 'The Mock Life',\n        creator: 'Alex Mock',\n        publisher: 'University Press',\n        location: 'Ann Arbor, MI',\n        pubdate: '2017-05-23'\n      },\n      contents: {\n        toc: [\n          {id: 1, href: \"/epubs/mock/ops/xhtml/TitlePage.xhtml\", label: \"Title\", parent: null},\n          {id: 2, href: \"/epubs/mock/ops/xhtml/Chapter01.xhtml\", label: \"Chapter 1\", parent: null},\n          {id: 3, href: \"/epubs/mock/ops/xhtml/Chapter02.xhtml\", label: \"Chapter 2\", parent: null},\n          {id: 4, href: \"/epubs/mock/ops/xhtml/Chapter03.xhtml\", label: \"Chapter 3\", parent: null},\n          {id: 5, href: \"/epubs/mock/ops/xhtml/Chapter04.xhtml\", label: \"Chapter 4\", parent: null},\n          {id: 6, href: \"/epubs/mock/ops/xhtml/Chapter05.xhtml\", label: \"Chapter 5\", parent: null},\n          {id: 7, href: \"/epubs/mock/ops/xhtml/Chapter06.xhtml\", label: \"Chapter 6\", parent: null},\n          {id: 8, href: \"/epubs/mock/ops/xhtml/Chapter07.xhtml\", label: \"Chapter 7\", parent: null},\n          {id: 9, href: \"/epubs/mock/ops/xhtml/Index.xhtml\", label: \"Index\", parent: null},\n        ]\n      }\n    };\n\n    this._locations = [\n      'epubcfi(/6/4[TitlePage.xhtml])',\n      'epubcfi(/6/4[Chapter01.xhtml])',\n      'epubcfi(/6/4[Chapter02.xhtml])',\n      'epubcfi(/6/4[Chapter03.xhtml])',\n      'epubcfi(/6/4[Chapter04.xhtml])',\n      'epubcfi(/6/4[Chapter05.xhtml])',\n      'epubcfi(/6/4[Chapter06.xhtml])',\n      'epubcfi(/6/4[Chapter07.xhtml])',\n      'epubcfi(/6/4[Chapter08.xhtml])',\n      'epubcfi(/6/4[Index.xhtml])',\n    ];\n\n    this.__currentIndex = 0;\n\n    this.metadata = this._book.metadata;\n    this.fire('updateContents', this._book.contents);\n    this.fire('updateTitle', this._metadata);\n    this.fire('updateLocations', this._locations);\n    this.draw(target, callback);\n  },\n\n  draw: function(target, callback) {\n    var self = this;\n    this.settings = { flow: this.options.flow };\n    this.settings.height = '100%';\n    this.settings.width = '99%';\n    // this.settings.width = '100%';\n    if ( this.options.flow == 'auto' ) {\n      this._panes['book'].style.overflow = 'hidden';\n    } else {\n      this._panes['book'].style.overflow = 'auto';\n    }\n    if ( typeof(target) == 'function' && cb === undefined ) {\n      callback = target;\n      target = undefined;\n    }\n    callback();\n    self.fire('ready');\n  },\n\n  next: function() {\n    // this._rendition.next();\n  },\n\n  prev: function() {\n    // this._rendition.prev();\n  },\n\n  first: function() {\n    // this._rendition.display(0);\n  },\n\n  last: function() {\n  },\n\n  gotoPage: function(target) {\n    if ( typeof(target) == \"string\" ) {\n      this.__currentIndex = this._locations.indexOf(target);\n    } else {\n      this.__currentIndex = target;\n    }\n    this.fire(\"relocated\", this.currentLocation());\n  },\n\n  destroy: function() {\n    // if ( this._rendition ) {\n    //   this._rendition.destroy();\n    // }\n    // this._rendition = null;\n  },\n\n  currentLocation: function() {\n    var cfi = this._locations[this.__currentIndex];\n    return {\n      start: { cfi: cfi, href: cfi },\n      end: { cfi: cfi, href: cfi }\n    }\n  },\n\n  _bindEvents: function() {\n    var self = this;\n\n  },\n\n  _updateTheme: function() {\n\n  },\n\n  EOT: true\n\n})\n\nObject.defineProperty(Reader.Mock.prototype, 'metadata', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    return this._metadata;\n  },\n\n  set: function(data) {\n    this._metadata = Util.extend({}, data, this.options.metadata);\n  }\n});\n\nObject.defineProperty(Reader.Mock.prototype, 'locations', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    var self = this;\n    return {\n      total: self._locations.length,\n      locationFromCfi: function(cfi) {\n        return self._locations.indexOf(cfi);\n      },\n      percentageFromCfi: function(cfi) {\n        var index = self.locations.locationFromCfi(cfi);\n        return ( index / self.locations.total );\n      },\n      cfiFromPercentage: function(percentage) {\n        var index = Math.ceil(percentage * 10);\n        return self._locations[index];\n      }\n    }\n  }\n});\n\nObject.defineProperty(Reader.Mock.prototype, 'annotations', {\n  get: function() {\n    return {\n      reset: function() {},\n      highlight: function() {}\n    }\n  }\n})\n\nexport function createReader(id, options) {\n  return new Reader.Mock(id, options);\n}\n","import {Reader} from './Reader';\nimport * as EpubJS from './Reader.EpubJS';\nimport * as Mock from './Reader.Mock';\n\nvar engines = {\n  epubjs: EpubJS.createReader,\n  mock: Mock.createReader\n}\n\nexport var reader = function(id, options) {\n  options = options || {};\n  var engine = options.engine || window.COZY_EPUB_ENGINE || 'epubjs';\n  var engine_href = options.engine_href || window.COZY_EPUB_ENGINE_HREF;\n  var _this = this;\n  var _arguments = arguments;\n\n  options.engine = engine;\n  options.engine_href = engine_href;\n\n  return engines[engine].apply(_this, [id, options]);\n}"],"names":["global","this","extend","dest","i","j","len","src","arguments","length","create","Object","F","proto","prototype","bind","fn","obj","slice","Array","apply","call","args","concat","lastId","stamp","_cozy_id","throttle","time","context","lock","wrapperFn","later","setTimeout","wrapNum","x","range","includeMax","max","min","d","falseFn","formatNum","num","digits","pow","Math","round","isNumeric","isNaN","parseFloat","isFinite","trim","str","replace","splitWords","split","setOptions","options","hasOwnProperty","getParamString","existingUrl","uppercase","params","push","encodeURIComponent","toUpperCase","indexOf","join","templateRe","template","data","key","value","undefined","Error","isArray","toString","array","el","emptyImageUrl","getPrefixed","name","window","lastTime","timeoutDefer","Date","timeToCall","requestFn","requestAnimationFrame","cancelFn","cancelAnimationFrame","id","clearTimeout","requestAnimFrame","immediate","cancelAnimFrame","loader","js","url","handler","_resolved","callbacks","error","then","cb","resolve","catch","reject","_argv","shift","e","console","log","trace","element","document","createElement","onload","onerror","async","parent","attr","appendChild","Class","props","NewClass","initialize","callInitHooks","parentProto","__super__","Util","constructor","statics","includes","checkDeprecatedMixinEvents","_initHooks","_initHooksCalled","include","mergeOptions","addInitHook","init","cozy","Mixin","Evented","on","types","type","_on","off","_events","_off","typeListeners","newListener","ctx","listeners","l","_firingCount","splice","fire","propagate","listens","event","target","_propagateEvent","_eventParents","once","addEventParent","removeEventParent","layer","addEventListener","removeEventListener","clearAllEventListeners","addOneTimeEventListener","fireEvent","hasEventListeners","style","documentElement","ie","ielt9","edge","navigator","webkit","userAgentContains","android","android23","opera","chrome","gecko","safari","phantom","opera12","win","platform","ie3d","webkit3d","WebKitCSSMatrix","gecko3d","any3d","L_DISABLE_3D","mobile","orientation","mobileWebkit","mobileWebkit3d","msPointer","PointerEvent","MSPointerEvent","pointer","touch","L_NO_TOUCH","DocumentTouch","mobileOpera","mobileGecko","retina","devicePixelRatio","screen","deviceXDPI","logicalXDPI","canvas","getContext","svg","vml","div","innerHTML","shape","firstChild","behavior","babelHelpers.typeof","adj","columnCount","classList","userAgent","toLowerCase","Point","y","clone","add","point","_add","toPoint","subtract","_subtract","divideBy","_divideBy","multiplyBy","_multiplyBy","scaleBy","unscaleBy","_round","floor","_floor","ceil","_ceil","distanceTo","sqrt","equals","contains","abs","POINTER_DOWN","Browser","POINTER_MOVE","POINTER_UP","POINTER_CANCEL","TAG_WHITE_LIST","_pointers","_pointerDocListener","_pointersCount","addPointerListener","_addPointerStart","_addPointerMove","_addPointerEnd","removePointerListener","onDown","pointerType","MSPOINTER_TYPE_MOUSE","tagName","DomEvent","_handlePointer","_globalPointerDown","_globalPointerMove","_globalPointerUp","pointerId","touches","changedTouches","onMove","buttons","onUp","_touchstart","_touchend","_pre","addDoubleTapListener","last","doubleTap","delay","onTouchStart","count","now","delta","onTouchEnd","cancelBubble","newTouch","prop","removeDoubleTapListener","touchstart","touchend","dblclick","addOne","eventsKey","removeOne","originalHandler","isExternalTarget","filterClick","attachEvent","detachEvent","stopPropagation","originalEvent","_stopped","skipped","disableScrollPropagation","disableClickPropagation","fakeStop","preventDefault","returnValue","stop","getMousePosition","container","clientX","clientY","rect","getBoundingClientRect","left","clientLeft","top","clientTop","wheelPxFactor","getWheelDelta","wheelDeltaY","deltaY","deltaMode","deltaX","deltaZ","wheelDelta","detail","skipEvents","events","related","relatedTarget","parentNode","err","lastClick","timeStamp","elapsed","_simulatedClick","_simulated","Element","matches","ep","webkitMatchesSelector","msMatchesSelector","mozMatchesSelector","TRANSFORM","testProp","TRANSITION","TRANSITION_END","get","getElementById","getStyle","currentStyle","defaultView","css","getComputedStyle","className","remove","removeChild","empty","toFront","toBack","insertBefore","hasClass","getClass","RegExp","test","addClass","classes","setClass","removeClass","baseVal","setOpacity","opacity","_setOpacityIE","filter","filterName","filters","item","Enabled","Opacity","isPropertySupported","setTransform","offset","scale","pos","setPosition","_leaflet_pos","getPosition","disableTextSelection","enableTextSelection","_userSelect","userSelectProperty","disableImageDrag","enableImageDrag","_outlineElement","_outlineStyle","preventOutline","tabIndex","restoreOutline","outline","freeGlobal","Symbol","root","objectProto","nativeObjectToString","symToStringTag","getRawTag","objectToString","isObject","baseGetTag","coreJsData","funcProto","funcToString","isMasked","isFunction","toSource","getValue","baseIsNative","defineProperty","getNative","eq","baseAssignValue","assignValue","nativeMax","identity","constant","shortOut","baseSetToString","setToString","overRest","isLength","MAX_SAFE_INTEGER","isArrayLike","isIndex","baseRest","isIterateeCall","isObjectLike","baseIsArguments","stubFalse","argsTag","funcTag","nodeUtil","baseUnary","baseIsTypedArray","isArguments","isBuffer","isTypedArray","baseTimes","overArg","isPrototype","nativeKeys","arrayLikeKeys","baseKeys","createAssigner","copyObject","keys","keyboardAllowed","val","fnMap","ret","eventNameMap","change","fullscreenchange","fullscreenerror","screenfull","request","elem","requestFullscreen","ALLOW_KEYBOARD_INPUT","exit","exitFullscreen","toggle","isFullscreen","onchange","callback","eventName","raw","defineProperties","Boolean","fullscreenElement","enumerable","enabled","fullscreenEnabled","Reader","regions","metadata","flow","engine","fontSizeLarge","fontSizeSmall","fontSizeDefault","trackResize","text_size","mobileMediaQuery","forceScrolledDocHeight","theme","rootfilePath","themes","self","_original_document_title","title","localStorage","getItem","assign","JSON","parse","_checkFeatureCompatibility","_initContainer","_initLayout","forEach","href","klass","rules","rule","new_rule","_updateTheme","_initEvents","_mode","mode","start","engine_href","_start","_loaded","open","reopen","saveOptions","saved_options","setItem","stringify","DomUtil","_container","dataset","draw","next","prev","display","index","gotoPage","goBack","history","back","goForward","forward","_preResize","_onScroll","_containerId","_fadeAnimated","fadeAnimation","position","_initPanes","panes","_panes","prefix","_initBookLoader","_checkIfLoaded","_targets","tracking","reader","_action","_last_location_start","_reader","action","v","pop","pageview","location","cfi","transform3DLimit","_onMoveEnd","location_href","_ignoreHistory","tmp_href","substr","pushState","percentage","p","isTrusted","state","keyName","check","activeElement","localName","parentElement","IGNORE_TARGETS","shiftKey","_scroll","scrollTop","scrollLeft","_handleDOMEvent","keyCode","srcElement","_fireDOMEvent","targets","synth","_findEventTargets","isMarker","containerPoint","latLngToContainerPoint","getLatLng","mouseEventToContainerPoint","layerPoint","containerPointToLayerPoint","latlng","layerPointToLatLng","nonBubblingEvents","getFixedBookPanelSize","h","clientHeight","paddingTop","paddingBottom","w","clientWidth","paddingRight","paddingLeft","height","width","invalidateSize","_drawn","_resizeRequest","_resizeBookPane","_setupHooks","_checkMobileDevice","_isMobile","matchMedia","_enableBookLoader","_clearBookLoaderTimeout","_force_progress","_loader_timeout","_disableBookLoader","force","loader_template","loaderTemplate","body","DOMParser","parseFromString","children","EOT","Control","_locked","_id","getTime","parseInt","random","getRegion","region","setRegion","removeControl","addControl","getContainer","addTo","onAdd","area","getControlRegion","onRemove","_refocusOnMap","screenX","screenY","focus","_className","widget","direction","control","getControlContainer","_controlContainer","parts","tmp","slug","panel","getControlRegion_1","slot","childElement","_classify","_clearControlRegion","_controlRegions","PageControl","_control","querySelector","_createButton","_fill","html","label","_bindEvents","link","setAttribute","_unit","s","unit","_label","PagePrevious","PageNext","PageFirst","first","PageLast","pageNext","pagePrevious","pageFirst","pageLast","activeModal","FOCUSABLE_ELEMENTS","ACTIONABLE_ELEMENTS","Modal","fraction","actions","onShow","onClose","handlers","_initializedEvents","panelHTML","main","button_cls","modal","onClick","onKeydown","onModalTransition","button_id","button","close","closeModal","deactivate","removeEventListeners","showModal","_resize","setFocusToFirstNode","addEventListeners","activate","offsetHeight","offsetWidth","header","footer","getFocusableNodes","nodes","querySelectorAll","map","focusableNodes","getActionableNodes","maintainFocus","closeAfterAction","hasAttribute","actionableNodes","click","selector","getAttribute","focusedItemIndex","Contents","defaultTemplate","_modal","_setupSkipLink","_process","items","tabindex","option","_createOption","subitems","toc","chapter","anchor","textContent","span","skipLink","ul","contents","Title","h1","_title","_divider","_section","bookTitle","PublicationMetadata","_publisher","_rights","publisher","rights","publicationMetadata","Preferences","hasThemes","_activated","updatePreferences","initializeForm","_createPanel","possible_fieldsets","layout","rootfiles","_fieldsets","cls","fieldset","fields","hasFields","field","inputs","input","checked","hint","_form","new_options","saveable_options","updateForm","Fieldset","_current","TextSize","form","_input","_output","_preview","_actionReset","_updatePreview","saveable","fontSize","Display","scrolled_help","Theme","Rendition","expr","rootfile","accessMode","Scale","transform","preferences","Widget","_onAddExtra","_updateTemplate","_updateClass","node","Button","Panel","Toggle","states","stateName","_resetState","_state","Citation","designMode","formatted","createRange","selectNode","sel","getSelection","removeAllRanges","addRange","flag","execCommand","_message","detach","citations","citation","format","text","createTextNode","_formatted","_initializeForm","_formatCitation","selected","Search","_data","_canceled","_processing","_article","searchString","openModalResults","openModalWaiting","submitQuery","_emptyArticle","_buildResults","searchUrl","XMLHttpRequest","status","response","send","hasChildNodes","lastChild","content","annotations","reset","highlight","highlight_off","search_results","result","cfiRange","snippet","chapterTitle","search","BibliographicInformation","dl","metadata_fields","idx","_formatDate","metadata_fields_seen","dt","dd","match","bibliographicInformation","Download","_configureDownloadForm","submit","download_links","size","download","Navigator","_setup","locations","_initializeNavigator","_createControl","_background","_status","_spanCurrentPercentage","_spanCurrentLocation","_spanTotalLocations","_update","_mouseDown","_initiated","percentageFromCfi","currentLocation","cfiFromPercentage","current","rangeBg","current_location","locationFromCfi","_last_delta","_last_value","_total","total","Bus","instance","bus","Events","ePub","require","EpubJS","_epubjs_ready","xpath","path","sessionStorage","book_href","book_options","packagePath","useArchive","openAs","_book","epubjs","removeItem","loaded","navigation","_contents","package","ready","parseRootfiles","spine","each","cfiBase","_locations","t","f","_rendition","manager","stage","generate","load","containerDoc","hooks","clear","destroy","settings","overflow","spread","_drawRendition","renderTo","_updateFontSize","hash","status_index","register","inner","_initializeReaderStyles","_queueTimeout","rootFilePath","newScrollTop","scrollBy","scrollHeight","_navigate","promise","section","guessed","path1","directory","navPath","path2","dirname","canonical","__hash","navigating","a","doUpdate","changed","_updateScale","reload","_selectTheme","_cached_location","custom_stylesheet_rules","addStylesheetRules","_layout","columnWidth","view","box","book","new_target","cfiFromElement","mod","xyz","override","refresh","select","_queueScale","_metadata","set","_annotations","decodeURI","_annotationsBySectionIndex","createReader","Mock","creator","pubdate","__currentIndex","end","engines","mock","COZY_EPUB_ENGINE","COZY_EPUB_ENGINE_HREF","_this"],"mappings":"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"}
>>>>>>> be28337... track hash during navigation
